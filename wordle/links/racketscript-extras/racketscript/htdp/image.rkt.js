import * as $rjs_core from '../../../../runtime/core.js';import * as M0 from "../../../../collects/racket/private/list.rkt.js";import * as M1 from "../private/jscommon.rkt.js";import * as M2 from "../../../racketscript-compiler/racketscript/private/interop.rkt.js";import * as M3 from "../../../../runtime/kernel.rkt.js";import * as M4 from "../../../../collects/racket/private/map.rkt.js";import * as M5 from "./private/color.rkt.js";import * as M6 from "../../../racketscript-compiler/racketscript/interop.rkt.js";var let_result1640 = M3.make_struct_type($rjs_core.PrimitiveSymbol.make("posn"),false,2,0,false,M3.rnull,false,false,$rjs_core.Pair.makeList(0,1),false,$rjs_core.PrimitiveSymbol.make("posn"));var struct_2735 = let_result1640.getAt(0);var make_2736 = let_result1640.getAt(1);var __p2737 = let_result1640.getAt(2);var __ref2738 = let_result1640.getAt(3);var __set_bang_2739 = let_result1640.getAt(4);var let_result1641 = M3.values(struct_2735,make_2736,__p2737,M3.make_struct_field_accessor(__ref2738,0,$rjs_core.PrimitiveSymbol.make("x")),M3.make_struct_field_accessor(__ref2738,1,$rjs_core.PrimitiveSymbol.make("y")));var struct_posn = let_result1641.getAt(0);var make_posn = let_result1641.getAt(1);var posn_p = let_result1641.getAt(2);var posn_x = let_result1641.getAt(3);var posn_y = let_result1641.getAt(4);var ___gt_web_color = function(p2740) {if (M3.string_p(p2740)!==false) {var if_res1644 = M5.string__gt_web_color(p2740);} else {if (M5.color_p(p2740)!==false) {var if_res1643 = M5.color__gt_web_color(p2740);} else {if (M3.symbol_p(p2740)!==false) {var if_res1642 = M5.string__gt_web_color(M3.symbol__gt_string(p2740));} else {var if_res1642 = M3.error($rjs_core.PrimitiveSymbol.make("color"),$rjs_core.UString.make("invalid color"));}var if_res1643 = if_res1642;}var if_res1644 = if_res1643;}return if_res1644;};var print_image = function(d2741) {var canvas2742 = M1.document.createElement("canvas");var ctx2743 = canvas2742.getContext("2d");M1.document.body.appendChild(canvas2742);M1.document.body.appendChild(M1.document.createElement("br"));canvas2742.width = d2741.width;canvas2742.height = d2741.height;ctx2743.save();ctx2743.translate(d2741.width/2,d2741.height/2);d2741.render(ctx2743,0,0);return ctx2743.restore();};var canvas2744 = M1.document.createElement("canvas");var __times_invisible_canvas_context_times_ = canvas2744.getContext("2d");var empty_image = {'type':$rjs_core.UString.make("empty-image"),'width':0,'height':0,'render':function(ctx2745, x2746, y2747) {return M3.rvoid();}};var image_height = function(i2748) {return i2748.height;};var image_width = function(i2749) {return i2749.width;};var EmptyScene = function(width2750, height2751, borders_p2752) {var this2753 = this;this2753.type = $rjs_core.UString.make("empty-scene");this2753.width = width2750;this2753.height = height2751;this2753.borders_p = borders_p2752;return null;};EmptyScene.prototype.render = function(ctx2754, x2755, y2756) {return M3.rvoid();};var Text = function(text2757, size2758, color2759, face2760, family2761, style2762, weight2763, underline_p2764) {var this2765 = this;this2765.type = $rjs_core.UString.make("text");this2765.text = text2757;this2765.size = size2758;this2765.color = ___gt_web_color(color2759);this2765.face = face2760;this2765.family = family2761;this2765.style = style2762;this2765.weight = weight2763;this2765.underline = underline_p2764;return this2765._updateMetrics();};Text.prototype._updateMetrics = function() {var this2766 = this;var font2767 = M3.string_append(this2766.weight,$rjs_core.UString.make(" "),this2766.style,$rjs_core.UString.make(" "),M3.number__gt_string(this2766.size),$rjs_core.UString.make("px "),this2766.face,$rjs_core.UString.make(" "),this2766.family);__times_invisible_canvas_context_times_.font = M6.js_string(font2767);var let_result1645 = M3.values();var metrics2768 = __times_invisible_canvas_context_times_.measureText(M6.js_string(this2766.text));this2766.font = font2767;this2766.width = metrics2768.width;this2766.height = this2766.size;return null;};Text.prototype.render = function(ctx2769, x2770, y2771) {var this2772 = this;ctx2769.save();ctx2769.translate(x2770,y2771);ctx2769.font = M6.js_string(this2772.font);ctx2769.textAlign = "center";ctx2769.textBaseline = "middle";ctx2769.fillStyle = M6.js_string(this2772.color);ctx2769.fillText(M6.js_string(this2772.text),0,0);return ctx2769.restore();};var Line = function(x2773, y2774, pen_or_color2775) {var this2776 = this;this2776.type = $rjs_core.UString.make("line");this2776.width = M1.abs_plus_ceil(x2773);this2776.height = M1.abs_plus_ceil(y2774);this2776.mode = false;this2776.pen = pen_or_color2775;return null;};Line.prototype.render = function(ctx2777, x2778, y2779) {var this2780 = this;ctx2777.save();var let_result1646 = M3.values();ctx2777.translate(x2778,y2779);var let_result1647 = M3.values();ctx2777.beginPath();var let_result1648 = M3.values();var sx2781 = M3.__(M3.abs(this2780.x/2));var sy2782 = M3.__(M3.abs(this2780.y/2));if (M3.__gt__eq_(x2778,0)!==false) {var if_res1649 = M3.__gt__eq_(y2779,0);} else {var if_res1649 = false;}if (if_res1649!==false) {ctx2777.moveTo(sx2781,sy2782);var if_res1656 = ctx2777.lineTo(sx2781+x2778,sy2782+y2779);} else {if (M3.__gt__eq_(x2778,0)!==false) {var if_res1650 = M3.__lt_(y2779,0);} else {var if_res1650 = false;}if (if_res1650!==false) {ctx2777.moveTo(sx2781+x2778,sy2782);var if_res1655 = ctx2777.lineTo(sx2781,sy2782-y2779);} else {if (M3.__lt_(x2778,0)!==false) {var if_res1651 = M3.__gt__eq_(y2779,0);} else {var if_res1651 = false;}if (if_res1651!==false) {ctx2777.moveTo(sx2781,sy2782+y2779);var if_res1654 = ctx2777.lineTo(sx2781-x2778,sy2782);} else {if (M3.__lt_(x2778,0)!==false) {var if_res1652 = M3.__lt_(y2779,0);} else {var if_res1652 = false;}if (if_res1652!==false) {ctx2777.moveTo(sx2781-x2778,sy2782-y2779);var if_res1653 = ctx2777.lineTo(sx2781,sy2782);} else {var if_res1653 = M3.rvoid();}var if_res1654 = if_res1653;}var if_res1655 = if_res1654;}var if_res1656 = if_res1655;}if_res1656;var or_part2783 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2783!==false) {var if_res1657 = or_part2783;} else {var if_res1657 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("outline"));}if (if_res1657!==false) {ctx2777.strokeStyle = M6.js_string(___gt_web_color(this2780.pen));var if_res1660 = ctx2777.stroke();} else {var or_part2784 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2784!==false) {var if_res1658 = or_part2784;} else {var if_res1658 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("solid"));}if (if_res1658!==false) {ctx2777.fillStyle = M6.js_string(___gt_web_color(this2780.pen));var if_res1659 = ctx2777.fill();} else {var if_res1659 = M3.rvoid();}var if_res1660 = if_res1659;}if_res1660;ctx2777.closePath();return ctx2777.restore();};var Rectangle = function(width2785, height2786, mode2787, pen_or_color2788) {var this2789 = this;this2789.type = $rjs_core.UString.make("rectangle");this2789.width = width2785;this2789.height = height2786;this2789.mode = mode2787;this2789.pen = pen_or_color2788;return null;};Rectangle.prototype.render = function(ctx2790, x2791, y2792) {var this2793 = this;ctx2790.save();ctx2790.translate(x2791,y2792);ctx2790.beginPath();var width2794 = this2793.width;var height2795 = this2793.height;var start_x2796 = M3.__(width2794/2);var start_y2797 = M3.__(height2795/2);ctx2790.rect(start_x2796,start_y2797,width2794,height2795);var or_part2798 = M3.equal_p(this2793.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2798!==false) {var if_res1661 = or_part2798;} else {var if_res1661 = M3.equal_p(this2793.mode,$rjs_core.UString.make("outline"));}if (if_res1661!==false) {ctx2790.strokeStyle = M6.js_string(___gt_web_color(this2793.pen));var if_res1664 = ctx2790.stroke();} else {var or_part2799 = M3.equal_p(this2793.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2799!==false) {var if_res1662 = or_part2799;} else {var if_res1662 = M3.equal_p(this2793.mode,$rjs_core.UString.make("solid"));}if (if_res1662!==false) {ctx2790.fillStyle = M6.js_string(___gt_web_color(this2793.pen));var if_res1663 = ctx2790.fill();} else {var if_res1663 = M3.rvoid();}var if_res1664 = if_res1663;}if_res1664;ctx2790.closePath();return ctx2790.restore();};var Circle = function(radius2800, mode2801, pen_or_color2802) {var this2803 = this;var diameter2804 = radius2800*2;this2803.type = $rjs_core.UString.make("circle");this2803.radius = radius2800;this2803.width = diameter2804;this2803.height = diameter2804;this2803.mode = mode2801;this2803.pen = pen_or_color2802;return null;};Circle.prototype.render = function(ctx2805, x2806, y2807) {var this2808 = this;var radius2809 = this2808.radius;ctx2805.save();ctx2805.translate(x2806,y2807);ctx2805.beginPath();ctx2805.ellipse(0,0,radius2809,radius2809,0,0,M1.Math.PI*2);var or_part2810 = M3.equal_p(this2808.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2810!==false) {var if_res1665 = or_part2810;} else {var if_res1665 = M3.equal_p(this2808.mode,$rjs_core.UString.make("outline"));}if (if_res1665!==false) {ctx2805.strokeStyle = M6.js_string(___gt_web_color(this2808.pen));var if_res1668 = ctx2805.stroke();} else {var or_part2811 = M3.equal_p(this2808.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2811!==false) {var if_res1666 = or_part2811;} else {var if_res1666 = M3.equal_p(this2808.mode,$rjs_core.UString.make("solid"));}if (if_res1666!==false) {ctx2805.fillStyle = M6.js_string(___gt_web_color(this2808.pen));var if_res1667 = ctx2805.fill();} else {var if_res1667 = M3.rvoid();}var if_res1668 = if_res1667;}if_res1668;ctx2805.closePath();return ctx2805.restore();};var Polygon = function(vertices2812, mode2813, pen_or_color2814) {var this2815 = this;var xs2816 = M4.map(posn_x,vertices2812);var ys2817 = M4.map(posn_y,vertices2812);var width2818 = M3.apply(M3.max,xs2816)-M3.apply(M3.min,xs2816);var height2819 = M3.apply(M3.max,ys2817)-M3.apply(M3.min,xs2816);this2815.type = $rjs_core.UString.make("polygon");this2815.vertices = vertices2812;this2815.width = width2818;this2815.height = height2819;this2815.mode = mode2813;this2815.pen = pen_or_color2814;return null;};Polygon.prototype.render = function(ctx2820, x2821, y2822) {var this2823 = this;var first_point2824 = M3.car(this2823.vertices);var rest_points2825 = M3.cdr(this2823.vertices);var radius2826 = this2823.radius;ctx2820.save();ctx2820.translate(x2821,y2822);ctx2820.beginPath();ctx2820.moveTo(posn_x(first_point2824),posn_y(first_point2824));var loop2827 = function(points2828) {if (M3.null_p(points2828)!==false) {var if_res1669 = M3.rvoid();} else {var pt2829 = M3.car(points2828);ctx2820.lineTo(posn_x(pt2829),posn_y(pt2829));var if_res1669 = loop2827(M3.cdr(points2828));}return if_res1669;};loop2827(rest_points2825);var or_part2830 = M3.equal_p(this2823.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2830!==false) {var if_res1670 = or_part2830;} else {var if_res1670 = M3.equal_p(this2823.mode,$rjs_core.UString.make("outline"));}if (if_res1670!==false) {ctx2820.strokeStyle = M6.js_string(___gt_web_color(this2823.pen));var if_res1673 = ctx2820.stroke();} else {var or_part2831 = M3.equal_p(this2823.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2831!==false) {var if_res1671 = or_part2831;} else {var if_res1671 = M3.equal_p(this2823.mode,$rjs_core.UString.make("solid"));}if (if_res1671!==false) {ctx2820.fillStyle = M6.js_string(___gt_web_color(this2823.pen));var if_res1672 = ctx2820.fill();} else {var if_res1672 = M3.rvoid();}var if_res1673 = if_res1672;}if_res1673;ctx2820.closePath();return ctx2820.restore();};var empty_scene = function(width2832, height2833) {return new EmptyScene(width2832,height2833,false);};var text = function(txt2834, size2835, color2836) {return new Text(txt2834,size2835,color2836,$rjs_core.UString.make(""),$rjs_core.UString.make("serif"),$rjs_core.UString.make("normal"),$rjs_core.UString.make("normal"),false);};var text_by_font = function(txt2837, size2838, color2839, face2840, family2841, style2842, weight2843, underline_p2844) {var or_part2845 = face2840;if (or_part2845!==false) {var if_res1677 = or_part2845;} else {var if_res1677 = $rjs_core.UString.make("");}if (M3.symbol_p(family2841)!==false) {var if_res1676 = M3.symbol__gt_string(family2841);} else {var if_res1676 = family2841;}if (M3.symbol_p(style2842)!==false) {var if_res1675 = M3.symbol__gt_string(style2842);} else {var if_res1675 = style2842;}if (M3.symbol_p(weight2843)!==false) {var if_res1674 = M3.symbol__gt_string(weight2843);} else {var if_res1674 = weight2843;}return new Text(txt2837,size2838,color2839,if_res1677,if_res1676,if_res1675,if_res1674,underline_p2844);};var line = function(x2846, y2847, pen_or_color2848) {return new Line(x2846,y2847,pen_or_color2848);};var rectangle = function(w2849, h2850, m2851, p2852) {return new Rectangle(w2849,h2850,m2851,p2852);};var square = function(s2853, m2854, p2855) {return new Rectangle(s2853,s2853,m2854,p2855);};var circle = function(r2856, m2857, p2858) {return new Circle(r2856,m2857,p2858);};var triangle = function(side2859, mode2860, color2861) {var height2862 = side2859*(M3.sqrt(3)/2);return new Polygon(M3.list(make_posn(M3.__(side2859/2),height2862/2),make_posn(0,M3.__(height2862/2)),make_posn(side2859/2,height2862/2)),mode2860,color2861);};var Overlay = function(x_place2863, y_place2864, ima2865, imb2866) {var this2867 = this;var ima_cx2868 = ima2865.width/2;var ima_cy2869 = ima2865.height/2;var imb_cx2870 = imb2866.width/2;var imb_cy2871 = imb2866.height/2;var tmp2873 = x_place2863;if (M3.equal_p(tmp2873,$rjs_core.UString.make("beside"))!==false) {var if_res1680 = ima2865.width+imb2866.width;} else {if (M3.number_p(x_place2863)!==false) {if (M3.positive_p(x_place2863)!==false) {var if_res1678 = M3.max(ima2865.width,imb2866.width+x_place2863);} else {var if_res1678 = M3.max(imb2866.width,ima2865.width-x_place2863);}var if_res1679 = if_res1678;} else {var if_res1679 = M3.max(ima2865.width,imb2866.width);}var if_res1680 = if_res1679;}var width2872 = if_res1680;var tmp2875 = y_place2864;if (M3.equal_p(tmp2875,$rjs_core.UString.make("above"))!==false) {var if_res1683 = ima2865.height+imb2866.height;} else {if (M3.number_p(y_place2864)!==false) {if (M3.positive_p(y_place2864)!==false) {var if_res1681 = M3.max(ima2865.height,imb2866.height+y_place2864);} else {var if_res1681 = M3.max(imb2866.height,ima2865.height-y_place2864);}var if_res1682 = if_res1681;} else {var if_res1682 = M3.max(ima2865.height,imb2866.height);}var if_res1683 = if_res1682;}var height2874 = if_res1683;var δ_edge_x2876 = width2872/2;var δ_edge_y2877 = height2874/2;var tmp2880 = x_place2863;if (M3.equal_p(tmp2880,$rjs_core.UString.make("left"))!==false) {var if_res1690 = M3.values(ima_cx2868-δ_edge_x2876,imb_cx2870-δ_edge_x2876);} else {if (M3.equal_p(tmp2880,$rjs_core.UString.make("right"))!==false) {var if_res1689 = M3.values(δ_edge_x2876-ima_cx2868,δ_edge_x2876-imb_cx2870);} else {if (M3.equal_p(tmp2880,$rjs_core.UString.make("beside"))!==false) {var if_res1688 = M3.values(ima_cx2868-δ_edge_x2876,δ_edge_x2876-imb_cx2870);} else {if (M3.equal_p(tmp2880,$rjs_core.UString.make("middle"))!==false) {var if_res1684 = true;} else {var if_res1684 = M3.equal_p(tmp2880,$rjs_core.UString.make("center"));}if (if_res1684!==false) {var if_res1687 = M3.values(0,0);} else {if (M3.number_p(x_place2863)!==false) {var local_width2881 = M3.max(ima2865.width,imb2866.width);var local_acx2882 = ima_cx2868-(local_width2881/2);var local_bcx2883 = imb_cx2870-(local_width2881/2);var acx_bcx2884 = δ_edge_x2876-(local_width2881/2);if (M3.positive_p(x_place2863)!==false) {var if_res1685 = M3.values(local_acx2882-acx_bcx2884,x_place2863+(local_bcx2883-acx_bcx2884));} else {var if_res1685 = M3.values(local_acx2882-x_place2863-acx_bcx2884,local_bcx2883-acx_bcx2884);}var if_res1686 = if_res1685;} else {var if_res1686 = M3.error($rjs_core.UString.make("invalid x-place align"));}var if_res1687 = if_res1686;}var if_res1688 = if_res1687;}var if_res1689 = if_res1688;}var if_res1690 = if_res1689;}var let_result1691 = if_res1690;var δ_a_x2878 = let_result1691.getAt(0);var δ_b_x2879 = let_result1691.getAt(1);var tmp2887 = y_place2864;if (M3.equal_p(tmp2887,$rjs_core.UString.make("top"))!==false) {var if_res1698 = M3.values(ima_cy2869-δ_edge_y2877,imb_cy2871-δ_edge_y2877);} else {if (M3.equal_p(tmp2887,$rjs_core.UString.make("bottom"))!==false) {var if_res1697 = M3.values(δ_edge_y2877-ima_cy2869,δ_edge_y2877-imb_cy2871);} else {if (M3.equal_p(tmp2887,$rjs_core.UString.make("above"))!==false) {var if_res1696 = M3.values(ima_cy2869-δ_edge_y2877,δ_edge_y2877-imb_cy2871);} else {if (M3.equal_p(tmp2887,$rjs_core.UString.make("middle"))!==false) {var if_res1692 = true;} else {var if_res1692 = M3.equal_p(tmp2887,$rjs_core.UString.make("center"));}if (if_res1692!==false) {var if_res1695 = M3.values(0,0);} else {if (M3.number_p(y_place2864)!==false) {var local_height2888 = M3.max(ima2865.height,imb2866.height);var local_acy2889 = ima_cy2869-(local_height2888/2);var local_bcy2890 = imb_cy2871-(local_height2888/2);var acy_bcy2891 = δ_edge_y2877-(local_height2888/2);if (M3.positive_p(y_place2864)!==false) {var if_res1693 = M3.values(local_acy2889-acy_bcy2891,y_place2864+(local_bcy2890-acy_bcy2891));} else {var if_res1693 = M3.values(local_acy2889-y_place2864-acy_bcy2891,local_bcy2890-acy_bcy2891);}var if_res1694 = if_res1693;} else {var if_res1694 = M3.error($rjs_core.UString.make("invalid y-place align"));}var if_res1695 = if_res1694;}var if_res1696 = if_res1695;}var if_res1697 = if_res1696;}var if_res1698 = if_res1697;}var let_result1699 = if_res1698;var δ_a_y2885 = let_result1699.getAt(0);var δ_b_y2886 = let_result1699.getAt(1);this2867.type = $rjs_core.UString.make("overlay");this2867.ima = ima2865;this2867.imb = imb2866;this2867.width = width2872;this2867.height = height2874;this2867.aDx = δ_a_x2878;this2867.aDy = δ_a_y2885;this2867.bDx = δ_b_x2879;this2867.bDy = δ_b_y2886;return null;};Overlay.prototype.render = function(ctx2892, x2893, y2894) {var this2895 = this;var ima2896 = this2895.ima;var imb2897 = this2895.imb;ctx2892.save();ctx2892.translate(x2893,y2894);imb2897.render(ctx2892,this2895.bDx,this2895.bDy);ima2896.render(ctx2892,this2895.aDx,this2895.aDy);return ctx2892.restore();};var Container = function(childs2898, posns2899, width2900, height2901) {var this2902 = this;this2902.type = $rjs_core.UString.make("container");this2902.childs = childs2898;this2902.posns = posns2899;this2902.width = width2900;this2902.height = height2901;return null;};Container.prototype.render = function(ctx2903, x2904, y2905) {var this2906 = this;var width2907 = this2906.width;var height2908 = this2906.height;ctx2903.save();ctx2903.translate(x2904-(width2907/2),y2905-(height2908/2));ctx2903.beginPath();ctx2903.rect(0,0,M3.sub1(width2907),M3.sub1(height2908));ctx2903.clip();var loop2909 = function(childs2910, posns2911) {if (M3.null_p(childs2910)!==false) {var if_res1700 = M3.rvoid();} else {var child2912 = M3.car(childs2910);var posn2913 = M3.car(posns2911);child2912.render(ctx2903,posn_x(posn2913),posn_y(posn2913));var if_res1700 = loop2909(M3.cdr(childs2910),M3.cdr(posns2911));}return if_res1700;};loop2909(this2906.childs,this2906.posns);return ctx2903.restore();};var Bitmap = function(data2914) {var this2915 = this;var image2916 = new Image;image2916.crossOrigin = "anonymous";image2916.src = M6.js_string(data2914);this2915.image = image2916;this2915.width = image2916.width;this2915.height = image2916.height;return null;};Bitmap.prototype.render = function(ctx2917, x2918, y2919) {var this2920 = this;var image2921 = this2920.image;ctx2917.save();ctx2917.translate(x2918,y2919);ctx2917.drawImage(image2921,M3.__(image2921.width/2),M3.__(image2921.height/2));return ctx2917.restore();};var Freeze = function(img2922) {var this2923 = this;var canvas2924 = M1.document.createElement("canvas");var ctx2925 = canvas2924.getContext("2d");var width2926 = img2922.width;var height2927 = img2922.height;canvas2924.width = width2926;canvas2924.height = height2927;ctx2925.save();ctx2925.translate(width2926/2,height2927/2);img2922.render(ctx2925,0,0);ctx2925.restore();this2923.width = width2926;this2923.height = height2927;this2923.canvas = canvas2924;return null;};Freeze.prototype.render = function(ctx2928, x2929, y2930) {var this2931 = this;var width2932 = this2931.width;var height2933 = this2931.height;ctx2928.save();ctx2928.translate(x2929,y2930);ctx2928.drawImage(this2931.canvas,M3.__(width2932/2),M3.__(height2933/2));return ctx2928.restore();};var Rotate = function(image2934, angle2935) {var this2936 = this;var width2937 = image2934.width;var height2938 = image2934.height;var θ2939 = (M1.Math.PI*angle2935)/180.0;var sin_θ2940 = M3.sin(θ2939);var cos_θ2941 = M3.cos(θ2939);var x12942 = cos_θ2941*width2937;var y12943 = sin_θ2940*width2937;var x22944 = M3.__(sin_θ2940)*height2938;var y22945 = cos_θ2941*height2938;var x32946 = x12942+x22944;var y32947 = y12943+y22945;var min_x2948 = M3.min(0,x12942,x22944,x32946);var max_x2949 = M3.max(0,x12942,x22944,x32946);var min_y2950 = M3.min(0,y12943,y22945,y32947);var max_y2951 = M3.max(0,y12943,y22945,y32947);var rotated_width2952 = M3.floor(max_x2949-min_x2948);var rotated_height2953 = M3.floor(max_y2951-min_y2950);this2936.image = image2934;this2936.width = rotated_width2952;this2936.height = rotated_height2953;this2936.degrees = angle2935;this2936.radians = θ2939;return null;};Rotate.prototype.render = function(ctx2954, x2955, y2956) {var this2957 = this;ctx2954.save();ctx2954.translate(x2955,y2956);ctx2954.rotate(this2957.radians);this2957.image.render(ctx2954,0,0);return ctx2954.restore();};var Scale = function(image2958, x_factor2959, y_factor2960) {var this2961 = this;this2961.image = image2958;this2961.x_factor = x_factor2959;this2961.y_factor = y_factor2960;this2961.width = M3.abs(M3.floor(image2958.width*x_factor2959));this2961.height = M3.abs(M3.floor(image2958.height*y_factor2960));return null;};Scale.prototype.render = function(ctx2962, x2963, y2964) {var this2965 = this;ctx2962.save();ctx2962.translate(x2963,y2964);ctx2962.scale(this2965.x_factor,this2965.y_factor);this2965.image.render(ctx2962,0,0);return ctx2962.restore();};var container = function(childs2966, posns2967, width2968, height2969) {return new Container(childs2966,posns2967,width2968,height2969);};var place_image = function(child2970, cx2971, cy2972, base2973) {var width2974 = base2973.width;var height2975 = base2973.height;return container(M3.list(base2973,child2970),M3.list(make_posn(width2974/2,height2975/2),make_posn(cx2971,cy2972)),width2974,height2975);};var place_images = function(images2976, posns2977, scene2978) {var width2979 = scene2978.width;var height2980 = scene2978.height;return container(M3.cons(scene2978,images2976),M3.cons(make_posn(width2979/2,height2980/2),posns2977),width2979,height2980);};var __align_image_pos = function(image2981, pos2982, x_place2983, y_place2984) {var x2985 = posn_x(pos2982);var y2986 = posn_y(pos2982);var tmp2988 = x_place2983;if (M3.equal_p(tmp2988,$rjs_core.UString.make("left"))!==false) {var if_res1704 = (image2981.width/2)+x2985;} else {if (M3.equal_p(tmp2988,$rjs_core.UString.make("right"))!==false) {var if_res1703 = x2985-(image2981.width/2);} else {if (M3.equal_p(tmp2988,$rjs_core.UString.make("center"))!==false) {var if_res1701 = true;} else {var if_res1701 = M3.equal_p(tmp2988,$rjs_core.UString.make("middle"));}if (if_res1701!==false) {var if_res1702 = x2985;} else {var if_res1702 = M3.rvoid();}var if_res1703 = if_res1702;}var if_res1704 = if_res1703;}var new_x2987 = if_res1704;var tmp2990 = y_place2984;if (M3.equal_p(tmp2990,$rjs_core.UString.make("top"))!==false) {var if_res1708 = (image2981.height/2)+y2986;} else {if (M3.equal_p(tmp2990,$rjs_core.UString.make("bottom"))!==false) {var if_res1707 = y2986-(image2981.height/2);} else {if (M3.equal_p(tmp2990,$rjs_core.UString.make("center"))!==false) {var if_res1705 = true;} else {var if_res1705 = M3.equal_p(tmp2990,$rjs_core.UString.make("middle"));}if (if_res1705!==false) {var if_res1706 = y2986;} else {var if_res1706 = M3.rvoid();}var if_res1707 = if_res1706;}var if_res1708 = if_res1707;}var new_y2989 = if_res1708;return make_posn(new_x2987,new_y2989);};var place_image_by_align = function(image2991, x2992, y2993, x_place2994, y_place2995, scene2996) {var new_pos2997 = __align_image_pos(image2991,make_posn(x2992,y2993),x_place2994,y_place2995);return place_image(image2991,posn_x(new_pos2997),posn_y(new_pos2997),scene2996);};var place_images_by_align = function(images2998, posns2999, x_place3000, y_place3001, scene3002) {var new_posns3003 = M4.map(function(i3004, p3005) {return __align_image_pos(i3004,p3005,x_place3000,y_place3001);},images2998,posns2999);return place_images(images2998,new_posns3003,scene3002);};var __single_overlay = function(x_place3006, y_place3007, ima3008, imb3009) {return new Overlay(x_place3006,y_place3007,ima3008,imb3009);};var __single_underlay = function(x_place3010, y_place3011, ima3012, imb3013) {return new Overlay(x_place3010,y_place3011,imb3013,ima3012);};var overlay_by_align = $rjs_core.attachProcedureArity(function(x_place3014, y_place3015, ima3016, imb3017, ...imn30181709) {var imn3018 = $rjs_core.Pair.listFromArray(imn30181709);return M0.foldl(function(img3019, acc3020) {return __single_overlay(x_place3014,y_place3015,acc3020,img3019);},empty_image,M3.cons(ima3016,M3.cons(imb3017,imn3018)));});var overlay = $rjs_core.attachProcedureArity(function(ima3021, imb3022, ...imn30231710) {var imn3023 = $rjs_core.Pair.listFromArray(imn30231710);return M0.foldl(function(img3024, acc3025) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc3025,img3024);},empty_image,M3.cons(ima3021,M3.cons(imb3022,imn3023)));});var overlay_by_xy = function(ima3026, x3027, y3028, imb3029) {return new Overlay(x3027,y3028,ima3026,imb3029);};var underlay = $rjs_core.attachProcedureArity(function(ima3030, imb3031, ...imn30321711) {var imn3032 = $rjs_core.Pair.listFromArray(imn30321711);return M0.foldl(function(img3033, acc3034) {return __single_underlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc3034,img3033);},empty_image,M3.cons(ima3030,M3.cons(imb3031,imn3032)));});var underlay_by_align = $rjs_core.attachProcedureArity(function(x_place3035, y_place3036, ima3037, imb3038, ...imn30391712) {var imn3039 = $rjs_core.Pair.listFromArray(imn30391712);return M0.foldl(function(img3040, acc3041) {return __single_underlay(x_place3035,y_place3036,acc3041,img3040);},empty_image,M3.cons(ima3037,M3.cons(imb3038,imn3039)));});var underlay_by_xy = function(ima3042, x3043, y3044, imb3045) {return new Overlay(M3.__(x3043),M3.__(y3044),imb3045,ima3042);};var above_by_align = $rjs_core.attachProcedureArity(function(x_place3046, i13047, i23048, ...is30491713) {var is3049 = $rjs_core.Pair.listFromArray(is30491713);return M0.foldl(function(img3050, acc3051) {return __single_overlay(x_place3046,$rjs_core.UString.make("above"),acc3051,img3050);},empty_image,M3.cons(i13047,M3.cons(i23048,is3049)));});var above = $rjs_core.attachProcedureArity(function(i13052, i23053, ...is30541714) {var is3054 = $rjs_core.Pair.listFromArray(is30541714);return M0.foldl(function(img3055, acc3056) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("above"),acc3056,img3055);},empty_image,M3.cons(i13052,M3.cons(i23053,is3054)));});var beside_by_align = $rjs_core.attachProcedureArity(function(y_place3057, i13058, i23059, ...is30601715) {var is3060 = $rjs_core.Pair.listFromArray(is30601715);return M0.foldl(function(img3061, acc3062) {return __single_overlay($rjs_core.UString.make("beside"),y_place3057,acc3062,img3061);},empty_image,M3.cons(i13058,M3.cons(i23059,is3060)));});var beside = $rjs_core.attachProcedureArity(function(i13063, i23064, ...is30651716) {var is3065 = $rjs_core.Pair.listFromArray(is30651716);return M0.foldl(function(img3066, acc3067) {return __single_overlay($rjs_core.UString.make("beside"),$rjs_core.UString.make("middle"),acc3067,img3066);},empty_image,M3.cons(i13063,M3.cons(i23064,is3065)));});var rotate = function(angle3068, image3069) {return new Rotate(image3069,M3.__(angle3068));};var scale = function(factor3070, image3071) {return new Scale(image3071,factor3070,factor3070);};var flip_horizontal = function(image3072) {return new Scale(image3072,-1,1);};var flip_vertical = function(image3073) {return new Scale(image3073,1,-1);};var bitmap_by_data = function(data3074) {return new Bitmap(data3074);};var bitmap_by_url = function(url3075) {return new Bitmap(url3075);};var frame = function(img3076) {return color_frame($rjs_core.UString.make("black"),img3076);};var color_frame = function(color3077, img3078) {return overlay(rectangle(image_width(img3078),image_height(img3078),$rjs_core.PrimitiveSymbol.make("outline"),color3077),img3078);};var freeze = function(img3079) {return new Freeze(img3079);};var __rjs_quoted__ = {};__rjs_quoted__.empty_image = empty_image;__rjs_quoted__.posn_p = posn_p;__rjs_quoted__.make_posn = make_posn;__rjs_quoted__.posn_y = posn_y;__rjs_quoted__.posn_x = posn_x;__rjs_quoted__.___gt_web_color = ___gt_web_color;__rjs_quoted__.struct_posn = struct_posn;export { __rjs_quoted__,posn_x,posn_y,posn_p,make_posn,struct_posn,print_image,freeze,bitmap_by_url,bitmap_by_data,flip_horizontal,flip_vertical,scale,rotate,beside,beside_by_align,above,above_by_align,underlay_by_xy,underlay,overlay,overlay_by_xy,overlay_by_align,place_images_by_align,place_image_by_align,place_images,place_image,color_frame,frame,triangle,text_by_font,text,circle,square,rectangle,line,image_width,image_height,empty_scene,empty_image };