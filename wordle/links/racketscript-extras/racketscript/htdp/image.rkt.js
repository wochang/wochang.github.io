import * as $rjs_core from '../../../../runtime/core.js';import * as M0 from "../../../../collects/racket/private/list.rkt.js";import * as M1 from "../private/jscommon.rkt.js";import * as M2 from "../../../racketscript-compiler/racketscript/private/interop.rkt.js";import * as M3 from "../../../../runtime/kernel.rkt.js";import * as M4 from "../../../../collects/racket/private/map.rkt.js";import * as M5 from "./private/color.rkt.js";import * as M6 from "../../../racketscript-compiler/racketscript/interop.rkt.js";var let_result1645 = M3.make_struct_type($rjs_core.PrimitiveSymbol.make("posn"),false,2,0,false,M3.rnull,false,false,$rjs_core.Pair.makeList(0,1),false,$rjs_core.PrimitiveSymbol.make("posn"));var struct_2738 = let_result1645.getAt(0);var make_2739 = let_result1645.getAt(1);var __p2740 = let_result1645.getAt(2);var __ref2741 = let_result1645.getAt(3);var __set_bang_2742 = let_result1645.getAt(4);var let_result1646 = M3.values(struct_2738,make_2739,__p2740,M3.make_struct_field_accessor(__ref2741,0,$rjs_core.PrimitiveSymbol.make("x")),M3.make_struct_field_accessor(__ref2741,1,$rjs_core.PrimitiveSymbol.make("y")));var struct_posn = let_result1646.getAt(0);var make_posn = let_result1646.getAt(1);var posn_p = let_result1646.getAt(2);var posn_x = let_result1646.getAt(3);var posn_y = let_result1646.getAt(4);var ___gt_web_color = function(p2743) {if (M3.string_p(p2743)!==false) {var if_res1649 = M5.string__gt_web_color(p2743);} else {if (M5.color_p(p2743)!==false) {var if_res1648 = M5.color__gt_web_color(p2743);} else {if (M3.symbol_p(p2743)!==false) {var if_res1647 = M5.string__gt_web_color(M3.symbol__gt_string(p2743));} else {var if_res1647 = M3.error($rjs_core.PrimitiveSymbol.make("color"),$rjs_core.UString.make("invalid color"));}var if_res1648 = if_res1647;}var if_res1649 = if_res1648;}return if_res1649;};var print_image = function(d2744) {var canvas2745 = M1.document.createElement("canvas");var ctx2746 = canvas2745.getContext("2d");M1.document.body.appendChild(canvas2745);M1.document.body.appendChild(M1.document.createElement("br"));canvas2745.width = d2744.width;canvas2745.height = d2744.height;ctx2746.save();ctx2746.translate(d2744.width/2,d2744.height/2);d2744.render(ctx2746,0,0);return ctx2746.restore();};var canvas2747 = M1.document.createElement("canvas");var __times_invisible_canvas_context_times_ = canvas2747.getContext("2d");var empty_image = {'type':$rjs_core.UString.make("empty-image"),'width':0,'height':0,'render':function(ctx2748, x2749, y2750) {return M3.rvoid();}};var image_height = function(i2751) {return i2751.height;};var image_width = function(i2752) {return i2752.width;};var EmptyScene = function(width2753, height2754, borders_p2755) {var this2756 = this;this2756.type = $rjs_core.UString.make("empty-scene");this2756.width = width2753;this2756.height = height2754;this2756.borders_p = borders_p2755;return null;};EmptyScene.prototype.render = function(ctx2757, x2758, y2759) {return M3.rvoid();};var Text = function(text2760, size2761, color2762, face2763, family2764, style2765, weight2766, underline_p2767) {var this2768 = this;this2768.type = $rjs_core.UString.make("text");this2768.text = text2760;this2768.size = size2761;this2768.color = ___gt_web_color(color2762);this2768.face = face2763;this2768.family = family2764;this2768.style = style2765;this2768.weight = weight2766;this2768.underline = underline_p2767;return this2768._updateMetrics();};Text.prototype._updateMetrics = function() {var this2769 = this;var font2770 = M3.string_append(this2769.weight,$rjs_core.UString.make(" "),this2769.style,$rjs_core.UString.make(" "),M3.number__gt_string(this2769.size),$rjs_core.UString.make("px "),this2769.face,$rjs_core.UString.make(" "),this2769.family);__times_invisible_canvas_context_times_.font = M6.js_string(font2770);var let_result1650 = M3.values();var metrics2771 = __times_invisible_canvas_context_times_.measureText(M6.js_string(this2769.text));this2769.font = font2770;this2769.width = metrics2771.width;this2769.height = this2769.size;return null;};Text.prototype.render = function(ctx2772, x2773, y2774) {var this2775 = this;ctx2772.save();ctx2772.translate(x2773,y2774);ctx2772.font = M6.js_string(this2775.font);ctx2772.textAlign = "center";ctx2772.textBaseline = "middle";ctx2772.fillStyle = M6.js_string(this2775.color);ctx2772.fillText(M6.js_string(this2775.text),0,0);return ctx2772.restore();};var Line = function(x2776, y2777, pen_or_color2778) {var this2779 = this;this2779.type = $rjs_core.UString.make("line");this2779.width = M1.abs_plus_ceil(x2776);this2779.height = M1.abs_plus_ceil(y2777);this2779.mode = false;this2779.pen = pen_or_color2778;return null;};Line.prototype.render = function(ctx2780, x2781, y2782) {var this2783 = this;ctx2780.save();var let_result1651 = M3.values();ctx2780.translate(x2781,y2782);var let_result1652 = M3.values();ctx2780.beginPath();var let_result1653 = M3.values();var sx2784 = M3.__(M3.abs(this2783.x/2));var sy2785 = M3.__(M3.abs(this2783.y/2));if (M3.__gt__eq_(x2781,0)!==false) {var if_res1654 = M3.__gt__eq_(y2782,0);} else {var if_res1654 = false;}if (if_res1654!==false) {ctx2780.moveTo(sx2784,sy2785);var if_res1661 = ctx2780.lineTo(sx2784+x2781,sy2785+y2782);} else {if (M3.__gt__eq_(x2781,0)!==false) {var if_res1655 = M3.__lt_(y2782,0);} else {var if_res1655 = false;}if (if_res1655!==false) {ctx2780.moveTo(sx2784+x2781,sy2785);var if_res1660 = ctx2780.lineTo(sx2784,sy2785-y2782);} else {if (M3.__lt_(x2781,0)!==false) {var if_res1656 = M3.__gt__eq_(y2782,0);} else {var if_res1656 = false;}if (if_res1656!==false) {ctx2780.moveTo(sx2784,sy2785+y2782);var if_res1659 = ctx2780.lineTo(sx2784-x2781,sy2785);} else {if (M3.__lt_(x2781,0)!==false) {var if_res1657 = M3.__lt_(y2782,0);} else {var if_res1657 = false;}if (if_res1657!==false) {ctx2780.moveTo(sx2784-x2781,sy2785-y2782);var if_res1658 = ctx2780.lineTo(sx2784,sy2785);} else {var if_res1658 = M3.rvoid();}var if_res1659 = if_res1658;}var if_res1660 = if_res1659;}var if_res1661 = if_res1660;}if_res1661;var or_part2786 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2786!==false) {var if_res1662 = or_part2786;} else {var if_res1662 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("outline"));}if (if_res1662!==false) {ctx2780.strokeStyle = M6.js_string(___gt_web_color(this2783.pen));var if_res1665 = ctx2780.stroke();} else {var or_part2787 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2787!==false) {var if_res1663 = or_part2787;} else {var if_res1663 = M3.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("solid"));}if (if_res1663!==false) {ctx2780.fillStyle = M6.js_string(___gt_web_color(this2783.pen));var if_res1664 = ctx2780.fill();} else {var if_res1664 = M3.rvoid();}var if_res1665 = if_res1664;}if_res1665;ctx2780.closePath();return ctx2780.restore();};var Rectangle = function(width2788, height2789, mode2790, pen_or_color2791) {var this2792 = this;this2792.type = $rjs_core.UString.make("rectangle");this2792.width = width2788;this2792.height = height2789;this2792.mode = mode2790;this2792.pen = pen_or_color2791;return null;};Rectangle.prototype.render = function(ctx2793, x2794, y2795) {var this2796 = this;ctx2793.save();ctx2793.translate(x2794,y2795);ctx2793.beginPath();var width2797 = this2796.width;var height2798 = this2796.height;var start_x2799 = M3.__(width2797/2);var start_y2800 = M3.__(height2798/2);ctx2793.rect(start_x2799,start_y2800,width2797,height2798);var or_part2801 = M3.equal_p(this2796.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2801!==false) {var if_res1666 = or_part2801;} else {var if_res1666 = M3.equal_p(this2796.mode,$rjs_core.UString.make("outline"));}if (if_res1666!==false) {ctx2793.strokeStyle = M6.js_string(___gt_web_color(this2796.pen));var if_res1669 = ctx2793.stroke();} else {var or_part2802 = M3.equal_p(this2796.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2802!==false) {var if_res1667 = or_part2802;} else {var if_res1667 = M3.equal_p(this2796.mode,$rjs_core.UString.make("solid"));}if (if_res1667!==false) {ctx2793.fillStyle = M6.js_string(___gt_web_color(this2796.pen));var if_res1668 = ctx2793.fill();} else {var if_res1668 = M3.rvoid();}var if_res1669 = if_res1668;}if_res1669;ctx2793.closePath();return ctx2793.restore();};var Circle = function(radius2803, mode2804, pen_or_color2805) {var this2806 = this;var diameter2807 = radius2803*2;this2806.type = $rjs_core.UString.make("circle");this2806.radius = radius2803;this2806.width = diameter2807;this2806.height = diameter2807;this2806.mode = mode2804;this2806.pen = pen_or_color2805;return null;};Circle.prototype.render = function(ctx2808, x2809, y2810) {var this2811 = this;var radius2812 = this2811.radius;ctx2808.save();ctx2808.translate(x2809,y2810);ctx2808.beginPath();ctx2808.ellipse(0,0,radius2812,radius2812,0,0,M1.Math.PI*2);var or_part2813 = M3.equal_p(this2811.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2813!==false) {var if_res1670 = or_part2813;} else {var if_res1670 = M3.equal_p(this2811.mode,$rjs_core.UString.make("outline"));}if (if_res1670!==false) {ctx2808.strokeStyle = M6.js_string(___gt_web_color(this2811.pen));var if_res1673 = ctx2808.stroke();} else {var or_part2814 = M3.equal_p(this2811.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2814!==false) {var if_res1671 = or_part2814;} else {var if_res1671 = M3.equal_p(this2811.mode,$rjs_core.UString.make("solid"));}if (if_res1671!==false) {ctx2808.fillStyle = M6.js_string(___gt_web_color(this2811.pen));var if_res1672 = ctx2808.fill();} else {var if_res1672 = M3.rvoid();}var if_res1673 = if_res1672;}if_res1673;ctx2808.closePath();return ctx2808.restore();};var Polygon = function(vertices2815, mode2816, pen_or_color2817) {var this2818 = this;var xs2819 = M4.map(posn_x,vertices2815);var ys2820 = M4.map(posn_y,vertices2815);var width2821 = M3.apply(M3.max,xs2819)-M3.apply(M3.min,xs2819);var height2822 = M3.apply(M3.max,ys2820)-M3.apply(M3.min,xs2819);this2818.type = $rjs_core.UString.make("polygon");this2818.vertices = vertices2815;this2818.width = width2821;this2818.height = height2822;this2818.mode = mode2816;this2818.pen = pen_or_color2817;return null;};Polygon.prototype.render = function(ctx2823, x2824, y2825) {var this2826 = this;var first_point2827 = M3.car(this2826.vertices);var rest_points2828 = M3.cdr(this2826.vertices);var radius2829 = this2826.radius;ctx2823.save();ctx2823.translate(x2824,y2825);ctx2823.beginPath();ctx2823.moveTo(posn_x(first_point2827),posn_y(first_point2827));var loop2830 = function(points2831) {if (M3.null_p(points2831)!==false) {var if_res1674 = M3.rvoid();} else {var pt2832 = M3.car(points2831);ctx2823.lineTo(posn_x(pt2832),posn_y(pt2832));var if_res1674 = loop2830(M3.cdr(points2831));}return if_res1674;};loop2830(rest_points2828);var or_part2833 = M3.equal_p(this2826.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part2833!==false) {var if_res1675 = or_part2833;} else {var if_res1675 = M3.equal_p(this2826.mode,$rjs_core.UString.make("outline"));}if (if_res1675!==false) {ctx2823.strokeStyle = M6.js_string(___gt_web_color(this2826.pen));var if_res1678 = ctx2823.stroke();} else {var or_part2834 = M3.equal_p(this2826.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part2834!==false) {var if_res1676 = or_part2834;} else {var if_res1676 = M3.equal_p(this2826.mode,$rjs_core.UString.make("solid"));}if (if_res1676!==false) {ctx2823.fillStyle = M6.js_string(___gt_web_color(this2826.pen));var if_res1677 = ctx2823.fill();} else {var if_res1677 = M3.rvoid();}var if_res1678 = if_res1677;}if_res1678;ctx2823.closePath();return ctx2823.restore();};var empty_scene = function(width2835, height2836) {return new EmptyScene(width2835,height2836,false);};var text = function(txt2837, size2838, color2839) {return new Text(txt2837,size2838,color2839,$rjs_core.UString.make(""),$rjs_core.UString.make("serif"),$rjs_core.UString.make("normal"),$rjs_core.UString.make("normal"),false);};var text_by_font = function(txt2840, size2841, color2842, face2843, family2844, style2845, weight2846, underline_p2847) {var or_part2848 = face2843;if (or_part2848!==false) {var if_res1682 = or_part2848;} else {var if_res1682 = $rjs_core.UString.make("");}if (M3.symbol_p(family2844)!==false) {var if_res1681 = M3.symbol__gt_string(family2844);} else {var if_res1681 = family2844;}if (M3.symbol_p(style2845)!==false) {var if_res1680 = M3.symbol__gt_string(style2845);} else {var if_res1680 = style2845;}if (M3.symbol_p(weight2846)!==false) {var if_res1679 = M3.symbol__gt_string(weight2846);} else {var if_res1679 = weight2846;}return new Text(txt2840,size2841,color2842,if_res1682,if_res1681,if_res1680,if_res1679,underline_p2847);};var line = function(x2849, y2850, pen_or_color2851) {return new Line(x2849,y2850,pen_or_color2851);};var rectangle = function(w2852, h2853, m2854, p2855) {return new Rectangle(w2852,h2853,m2854,p2855);};var square = function(s2856, m2857, p2858) {return new Rectangle(s2856,s2856,m2857,p2858);};var circle = function(r2859, m2860, p2861) {return new Circle(r2859,m2860,p2861);};var triangle = function(side2862, mode2863, color2864) {var height2865 = side2862*(M3.sqrt(3)/2);return new Polygon(M3.list(make_posn(M3.__(side2862/2),height2865/2),make_posn(0,M3.__(height2865/2)),make_posn(side2862/2,height2865/2)),mode2863,color2864);};var Overlay = function(x_place2866, y_place2867, ima2868, imb2869) {var this2870 = this;var ima_cx2871 = ima2868.width/2;var ima_cy2872 = ima2868.height/2;var imb_cx2873 = imb2869.width/2;var imb_cy2874 = imb2869.height/2;var tmp2876 = x_place2866;if (M3.equal_p(tmp2876,$rjs_core.UString.make("beside"))!==false) {var if_res1685 = ima2868.width+imb2869.width;} else {if (M3.number_p(x_place2866)!==false) {if (M3.positive_p(x_place2866)!==false) {var if_res1683 = M3.max(ima2868.width,imb2869.width+x_place2866);} else {var if_res1683 = M3.max(imb2869.width,ima2868.width-x_place2866);}var if_res1684 = if_res1683;} else {var if_res1684 = M3.max(ima2868.width,imb2869.width);}var if_res1685 = if_res1684;}var width2875 = if_res1685;var tmp2878 = y_place2867;if (M3.equal_p(tmp2878,$rjs_core.UString.make("above"))!==false) {var if_res1688 = ima2868.height+imb2869.height;} else {if (M3.number_p(y_place2867)!==false) {if (M3.positive_p(y_place2867)!==false) {var if_res1686 = M3.max(ima2868.height,imb2869.height+y_place2867);} else {var if_res1686 = M3.max(imb2869.height,ima2868.height-y_place2867);}var if_res1687 = if_res1686;} else {var if_res1687 = M3.max(ima2868.height,imb2869.height);}var if_res1688 = if_res1687;}var height2877 = if_res1688;var δ_edge_x2879 = width2875/2;var δ_edge_y2880 = height2877/2;var tmp2883 = x_place2866;if (M3.equal_p(tmp2883,$rjs_core.UString.make("left"))!==false) {var if_res1695 = M3.values(ima_cx2871-δ_edge_x2879,imb_cx2873-δ_edge_x2879);} else {if (M3.equal_p(tmp2883,$rjs_core.UString.make("right"))!==false) {var if_res1694 = M3.values(δ_edge_x2879-ima_cx2871,δ_edge_x2879-imb_cx2873);} else {if (M3.equal_p(tmp2883,$rjs_core.UString.make("beside"))!==false) {var if_res1693 = M3.values(ima_cx2871-δ_edge_x2879,δ_edge_x2879-imb_cx2873);} else {if (M3.equal_p(tmp2883,$rjs_core.UString.make("middle"))!==false) {var if_res1689 = true;} else {var if_res1689 = M3.equal_p(tmp2883,$rjs_core.UString.make("center"));}if (if_res1689!==false) {var if_res1692 = M3.values(0,0);} else {if (M3.number_p(x_place2866)!==false) {var local_width2884 = M3.max(ima2868.width,imb2869.width);var local_acx2885 = ima_cx2871-(local_width2884/2);var local_bcx2886 = imb_cx2873-(local_width2884/2);var acx_bcx2887 = δ_edge_x2879-(local_width2884/2);if (M3.positive_p(x_place2866)!==false) {var if_res1690 = M3.values(local_acx2885-acx_bcx2887,x_place2866+(local_bcx2886-acx_bcx2887));} else {var if_res1690 = M3.values(local_acx2885-x_place2866-acx_bcx2887,local_bcx2886-acx_bcx2887);}var if_res1691 = if_res1690;} else {var if_res1691 = M3.error($rjs_core.UString.make("invalid x-place align"));}var if_res1692 = if_res1691;}var if_res1693 = if_res1692;}var if_res1694 = if_res1693;}var if_res1695 = if_res1694;}var let_result1696 = if_res1695;var δ_a_x2881 = let_result1696.getAt(0);var δ_b_x2882 = let_result1696.getAt(1);var tmp2890 = y_place2867;if (M3.equal_p(tmp2890,$rjs_core.UString.make("top"))!==false) {var if_res1703 = M3.values(ima_cy2872-δ_edge_y2880,imb_cy2874-δ_edge_y2880);} else {if (M3.equal_p(tmp2890,$rjs_core.UString.make("bottom"))!==false) {var if_res1702 = M3.values(δ_edge_y2880-ima_cy2872,δ_edge_y2880-imb_cy2874);} else {if (M3.equal_p(tmp2890,$rjs_core.UString.make("above"))!==false) {var if_res1701 = M3.values(ima_cy2872-δ_edge_y2880,δ_edge_y2880-imb_cy2874);} else {if (M3.equal_p(tmp2890,$rjs_core.UString.make("middle"))!==false) {var if_res1697 = true;} else {var if_res1697 = M3.equal_p(tmp2890,$rjs_core.UString.make("center"));}if (if_res1697!==false) {var if_res1700 = M3.values(0,0);} else {if (M3.number_p(y_place2867)!==false) {var local_height2891 = M3.max(ima2868.height,imb2869.height);var local_acy2892 = ima_cy2872-(local_height2891/2);var local_bcy2893 = imb_cy2874-(local_height2891/2);var acy_bcy2894 = δ_edge_y2880-(local_height2891/2);if (M3.positive_p(y_place2867)!==false) {var if_res1698 = M3.values(local_acy2892-acy_bcy2894,y_place2867+(local_bcy2893-acy_bcy2894));} else {var if_res1698 = M3.values(local_acy2892-y_place2867-acy_bcy2894,local_bcy2893-acy_bcy2894);}var if_res1699 = if_res1698;} else {var if_res1699 = M3.error($rjs_core.UString.make("invalid y-place align"));}var if_res1700 = if_res1699;}var if_res1701 = if_res1700;}var if_res1702 = if_res1701;}var if_res1703 = if_res1702;}var let_result1704 = if_res1703;var δ_a_y2888 = let_result1704.getAt(0);var δ_b_y2889 = let_result1704.getAt(1);this2870.type = $rjs_core.UString.make("overlay");this2870.ima = ima2868;this2870.imb = imb2869;this2870.width = width2875;this2870.height = height2877;this2870.aDx = δ_a_x2881;this2870.aDy = δ_a_y2888;this2870.bDx = δ_b_x2882;this2870.bDy = δ_b_y2889;return null;};Overlay.prototype.render = function(ctx2895, x2896, y2897) {var this2898 = this;var ima2899 = this2898.ima;var imb2900 = this2898.imb;ctx2895.save();ctx2895.translate(x2896,y2897);imb2900.render(ctx2895,this2898.bDx,this2898.bDy);ima2899.render(ctx2895,this2898.aDx,this2898.aDy);return ctx2895.restore();};var Container = function(childs2901, posns2902, width2903, height2904) {var this2905 = this;this2905.type = $rjs_core.UString.make("container");this2905.childs = childs2901;this2905.posns = posns2902;this2905.width = width2903;this2905.height = height2904;return null;};Container.prototype.render = function(ctx2906, x2907, y2908) {var this2909 = this;var width2910 = this2909.width;var height2911 = this2909.height;ctx2906.save();ctx2906.translate(x2907-(width2910/2),y2908-(height2911/2));ctx2906.beginPath();ctx2906.rect(0,0,M3.sub1(width2910),M3.sub1(height2911));ctx2906.clip();var loop2912 = function(childs2913, posns2914) {if (M3.null_p(childs2913)!==false) {var if_res1705 = M3.rvoid();} else {var child2915 = M3.car(childs2913);var posn2916 = M3.car(posns2914);child2915.render(ctx2906,posn_x(posn2916),posn_y(posn2916));var if_res1705 = loop2912(M3.cdr(childs2913),M3.cdr(posns2914));}return if_res1705;};loop2912(this2909.childs,this2909.posns);return ctx2906.restore();};var Bitmap = function(data2917) {var this2918 = this;var image2919 = new Image;image2919.crossOrigin = "anonymous";image2919.src = M6.js_string(data2917);this2918.image = image2919;this2918.width = image2919.width;this2918.height = image2919.height;return null;};Bitmap.prototype.render = function(ctx2920, x2921, y2922) {var this2923 = this;var image2924 = this2923.image;ctx2920.save();ctx2920.translate(x2921,y2922);ctx2920.drawImage(image2924,M3.__(image2924.width/2),M3.__(image2924.height/2));return ctx2920.restore();};var Freeze = function(img2925) {var this2926 = this;var canvas2927 = M1.document.createElement("canvas");var ctx2928 = canvas2927.getContext("2d");var width2929 = img2925.width;var height2930 = img2925.height;canvas2927.width = width2929;canvas2927.height = height2930;ctx2928.save();ctx2928.translate(width2929/2,height2930/2);img2925.render(ctx2928,0,0);ctx2928.restore();this2926.width = width2929;this2926.height = height2930;this2926.canvas = canvas2927;return null;};Freeze.prototype.render = function(ctx2931, x2932, y2933) {var this2934 = this;var width2935 = this2934.width;var height2936 = this2934.height;ctx2931.save();ctx2931.translate(x2932,y2933);ctx2931.drawImage(this2934.canvas,M3.__(width2935/2),M3.__(height2936/2));return ctx2931.restore();};var Rotate = function(image2937, angle2938) {var this2939 = this;var width2940 = image2937.width;var height2941 = image2937.height;var θ2942 = (M1.Math.PI*angle2938)/180.0;var sin_θ2943 = M3.sin(θ2942);var cos_θ2944 = M3.cos(θ2942);var x12945 = cos_θ2944*width2940;var y12946 = sin_θ2943*width2940;var x22947 = M3.__(sin_θ2943)*height2941;var y22948 = cos_θ2944*height2941;var x32949 = x12945+x22947;var y32950 = y12946+y22948;var min_x2951 = M3.min(0,x12945,x22947,x32949);var max_x2952 = M3.max(0,x12945,x22947,x32949);var min_y2953 = M3.min(0,y12946,y22948,y32950);var max_y2954 = M3.max(0,y12946,y22948,y32950);var rotated_width2955 = M3.floor(max_x2952-min_x2951);var rotated_height2956 = M3.floor(max_y2954-min_y2953);this2939.image = image2937;this2939.width = rotated_width2955;this2939.height = rotated_height2956;this2939.degrees = angle2938;this2939.radians = θ2942;return null;};Rotate.prototype.render = function(ctx2957, x2958, y2959) {var this2960 = this;ctx2957.save();ctx2957.translate(x2958,y2959);ctx2957.rotate(this2960.radians);this2960.image.render(ctx2957,0,0);return ctx2957.restore();};var Scale = function(image2961, x_factor2962, y_factor2963) {var this2964 = this;this2964.image = image2961;this2964.x_factor = x_factor2962;this2964.y_factor = y_factor2963;this2964.width = M3.abs(M3.floor(image2961.width*x_factor2962));this2964.height = M3.abs(M3.floor(image2961.height*y_factor2963));return null;};Scale.prototype.render = function(ctx2965, x2966, y2967) {var this2968 = this;ctx2965.save();ctx2965.translate(x2966,y2967);ctx2965.scale(this2968.x_factor,this2968.y_factor);this2968.image.render(ctx2965,0,0);return ctx2965.restore();};var container = function(childs2969, posns2970, width2971, height2972) {return new Container(childs2969,posns2970,width2971,height2972);};var place_image = function(child2973, cx2974, cy2975, base2976) {var width2977 = base2976.width;var height2978 = base2976.height;return container(M3.list(base2976,child2973),M3.list(make_posn(width2977/2,height2978/2),make_posn(cx2974,cy2975)),width2977,height2978);};var place_images = function(images2979, posns2980, scene2981) {var width2982 = scene2981.width;var height2983 = scene2981.height;return container(M3.cons(scene2981,images2979),M3.cons(make_posn(width2982/2,height2983/2),posns2980),width2982,height2983);};var __align_image_pos = function(image2984, pos2985, x_place2986, y_place2987) {var x2988 = posn_x(pos2985);var y2989 = posn_y(pos2985);var tmp2991 = x_place2986;if (M3.equal_p(tmp2991,$rjs_core.UString.make("left"))!==false) {var if_res1709 = (image2984.width/2)+x2988;} else {if (M3.equal_p(tmp2991,$rjs_core.UString.make("right"))!==false) {var if_res1708 = x2988-(image2984.width/2);} else {if (M3.equal_p(tmp2991,$rjs_core.UString.make("center"))!==false) {var if_res1706 = true;} else {var if_res1706 = M3.equal_p(tmp2991,$rjs_core.UString.make("middle"));}if (if_res1706!==false) {var if_res1707 = x2988;} else {var if_res1707 = M3.rvoid();}var if_res1708 = if_res1707;}var if_res1709 = if_res1708;}var new_x2990 = if_res1709;var tmp2993 = y_place2987;if (M3.equal_p(tmp2993,$rjs_core.UString.make("top"))!==false) {var if_res1713 = (image2984.height/2)+y2989;} else {if (M3.equal_p(tmp2993,$rjs_core.UString.make("bottom"))!==false) {var if_res1712 = y2989-(image2984.height/2);} else {if (M3.equal_p(tmp2993,$rjs_core.UString.make("center"))!==false) {var if_res1710 = true;} else {var if_res1710 = M3.equal_p(tmp2993,$rjs_core.UString.make("middle"));}if (if_res1710!==false) {var if_res1711 = y2989;} else {var if_res1711 = M3.rvoid();}var if_res1712 = if_res1711;}var if_res1713 = if_res1712;}var new_y2992 = if_res1713;return make_posn(new_x2990,new_y2992);};var place_image_by_align = function(image2994, x2995, y2996, x_place2997, y_place2998, scene2999) {var new_pos3000 = __align_image_pos(image2994,make_posn(x2995,y2996),x_place2997,y_place2998);return place_image(image2994,posn_x(new_pos3000),posn_y(new_pos3000),scene2999);};var place_images_by_align = function(images3001, posns3002, x_place3003, y_place3004, scene3005) {var new_posns3006 = M4.map(function(i3007, p3008) {return __align_image_pos(i3007,p3008,x_place3003,y_place3004);},images3001,posns3002);return place_images(images3001,new_posns3006,scene3005);};var __single_overlay = function(x_place3009, y_place3010, ima3011, imb3012) {return new Overlay(x_place3009,y_place3010,ima3011,imb3012);};var __single_underlay = function(x_place3013, y_place3014, ima3015, imb3016) {return new Overlay(x_place3013,y_place3014,imb3016,ima3015);};var overlay_by_align = $rjs_core.attachProcedureArity(function(x_place3017, y_place3018, ima3019, imb3020, ...imn30211714) {var imn3021 = $rjs_core.Pair.listFromArray(imn30211714);return M0.foldl(function(img3022, acc3023) {return __single_overlay(x_place3017,y_place3018,acc3023,img3022);},empty_image,M3.cons(ima3019,M3.cons(imb3020,imn3021)));});var overlay = $rjs_core.attachProcedureArity(function(ima3024, imb3025, ...imn30261715) {var imn3026 = $rjs_core.Pair.listFromArray(imn30261715);return M0.foldl(function(img3027, acc3028) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc3028,img3027);},empty_image,M3.cons(ima3024,M3.cons(imb3025,imn3026)));});var overlay_by_xy = function(ima3029, x3030, y3031, imb3032) {return new Overlay(x3030,y3031,ima3029,imb3032);};var underlay = $rjs_core.attachProcedureArity(function(ima3033, imb3034, ...imn30351716) {var imn3035 = $rjs_core.Pair.listFromArray(imn30351716);return M0.foldl(function(img3036, acc3037) {return __single_underlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc3037,img3036);},empty_image,M3.cons(ima3033,M3.cons(imb3034,imn3035)));});var underlay_by_align = $rjs_core.attachProcedureArity(function(x_place3038, y_place3039, ima3040, imb3041, ...imn30421717) {var imn3042 = $rjs_core.Pair.listFromArray(imn30421717);return M0.foldl(function(img3043, acc3044) {return __single_underlay(x_place3038,y_place3039,acc3044,img3043);},empty_image,M3.cons(ima3040,M3.cons(imb3041,imn3042)));});var underlay_by_xy = function(ima3045, x3046, y3047, imb3048) {return new Overlay(M3.__(x3046),M3.__(y3047),imb3048,ima3045);};var above_by_align = $rjs_core.attachProcedureArity(function(x_place3049, i13050, i23051, ...is30521718) {var is3052 = $rjs_core.Pair.listFromArray(is30521718);return M0.foldl(function(img3053, acc3054) {return __single_overlay(x_place3049,$rjs_core.UString.make("above"),acc3054,img3053);},empty_image,M3.cons(i13050,M3.cons(i23051,is3052)));});var above = $rjs_core.attachProcedureArity(function(i13055, i23056, ...is30571719) {var is3057 = $rjs_core.Pair.listFromArray(is30571719);return M0.foldl(function(img3058, acc3059) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("above"),acc3059,img3058);},empty_image,M3.cons(i13055,M3.cons(i23056,is3057)));});var beside_by_align = $rjs_core.attachProcedureArity(function(y_place3060, i13061, i23062, ...is30631720) {var is3063 = $rjs_core.Pair.listFromArray(is30631720);return M0.foldl(function(img3064, acc3065) {return __single_overlay($rjs_core.UString.make("beside"),y_place3060,acc3065,img3064);},empty_image,M3.cons(i13061,M3.cons(i23062,is3063)));});var beside = $rjs_core.attachProcedureArity(function(i13066, i23067, ...is30681721) {var is3068 = $rjs_core.Pair.listFromArray(is30681721);return M0.foldl(function(img3069, acc3070) {return __single_overlay($rjs_core.UString.make("beside"),$rjs_core.UString.make("middle"),acc3070,img3069);},empty_image,M3.cons(i13066,M3.cons(i23067,is3068)));});var rotate = function(angle3071, image3072) {return new Rotate(image3072,M3.__(angle3071));};var scale = function(factor3073, image3074) {return new Scale(image3074,factor3073,factor3073);};var flip_horizontal = function(image3075) {return new Scale(image3075,-1,1);};var flip_vertical = function(image3076) {return new Scale(image3076,1,-1);};var bitmap_by_data = function(data3077) {return new Bitmap(data3077);};var bitmap_by_url = function(url3078) {return new Bitmap(url3078);};var frame = function(img3079) {return color_frame($rjs_core.UString.make("black"),img3079);};var color_frame = function(color3080, img3081) {return overlay(rectangle(image_width(img3081),image_height(img3081),$rjs_core.PrimitiveSymbol.make("outline"),color3080),img3081);};var freeze = function(img3082) {return new Freeze(img3082);};var __rjs_quoted__ = {};__rjs_quoted__.empty_image = empty_image;__rjs_quoted__.posn_p = posn_p;__rjs_quoted__.make_posn = make_posn;__rjs_quoted__.posn_y = posn_y;__rjs_quoted__.posn_x = posn_x;__rjs_quoted__.___gt_web_color = ___gt_web_color;__rjs_quoted__.struct_posn = struct_posn;export { __rjs_quoted__,posn_x,posn_y,posn_p,make_posn,struct_posn,print_image,freeze,bitmap_by_url,bitmap_by_data,flip_horizontal,flip_vertical,scale,rotate,beside,beside_by_align,above,above_by_align,underlay_by_xy,underlay,overlay,overlay_by_xy,overlay_by_align,place_images_by_align,place_image_by_align,place_images,place_image,color_frame,frame,triangle,text_by_font,text,circle,square,rectangle,line,image_width,image_height,empty_scene,empty_image };