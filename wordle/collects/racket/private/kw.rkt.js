import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result2419 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result2419.getAt(0);var keyword_impersonator_p = let_result2419.getAt(1);var keyword_impersonator_ref = let_result2419.getAt(2);var keyword_procedure_impersonator_of = function(v4126) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_impersonator_p(v4126)!==false) {var if_res2420 = keyword_impersonator_ref(v4126)(v4126);} else {var if_res2420 = false;}return if_res2420;};var let_result2421 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result2421.getAt(0);var mk_kw_proc = let_result2421.getAt(1);var keyword_procedure_p = let_result2421.getAt(2);var keyword_procedure_ref = let_result2421.getAt(3);var keyword_procedure_set_bang_ = let_result2421.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result2422 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result2422.getAt(0);var make_km = let_result2422.getAt(1);var keyword_method_p = let_result2422.getAt(2);var km_ref = let_result2422.getAt(3);var km_set_bang_ = let_result2422.getAt(4);var generate_arity_string = function(proc4127) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result2423 = procedure_keywords(proc4127);var req4128 = let_result2423.getAt(0);var allowed4129 = let_result2423.getAt(1);var a4130 = M0.procedure_arity(proc4127);var keywords_desc4131 = function(opt4133, req4134) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var temp2429 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req4134))!==false) {var if_res2428 = M0.format($rjs_core.UString.make("an ~aargument"),opt4133);} else {var if_res2428 = M0.format($rjs_core.UString.make("~aarguments"),opt4133);}if (M0.null_p(M0.cdr(req4134))!==false) {var if_res2427 = $rjs_core.UString.make("");} else {var if_res2427 = $rjs_core.UString.make("s");}var tmp4135 = M0.length(req4134);if (M0.equal_p(tmp4135,1)!==false) {var if_res2426 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req4134));} else {if (M0.equal_p(tmp4135,2)!==false) {var if_res2425 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req4134),M0.cadr(req4134));} else {var loop4136 = function(req4137) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(req4137))!==false) {var if_res2424 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req4137));} else {var if_res2424 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req4137),loop4136(M0.cdr(req4137)));}return if_res2424;};var if_res2425 = loop4136(req4134);}var if_res2426 = if_res2425;}return M0.format(temp2429,if_res2428,if_res2427,if_res2426);};var method_adjust4132 = function(a4138) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part4139 = okm_p(proc4127);if (or_part4139!==false) {var if_res2430 = or_part4139;} else {var if_res2430 = keyword_method_p(proc4127);}if (if_res2430!==false) {if (M0.zero_p(a4138)!==false) {var if_res2431 = 0;} else {var if_res2431 = M0.sub1(a4138);}var if_res2432 = if_res2431;} else {var if_res2432 = a4138;}return if_res2432;};if (M0.number_p(a4130)!==false) {var a4140 = method_adjust4132(a4130);var if_res2439 = M0.format($rjs_core.UString.make("~a"),a4140);} else {if (M0.arity_at_least_p(a4130)!==false) {var a4141 = method_adjust4132(M0.arity_at_least_value(a4130));var if_res2438 = M0.format($rjs_core.UString.make("at least ~a"),a4141);} else {var if_res2438 = $rjs_core.UString.make("a different number");}var if_res2439 = if_res2438;}if (M0.null_p(req4128)!==false) {var if_res2437 = $rjs_core.UString.make("");} else {var if_res2437 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc4131($rjs_core.UString.make(""),req4128));}if (allowed4129!==false) {var loop4143 = function(req4144, allowed4145) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req4144)!==false) {var if_res2434 = allowed4145;} else {if (M0.eq_p(M0.car(req4144),M0.car(allowed4145))!==false) {var if_res2433 = loop4143(M0.cdr(req4144),M0.cdr(allowed4145));} else {var if_res2433 = M0.cons(M0.car(allowed4145),loop4143(req4144,M0.cdr(allowed4145)));}var if_res2434 = if_res2433;}return if_res2434;};var others4142 = loop4143(req4128,allowed4129);if (M0.null_p(others4142)!==false) {var if_res2435 = $rjs_core.UString.make("");} else {var if_res2435 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc4131($rjs_core.UString.make("optional "),others4142));}var if_res2436 = if_res2435;} else {var if_res2436 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res2439,if_res2437,if_res2436);};var let_result2440 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result2440.getAt(0);var make_optional_keyword_procedure = let_result2440.getAt(1);var okp_p = let_result2440.getAt(2);var okp_ref = let_result2440.getAt(3);var okp_set_bang_ = let_result2440.getAt(4);var let_result2441 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result2441.getAt(0);var make_optional_keyword_method = let_result2441.getAt(1);var okm_p = let_result2441.getAt(2);var okm_ref = let_result2441.getAt(3);var okm_set_bang_ = let_result2441.getAt(4);var let_result2442 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result2442.getAt(0);var named_keyword_procedure_p = let_result2442.getAt(1);var keyword_procedure_name_plus_fail = let_result2442.getAt(2);var let_result2444 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v4146, info_l4147) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_integer_p(v4146)!==false) {var if_res2443 = M0.make_struct_field_accessor(M0.list_ref(info_l4147,3),v4146);} else {var if_res2443 = false;}return if_res2443;});var prop_procedure_accessor = let_result2444.getAt(0);var procedure_accessor_p = let_result2444.getAt(1);var procedure_accessor_ref = let_result2444.getAt(2);var let_result2445 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result2445.getAt(0);var new_procedure_p = let_result2445.getAt(1);var new_procedure_ref = let_result2445.getAt(2);var let_result2446 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4148) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kpp_ref(v4148,0);})));var struct_keyword_procedure_impersonator = let_result2446.getAt(0);var make_kpp = let_result2446.getAt(1);var keyword_procedure_impersonator_p = let_result2446.getAt(2);var kpp_ref = let_result2446.getAt(3);var kpp_set_bang_ = let_result2446.getAt(4);var let_result2447 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4149) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return kmp_ref(v4149,0);})));var struct_keyword_method_impersonator = let_result2447.getAt(0);var make_kmp = let_result2447.getAt(1);var keyword_method_impersonator_p = let_result2447.getAt(2);var kmp_ref = let_result2447.getAt(3);var kmp_set_bang_ = let_result2447.getAt(4);var let_result2448 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4150) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okpp_ref(v4150,0);})));var struct_okpp = let_result2448.getAt(0);var make_optional_keyword_procedure_impersonator = let_result2448.getAt(1);var okpp_p = let_result2448.getAt(2);var okpp_ref = let_result2448.getAt(3);var okpp_set_bang_ = let_result2448.getAt(4);var let_result2449 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4151) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return okmp_ref(v4151,0);})));var struct_okmp = let_result2449.getAt(0);var make_optional_keyword_method_impersonator = let_result2449.getAt(1);var okmp_p = let_result2449.getAt(2);var okmp_ref = let_result2449.getAt(3);var okmp_set_bang_ = let_result2449.getAt(4);var let_result2450 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result2450.getAt(0);var make_kp_by_ae = let_result2450.getAt(1);var kp_by_ae_p = let_result2450.getAt(2);var kp_by_ae_ref = let_result2450.getAt(3);var kp_by_ae_set_bang_ = let_result2450.getAt(4);var let_result2451 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result2451.getAt(0);var make_km_by_ae = let_result2451.getAt(1);var km_by_ae_p = let_result2451.getAt(2);var km_by_ae_ref = let_result2451.getAt(3);var km_by_ae_set_bang_ = let_result2451.getAt(4);var let_result2452 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result2452.getAt(0);var make_kpi_by_ae = let_result2452.getAt(1);var kpi_by_ae_p = let_result2452.getAt(2);var kpi_by_ae_ref = let_result2452.getAt(3);var kpi_by_ae_set_bang_ = let_result2452.getAt(4);var let_result2453 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result2453.getAt(0);var make_kmi_by_ae = let_result2453.getAt(1);var kmi_by_ae_p = let_result2453.getAt(2);var kmi_by_ae_ref = let_result2453.getAt(3);var kmi_by_ae_set_bang_ = let_result2453.getAt(4);var make_required = function(name4152, fail_proc4153, method_p4154, impersonator_p4155) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var or_part4161 = name4152;if (or_part4161!==false) {var if_res2457 = or_part4161;} else {var if_res2457 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p4155!==false) {if (method_p4154!==false) {var if_res2454 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res2454 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res2456 = if_res2454;} else {if (method_p4154!==false) {var if_res2455 = struct_keyword_method_by_arity_error;} else {var if_res2455 = struct_keyword_procedure_by_arity_error;}var if_res2456 = if_res2455;}var let_result2458 = M0.make_struct_type(if_res2457,if_res2456,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name4152,fail_proc4153))),M0.current_inspector(),fail_proc4153);var s_4156 = let_result2458.getAt(0);var mk4157 = let_result2458.getAt(1);var __p4158 = let_result2458.getAt(2);var __ref4159 = let_result2458.getAt(3);var __set_bang_4160 = let_result2458.getAt(4);return mk4157;};var cl2459 = function(proc4162) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc_name4163 = M0.object_name(proc4162);var plain_proc4164 = $rjs_core.attachProcedureArity(function(...args41652462) {var args4165 = $rjs_core.Pair.listFromArray(args41652462);return M0.apply(proc4162,M0.rnull,M0.rnull,args4165);});if (M0.symbol_p(proc_name4163)!==false) {var if_res2463 = M0.__rjs_quoted__.procedure_rename(plain_proc4164,proc_name4163);} else {var if_res2463 = plain_proc4164;}return make_keyword_procedure(proc4162,if_res2463);};var cl2460 = function(proc4166, plain_proc4167) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc4166)!==false) {var if_res2464 = M0.procedure_arity_mask(proc4166);} else {var if_res2464 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res2464),proc4166,M0.rnull,false,plain_proc4167);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam2461 = {'1':cl2459,'2':cl2460}[arguments.length];if (fixed_lam2461!==undefined) {return fixed_lam2461.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc4168, kws4169, kw_vals4170, normal_args4171, ...normal_argss41722465) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var normal_argss4172 = $rjs_core.Pair.listFromArray(normal_argss41722465);var type_error4173 = function(what4174, which4175) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what4174,which4175,proc4168,kws4169,kw_vals4170,normal_args4171,normal_argss4172);};if (M0.procedure_p(proc4168)!==false) {var if_res2466 = M0.rvoid();} else {var if_res2466 = type_error4173($rjs_core.UString.make("procedure?"),0);}if_res2466;var loop4176 = function(ks4177) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(ks4177)!==false) {var if_res2473 = M0.rvoid();} else {var or_part4178 = M0.not(M0.pair_p(ks4177));if (or_part4178!==false) {var if_res2467 = or_part4178;} else {var if_res2467 = M0.not(M0.keyword_p(M0.car(ks4177)));}if (if_res2467!==false) {var if_res2472 = type_error4173($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks4177))!==false) {var if_res2471 = M0.rvoid();} else {var or_part4179 = M0.not(M0.pair_p(M0.cdr(ks4177)));if (or_part4179!==false) {var if_res2468 = or_part4179;} else {var if_res2468 = M0.not(M0.keyword_p(M0.cadr(ks4177)));}if (if_res2468!==false) {var if_res2470 = loop4176(M0.cdr(ks4177));} else {if (M0.keyword_lt__p(M0.car(ks4177),M0.cadr(ks4177))!==false) {var if_res2469 = loop4176(M0.cdr(ks4177));} else {var if_res2469 = type_error4173($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res2470 = if_res2469;}var if_res2471 = if_res2470;}var if_res2472 = if_res2471;}var if_res2473 = if_res2472;}return if_res2473;};loop4176(kws4169);if (M0.list_p(kw_vals4170)!==false) {var if_res2474 = M0.rvoid();} else {var if_res2474 = type_error4173($rjs_core.UString.make("list?"),2);}if_res2474;if (M0.__eq_(M0.length(kws4169),M0.length(kw_vals4170))!==false) {var if_res2475 = M0.rvoid();} else {var if_res2475 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws4169),$rjs_core.UString.make("value list length"),M0.length(kw_vals4170),$rjs_core.UString.make("keyword list"),kws4169,$rjs_core.UString.make("value list"),kw_vals4170);}if_res2475;var loop4181 = function(normal_argss4182, pos4183) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(M0.cdr(normal_argss4182))!==false) {var l4184 = M0.car(normal_argss4182);if (M0.list_p(l4184)!==false) {var if_res2476 = l4184;} else {var if_res2476 = type_error4173($rjs_core.UString.make("list?"),pos4183);}var if_res2477 = if_res2476;} else {var if_res2477 = M0.cons(M0.car(normal_argss4182),loop4181(M0.cdr(normal_argss4182),M0.add1(pos4183)));}return if_res2477;};var normal_args4180 = loop4181(M0.cons(normal_args4171,normal_argss4172),3);if (M0.null_p(kws4169)!==false) {var if_res2478 = M0.apply(proc4168,normal_args4180);} else {var if_res2478 = M0.apply(keyword_procedure_extract_by_method(kws4169,2+M0.length(normal_args4180),proc4168,0),kws4169,kw_vals4170,normal_args4180);}return if_res2478;});var procedure_keywords = function(p4185) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p4185)!==false) {var if_res2483 = M0.values(keyword_procedure_required(p4185),keyword_procedure_allowed(p4185));} else {if (M0.procedure_p(p4185)!==false) {if (new_procedure_p(p4185)!==false) {var v4186 = new_procedure_ref(p4185);if (M0.procedure_p(v4186)!==false) {var if_res2480 = procedure_keywords(v4186);} else {var a4187 = procedure_accessor_ref(p4185);if (a4187!==false) {var if_res2479 = procedure_keywords(a4187(p4185));} else {var if_res2479 = M0.values(M0.rnull,M0.rnull);}var if_res2480 = if_res2479;}var if_res2481 = if_res2480;} else {var if_res2481 = M0.values(M0.rnull,M0.rnull);}var if_res2482 = if_res2481;} else {var if_res2482 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p4185);}var if_res2483 = if_res2482;}return if_res2483;};var missing_kw = $rjs_core.attachProcedureArity(function(proc4188, ...args41892484) {if (arguments.length<1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args4189 = $rjs_core.Pair.listFromArray(args41892484);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc4188,0),M0.rnull,M0.rnull,args4189);});var check_kw_args = function(p4190, kws4191) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop4192 = function(kws4193, required4194, allowed4195) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws4193)!==false) {if (M0.null_p(required4194)!==false) {var if_res2485 = M0.values(false,false);} else {var if_res2485 = M0.values(M0.car(required4194),false);}var if_res2494 = if_res2485;} else {if (M0.pair_p(required4194)!==false) {var if_res2486 = M0.eq_p(M0.car(required4194),M0.car(kws4193));} else {var if_res2486 = false;}if (if_res2486!==false) {var temp2489 = M0.cdr(kws4193);var temp2488 = M0.cdr(required4194);if (allowed4195!==false) {var if_res2487 = M0.cdr(allowed4195);} else {var if_res2487 = false;}var if_res2493 = loop4192(temp2489,temp2488,if_res2487);} else {if (M0.not(allowed4195)!==false) {var if_res2492 = loop4192(M0.cdr(kws4193),required4194,false);} else {if (M0.pair_p(allowed4195)!==false) {if (M0.eq_p(M0.car(allowed4195),M0.car(kws4193))!==false) {var if_res2490 = loop4192(M0.cdr(kws4193),required4194,M0.cdr(allowed4195));} else {var if_res2490 = loop4192(kws4193,required4194,M0.cdr(allowed4195));}var if_res2491 = if_res2490;} else {var if_res2491 = M0.values(false,M0.car(kws4193));}var if_res2492 = if_res2491;}var if_res2493 = if_res2492;}var if_res2494 = if_res2493;}return if_res2494;};return loop4192(kws4191,keyword_procedure_required(p4190),keyword_procedure_allowed(p4190));};var make_keyword_checker = function(req_kws4196, allowed_kws4197, arity_mask4198) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(allowed_kws4197)!==false) {if (M0.null_p(req_kws4196)!==false) {var if_res2497 = function(kws4199, a4200) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (true!==false) {var if_res2495 = M0.bitwise_bit_set_p(arity_mask4198,a4200);} else {var if_res2495 = false;}return if_res2495;};} else {var if_res2497 = function(kws4201, a4202) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(req_kws4196,kws4201)!==false) {var if_res2496 = M0.bitwise_bit_set_p(arity_mask4198,a4202);} else {var if_res2496 = false;}return if_res2496;};}var if_res2510 = if_res2497;} else {if (M0.null_p(allowed_kws4197)!==false) {var if_res2509 = function(kws4203, a4204) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws4203)!==false) {var if_res2498 = M0.bitwise_bit_set_p(arity_mask4198,a4204);} else {var if_res2498 = false;}return if_res2498;};} else {if (M0.null_p(req_kws4196)!==false) {var if_res2508 = function(kws4205, a4206) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subset_p(kws4205,allowed_kws4197)!==false) {var if_res2499 = M0.bitwise_bit_set_p(arity_mask4198,a4206);} else {var if_res2499 = false;}return if_res2499;};} else {if (M0.list_p(req_kws4196)!==false) {if (M0.list_p(allowed_kws4197)!==false) {var if_res2500 = M0.eq_p(M0.length(req_kws4196),M0.length(allowed_kws4197));} else {var if_res2500 = false;}var if_res2501 = if_res2500;} else {var if_res2501 = false;}if (if_res2501!==false) {var if_res2507 = function(kws4207, a4208) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop4209 = function(kws4210, req_kws4211) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(req_kws4211)!==false) {var if_res2504 = M0.null_p(kws4210);} else {if (M0.null_p(kws4210)!==false) {var if_res2503 = false;} else {if (M0.eq_p(M0.car(kws4210),M0.car(req_kws4211))!==false) {var if_res2502 = loop4209(M0.cdr(kws4210),M0.cdr(req_kws4211));} else {var if_res2502 = false;}var if_res2503 = if_res2502;}var if_res2504 = if_res2503;}return if_res2504;};if (loop4209(kws4207,req_kws4196)!==false) {var if_res2505 = M0.bitwise_bit_set_p(arity_mask4198,a4208);} else {var if_res2505 = false;}return if_res2505;};} else {var if_res2507 = function(kws4212, a4213) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (subsets_p(req_kws4196,kws4212,allowed_kws4197)!==false) {var if_res2506 = M0.bitwise_bit_set_p(arity_mask4198,a4213);} else {var if_res2506 = false;}return if_res2506;};}var if_res2508 = if_res2507;}var if_res2509 = if_res2508;}var if_res2510 = if_res2509;}return if_res2510;};var subset_p = function(l14214, l24215) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l14214)!==false) {var if_res2513 = true;} else {if (M0.null_p(l24215)!==false) {var if_res2512 = false;} else {if (M0.eq_p(M0.car(l14214),M0.car(l24215))!==false) {var if_res2511 = subset_p(M0.cdr(l14214),M0.cdr(l24215));} else {var if_res2511 = subset_p(l14214,M0.cdr(l24215));}var if_res2512 = if_res2511;}var if_res2513 = if_res2512;}return if_res2513;};var subsets_p = function(l14216, l24217, l34218) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l14216)!==false) {var if_res2518 = subset_p(l24217,l34218);} else {if (M0.null_p(l24217)!==false) {var if_res2517 = false;} else {if (M0.null_p(l34218)!==false) {var if_res2516 = false;} else {var v24219 = M0.car(l24217);if (M0.eq_p(M0.car(l14216),v24219)!==false) {var if_res2515 = subsets_p(M0.cdr(l14216),M0.cdr(l24217),M0.cdr(l34218));} else {if (M0.eq_p(v24219,M0.car(l34218))!==false) {var if_res2514 = subsets_p(l14216,M0.cdr(l24217),M0.cdr(l34218));} else {var if_res2514 = subsets_p(l14216,l24217,M0.cdr(l34218));}var if_res2515 = if_res2514;}var if_res2516 = if_res2515;}var if_res2517 = if_res2516;}var if_res2518 = if_res2517;}return if_res2518;};var keyword_procedure_extract_by_method = function(kws4220, n4221, p4222, method_n4223) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(p4222)!==false) {var if_res2519 = keyword_procedure_checker(p4222)(kws4220,n4221);} else {var if_res2519 = false;}if (if_res2519!==false) {var if_res2549 = keyword_procedure_proc(p4222);} else {if (M0.not(keyword_procedure_p(p4222))!==false) {if (M0.procedure_p(p4222)!==false) {if (new_procedure_p(p4222)!==false) {var a4226 = procedure_accessor_ref(p4222);if (a4226!==false) {var if_res2520 = a4226(p4222);} else {var if_res2520 = false;}var if_res2521 = if_res2520;} else {var if_res2521 = false;}var or_part4225 = if_res2521;if (or_part4225!==false) {var if_res2524 = or_part4225;} else {var or_part4227 = M0.procedure_extract_target(p4222);if (or_part4227!==false) {var if_res2523 = or_part4227;} else {if (new_procedure_p(p4222)!==false) {var if_res2522 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res2522 = false;}var if_res2523 = if_res2522;}var if_res2524 = if_res2523;}var if_res2525 = if_res2524;} else {var if_res2525 = false;}var if_res2526 = if_res2525;} else {var if_res2526 = false;}var p24224 = if_res2526;if (p24224!==false) {if (M0.eq_p(p24224,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p34228 = keyword_procedure_extract_by_method(kws4220,M0.add1(n4221),new_procedure_ref(p4222),M0.add1(method_n4223));var if_res2528 = $rjs_core.attachProcedureArity(function(kws4229, kw_args4230, ...args42312527) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args4231 = $rjs_core.Pair.listFromArray(args42312527);return M0.apply(p34228,kws4229,kw_args4230,M0.cons(p4222,args4231));});} else {var if_res2528 = keyword_procedure_extract_by_method(kws4220,n4221,p24224,method_n4223);}var if_res2548 = if_res2528;} else {var if_res2548 = $rjs_core.attachProcedureArity(function(kws4232, kw_args4233, ...args42342529) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args4234 = $rjs_core.Pair.listFromArray(args42342529);if (keyword_procedure_p(p4222)!==false) {var if_res2530 = check_kw_args(p4222,kws4232);} else {var if_res2530 = M0.values(false,M0.car(kws4232));}var let_result2531 = if_res2530;var missing_kw4235 = let_result2531.getAt(0);var extra_kw4236 = let_result2531.getAt(1);var or_part4241 = keyword_method_p(p4222);if (or_part4241!==false) {var if_res2532 = or_part4241;} else {var if_res2532 = okm_p(p4222);}if (if_res2532!==false) {var if_res2533 = 1;} else {var if_res2533 = 0;}var method_n4240 = method_n4223+if_res2533;if (M0.__gt__eq_(n4221,method_n4240)!==false) {var if_res2534 = n4221-method_n4240;} else {var if_res2534 = n4221;}var n4237 = if_res2534;if (M0.null_p(args4234)!==false) {var if_res2535 = M0.null_p(kws4232);} else {var if_res2535 = false;}if (if_res2535!==false) {var if_res2536 = $rjs_core.UString.make("");} else {var if_res2536 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v4242) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~e"),v4242);},args4234),M0.map(function(kw4243, kw_arg4244) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw4243,kw_arg4244);},kws4232,kw_args4233)));}var args_str4238 = if_res2536;var proc_name4239 = function(p4245) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (named_keyword_procedure_p(p4245)!==false) {var if_res2537 = M0.car(keyword_procedure_name_plus_fail(p4245));} else {var if_res2537 = false;}var or_part4246 = if_res2537;if (or_part4246!==false) {var if_res2539 = or_part4246;} else {var or_part4247 = M0.object_name(p4245);if (or_part4247!==false) {var if_res2538 = or_part4247;} else {var if_res2538 = p4245;}var if_res2539 = if_res2538;}return if_res2539;};var or_part4248 = extra_kw4236;if (or_part4248!==false) {var if_res2546 = or_part4248;} else {var if_res2546 = missing_kw4235;}if (if_res2546!==false) {var if_res2547 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res2547 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw4236!==false) {if (keyword_procedure_p(p4222)!==false) {var if_res2541 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name4239(p4222),extra_kw4236,args_str4238);} else {if (M0.procedure_p(p4222)!==false) {var if_res2540 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name4239(p4222),args_str4238);} else {var if_res2540 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p4222,args_str4238);}var if_res2541 = if_res2540;}var if_res2545 = if_res2541;} else {if (missing_kw4235!==false) {var if_res2544 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name4239(p4222),missing_kw4235,args_str4238);} else {var temp2543 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n4237-2)!==false) {var if_res2542 = $rjs_core.UString.make("");} else {var if_res2542 = $rjs_core.UString.make("s");}var if_res2544 = M0.format(temp2543,n4237-2,if_res2542,proc_name4239(p4222),args_str4238);}var if_res2545 = if_res2544;}return M0.raise(if_res2547(if_res2545,M0.current_continuation_marks()));});}var if_res2549 = if_res2548;}return if_res2549;};var keyword_procedure_extract = function(p4249, kws4250, n4251) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}return keyword_procedure_extract_by_method(kws4250,n4251,p4249,0);};var cl2550 = function(proc4252, arity4253, req_kw4254, allowed_kw4255, name4256) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc4252,arity4253,false,name4256,req_kw4254,allowed_kw4255);};var cl2551 = function(proc4257, arity4258, req_kw4259, allowed_kw4260) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc4257,arity4258,false,false,req_kw4259,allowed_kw4260);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam2552 = {'5':cl2550,'4':cl2551}[arguments.length];if (fixed_lam2552!==undefined) {return fixed_lam2552.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl2553 = function(proc4261, mask4262, req_kw4263, allowed_kw4264, name4265) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc4261,false,mask4262,name4265,req_kw4263,allowed_kw4264);};var cl2554 = function(proc4266, mask4267, req_kw4268, allowed_kw4269) {if (arguments.length!==4) {throw $rjs_core.racketContractError("arity mismatch");} else {}return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc4266,false,mask4267,false,req_kw4268,allowed_kw4269);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam2555 = {'5':cl2553,'4':cl2554}[arguments.length];if (fixed_lam2555!==undefined) {return fixed_lam2555.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who4270, proc4271, arity4272, mask4273, name4274, req_kw4275, allowed_kw4276) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (okp_p(proc4271)!==false) {var if_res2556 = okp_ref(proc4271,0);} else {var if_res2556 = proc4271;}var p4278 = if_res2556;if (arity4272!==false) {var if_res2557 = M0.__rjs_quoted__.procedure_reduce_arity(p4278,arity4272);} else {var if_res2557 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p4278,mask4273,name4274);}var plain_proc4277 = if_res2557;var sorted_p4279 = function(kws4280) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop4281 = function(kws4282) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(kws4282)!==false) {var if_res2560 = true;} else {if (M0.null_p(M0.cdr(kws4282))!==false) {var if_res2559 = true;} else {if (M0.keyword_lt__p(M0.car(kws4282),M0.cadr(kws4282))!==false) {var if_res2558 = loop4281(M0.cdr(kws4282));} else {var if_res2558 = false;}var if_res2559 = if_res2558;}var if_res2560 = if_res2559;}return if_res2560;};return loop4281(kws4280);};if (M0.list_p(req_kw4275)!==false) {if (M0.andmap(M0.keyword_p,req_kw4275)!==false) {var if_res2561 = sorted_p4279(req_kw4275);} else {var if_res2561 = false;}var if_res2562 = if_res2561;} else {var if_res2562 = false;}if (if_res2562!==false) {var if_res2565 = M0.rvoid();} else {var temp2564 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part4283 = arity4272;if (or_part4283!==false) {var if_res2563 = or_part4283;} else {var if_res2563 = mask4273;}var if_res2565 = M0.raise_argument_error(who4270,temp2564,2,proc4271,if_res2563,req_kw4275,allowed_kw4276);}if_res2565;if (allowed_kw4276!==false) {if (M0.list_p(allowed_kw4276)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw4276)!==false) {var if_res2566 = sorted_p4279(allowed_kw4276);} else {var if_res2566 = false;}var if_res2567 = if_res2566;} else {var if_res2567 = false;}if (if_res2567!==false) {var if_res2570 = M0.rvoid();} else {var temp2569 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part4284 = arity4272;if (or_part4284!==false) {var if_res2568 = or_part4284;} else {var if_res2568 = mask4273;}var if_res2570 = M0.raise_argument_error(who4270,temp2569,3,proc4271,if_res2568,req_kw4275,allowed_kw4276);}if_res2570;if (subset_p(req_kw4275,allowed_kw4276)!==false) {var if_res2571 = M0.rvoid();} else {var if_res2571 = M0.raise_arguments_error(who4270,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw4276,$rjs_core.UString.make("required keywords"),req_kw4275);}var if_res2572 = if_res2571;} else {var if_res2572 = M0.rvoid();}if_res2572;var let_result2573 = procedure_keywords(proc4271);var old_req4285 = let_result2573.getAt(0);var old_allowed4286 = let_result2573.getAt(1);if (subset_p(old_req4285,req_kw4275)!==false) {var if_res2574 = M0.rvoid();} else {var if_res2574 = M0.raise_arguments_error(who4270,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req4285,$rjs_core.UString.make("requested required keywords"),req_kw4275);}if_res2574;if (old_allowed4286!==false) {if (subset_p(req_kw4275,old_allowed4286)!==false) {var if_res2575 = M0.rvoid();} else {var if_res2575 = M0.raise_arguments_error(who4270,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed4286,$rjs_core.UString.make("requested required keywords"),req_kw4275);}if_res2575;var or_part4287 = M0.not(allowed_kw4276);if (or_part4287!==false) {var if_res2576 = or_part4287;} else {var if_res2576 = subset_p(allowed_kw4276,old_allowed4286);}if (if_res2576!==false) {var if_res2577 = M0.rvoid();} else {var if_res2577 = M0.raise_arguments_error(who4270,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed4286,$rjs_core.UString.make("requested allowed keywords"),allowed_kw4276);}var if_res2578 = if_res2577;} else {var if_res2578 = M0.rvoid();}if_res2578;if (M0.null_p(allowed_kw4276)!==false) {var if_res2586 = plain_proc4277;} else {var or_part4289 = mask4273;if (or_part4289!==false) {var if_res2579 = or_part4289;} else {var if_res2579 = arity__gt_mask(arity4272);}var mask4288 = if_res2579;var new_mask4290 = M0.arithmetic_shift(mask4288,2);var kw_checker4291 = make_keyword_checker(req_kw4275,allowed_kw4276,new_mask4290);var proc4292 = normalize_proc(proc4271);var new_kw_proc4293 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc4292),new_mask4290);if (M0.null_p(req_kw4275)!==false) {if (okm_p(proc4292)!==false) {var if_res2580 = make_optional_keyword_method;} else {var if_res2580 = make_optional_keyword_procedure;}var if_res2585 = if_res2580(kw_checker4291,new_kw_proc4293,req_kw4275,allowed_kw4276,plain_proc4277);} else {if (named_keyword_procedure_p(proc4292)!==false) {var if_res2583 = M0.car(keyword_procedure_name_plus_fail(proc4292));} else {var if_res2583 = false;}var or_part4294 = if_res2583;if (or_part4294!==false) {var if_res2584 = or_part4294;} else {var if_res2584 = M0.object_name(proc4292);}var temp2582 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask4288,1));var or_part4295 = okm_p(proc4292);if (or_part4295!==false) {var if_res2581 = or_part4295;} else {var if_res2581 = keyword_method_p(proc4292);}var if_res2585 = make_required(if_res2584,temp2582,if_res2581,false)(kw_checker4291,new_kw_proc4293,req_kw4275,allowed_kw4276);}var if_res2586 = if_res2585;}return if_res2586;};var arity__gt_mask = function(a4296) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.exact_nonnegative_integer_p(a4296)!==false) {var if_res2592 = M0.arithmetic_shift(1,a4296);} else {if (M0.arity_at_least_p(a4296)!==false) {var if_res2591 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a4296))));} else {if (M0.list_p(a4296)!==false) {var loop4297 = function(mask4298, l4299) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(l4299)!==false) {var if_res2589 = mask4298;} else {var a4300 = M0.car(l4299);var or_part4301 = M0.exact_nonnegative_integer_p(a4300);if (or_part4301!==false) {var if_res2587 = or_part4301;} else {var if_res2587 = M0.arity_at_least_p(a4300);}if (if_res2587!==false) {var if_res2588 = loop4297(M0.bitwise_ior(mask4298,arity__gt_mask(a4300)),M0.cdr(l4299));} else {var if_res2588 = false;}var if_res2589 = if_res2588;}return if_res2589;};var if_res2590 = loop4297(0,a4296);} else {var if_res2590 = false;}var if_res2591 = if_res2590;}var if_res2592 = if_res2591;}return if_res2592;};var cl2593 = function(proc4303, arity4304, name4305) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc4303)!==false) {var let_result2596 = procedure_keywords(proc4303);var req4306 = let_result2596.getAt(0);var allows4307 = let_result2596.getAt(1);if (M0.pair_p(req4306)!==false) {var if_res2597 = M0.not(M0.null_p(arity4304));} else {var if_res2597 = false;}var if_res2598 = if_res2597;} else {var if_res2598 = false;}if (if_res2598!==false) {var if_res2600 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc4303);} else {if (okm_p(proc4303)!==false) {var if_res2599 = M0.__rjs_quoted__.procedure__gt_method(proc4303);} else {var if_res2599 = proc4303;}var if_res2600 = M0.__rjs_quoted__.procedure_reduce_arity(if_res2599,arity4304,name4305);}return if_res2600;};var cl2594 = function(proc4308, arity4309) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity(proc4308,arity4309,false);};var procedure_reduce_arity4302 = $rjs_core.attachProcedureArity(function() {var fixed_lam2595 = {'3':cl2593,'2':cl2594}[arguments.length];if (fixed_lam2595!==undefined) {return fixed_lam2595.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity4302;var cl2601 = function(proc4311, mask4312, name4313) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_p(proc4311)!==false) {var let_result2604 = procedure_keywords(proc4311);var req4314 = let_result2604.getAt(0);var allows4315 = let_result2604.getAt(1);if (M0.pair_p(req4314)!==false) {var if_res2605 = M0.not(M0.eqv_p(mask4312,0));} else {var if_res2605 = false;}var if_res2606 = if_res2605;} else {var if_res2606 = false;}if (if_res2606!==false) {var if_res2608 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc4311);} else {if (okm_p(proc4311)!==false) {var if_res2607 = M0.__rjs_quoted__.procedure__gt_method(proc4311);} else {var if_res2607 = proc4311;}var if_res2608 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res2607,mask4312,name4313);}return if_res2608;};var cl2602 = function(proc4316, mask4317) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return new_procedure_reduce_arity_mask(proc4316,mask4317,false);};var procedure_reduce_arity4310 = $rjs_core.attachProcedureArity(function() {var fixed_lam2603 = {'3':cl2601,'2':cl2602}[arguments.length];if (fixed_lam2603!==undefined) {return fixed_lam2603.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity4310;var procedure__gt_method4318 = function(proc4319) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var proc4320 = normalize_proc(proc4319);if (keyword_procedure_p(proc4320)!==false) {if (okm_p(proc4320)!==false) {var if_res2611 = proc4320;} else {if (keyword_method_p(proc4320)!==false) {var if_res2610 = proc4320;} else {if (okp_p(proc4320)!==false) {var if_res2609 = make_optional_keyword_method(keyword_procedure_checker(proc4320),keyword_procedure_proc(proc4320),keyword_procedure_required(proc4320),keyword_procedure_allowed(proc4320),okp_ref(proc4320,0));} else {var name_plus_fail4321 = keyword_procedure_name_plus_fail(proc4320);var mk4322 = make_required(M0.car(name_plus_fail4321),M0.cdr(name_plus_fail4321),true,false);var if_res2609 = mk4322(keyword_procedure_checker(proc4320),keyword_procedure_proc(proc4320),keyword_procedure_required(proc4320),keyword_procedure_allowed(proc4320));}var if_res2610 = if_res2609;}var if_res2611 = if_res2610;}var if_res2612 = if_res2611;} else {var if_res2612 = M0.__rjs_quoted__.procedure__gt_method(proc4320);}return if_res2612;};var new_procedure__gt_method = procedure__gt_method4318;var procedure_rename4323 = function(proc4324, name4325) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc4324)!==false) {var if_res2613 = M0.symbol_p(name4325);} else {var if_res2613 = false;}if (M0.not(if_res2613)!==false) {var if_res2616 = M0.__rjs_quoted__.procedure_rename(proc4324,name4325);} else {if (okp_p(proc4324)!==false) {if (okm_p(proc4324)!==false) {var if_res2614 = make_optional_keyword_method;} else {var if_res2614 = make_optional_keyword_procedure;}var if_res2615 = if_res2614(keyword_procedure_checker(proc4324),keyword_procedure_proc(proc4324),keyword_procedure_required(proc4324),keyword_procedure_allowed(proc4324),M0.__rjs_quoted__.procedure_rename(okp_ref(proc4324,0),name4325));} else {var name_plus_fail4326 = keyword_procedure_name_plus_fail(proc4324);var mk4327 = make_required(name4325,M0.cdr(name_plus_fail4326),keyword_method_p(proc4324),false);var if_res2615 = mk4327(keyword_procedure_checker(proc4324),keyword_procedure_proc(proc4324),keyword_procedure_required(proc4324),keyword_procedure_allowed(proc4324));}var if_res2616 = if_res2615;}return if_res2616;};var new_procedure_rename = procedure_rename4323;var chaperone_procedure4328 = $rjs_core.attachProcedureArity(function(proc4329, wrap_proc4330, ...props43312617) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props4331 = $rjs_core.Pair.listFromArray(props43312617);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc4329,wrap_proc4330,props4331);});var new_chaperone_procedure = chaperone_procedure4328;var unsafe_chaperone_procedure4332 = $rjs_core.attachProcedureArity(function(proc4333, wrap_proc4334, ...props43352618) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props4335 = $rjs_core.Pair.listFromArray(props43352618);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc4333,wrap_proc4334,props4335);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure4332;var impersonate_procedure4336 = $rjs_core.attachProcedureArity(function(proc4337, wrap_proc4338, ...props43392619) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props4339 = $rjs_core.Pair.listFromArray(props43392619);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc4337,wrap_proc4338,props4339);});var new_impersonate_procedure = impersonate_procedure4336;var unsafe_impersonate_procedure4340 = $rjs_core.attachProcedureArity(function(proc4341, wrap_proc4342, ...props43432620) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props4343 = $rjs_core.Pair.listFromArray(props43432620);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc4341,wrap_proc4342,props4343);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure4340;var chaperone_procedure_times_4344 = $rjs_core.attachProcedureArity(function(proc4345, wrap_proc4346, ...props43472621) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props4347 = $rjs_core.Pair.listFromArray(props43472621);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc4345,wrap_proc4346,props4347);});var new_chaperone_procedure_times_ = chaperone_procedure_times_4344;var impersonate_procedure_times_4348 = $rjs_core.attachProcedureArity(function(proc4349, wrap_proc4350, ...props43512622) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var props4351 = $rjs_core.Pair.listFromArray(props43512622);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc4349,wrap_proc4350,props4351);});var new_impersonate_procedure_times_ = impersonate_procedure_times_4348;var do_chaperone_procedure = function(is_impersonator_p4352, self_arg_p4353, chaperone_procedure4354, name4355, proc4356, wrap_proc4357, props4358) {if (arguments.length!==7) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc4359 = normalize_proc(proc4356);var n_wrap_proc4360 = normalize_proc(wrap_proc4357);var or_part4361 = M0.not(keyword_procedure_p(n_proc4359));if (or_part4361!==false) {var if_res2624 = or_part4361;} else {var or_part4362 = M0.not(M0.procedure_p(wrap_proc4357));if (or_part4362!==false) {var if_res2623 = or_part4362;} else {var if_res2623 = bad_props_p(props4358);}var if_res2624 = if_res2623;}if (if_res2624!==false) {var if_res2688 = M0.apply(chaperone_procedure4354,proc4356,wrap_proc4357,props4358);} else {chaperone_arity_match_checking(self_arg_p4353,name4355,proc4356,wrap_proc4357,props4358);var p4364 = keyword_procedure_proc(n_wrap_proc4360);if (self_arg_p4353!==false) {var cl2625 = $rjs_core.attachProcedureArity(function(self_proc4365, kws4366, args4367, ...rest43682630) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest4368 = $rjs_core.Pair.listFromArray(rest43682630);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p4364,kws4366,args4367,self_proc4365,rest4368);},$rjs_core.attachProcedureArity(function(...results43692631) {var results4369 = $rjs_core.Pair.listFromArray(results43692631);var len4370 = M0.length(results4369);var alen4371 = M0.length(rest4368);if (M0.__lt_(len4370,alen4371+1)!==false) {var if_res2632 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen4371+1,$rjs_core.UString.make("received number of results"),len4370,$rjs_core.UString.make("wrapper procedure"),wrap_proc4357);} else {var if_res2632 = M0.rvoid();}if_res2632;var num_extra4372 = len4370-(alen4371+1);var new_args4373 = M0.list_ref(results4369,num_extra4372);if (M0.list_p(new_args4373)!==false) {var if_res2633 = M0.__eq_(M0.length(new_args4373),M0.length(args4367));} else {var if_res2633 = false;}if (if_res2633!==false) {var if_res2637 = M0.rvoid();} else {var temp2636 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp2635 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len4370,alen4371)!==false) {var if_res2634 = $rjs_core.UString.make("");} else {var if_res2634 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res2637 = M0.raise_arguments_error(temp2636,M0.format(temp2635,if_res2634),$rjs_core.UString.make("first result"),new_args4373,$rjs_core.UString.make("wrapper procedure"),wrap_proc4357);}if_res2637;M0.for_each(function(kw4374, new_arg4375, arg4376) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p4352!==false) {var if_res2639 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg4375,arg4376)!==false) {var if_res2638 = M0.rvoid();} else {var if_res2638 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw4374),$rjs_core.UString.make("result"),new_arg4375,$rjs_core.UString.make("wrapper procedure"),wrap_proc4357);}var if_res2639 = if_res2638;}return if_res2639;},kws4366,new_args4373,args4367);var tmp4377 = num_extra4372;if (M0.equal_p(tmp4377,0)!==false) {var if_res2642 = M0.apply(M0.values,kws4366,results4369);} else {if (M0.equal_p(tmp4377,1)!==false) {var if_res2641 = M0.apply(M0.values,M0.car(results4369),kws4366,M0.cdr(results4369));} else {var loop4378 = function(results4379, c4380) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c4380)!==false) {var if_res2640 = M0.cons(kws4366,results4379);} else {var if_res2640 = M0.cons(M0.car(results4379),loop4378(M0.cdr(results4379),M0.sub1(c4380)));}return if_res2640;};var if_res2641 = M0.apply(M0.values,loop4378(results4369,num_extra4372));}var if_res2642 = if_res2641;}return if_res2642;}));});var cl2626 = $rjs_core.attachProcedureArity(function(...other43812643) {var other4381 = $rjs_core.Pair.listFromArray(other43812643);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res2663 = $rjs_core.attachProcedureArity(function() {var fixed_lam2627 = {}[arguments.length];if (fixed_lam2627!==undefined) {return fixed_lam2627.apply(null,arguments);} else {if (M0.__gt__eq_(cl2625.length,1)!==false) {var if_res2629 = cl2625.apply(null,arguments);} else {if (true!==false) {var if_res2628 = cl2626.apply(null,arguments);} else {var if_res2628 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res2629 = if_res2628;}return if_res2629;}},[M0.make_arity_at_least(0)]);} else {var cl2644 = $rjs_core.attachProcedureArity(function(kws4382, args4383, ...rest43842649) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var rest4384 = $rjs_core.Pair.listFromArray(rest43842649);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(p4364,kws4382,args4383,rest4384);},$rjs_core.attachProcedureArity(function(...results43852650) {var results4385 = $rjs_core.Pair.listFromArray(results43852650);var len4386 = M0.length(results4385);var alen4387 = M0.length(rest4384);if (M0.__lt_(len4386,alen4387+1)!==false) {var if_res2651 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen4387+1,$rjs_core.UString.make("received number of results"),len4386,$rjs_core.UString.make("wrapper procedure"),wrap_proc4357);} else {var if_res2651 = M0.rvoid();}if_res2651;var num_extra4388 = len4386-(alen4387+1);var new_args4389 = M0.list_ref(results4385,num_extra4388);if (M0.list_p(new_args4389)!==false) {var if_res2652 = M0.__eq_(M0.length(new_args4389),M0.length(args4383));} else {var if_res2652 = false;}if (if_res2652!==false) {var if_res2656 = M0.rvoid();} else {var temp2655 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp2654 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len4386,alen4387)!==false) {var if_res2653 = $rjs_core.UString.make("");} else {var if_res2653 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res2656 = M0.raise_arguments_error(temp2655,M0.format(temp2654,if_res2653),$rjs_core.UString.make("first result"),new_args4389,$rjs_core.UString.make("wrapper procedure"),wrap_proc4357);}if_res2656;M0.for_each(function(kw4390, new_arg4391, arg4392) {if (arguments.length!==3) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p4352!==false) {var if_res2658 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg4391,arg4392)!==false) {var if_res2657 = M0.rvoid();} else {var if_res2657 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw4390),$rjs_core.UString.make("result"),new_arg4391,$rjs_core.UString.make("wrapper procedure"),wrap_proc4357);}var if_res2658 = if_res2657;}return if_res2658;},kws4382,new_args4389,args4383);var tmp4393 = num_extra4388;if (M0.equal_p(tmp4393,0)!==false) {var if_res2661 = M0.apply(M0.values,kws4382,results4385);} else {if (M0.equal_p(tmp4393,1)!==false) {var if_res2660 = M0.apply(M0.values,M0.car(results4385),kws4382,M0.cdr(results4385));} else {var loop4394 = function(results4395, c4396) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(c4396)!==false) {var if_res2659 = M0.cons(kws4382,results4395);} else {var if_res2659 = M0.cons(M0.car(results4395),loop4394(M0.cdr(results4395),M0.sub1(c4396)));}return if_res2659;};var if_res2660 = M0.apply(M0.values,loop4394(results4385,num_extra4388));}var if_res2661 = if_res2660;}return if_res2661;}));});var cl2645 = $rjs_core.attachProcedureArity(function(...other43972662) {var other4397 = $rjs_core.Pair.listFromArray(other43972662);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res2663 = $rjs_core.attachProcedureArity(function() {var fixed_lam2646 = {}[arguments.length];if (fixed_lam2646!==undefined) {return fixed_lam2646.apply(null,arguments);} else {if (M0.__gt__eq_(cl2644.length,1)!==false) {var if_res2648 = cl2644.apply(null,arguments);} else {if (true!==false) {var if_res2647 = cl2645.apply(null,arguments);} else {var if_res2647 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res2648 = if_res2647;}return if_res2648;}},[M0.make_arity_at_least(0)]);}var kw_chaperone4363 = if_res2663;var wrap4400 = function(proc4401, n_proc4402) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.not(M0.eq_p(n_proc4402,proc4401))!==false) {var if_res2664 = new_procedure_p(proc4401);} else {var if_res2664 = false;}if (if_res2664!==false) {var v4403 = new_procedure_ref(proc4401);if (M0.exact_integer_p(v4403)!==false) {var acc4404 = procedure_accessor_ref(proc4401);var if_res2680 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc4401,acc4404,function(self4405, sub_proc4406) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var let_result2665 = wrap4400(sub_proc4406,normalize_proc(sub_proc4406));var f4407 = let_result2665.getAt(0);var acc4408 = let_result2665.getAt(1);return f4407;}),acc4404);} else {if (is_impersonator_p4352!==false) {var if_res2679 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res2679 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc4402)!==false) {var if_res2678 = chaperone_procedure4354(proc4401,wrap_proc4357);} else {var if_res2678 = proc4401;}var new_kw_proc4409 = if_res2679(if_res2678,new_procedure_ref,function(self4410, proc4411) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (is_impersonator_p4352!==false) {var if_res2677 = new_impersonate_procedure;} else {var if_res2677 = new_chaperone_procedure;}if (self_arg_p4353!==false) {var if_res2676 = $rjs_core.attachProcedureArity(function(proc_self4412, kws4413, kw_args4414, self4415, ...args44162666) {if (arguments.length<4) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args4416 = $rjs_core.Pair.listFromArray(args44162666);var len4417 = M0.length(args4416);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone4363,proc_self4412,kws4413,kw_args4414,args4416);},$rjs_core.attachProcedureArity(function(...results44182667) {var results4418 = $rjs_core.Pair.listFromArray(results44182667);var r_len4419 = M0.length(results4418);var list_take4420 = function(l4421, n4422) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n4422)!==false) {var if_res2668 = M0.rnull;} else {var if_res2668 = M0.cons(M0.car(l4421),list_take4420(M0.cdr(l4421),M0.sub1(n4422)));}return if_res2668;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res2669 = M0.__eq_(r_len4419,2+len4417);} else {var if_res2669 = false;}if (if_res2669!==false) {var if_res2670 = M0.apply(M0.values,M0.cadr(results4418),self4415,M0.cddr(results4418));} else {var skip4423 = r_len4419-len4417;var if_res2670 = M0.apply(M0.values,M0.append(list_take4420(results4418,skip4423-2),M0.list(M0.list_ref(results4418,M0.sub1(skip4423)),self4415),M0.__rjs_quoted__.list_tail(results4418,skip4423)));}return if_res2670;}));});} else {var if_res2676 = $rjs_core.attachProcedureArity(function(kws4424, kw_args4425, self4426, ...args44272671) {if (arguments.length<3) {throw $rjs_core.racketContractError("arity mismatch");} else {}var args4427 = $rjs_core.Pair.listFromArray(args44272671);var len4428 = M0.length(args4427);return M0.call_with_values(function() {if (arguments.length!==0) {throw $rjs_core.racketContractError("arity mismatch");} else {}return M0.apply(kw_chaperone4363,kws4424,kw_args4425,args4427);},$rjs_core.attachProcedureArity(function(...results44292672) {var results4429 = $rjs_core.Pair.listFromArray(results44292672);var r_len4430 = M0.length(results4429);var list_take4431 = function(l4432, n4433) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.zero_p(n4433)!==false) {var if_res2673 = M0.rnull;} else {var if_res2673 = M0.cons(M0.car(l4432),list_take4431(M0.cdr(l4432),M0.sub1(n4433)));}return if_res2673;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res2674 = M0.__eq_(r_len4430,2+len4428);} else {var if_res2674 = false;}if (if_res2674!==false) {var if_res2675 = M0.apply(M0.values,M0.cadr(results4429),self4426,M0.cddr(results4429));} else {var skip4434 = r_len4430-len4428;var if_res2675 = M0.apply(M0.values,M0.append(list_take4431(results4429,skip4434-2),M0.list(M0.list_ref(results4429,M0.sub1(skip4434)),self4426),M0.__rjs_quoted__.list_tail(results4429,skip4434)));}return if_res2675;}));});}return if_res2677(proc4411,make_keyword_procedure(if_res2676));});var if_res2680 = M0.values(new_kw_proc4409,new_procedure_ref);}var if_res2685 = if_res2680;} else {if (okp_p(n_proc4402)!==false) {if (is_impersonator_p4352!==false) {if (okm_p(n_proc4402)!==false) {var if_res2681 = make_optional_keyword_method_impersonator;} else {var if_res2681 = make_optional_keyword_procedure_impersonator;}var if_res2682 = if_res2681(keyword_procedure_checker(n_proc4402),chaperone_procedure4354(keyword_procedure_proc(n_proc4402),kw_chaperone4363),keyword_procedure_required(n_proc4402),keyword_procedure_allowed(n_proc4402),chaperone_procedure4354(okp_ref(n_proc4402,0),okp_ref(n_wrap_proc4360,0)),n_proc4402);} else {var if_res2682 = M0.__rjs_quoted__.chaperone_struct(proc4401,keyword_procedure_proc,function(self4435, proc4436) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure4354(proc4436,kw_chaperone4363);},M0.make_struct_field_accessor(okp_ref,0),function(self4437, proc4438) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure4354(proc4438,okp_ref(n_wrap_proc4360,0));});}var if_res2684 = M0.values(if_res2682,keyword_procedure_proc);} else {if (is_impersonator_p4352!==false) {var name_plus_fail4439 = keyword_procedure_name_plus_fail(n_proc4402);var mk4440 = make_required(M0.car(name_plus_fail4439),M0.cdr(name_plus_fail4439),keyword_method_p(n_proc4402),true);var if_res2683 = mk4440(keyword_procedure_checker(n_proc4402),chaperone_procedure4354(keyword_procedure_proc(n_proc4402),kw_chaperone4363),keyword_procedure_required(n_proc4402),keyword_procedure_allowed(n_proc4402),n_proc4402);} else {var if_res2683 = M0.__rjs_quoted__.chaperone_struct(n_proc4402,keyword_procedure_proc,function(self4441, proc4442) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}return chaperone_procedure4354(proc4442,kw_chaperone4363);});}var if_res2684 = M0.values(if_res2683,keyword_procedure_proc);}var if_res2685 = if_res2684;}return if_res2685;};var let_result2686 = wrap4400(proc4356,n_proc4359);var new_proc4398 = let_result2686.getAt(0);var chap_accessor4399 = let_result2686.getAt(1);if (M0.null_p(props4358)!==false) {var if_res2687 = new_proc4398;} else {var if_res2687 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc4398,chap_accessor4399,false,props4358);}var if_res2688 = if_res2687;}return if_res2688;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure4443, name4444, proc4445, wrap_proc4446, props4447) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var n_proc4448 = normalize_proc(proc4445);var n_wrap_proc4449 = normalize_proc(wrap_proc4446);var or_part4450 = M0.not(keyword_procedure_p(n_proc4448));if (or_part4450!==false) {var if_res2690 = or_part4450;} else {var or_part4451 = M0.not(M0.procedure_p(wrap_proc4446));if (or_part4451!==false) {var if_res2689 = or_part4451;} else {var if_res2689 = bad_props_p(props4447);}var if_res2690 = if_res2689;}if (if_res2690!==false) {var if_res2691 = M0.apply(unsafe_chaperone_procedure4443,proc4445,wrap_proc4446,props4447);} else {chaperone_arity_match_checking(false,name4444,proc4445,wrap_proc4446,props4447);var if_res2691 = M0.apply(unsafe_chaperone_procedure4443,proc4445,wrap_proc4446,props4447);}return if_res2691;};var bad_props_p = function(props4452) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}var loop4453 = function(props4454) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.null_p(props4454)!==false) {var if_res2694 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props4454))!==false) {var props4455 = M0.cdr(props4454);var or_part4456 = M0.null_p(props4455);if (or_part4456!==false) {var if_res2692 = or_part4456;} else {var if_res2692 = loop4453(M0.cdr(props4455));}var if_res2693 = if_res2692;} else {var if_res2693 = true;}var if_res2694 = if_res2693;}return if_res2694;};return loop4453(props4452);};var chaperone_arity_match_checking = function(self_arg_p4457, name4458, proc4459, wrap_proc4460, props4461) {if (arguments.length!==5) {throw $rjs_core.racketContractError("arity mismatch");} else {}var a4462 = M0.procedure_arity(proc4459);var b4463 = M0.procedure_arity(wrap_proc4460);if (self_arg_p4457!==false) {var if_res2695 = 1;} else {var if_res2695 = 0;}var d4464 = if_res2695;var let_result2696 = procedure_keywords(proc4459);var a_req4465 = let_result2696.getAt(0);var a_allow4466 = let_result2696.getAt(1);var let_result2697 = procedure_keywords(wrap_proc4460);var b_req4467 = let_result2697.getAt(0);var b_allow4468 = let_result2697.getAt(1);var includes_p4469 = function(a4470, b4471) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.number_p(b4471)!==false) {if (M0.number_p(a4470)!==false) {var if_res2699 = M0.__eq_(b4471,a4470+d4464);} else {if (M0.arity_at_least_p(a4470)!==false) {var if_res2698 = M0.__gt__eq_(b4471,M0.arity_at_least_value(a4470)+d4464);} else {var if_res2698 = M0.ormap(function(a4472) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p4469(a4472,b4471);},a4470);}var if_res2699 = if_res2698;}var if_res2703 = if_res2699;} else {if (M0.arity_at_least_p(b4471)!==false) {if (M0.number_p(a4470)!==false) {var if_res2701 = false;} else {if (M0.arity_at_least_p(a4470)!==false) {var if_res2700 = M0.__gt__eq_(M0.arity_at_least_value(b4471),M0.arity_at_least_value(a4470)+d4464);} else {var if_res2700 = M0.ormap(function(a4473) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p4469(b4471,a4473);},a4470);}var if_res2701 = if_res2700;}var if_res2702 = if_res2701;} else {var if_res2702 = M0.andmap(function(b4474) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}return includes_p4469(a4470,b4474);},b4471);}var if_res2703 = if_res2702;}return if_res2703;};if (includes_p4469(b4463,a4462)!==false) {var if_res2704 = M0.rvoid();} else {var if_res2704 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc4459,wrap_proc4460,props4461);}if_res2704;if (subset_p(b_req4467,a_req4465)!==false) {var if_res2705 = M0.rvoid();} else {var if_res2705 = M0.raise_arguments_error(name4458,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc4460,$rjs_core.UString.make("original procedure"),proc4459);}if_res2705;var or_part4475 = M0.not(b_allow4468);if (or_part4475!==false) {var if_res2707 = or_part4475;} else {if (a_allow4466!==false) {var if_res2706 = subset_p(a_allow4466,b_allow4468);} else {var if_res2706 = false;}var if_res2707 = if_res2706;}if (if_res2707!==false) {var if_res2708 = M0.rvoid();} else {var if_res2708 = M0.raise_arguments_error(name4458,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc4460,$rjs_core.UString.make("original procedure"),proc4459);}if_res2708;return M0.rvoid();};var normalize_proc = function(proc4476) {if (arguments.length!==1) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (keyword_procedure_p(proc4476)!==false) {var if_res2716 = proc4476;} else {if (new_procedure_p(proc4476)!==false) {var let_result2709 = procedure_keywords(proc4476);var req_kws4477 = let_result2709.getAt(0);var allowed_kws4478 = let_result2709.getAt(1);if (M0.null_p(allowed_kws4478)!==false) {var if_res2714 = proc4476;} else {var if_res2714 = make_optional_keyword_procedure(function(given_kws4479, given_argc4480) {if (arguments.length!==2) {throw $rjs_core.racketContractError("arity mismatch");} else {}if (M0.procedure_arity_includes_p(proc4476,given_argc4480-2,true)!==false) {var or_part4481 = M0.not(allowed_kws4478);if (or_part4481!==false) {var if_res2711 = or_part4481;} else {var if_res2711 = subset_p(given_kws4479,allowed_kws4478);}if (if_res2711!==false) {var if_res2712 = subset_p(req_kws4477,given_kws4479);} else {var if_res2712 = false;}var if_res2713 = if_res2712;} else {var if_res2713 = false;}return if_res2713;},$rjs_core.attachProcedureArity(function(kws4482, kw_args4483, ...vals44842710) {if (arguments.length<2) {throw $rjs_core.racketContractError("arity mismatch");} else {}var vals4484 = $rjs_core.Pair.listFromArray(vals44842710);return keyword_apply(proc4476,kws4482,kw_args4483,vals4484);}),req_kws4477,allowed_kws4478,proc4476);}var if_res2715 = if_res2714;} else {var if_res2715 = proc4476;}var if_res2716 = if_res2715;}return if_res2716;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_unsafe_impersonate_procedure,new_impersonate_procedure,new_unsafe_chaperone_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };