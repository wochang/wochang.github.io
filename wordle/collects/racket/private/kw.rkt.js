import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result2424 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result2424.getAt(0);var keyword_impersonator_p = let_result2424.getAt(1);var keyword_impersonator_ref = let_result2424.getAt(2);var keyword_procedure_impersonator_of = function(v4129) {if (keyword_impersonator_p(v4129)!==false) {var if_res2425 = keyword_impersonator_ref(v4129)(v4129);} else {var if_res2425 = false;}return if_res2425;};var let_result2426 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result2426.getAt(0);var mk_kw_proc = let_result2426.getAt(1);var keyword_procedure_p = let_result2426.getAt(2);var keyword_procedure_ref = let_result2426.getAt(3);var keyword_procedure_set_bang_ = let_result2426.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result2427 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result2427.getAt(0);var make_km = let_result2427.getAt(1);var keyword_method_p = let_result2427.getAt(2);var km_ref = let_result2427.getAt(3);var km_set_bang_ = let_result2427.getAt(4);var generate_arity_string = function(proc4130) {var let_result2428 = procedure_keywords(proc4130);var req4131 = let_result2428.getAt(0);var allowed4132 = let_result2428.getAt(1);var a4133 = M0.procedure_arity(proc4130);var keywords_desc4134 = function(opt4136, req4137) {var temp2434 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req4137))!==false) {var if_res2433 = M0.format($rjs_core.UString.make("an ~aargument"),opt4136);} else {var if_res2433 = M0.format($rjs_core.UString.make("~aarguments"),opt4136);}if (M0.null_p(M0.cdr(req4137))!==false) {var if_res2432 = $rjs_core.UString.make("");} else {var if_res2432 = $rjs_core.UString.make("s");}var tmp4138 = M0.length(req4137);if (M0.equal_p(tmp4138,1)!==false) {var if_res2431 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req4137));} else {if (M0.equal_p(tmp4138,2)!==false) {var if_res2430 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req4137),M0.cadr(req4137));} else {var loop4139 = function(req4140) {if (M0.null_p(M0.cdr(req4140))!==false) {var if_res2429 = M0.format($rjs_core.UString.make(" and ~a"),M0.car(req4140));} else {var if_res2429 = M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req4140),loop4139(M0.cdr(req4140)));}return if_res2429;};var if_res2430 = loop4139(req4137);}var if_res2431 = if_res2430;}return M0.format(temp2434,if_res2433,if_res2432,if_res2431);};var method_adjust4135 = function(a4141) {var or_part4142 = okm_p(proc4130);if (or_part4142!==false) {var if_res2435 = or_part4142;} else {var if_res2435 = keyword_method_p(proc4130);}if (if_res2435!==false) {if (M0.zero_p(a4141)!==false) {var if_res2436 = 0;} else {var if_res2436 = M0.sub1(a4141);}var if_res2437 = if_res2436;} else {var if_res2437 = a4141;}return if_res2437;};if (M0.number_p(a4133)!==false) {var a4143 = method_adjust4135(a4133);var if_res2444 = M0.format($rjs_core.UString.make("~a"),a4143);} else {if (M0.arity_at_least_p(a4133)!==false) {var a4144 = method_adjust4135(M0.arity_at_least_value(a4133));var if_res2443 = M0.format($rjs_core.UString.make("at least ~a"),a4144);} else {var if_res2443 = $rjs_core.UString.make("a different number");}var if_res2444 = if_res2443;}if (M0.null_p(req4131)!==false) {var if_res2442 = $rjs_core.UString.make("");} else {var if_res2442 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc4134($rjs_core.UString.make(""),req4131));}if (allowed4132!==false) {var loop4146 = function(req4147, allowed4148) {if (M0.null_p(req4147)!==false) {var if_res2439 = allowed4148;} else {if (M0.eq_p(M0.car(req4147),M0.car(allowed4148))!==false) {var if_res2438 = loop4146(M0.cdr(req4147),M0.cdr(allowed4148));} else {var if_res2438 = M0.cons(M0.car(allowed4148),loop4146(req4147,M0.cdr(allowed4148)));}var if_res2439 = if_res2438;}return if_res2439;};var others4145 = loop4146(req4131,allowed4132);if (M0.null_p(others4145)!==false) {var if_res2440 = $rjs_core.UString.make("");} else {var if_res2440 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc4134($rjs_core.UString.make("optional "),others4145));}var if_res2441 = if_res2440;} else {var if_res2441 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res2444,if_res2442,if_res2441);};var let_result2445 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result2445.getAt(0);var make_optional_keyword_procedure = let_result2445.getAt(1);var okp_p = let_result2445.getAt(2);var okp_ref = let_result2445.getAt(3);var okp_set_bang_ = let_result2445.getAt(4);var let_result2446 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result2446.getAt(0);var make_optional_keyword_method = let_result2446.getAt(1);var okm_p = let_result2446.getAt(2);var okm_ref = let_result2446.getAt(3);var okm_set_bang_ = let_result2446.getAt(4);var let_result2447 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result2447.getAt(0);var named_keyword_procedure_p = let_result2447.getAt(1);var keyword_procedure_name_plus_fail = let_result2447.getAt(2);var let_result2449 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v4149, info_l4150) {if (M0.exact_integer_p(v4149)!==false) {var if_res2448 = M0.make_struct_field_accessor(M0.list_ref(info_l4150,3),v4149);} else {var if_res2448 = false;}return if_res2448;});var prop_procedure_accessor = let_result2449.getAt(0);var procedure_accessor_p = let_result2449.getAt(1);var procedure_accessor_ref = let_result2449.getAt(2);var let_result2450 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result2450.getAt(0);var new_procedure_p = let_result2450.getAt(1);var new_procedure_ref = let_result2450.getAt(2);var let_result2451 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4151) {return kpp_ref(v4151,0);})));var struct_keyword_procedure_impersonator = let_result2451.getAt(0);var make_kpp = let_result2451.getAt(1);var keyword_procedure_impersonator_p = let_result2451.getAt(2);var kpp_ref = let_result2451.getAt(3);var kpp_set_bang_ = let_result2451.getAt(4);var let_result2452 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4152) {return kmp_ref(v4152,0);})));var struct_keyword_method_impersonator = let_result2452.getAt(0);var make_kmp = let_result2452.getAt(1);var keyword_method_impersonator_p = let_result2452.getAt(2);var kmp_ref = let_result2452.getAt(3);var kmp_set_bang_ = let_result2452.getAt(4);var let_result2453 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4153) {return okpp_ref(v4153,0);})));var struct_okpp = let_result2453.getAt(0);var make_optional_keyword_procedure_impersonator = let_result2453.getAt(1);var okpp_p = let_result2453.getAt(2);var okpp_ref = let_result2453.getAt(3);var okpp_set_bang_ = let_result2453.getAt(4);var let_result2454 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v4154) {return okmp_ref(v4154,0);})));var struct_okmp = let_result2454.getAt(0);var make_optional_keyword_method_impersonator = let_result2454.getAt(1);var okmp_p = let_result2454.getAt(2);var okmp_ref = let_result2454.getAt(3);var okmp_set_bang_ = let_result2454.getAt(4);var let_result2455 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result2455.getAt(0);var make_kp_by_ae = let_result2455.getAt(1);var kp_by_ae_p = let_result2455.getAt(2);var kp_by_ae_ref = let_result2455.getAt(3);var kp_by_ae_set_bang_ = let_result2455.getAt(4);var let_result2456 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result2456.getAt(0);var make_km_by_ae = let_result2456.getAt(1);var km_by_ae_p = let_result2456.getAt(2);var km_by_ae_ref = let_result2456.getAt(3);var km_by_ae_set_bang_ = let_result2456.getAt(4);var let_result2457 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result2457.getAt(0);var make_kpi_by_ae = let_result2457.getAt(1);var kpi_by_ae_p = let_result2457.getAt(2);var kpi_by_ae_ref = let_result2457.getAt(3);var kpi_by_ae_set_bang_ = let_result2457.getAt(4);var let_result2458 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result2458.getAt(0);var make_kmi_by_ae = let_result2458.getAt(1);var kmi_by_ae_p = let_result2458.getAt(2);var kmi_by_ae_ref = let_result2458.getAt(3);var kmi_by_ae_set_bang_ = let_result2458.getAt(4);var make_required = function(name4155, fail_proc4156, method_p4157, impersonator_p4158) {var or_part4164 = name4155;if (or_part4164!==false) {var if_res2462 = or_part4164;} else {var if_res2462 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p4158!==false) {if (method_p4157!==false) {var if_res2459 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res2459 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res2461 = if_res2459;} else {if (method_p4157!==false) {var if_res2460 = struct_keyword_method_by_arity_error;} else {var if_res2460 = struct_keyword_procedure_by_arity_error;}var if_res2461 = if_res2460;}var let_result2463 = M0.make_struct_type(if_res2462,if_res2461,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.cons(name4155,fail_proc4156))),M0.current_inspector(),fail_proc4156);var s_4159 = let_result2463.getAt(0);var mk4160 = let_result2463.getAt(1);var __p4161 = let_result2463.getAt(2);var __ref4162 = let_result2463.getAt(3);var __set_bang_4163 = let_result2463.getAt(4);return mk4160;};var cl2464 = function(proc4165) {var proc_name4166 = M0.object_name(proc4165);var plain_proc4167 = $rjs_core.attachProcedureArity(function(...args41682467) {var args4168 = $rjs_core.Pair.listFromArray(args41682467);return M0.apply(proc4165,M0.rnull,M0.rnull,args4168);});if (M0.symbol_p(proc_name4166)!==false) {var if_res2468 = M0.__rjs_quoted__.procedure_rename(plain_proc4167,proc_name4166);} else {var if_res2468 = plain_proc4167;}return make_keyword_procedure(proc4165,if_res2468);};var cl2465 = function(proc4169, plain_proc4170) {if (M0.procedure_p(proc4169)!==false) {var if_res2469 = M0.procedure_arity_mask(proc4169);} else {var if_res2469 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res2469),proc4169,M0.rnull,false,plain_proc4170);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam2466 = {'1':cl2464,'2':cl2465}[arguments.length];if (fixed_lam2466!==undefined) {return fixed_lam2466.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc4171, kws4172, kw_vals4173, normal_args4174, ...normal_argss41752470) {var normal_argss4175 = $rjs_core.Pair.listFromArray(normal_argss41752470);var type_error4176 = function(what4177, which4178) {return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what4177,which4178,proc4171,kws4172,kw_vals4173,normal_args4174,normal_argss4175);};if (M0.procedure_p(proc4171)!==false) {var if_res2471 = M0.rvoid();} else {var if_res2471 = type_error4176($rjs_core.UString.make("procedure?"),0);}if_res2471;var loop4179 = function(ks4180) {if (M0.null_p(ks4180)!==false) {var if_res2478 = M0.rvoid();} else {var or_part4181 = M0.not(M0.pair_p(ks4180));if (or_part4181!==false) {var if_res2472 = or_part4181;} else {var if_res2472 = M0.not(M0.keyword_p(M0.car(ks4180)));}if (if_res2472!==false) {var if_res2477 = type_error4176($rjs_core.UString.make("(listof keyword?)"),1);} else {if (M0.null_p(M0.cdr(ks4180))!==false) {var if_res2476 = M0.rvoid();} else {var or_part4182 = M0.not(M0.pair_p(M0.cdr(ks4180)));if (or_part4182!==false) {var if_res2473 = or_part4182;} else {var if_res2473 = M0.not(M0.keyword_p(M0.cadr(ks4180)));}if (if_res2473!==false) {var if_res2475 = loop4179(M0.cdr(ks4180));} else {if (M0.keyword_lt__p(M0.car(ks4180),M0.cadr(ks4180))!==false) {var if_res2474 = loop4179(M0.cdr(ks4180));} else {var if_res2474 = type_error4176($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}var if_res2475 = if_res2474;}var if_res2476 = if_res2475;}var if_res2477 = if_res2476;}var if_res2478 = if_res2477;}return if_res2478;};loop4179(kws4172);if (M0.list_p(kw_vals4173)!==false) {var if_res2479 = M0.rvoid();} else {var if_res2479 = type_error4176($rjs_core.UString.make("list?"),2);}if_res2479;if (M0.__eq_(M0.length(kws4172),M0.length(kw_vals4173))!==false) {var if_res2480 = M0.rvoid();} else {var if_res2480 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws4172),$rjs_core.UString.make("value list length"),M0.length(kw_vals4173),$rjs_core.UString.make("keyword list"),kws4172,$rjs_core.UString.make("value list"),kw_vals4173);}if_res2480;var loop4184 = function(normal_argss4185, pos4186) {if (M0.null_p(M0.cdr(normal_argss4185))!==false) {var l4187 = M0.car(normal_argss4185);if (M0.list_p(l4187)!==false) {var if_res2481 = l4187;} else {var if_res2481 = type_error4176($rjs_core.UString.make("list?"),pos4186);}var if_res2482 = if_res2481;} else {var if_res2482 = M0.cons(M0.car(normal_argss4185),loop4184(M0.cdr(normal_argss4185),M0.add1(pos4186)));}return if_res2482;};var normal_args4183 = loop4184(M0.cons(normal_args4174,normal_argss4175),3);if (M0.null_p(kws4172)!==false) {var if_res2483 = M0.apply(proc4171,normal_args4183);} else {var if_res2483 = M0.apply(keyword_procedure_extract_by_method(kws4172,2+M0.length(normal_args4183),proc4171,0),kws4172,kw_vals4173,normal_args4183);}return if_res2483;});var procedure_keywords = function(p4188) {if (keyword_procedure_p(p4188)!==false) {var if_res2488 = M0.values(keyword_procedure_required(p4188),keyword_procedure_allowed(p4188));} else {if (M0.procedure_p(p4188)!==false) {if (new_procedure_p(p4188)!==false) {var v4189 = new_procedure_ref(p4188);if (M0.procedure_p(v4189)!==false) {var if_res2485 = procedure_keywords(v4189);} else {var a4190 = procedure_accessor_ref(p4188);if (a4190!==false) {var if_res2484 = procedure_keywords(a4190(p4188));} else {var if_res2484 = M0.values(M0.rnull,M0.rnull);}var if_res2485 = if_res2484;}var if_res2486 = if_res2485;} else {var if_res2486 = M0.values(M0.rnull,M0.rnull);}var if_res2487 = if_res2486;} else {var if_res2487 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.UString.make("procedure?"),p4188);}var if_res2488 = if_res2487;}return if_res2488;};var missing_kw = $rjs_core.attachProcedureArity(function(proc4191, ...args41922489) {var args4192 = $rjs_core.Pair.listFromArray(args41922489);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc4191,0),M0.rnull,M0.rnull,args4192);});var check_kw_args = function(p4193, kws4194) {var loop4195 = function(kws4196, required4197, allowed4198) {if (M0.null_p(kws4196)!==false) {if (M0.null_p(required4197)!==false) {var if_res2490 = M0.values(false,false);} else {var if_res2490 = M0.values(M0.car(required4197),false);}var if_res2499 = if_res2490;} else {if (M0.pair_p(required4197)!==false) {var if_res2491 = M0.eq_p(M0.car(required4197),M0.car(kws4196));} else {var if_res2491 = false;}if (if_res2491!==false) {var temp2494 = M0.cdr(kws4196);var temp2493 = M0.cdr(required4197);if (allowed4198!==false) {var if_res2492 = M0.cdr(allowed4198);} else {var if_res2492 = false;}var if_res2498 = loop4195(temp2494,temp2493,if_res2492);} else {if (M0.not(allowed4198)!==false) {var if_res2497 = loop4195(M0.cdr(kws4196),required4197,false);} else {if (M0.pair_p(allowed4198)!==false) {if (M0.eq_p(M0.car(allowed4198),M0.car(kws4196))!==false) {var if_res2495 = loop4195(M0.cdr(kws4196),required4197,M0.cdr(allowed4198));} else {var if_res2495 = loop4195(kws4196,required4197,M0.cdr(allowed4198));}var if_res2496 = if_res2495;} else {var if_res2496 = M0.values(false,M0.car(kws4196));}var if_res2497 = if_res2496;}var if_res2498 = if_res2497;}var if_res2499 = if_res2498;}return if_res2499;};return loop4195(kws4194,keyword_procedure_required(p4193),keyword_procedure_allowed(p4193));};var make_keyword_checker = function(req_kws4199, allowed_kws4200, arity_mask4201) {if (M0.not(allowed_kws4200)!==false) {if (M0.null_p(req_kws4199)!==false) {var if_res2502 = function(kws4202, a4203) {if (true!==false) {var if_res2500 = M0.bitwise_bit_set_p(arity_mask4201,a4203);} else {var if_res2500 = false;}return if_res2500;};} else {var if_res2502 = function(kws4204, a4205) {if (subset_p(req_kws4199,kws4204)!==false) {var if_res2501 = M0.bitwise_bit_set_p(arity_mask4201,a4205);} else {var if_res2501 = false;}return if_res2501;};}var if_res2515 = if_res2502;} else {if (M0.null_p(allowed_kws4200)!==false) {var if_res2514 = function(kws4206, a4207) {if (M0.null_p(kws4206)!==false) {var if_res2503 = M0.bitwise_bit_set_p(arity_mask4201,a4207);} else {var if_res2503 = false;}return if_res2503;};} else {if (M0.null_p(req_kws4199)!==false) {var if_res2513 = function(kws4208, a4209) {if (subset_p(kws4208,allowed_kws4200)!==false) {var if_res2504 = M0.bitwise_bit_set_p(arity_mask4201,a4209);} else {var if_res2504 = false;}return if_res2504;};} else {if (M0.list_p(req_kws4199)!==false) {if (M0.list_p(allowed_kws4200)!==false) {var if_res2505 = M0.eq_p(M0.length(req_kws4199),M0.length(allowed_kws4200));} else {var if_res2505 = false;}var if_res2506 = if_res2505;} else {var if_res2506 = false;}if (if_res2506!==false) {var if_res2512 = function(kws4210, a4211) {var loop4212 = function(kws4213, req_kws4214) {if (M0.null_p(req_kws4214)!==false) {var if_res2509 = M0.null_p(kws4213);} else {if (M0.null_p(kws4213)!==false) {var if_res2508 = false;} else {if (M0.eq_p(M0.car(kws4213),M0.car(req_kws4214))!==false) {var if_res2507 = loop4212(M0.cdr(kws4213),M0.cdr(req_kws4214));} else {var if_res2507 = false;}var if_res2508 = if_res2507;}var if_res2509 = if_res2508;}return if_res2509;};if (loop4212(kws4210,req_kws4199)!==false) {var if_res2510 = M0.bitwise_bit_set_p(arity_mask4201,a4211);} else {var if_res2510 = false;}return if_res2510;};} else {var if_res2512 = function(kws4215, a4216) {if (subsets_p(req_kws4199,kws4215,allowed_kws4200)!==false) {var if_res2511 = M0.bitwise_bit_set_p(arity_mask4201,a4216);} else {var if_res2511 = false;}return if_res2511;};}var if_res2513 = if_res2512;}var if_res2514 = if_res2513;}var if_res2515 = if_res2514;}return if_res2515;};var subset_p = function(l14217, l24218) {if (M0.null_p(l14217)!==false) {var if_res2518 = true;} else {if (M0.null_p(l24218)!==false) {var if_res2517 = false;} else {if (M0.eq_p(M0.car(l14217),M0.car(l24218))!==false) {var if_res2516 = subset_p(M0.cdr(l14217),M0.cdr(l24218));} else {var if_res2516 = subset_p(l14217,M0.cdr(l24218));}var if_res2517 = if_res2516;}var if_res2518 = if_res2517;}return if_res2518;};var subsets_p = function(l14219, l24220, l34221) {if (M0.null_p(l14219)!==false) {var if_res2523 = subset_p(l24220,l34221);} else {if (M0.null_p(l24220)!==false) {var if_res2522 = false;} else {if (M0.null_p(l34221)!==false) {var if_res2521 = false;} else {var v24222 = M0.car(l24220);if (M0.eq_p(M0.car(l14219),v24222)!==false) {var if_res2520 = subsets_p(M0.cdr(l14219),M0.cdr(l24220),M0.cdr(l34221));} else {if (M0.eq_p(v24222,M0.car(l34221))!==false) {var if_res2519 = subsets_p(l14219,M0.cdr(l24220),M0.cdr(l34221));} else {var if_res2519 = subsets_p(l14219,l24220,M0.cdr(l34221));}var if_res2520 = if_res2519;}var if_res2521 = if_res2520;}var if_res2522 = if_res2521;}var if_res2523 = if_res2522;}return if_res2523;};var keyword_procedure_extract_by_method = function(kws4223, n4224, p4225, method_n4226) {if (keyword_procedure_p(p4225)!==false) {var if_res2524 = keyword_procedure_checker(p4225)(kws4223,n4224);} else {var if_res2524 = false;}if (if_res2524!==false) {var if_res2554 = keyword_procedure_proc(p4225);} else {if (M0.not(keyword_procedure_p(p4225))!==false) {if (M0.procedure_p(p4225)!==false) {if (new_procedure_p(p4225)!==false) {var a4229 = procedure_accessor_ref(p4225);if (a4229!==false) {var if_res2525 = a4229(p4225);} else {var if_res2525 = false;}var if_res2526 = if_res2525;} else {var if_res2526 = false;}var or_part4228 = if_res2526;if (or_part4228!==false) {var if_res2529 = or_part4228;} else {var or_part4230 = M0.procedure_extract_target(p4225);if (or_part4230!==false) {var if_res2528 = or_part4230;} else {if (new_procedure_p(p4225)!==false) {var if_res2527 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res2527 = false;}var if_res2528 = if_res2527;}var if_res2529 = if_res2528;}var if_res2530 = if_res2529;} else {var if_res2530 = false;}var if_res2531 = if_res2530;} else {var if_res2531 = false;}var p24227 = if_res2531;if (p24227!==false) {if (M0.eq_p(p24227,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p34231 = keyword_procedure_extract_by_method(kws4223,M0.add1(n4224),new_procedure_ref(p4225),M0.add1(method_n4226));var if_res2533 = $rjs_core.attachProcedureArity(function(kws4232, kw_args4233, ...args42342532) {var args4234 = $rjs_core.Pair.listFromArray(args42342532);return M0.apply(p34231,kws4232,kw_args4233,M0.cons(p4225,args4234));});} else {var if_res2533 = keyword_procedure_extract_by_method(kws4223,n4224,p24227,method_n4226);}var if_res2553 = if_res2533;} else {var if_res2553 = $rjs_core.attachProcedureArity(function(kws4235, kw_args4236, ...args42372534) {var args4237 = $rjs_core.Pair.listFromArray(args42372534);if (keyword_procedure_p(p4225)!==false) {var if_res2535 = check_kw_args(p4225,kws4235);} else {var if_res2535 = M0.values(false,M0.car(kws4235));}var let_result2536 = if_res2535;var missing_kw4238 = let_result2536.getAt(0);var extra_kw4239 = let_result2536.getAt(1);var or_part4244 = keyword_method_p(p4225);if (or_part4244!==false) {var if_res2537 = or_part4244;} else {var if_res2537 = okm_p(p4225);}if (if_res2537!==false) {var if_res2538 = 1;} else {var if_res2538 = 0;}var method_n4243 = method_n4226+if_res2538;if (M0.__gt__eq_(n4224,method_n4243)!==false) {var if_res2539 = n4224-method_n4243;} else {var if_res2539 = n4224;}var n4240 = if_res2539;if (M0.null_p(args4237)!==false) {var if_res2540 = M0.null_p(kws4235);} else {var if_res2540 = false;}if (if_res2540!==false) {var if_res2541 = $rjs_core.UString.make("");} else {var if_res2541 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v4245) {return M0.format($rjs_core.UString.make("\n   ~e"),v4245);},args4237),M0.map(function(kw4246, kw_arg4247) {return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw4246,kw_arg4247);},kws4235,kw_args4236)));}var args_str4241 = if_res2541;var proc_name4242 = function(p4248) {if (named_keyword_procedure_p(p4248)!==false) {var if_res2542 = M0.car(keyword_procedure_name_plus_fail(p4248));} else {var if_res2542 = false;}var or_part4249 = if_res2542;if (or_part4249!==false) {var if_res2544 = or_part4249;} else {var or_part4250 = M0.object_name(p4248);if (or_part4250!==false) {var if_res2543 = or_part4250;} else {var if_res2543 = p4248;}var if_res2544 = if_res2543;}return if_res2544;};var or_part4251 = extra_kw4239;if (or_part4251!==false) {var if_res2551 = or_part4251;} else {var if_res2551 = missing_kw4238;}if (if_res2551!==false) {var if_res2552 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res2552 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw4239!==false) {if (keyword_procedure_p(p4225)!==false) {var if_res2546 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name4242(p4225),extra_kw4239,args_str4241);} else {if (M0.procedure_p(p4225)!==false) {var if_res2545 = M0.format(M0.string_append($rjs_core.UString.make("application: procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name4242(p4225),args_str4241);} else {var if_res2545 = M0.format(M0.string_append($rjs_core.UString.make("application: not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p4225,args_str4241);}var if_res2546 = if_res2545;}var if_res2550 = if_res2546;} else {if (missing_kw4238!==false) {var if_res2549 = M0.format(M0.string_append($rjs_core.UString.make("application: required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name4242(p4225),missing_kw4238,args_str4241);} else {var temp2548 = M0.string_append($rjs_core.UString.make("application: no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n4240-2)!==false) {var if_res2547 = $rjs_core.UString.make("");} else {var if_res2547 = $rjs_core.UString.make("s");}var if_res2549 = M0.format(temp2548,n4240-2,if_res2547,proc_name4242(p4225),args_str4241);}var if_res2550 = if_res2549;}return M0.raise(if_res2552(if_res2550,M0.current_continuation_marks()));});}var if_res2554 = if_res2553;}return if_res2554;};var keyword_procedure_extract = function(p4252, kws4253, n4254) {return keyword_procedure_extract_by_method(kws4253,n4254,p4252,0);};var cl2555 = function(proc4255, arity4256, req_kw4257, allowed_kw4258, name4259) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc4255,arity4256,false,name4259,req_kw4257,allowed_kw4258);};var cl2556 = function(proc4260, arity4261, req_kw4262, allowed_kw4263) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc4260,arity4261,false,false,req_kw4262,allowed_kw4263);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam2557 = {'5':cl2555,'4':cl2556}[arguments.length];if (fixed_lam2557!==undefined) {return fixed_lam2557.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var cl2558 = function(proc4264, mask4265, req_kw4266, allowed_kw4267, name4268) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc4264,false,mask4265,name4268,req_kw4266,allowed_kw4267);};var cl2559 = function(proc4269, mask4270, req_kw4271, allowed_kw4272) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc4269,false,mask4270,false,req_kw4271,allowed_kw4272);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam2560 = {'5':cl2558,'4':cl2559}[arguments.length];if (fixed_lam2560!==undefined) {return fixed_lam2560.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5]);var do_procedure_reduce_keyword_arity = function(who4273, proc4274, arity4275, mask4276, name4277, req_kw4278, allowed_kw4279) {if (okp_p(proc4274)!==false) {var if_res2561 = okp_ref(proc4274,0);} else {var if_res2561 = proc4274;}var p4281 = if_res2561;if (arity4275!==false) {var if_res2562 = M0.__rjs_quoted__.procedure_reduce_arity(p4281,arity4275);} else {var if_res2562 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p4281,mask4276,name4277);}var plain_proc4280 = if_res2562;var sorted_p4282 = function(kws4283) {var loop4284 = function(kws4285) {if (M0.null_p(kws4285)!==false) {var if_res2565 = true;} else {if (M0.null_p(M0.cdr(kws4285))!==false) {var if_res2564 = true;} else {if (M0.keyword_lt__p(M0.car(kws4285),M0.cadr(kws4285))!==false) {var if_res2563 = loop4284(M0.cdr(kws4285));} else {var if_res2563 = false;}var if_res2564 = if_res2563;}var if_res2565 = if_res2564;}return if_res2565;};return loop4284(kws4283);};if (M0.list_p(req_kw4278)!==false) {if (M0.andmap(M0.keyword_p,req_kw4278)!==false) {var if_res2566 = sorted_p4282(req_kw4278);} else {var if_res2566 = false;}var if_res2567 = if_res2566;} else {var if_res2567 = false;}if (if_res2567!==false) {var if_res2570 = M0.rvoid();} else {var temp2569 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part4286 = arity4275;if (or_part4286!==false) {var if_res2568 = or_part4286;} else {var if_res2568 = mask4276;}var if_res2570 = M0.raise_argument_error(who4273,temp2569,2,proc4274,if_res2568,req_kw4278,allowed_kw4279);}if_res2570;if (allowed_kw4279!==false) {if (M0.list_p(allowed_kw4279)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw4279)!==false) {var if_res2571 = sorted_p4282(allowed_kw4279);} else {var if_res2571 = false;}var if_res2572 = if_res2571;} else {var if_res2572 = false;}if (if_res2572!==false) {var if_res2575 = M0.rvoid();} else {var temp2574 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part4287 = arity4275;if (or_part4287!==false) {var if_res2573 = or_part4287;} else {var if_res2573 = mask4276;}var if_res2575 = M0.raise_argument_error(who4273,temp2574,3,proc4274,if_res2573,req_kw4278,allowed_kw4279);}if_res2575;if (subset_p(req_kw4278,allowed_kw4279)!==false) {var if_res2576 = M0.rvoid();} else {var if_res2576 = M0.raise_arguments_error(who4273,$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw4279,$rjs_core.UString.make("required keywords"),req_kw4278);}var if_res2577 = if_res2576;} else {var if_res2577 = M0.rvoid();}if_res2577;var let_result2578 = procedure_keywords(proc4274);var old_req4288 = let_result2578.getAt(0);var old_allowed4289 = let_result2578.getAt(1);if (subset_p(old_req4288,req_kw4278)!==false) {var if_res2579 = M0.rvoid();} else {var if_res2579 = M0.raise_arguments_error(who4273,$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req4288,$rjs_core.UString.make("requested required keywords"),req_kw4278);}if_res2579;if (old_allowed4289!==false) {if (subset_p(req_kw4278,old_allowed4289)!==false) {var if_res2580 = M0.rvoid();} else {var if_res2580 = M0.raise_arguments_error(who4273,$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed4289,$rjs_core.UString.make("requested required keywords"),req_kw4278);}if_res2580;var or_part4290 = M0.not(allowed_kw4279);if (or_part4290!==false) {var if_res2581 = or_part4290;} else {var if_res2581 = subset_p(allowed_kw4279,old_allowed4289);}if (if_res2581!==false) {var if_res2582 = M0.rvoid();} else {var if_res2582 = M0.raise_arguments_error(who4273,$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed4289,$rjs_core.UString.make("requested allowed keywords"),allowed_kw4279);}var if_res2583 = if_res2582;} else {var if_res2583 = M0.rvoid();}if_res2583;if (M0.null_p(allowed_kw4279)!==false) {var if_res2591 = plain_proc4280;} else {var or_part4292 = mask4276;if (or_part4292!==false) {var if_res2584 = or_part4292;} else {var if_res2584 = arity__gt_mask(arity4275);}var mask4291 = if_res2584;var new_mask4293 = M0.arithmetic_shift(mask4291,2);var kw_checker4294 = make_keyword_checker(req_kw4278,allowed_kw4279,new_mask4293);var proc4295 = normalize_proc(proc4274);var new_kw_proc4296 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc4295),new_mask4293);if (M0.null_p(req_kw4278)!==false) {if (okm_p(proc4295)!==false) {var if_res2585 = make_optional_keyword_method;} else {var if_res2585 = make_optional_keyword_procedure;}var if_res2590 = if_res2585(kw_checker4294,new_kw_proc4296,req_kw4278,allowed_kw4279,plain_proc4280);} else {if (named_keyword_procedure_p(proc4295)!==false) {var if_res2588 = M0.car(keyword_procedure_name_plus_fail(proc4295));} else {var if_res2588 = false;}var or_part4297 = if_res2588;if (or_part4297!==false) {var if_res2589 = or_part4297;} else {var if_res2589 = M0.object_name(proc4295);}var temp2587 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask4291,1));var or_part4298 = okm_p(proc4295);if (or_part4298!==false) {var if_res2586 = or_part4298;} else {var if_res2586 = keyword_method_p(proc4295);}var if_res2590 = make_required(if_res2589,temp2587,if_res2586,false)(kw_checker4294,new_kw_proc4296,req_kw4278,allowed_kw4279);}var if_res2591 = if_res2590;}return if_res2591;};var arity__gt_mask = function(a4299) {if (M0.exact_nonnegative_integer_p(a4299)!==false) {var if_res2597 = M0.arithmetic_shift(1,a4299);} else {if (M0.arity_at_least_p(a4299)!==false) {var if_res2596 = M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a4299))));} else {if (M0.list_p(a4299)!==false) {var loop4300 = function(mask4301, l4302) {if (M0.null_p(l4302)!==false) {var if_res2594 = mask4301;} else {var a4303 = M0.car(l4302);var or_part4304 = M0.exact_nonnegative_integer_p(a4303);if (or_part4304!==false) {var if_res2592 = or_part4304;} else {var if_res2592 = M0.arity_at_least_p(a4303);}if (if_res2592!==false) {var if_res2593 = loop4300(M0.bitwise_ior(mask4301,arity__gt_mask(a4303)),M0.cdr(l4302));} else {var if_res2593 = false;}var if_res2594 = if_res2593;}return if_res2594;};var if_res2595 = loop4300(0,a4299);} else {var if_res2595 = false;}var if_res2596 = if_res2595;}var if_res2597 = if_res2596;}return if_res2597;};var cl2598 = function(proc4306, arity4307, name4308) {if (M0.procedure_p(proc4306)!==false) {var let_result2601 = procedure_keywords(proc4306);var req4309 = let_result2601.getAt(0);var allows4310 = let_result2601.getAt(1);if (M0.pair_p(req4309)!==false) {var if_res2602 = M0.not(M0.null_p(arity4307));} else {var if_res2602 = false;}var if_res2603 = if_res2602;} else {var if_res2603 = false;}if (if_res2603!==false) {var if_res2605 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc4306);} else {if (okm_p(proc4306)!==false) {var if_res2604 = M0.__rjs_quoted__.procedure__gt_method(proc4306);} else {var if_res2604 = proc4306;}var if_res2605 = M0.__rjs_quoted__.procedure_reduce_arity(if_res2604,arity4307,name4308);}return if_res2605;};var cl2599 = function(proc4311, arity4312) {return new_procedure_reduce_arity(proc4311,arity4312,false);};var procedure_reduce_arity4305 = $rjs_core.attachProcedureArity(function() {var fixed_lam2600 = {'3':cl2598,'2':cl2599}[arguments.length];if (fixed_lam2600!==undefined) {return fixed_lam2600.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity = procedure_reduce_arity4305;var cl2606 = function(proc4314, mask4315, name4316) {if (M0.procedure_p(proc4314)!==false) {var let_result2609 = procedure_keywords(proc4314);var req4317 = let_result2609.getAt(0);var allows4318 = let_result2609.getAt(1);if (M0.pair_p(req4317)!==false) {var if_res2610 = M0.not(M0.eqv_p(mask4315,0));} else {var if_res2610 = false;}var if_res2611 = if_res2610;} else {var if_res2611 = false;}if (if_res2611!==false) {var if_res2613 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc4314);} else {if (okm_p(proc4314)!==false) {var if_res2612 = M0.__rjs_quoted__.procedure__gt_method(proc4314);} else {var if_res2612 = proc4314;}var if_res2613 = M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res2612,mask4315,name4316);}return if_res2613;};var cl2607 = function(proc4319, mask4320) {return new_procedure_reduce_arity_mask(proc4319,mask4320,false);};var procedure_reduce_arity4313 = $rjs_core.attachProcedureArity(function() {var fixed_lam2608 = {'3':cl2606,'2':cl2607}[arguments.length];if (fixed_lam2608!==undefined) {return fixed_lam2608.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_reduce_arity_mask = procedure_reduce_arity4313;var procedure__gt_method4321 = function(proc4322) {var proc4323 = normalize_proc(proc4322);if (keyword_procedure_p(proc4323)!==false) {if (okm_p(proc4323)!==false) {var if_res2616 = proc4323;} else {if (keyword_method_p(proc4323)!==false) {var if_res2615 = proc4323;} else {if (okp_p(proc4323)!==false) {var if_res2614 = make_optional_keyword_method(keyword_procedure_checker(proc4323),keyword_procedure_proc(proc4323),keyword_procedure_required(proc4323),keyword_procedure_allowed(proc4323),okp_ref(proc4323,0));} else {var name_plus_fail4324 = keyword_procedure_name_plus_fail(proc4323);var mk4325 = make_required(M0.car(name_plus_fail4324),M0.cdr(name_plus_fail4324),true,false);var if_res2614 = mk4325(keyword_procedure_checker(proc4323),keyword_procedure_proc(proc4323),keyword_procedure_required(proc4323),keyword_procedure_allowed(proc4323));}var if_res2615 = if_res2614;}var if_res2616 = if_res2615;}var if_res2617 = if_res2616;} else {var if_res2617 = M0.__rjs_quoted__.procedure__gt_method(proc4323);}return if_res2617;};var new_procedure__gt_method = procedure__gt_method4321;var procedure_rename4326 = function(proc4327, name4328) {if (keyword_procedure_p(proc4327)!==false) {var if_res2618 = M0.symbol_p(name4328);} else {var if_res2618 = false;}if (M0.not(if_res2618)!==false) {var if_res2621 = M0.__rjs_quoted__.procedure_rename(proc4327,name4328);} else {if (okp_p(proc4327)!==false) {if (okm_p(proc4327)!==false) {var if_res2619 = make_optional_keyword_method;} else {var if_res2619 = make_optional_keyword_procedure;}var if_res2620 = if_res2619(keyword_procedure_checker(proc4327),keyword_procedure_proc(proc4327),keyword_procedure_required(proc4327),keyword_procedure_allowed(proc4327),M0.__rjs_quoted__.procedure_rename(okp_ref(proc4327,0),name4328));} else {var name_plus_fail4329 = keyword_procedure_name_plus_fail(proc4327);var mk4330 = make_required(name4328,M0.cdr(name_plus_fail4329),keyword_method_p(proc4327),false);var if_res2620 = mk4330(keyword_procedure_checker(proc4327),keyword_procedure_proc(proc4327),keyword_procedure_required(proc4327),keyword_procedure_allowed(proc4327));}var if_res2621 = if_res2620;}return if_res2621;};var new_procedure_rename = procedure_rename4326;var chaperone_procedure4331 = $rjs_core.attachProcedureArity(function(proc4332, wrap_proc4333, ...props43342622) {var props4334 = $rjs_core.Pair.listFromArray(props43342622);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc4332,wrap_proc4333,props4334);});var new_chaperone_procedure = chaperone_procedure4331;var unsafe_chaperone_procedure4335 = $rjs_core.attachProcedureArity(function(proc4336, wrap_proc4337, ...props43382623) {var props4338 = $rjs_core.Pair.listFromArray(props43382623);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc4336,wrap_proc4337,props4338);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure4335;var impersonate_procedure4339 = $rjs_core.attachProcedureArity(function(proc4340, wrap_proc4341, ...props43422624) {var props4342 = $rjs_core.Pair.listFromArray(props43422624);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc4340,wrap_proc4341,props4342);});var new_impersonate_procedure = impersonate_procedure4339;var unsafe_impersonate_procedure4343 = $rjs_core.attachProcedureArity(function(proc4344, wrap_proc4345, ...props43462625) {var props4346 = $rjs_core.Pair.listFromArray(props43462625);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc4344,wrap_proc4345,props4346);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure4343;var chaperone_procedure_times_4347 = $rjs_core.attachProcedureArity(function(proc4348, wrap_proc4349, ...props43502626) {var props4350 = $rjs_core.Pair.listFromArray(props43502626);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc4348,wrap_proc4349,props4350);});var new_chaperone_procedure_times_ = chaperone_procedure_times_4347;var impersonate_procedure_times_4351 = $rjs_core.attachProcedureArity(function(proc4352, wrap_proc4353, ...props43542627) {var props4354 = $rjs_core.Pair.listFromArray(props43542627);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc4352,wrap_proc4353,props4354);});var new_impersonate_procedure_times_ = impersonate_procedure_times_4351;var do_chaperone_procedure = function(is_impersonator_p4355, self_arg_p4356, chaperone_procedure4357, name4358, proc4359, wrap_proc4360, props4361) {var n_proc4362 = normalize_proc(proc4359);var n_wrap_proc4363 = normalize_proc(wrap_proc4360);var or_part4364 = M0.not(keyword_procedure_p(n_proc4362));if (or_part4364!==false) {var if_res2629 = or_part4364;} else {var or_part4365 = M0.not(M0.procedure_p(wrap_proc4360));if (or_part4365!==false) {var if_res2628 = or_part4365;} else {var if_res2628 = bad_props_p(props4361);}var if_res2629 = if_res2628;}if (if_res2629!==false) {var if_res2693 = M0.apply(chaperone_procedure4357,proc4359,wrap_proc4360,props4361);} else {chaperone_arity_match_checking(self_arg_p4356,name4358,proc4359,wrap_proc4360,props4361);var p4367 = keyword_procedure_proc(n_wrap_proc4363);if (self_arg_p4356!==false) {var cl2630 = $rjs_core.attachProcedureArity(function(self_proc4368, kws4369, args4370, ...rest43712635) {var rest4371 = $rjs_core.Pair.listFromArray(rest43712635);return M0.call_with_values(function() {return M0.apply(p4367,kws4369,args4370,self_proc4368,rest4371);},$rjs_core.attachProcedureArity(function(...results43722636) {var results4372 = $rjs_core.Pair.listFromArray(results43722636);var len4373 = M0.length(results4372);var alen4374 = M0.length(rest4371);if (M0.__lt_(len4373,alen4374+1)!==false) {var if_res2637 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen4374+1,$rjs_core.UString.make("received number of results"),len4373,$rjs_core.UString.make("wrapper procedure"),wrap_proc4360);} else {var if_res2637 = M0.rvoid();}if_res2637;var num_extra4375 = len4373-(alen4374+1);var new_args4376 = M0.list_ref(results4372,num_extra4375);if (M0.list_p(new_args4376)!==false) {var if_res2638 = M0.__eq_(M0.length(new_args4376),M0.length(args4370));} else {var if_res2638 = false;}if (if_res2638!==false) {var if_res2642 = M0.rvoid();} else {var temp2641 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp2640 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len4373,alen4374)!==false) {var if_res2639 = $rjs_core.UString.make("");} else {var if_res2639 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res2642 = M0.raise_arguments_error(temp2641,M0.format(temp2640,if_res2639),$rjs_core.UString.make("first result"),new_args4376,$rjs_core.UString.make("wrapper procedure"),wrap_proc4360);}if_res2642;M0.for_each(function(kw4377, new_arg4378, arg4379) {if (is_impersonator_p4355!==false) {var if_res2644 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg4378,arg4379)!==false) {var if_res2643 = M0.rvoid();} else {var if_res2643 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw4377),$rjs_core.UString.make("result"),new_arg4378,$rjs_core.UString.make("wrapper procedure"),wrap_proc4360);}var if_res2644 = if_res2643;}return if_res2644;},kws4369,new_args4376,args4370);var tmp4380 = num_extra4375;if (M0.equal_p(tmp4380,0)!==false) {var if_res2647 = M0.apply(M0.values,kws4369,results4372);} else {if (M0.equal_p(tmp4380,1)!==false) {var if_res2646 = M0.apply(M0.values,M0.car(results4372),kws4369,M0.cdr(results4372));} else {var loop4381 = function(results4382, c4383) {if (M0.zero_p(c4383)!==false) {var if_res2645 = M0.cons(kws4369,results4382);} else {var if_res2645 = M0.cons(M0.car(results4382),loop4381(M0.cdr(results4382),M0.sub1(c4383)));}return if_res2645;};var if_res2646 = M0.apply(M0.values,loop4381(results4372,num_extra4375));}var if_res2647 = if_res2646;}return if_res2647;}));});var cl2631 = $rjs_core.attachProcedureArity(function(...other43842648) {var other4384 = $rjs_core.Pair.listFromArray(other43842648);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res2668 = $rjs_core.attachProcedureArity(function() {var fixed_lam2632 = {}[arguments.length];if (fixed_lam2632!==undefined) {return fixed_lam2632.apply(null,arguments);} else {if (M0.__gt__eq_(cl2630.length,1)!==false) {var if_res2634 = cl2630.apply(null,arguments);} else {if (true!==false) {var if_res2633 = cl2631.apply(null,arguments);} else {var if_res2633 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res2634 = if_res2633;}return if_res2634;}},[M0.make_arity_at_least(0)]);} else {var cl2649 = $rjs_core.attachProcedureArity(function(kws4385, args4386, ...rest43872654) {var rest4387 = $rjs_core.Pair.listFromArray(rest43872654);return M0.call_with_values(function() {return M0.apply(p4367,kws4385,args4386,rest4387);},$rjs_core.attachProcedureArity(function(...results43882655) {var results4388 = $rjs_core.Pair.listFromArray(results43882655);var len4389 = M0.length(results4388);var alen4390 = M0.length(rest4387);if (M0.__lt_(len4389,alen4390+1)!==false) {var if_res2656 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen4390+1,$rjs_core.UString.make("received number of results"),len4389,$rjs_core.UString.make("wrapper procedure"),wrap_proc4360);} else {var if_res2656 = M0.rvoid();}if_res2656;var num_extra4391 = len4389-(alen4390+1);var new_args4392 = M0.list_ref(results4388,num_extra4391);if (M0.list_p(new_args4392)!==false) {var if_res2657 = M0.__eq_(M0.length(new_args4392),M0.length(args4386));} else {var if_res2657 = false;}if (if_res2657!==false) {var if_res2661 = M0.rvoid();} else {var temp2660 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp2659 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len4389,alen4390)!==false) {var if_res2658 = $rjs_core.UString.make("");} else {var if_res2658 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res2661 = M0.raise_arguments_error(temp2660,M0.format(temp2659,if_res2658),$rjs_core.UString.make("first result"),new_args4392,$rjs_core.UString.make("wrapper procedure"),wrap_proc4360);}if_res2661;M0.for_each(function(kw4393, new_arg4394, arg4395) {if (is_impersonator_p4355!==false) {var if_res2663 = M0.rvoid();} else {if (M0.__rjs_quoted__.chaperone_of_p(new_arg4394,arg4395)!==false) {var if_res2662 = M0.rvoid();} else {var if_res2662 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw4393),$rjs_core.UString.make("result"),new_arg4394,$rjs_core.UString.make("wrapper procedure"),wrap_proc4360);}var if_res2663 = if_res2662;}return if_res2663;},kws4385,new_args4392,args4386);var tmp4396 = num_extra4391;if (M0.equal_p(tmp4396,0)!==false) {var if_res2666 = M0.apply(M0.values,kws4385,results4388);} else {if (M0.equal_p(tmp4396,1)!==false) {var if_res2665 = M0.apply(M0.values,M0.car(results4388),kws4385,M0.cdr(results4388));} else {var loop4397 = function(results4398, c4399) {if (M0.zero_p(c4399)!==false) {var if_res2664 = M0.cons(kws4385,results4398);} else {var if_res2664 = M0.cons(M0.car(results4398),loop4397(M0.cdr(results4398),M0.sub1(c4399)));}return if_res2664;};var if_res2665 = M0.apply(M0.values,loop4397(results4388,num_extra4391));}var if_res2666 = if_res2665;}return if_res2666;}));});var cl2650 = $rjs_core.attachProcedureArity(function(...other44002667) {var other4400 = $rjs_core.Pair.listFromArray(other44002667);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res2668 = $rjs_core.attachProcedureArity(function() {var fixed_lam2651 = {}[arguments.length];if (fixed_lam2651!==undefined) {return fixed_lam2651.apply(null,arguments);} else {if (M0.__gt__eq_(cl2649.length,1)!==false) {var if_res2653 = cl2649.apply(null,arguments);} else {if (true!==false) {var if_res2652 = cl2650.apply(null,arguments);} else {var if_res2652 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}var if_res2653 = if_res2652;}return if_res2653;}},[M0.make_arity_at_least(0)]);}var kw_chaperone4366 = if_res2668;var wrap4403 = function(proc4404, n_proc4405) {if (M0.not(M0.eq_p(n_proc4405,proc4404))!==false) {var if_res2669 = new_procedure_p(proc4404);} else {var if_res2669 = false;}if (if_res2669!==false) {var v4406 = new_procedure_ref(proc4404);if (M0.exact_integer_p(v4406)!==false) {var acc4407 = procedure_accessor_ref(proc4404);var if_res2685 = M0.values(M0.__rjs_quoted__.chaperone_struct(proc4404,acc4407,function(self4408, sub_proc4409) {var let_result2670 = wrap4403(sub_proc4409,normalize_proc(sub_proc4409));var f4410 = let_result2670.getAt(0);var acc4411 = let_result2670.getAt(1);return f4410;}),acc4407);} else {if (is_impersonator_p4355!==false) {var if_res2684 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res2684 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc4405)!==false) {var if_res2683 = chaperone_procedure4357(proc4404,wrap_proc4360);} else {var if_res2683 = proc4404;}var new_kw_proc4412 = if_res2684(if_res2683,new_procedure_ref,function(self4413, proc4414) {if (is_impersonator_p4355!==false) {var if_res2682 = new_impersonate_procedure;} else {var if_res2682 = new_chaperone_procedure;}if (self_arg_p4356!==false) {var if_res2681 = $rjs_core.attachProcedureArity(function(proc_self4415, kws4416, kw_args4417, self4418, ...args44192671) {var args4419 = $rjs_core.Pair.listFromArray(args44192671);var len4420 = M0.length(args4419);return M0.call_with_values(function() {return M0.apply(kw_chaperone4366,proc_self4415,kws4416,kw_args4417,args4419);},$rjs_core.attachProcedureArity(function(...results44212672) {var results4421 = $rjs_core.Pair.listFromArray(results44212672);var r_len4422 = M0.length(results4421);var list_take4423 = function(l4424, n4425) {if (M0.zero_p(n4425)!==false) {var if_res2673 = M0.rnull;} else {var if_res2673 = M0.cons(M0.car(l4424),list_take4423(M0.cdr(l4424),M0.sub1(n4425)));}return if_res2673;};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res2674 = M0.__eq_(r_len4422,2+len4420);} else {var if_res2674 = false;}if (if_res2674!==false) {var if_res2675 = M0.apply(M0.values,M0.cadr(results4421),self4418,M0.cddr(results4421));} else {var skip4426 = r_len4422-len4420;var if_res2675 = M0.apply(M0.values,M0.append(list_take4423(results4421,skip4426-2),M0.list(M0.list_ref(results4421,M0.sub1(skip4426)),self4418),M0.__rjs_quoted__.list_tail(results4421,skip4426)));}return if_res2675;}));});} else {var if_res2681 = $rjs_core.attachProcedureArity(function(kws4427, kw_args4428, self4429, ...args44302676) {var args4430 = $rjs_core.Pair.listFromArray(args44302676);var len4431 = M0.length(args4430);return M0.call_with_values(function() {return M0.apply(kw_chaperone4366,kws4427,kw_args4428,args4430);},$rjs_core.attachProcedureArity(function(...results44322677) {var results4432 = $rjs_core.Pair.listFromArray(results44322677);var r_len4433 = M0.length(results4432);var list_take4434 = function(l4435, n4436) {if (M0.zero_p(n4436)!==false) {var if_res2678 = M0.rnull;} else {var if_res2678 = M0.cons(M0.car(l4435),list_take4434(M0.cdr(l4435),M0.sub1(n4436)));}return if_res2678;};if (M0.null_p($rjs_core.Pair.makeList())!==false) {var if_res2679 = M0.__eq_(r_len4433,2+len4431);} else {var if_res2679 = false;}if (if_res2679!==false) {var if_res2680 = M0.apply(M0.values,M0.cadr(results4432),self4429,M0.cddr(results4432));} else {var skip4437 = r_len4433-len4431;var if_res2680 = M0.apply(M0.values,M0.append(list_take4434(results4432,skip4437-2),M0.list(M0.list_ref(results4432,M0.sub1(skip4437)),self4429),M0.__rjs_quoted__.list_tail(results4432,skip4437)));}return if_res2680;}));});}return if_res2682(proc4414,make_keyword_procedure(if_res2681));});var if_res2685 = M0.values(new_kw_proc4412,new_procedure_ref);}var if_res2690 = if_res2685;} else {if (okp_p(n_proc4405)!==false) {if (is_impersonator_p4355!==false) {if (okm_p(n_proc4405)!==false) {var if_res2686 = make_optional_keyword_method_impersonator;} else {var if_res2686 = make_optional_keyword_procedure_impersonator;}var if_res2687 = if_res2686(keyword_procedure_checker(n_proc4405),chaperone_procedure4357(keyword_procedure_proc(n_proc4405),kw_chaperone4366),keyword_procedure_required(n_proc4405),keyword_procedure_allowed(n_proc4405),chaperone_procedure4357(okp_ref(n_proc4405,0),okp_ref(n_wrap_proc4363,0)),n_proc4405);} else {var if_res2687 = M0.__rjs_quoted__.chaperone_struct(proc4404,keyword_procedure_proc,function(self4438, proc4439) {return chaperone_procedure4357(proc4439,kw_chaperone4366);},M0.make_struct_field_accessor(okp_ref,0),function(self4440, proc4441) {return chaperone_procedure4357(proc4441,okp_ref(n_wrap_proc4363,0));});}var if_res2689 = M0.values(if_res2687,keyword_procedure_proc);} else {if (is_impersonator_p4355!==false) {var name_plus_fail4442 = keyword_procedure_name_plus_fail(n_proc4405);var mk4443 = make_required(M0.car(name_plus_fail4442),M0.cdr(name_plus_fail4442),keyword_method_p(n_proc4405),true);var if_res2688 = mk4443(keyword_procedure_checker(n_proc4405),chaperone_procedure4357(keyword_procedure_proc(n_proc4405),kw_chaperone4366),keyword_procedure_required(n_proc4405),keyword_procedure_allowed(n_proc4405),n_proc4405);} else {var if_res2688 = M0.__rjs_quoted__.chaperone_struct(n_proc4405,keyword_procedure_proc,function(self4444, proc4445) {return chaperone_procedure4357(proc4445,kw_chaperone4366);});}var if_res2689 = M0.values(if_res2688,keyword_procedure_proc);}var if_res2690 = if_res2689;}return if_res2690;};var let_result2691 = wrap4403(proc4359,n_proc4362);var new_proc4401 = let_result2691.getAt(0);var chap_accessor4402 = let_result2691.getAt(1);if (M0.null_p(props4361)!==false) {var if_res2692 = new_proc4401;} else {var if_res2692 = M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc4401,chap_accessor4402,false,props4361);}var if_res2693 = if_res2692;}return if_res2693;};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure4446, name4447, proc4448, wrap_proc4449, props4450) {var n_proc4451 = normalize_proc(proc4448);var n_wrap_proc4452 = normalize_proc(wrap_proc4449);var or_part4453 = M0.not(keyword_procedure_p(n_proc4451));if (or_part4453!==false) {var if_res2695 = or_part4453;} else {var or_part4454 = M0.not(M0.procedure_p(wrap_proc4449));if (or_part4454!==false) {var if_res2694 = or_part4454;} else {var if_res2694 = bad_props_p(props4450);}var if_res2695 = if_res2694;}if (if_res2695!==false) {var if_res2696 = M0.apply(unsafe_chaperone_procedure4446,proc4448,wrap_proc4449,props4450);} else {chaperone_arity_match_checking(false,name4447,proc4448,wrap_proc4449,props4450);var if_res2696 = M0.apply(unsafe_chaperone_procedure4446,proc4448,wrap_proc4449,props4450);}return if_res2696;};var bad_props_p = function(props4455) {var loop4456 = function(props4457) {if (M0.null_p(props4457)!==false) {var if_res2699 = false;} else {if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props4457))!==false) {var props4458 = M0.cdr(props4457);var or_part4459 = M0.null_p(props4458);if (or_part4459!==false) {var if_res2697 = or_part4459;} else {var if_res2697 = loop4456(M0.cdr(props4458));}var if_res2698 = if_res2697;} else {var if_res2698 = true;}var if_res2699 = if_res2698;}return if_res2699;};return loop4456(props4455);};var chaperone_arity_match_checking = function(self_arg_p4460, name4461, proc4462, wrap_proc4463, props4464) {var a4465 = M0.procedure_arity(proc4462);var b4466 = M0.procedure_arity(wrap_proc4463);if (self_arg_p4460!==false) {var if_res2700 = 1;} else {var if_res2700 = 0;}var d4467 = if_res2700;var let_result2701 = procedure_keywords(proc4462);var a_req4468 = let_result2701.getAt(0);var a_allow4469 = let_result2701.getAt(1);var let_result2702 = procedure_keywords(wrap_proc4463);var b_req4470 = let_result2702.getAt(0);var b_allow4471 = let_result2702.getAt(1);var includes_p4472 = function(a4473, b4474) {if (M0.number_p(b4474)!==false) {if (M0.number_p(a4473)!==false) {var if_res2704 = M0.__eq_(b4474,a4473+d4467);} else {if (M0.arity_at_least_p(a4473)!==false) {var if_res2703 = M0.__gt__eq_(b4474,M0.arity_at_least_value(a4473)+d4467);} else {var if_res2703 = M0.ormap(function(a4475) {return includes_p4472(a4475,b4474);},a4473);}var if_res2704 = if_res2703;}var if_res2708 = if_res2704;} else {if (M0.arity_at_least_p(b4474)!==false) {if (M0.number_p(a4473)!==false) {var if_res2706 = false;} else {if (M0.arity_at_least_p(a4473)!==false) {var if_res2705 = M0.__gt__eq_(M0.arity_at_least_value(b4474),M0.arity_at_least_value(a4473)+d4467);} else {var if_res2705 = M0.ormap(function(a4476) {return includes_p4472(b4474,a4476);},a4473);}var if_res2706 = if_res2705;}var if_res2707 = if_res2706;} else {var if_res2707 = M0.andmap(function(b4477) {return includes_p4472(a4473,b4477);},b4474);}var if_res2708 = if_res2707;}return if_res2708;};if (includes_p4472(b4466,a4465)!==false) {var if_res2709 = M0.rvoid();} else {var if_res2709 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc4462,wrap_proc4463,props4464);}if_res2709;if (subset_p(b_req4470,a_req4468)!==false) {var if_res2710 = M0.rvoid();} else {var if_res2710 = M0.raise_arguments_error(name4461,$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc4463,$rjs_core.UString.make("original procedure"),proc4462);}if_res2710;var or_part4478 = M0.not(b_allow4471);if (or_part4478!==false) {var if_res2712 = or_part4478;} else {if (a_allow4469!==false) {var if_res2711 = subset_p(a_allow4469,b_allow4471);} else {var if_res2711 = false;}var if_res2712 = if_res2711;}if (if_res2712!==false) {var if_res2713 = M0.rvoid();} else {var if_res2713 = M0.raise_arguments_error(name4461,$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc4463,$rjs_core.UString.make("original procedure"),proc4462);}if_res2713;return M0.rvoid();};var normalize_proc = function(proc4479) {if (keyword_procedure_p(proc4479)!==false) {var if_res2721 = proc4479;} else {if (new_procedure_p(proc4479)!==false) {var let_result2714 = procedure_keywords(proc4479);var req_kws4480 = let_result2714.getAt(0);var allowed_kws4481 = let_result2714.getAt(1);if (M0.null_p(allowed_kws4481)!==false) {var if_res2719 = proc4479;} else {var if_res2719 = make_optional_keyword_procedure(function(given_kws4482, given_argc4483) {if (M0.procedure_arity_includes_p(proc4479,given_argc4483-2,true)!==false) {var or_part4484 = M0.not(allowed_kws4481);if (or_part4484!==false) {var if_res2716 = or_part4484;} else {var if_res2716 = subset_p(given_kws4482,allowed_kws4481);}if (if_res2716!==false) {var if_res2717 = subset_p(req_kws4480,given_kws4482);} else {var if_res2717 = false;}var if_res2718 = if_res2717;} else {var if_res2718 = false;}return if_res2718;},$rjs_core.attachProcedureArity(function(kws4485, kw_args4486, ...vals44872715) {var vals4487 = $rjs_core.Pair.listFromArray(vals44872715);return keyword_apply(proc4479,kws4485,kw_args4486,vals4487);}),req_kws4480,allowed_kws4481,proc4479);}var if_res2720 = if_res2719;} else {var if_res2720 = proc4479;}var if_res2721 = if_res2720;}return if_res2721;};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_unsafe_impersonate_procedure,new_impersonate_procedure,new_unsafe_chaperone_procedure,new_chaperone_procedure,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };