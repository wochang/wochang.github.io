import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "./map.rkt.js";import * as M2 from "./kw.rkt.js";import * as M3 from "./qq-and-or.rkt.js";import * as M4 from "./reverse.rkt.js";import * as M5 from "./for.rkt.js";import * as M6 from "../../../runtime/read.rkt.js";import * as M7 from "../../../runtime/unsafe.rkt.js";var real__gt_decimal_string5105 = function(n25106, digits15107) {var n5108 = n25106;if (false!==false) {var if_res3173 = 2;} else {var if_res3173 = digits15107;}var digits5109 = if_res3173;if (M0.rational_p(n5108)!==false) {var if_res3174 = M0.rvoid();} else {var if_res3174 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("real->decimal-string"),$rjs_core.UString.make("rational?"),n5108);}if_res3174;if (M0.exact_nonnegative_integer_p(digits5109)!==false) {var if_res3175 = M0.rvoid();} else {var if_res3175 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("real->decimal-string"),$rjs_core.UString.make("exact-nonnegative-integer?"),digits5109);}if_res3175;var e5110 = M0.expt(10,digits5109);var num5111 = M0.round(M0.abs(e5110*M0.inexact__gt_exact(n5108)));var temp3181 = $rjs_core.UString.make("~a~a.~a");var or_part5112 = M0.negative_p(n5108);if (or_part5112!==false) {var if_res3179 = or_part5112;} else {var if_res3179 = M0.equal_p(n5108,-0.0);}if (if_res3179!==false) {var if_res3180 = $rjs_core.UString.make("-");} else {var if_res3180 = $rjs_core.UString.make("");}var temp3178 = M0.quotient(num5111,e5110);if (M0.zero_p(digits5109)!==false) {var if_res3177 = $rjs_core.UString.make("");} else {var s5113 = M0.number__gt_string(M0.remainder(num5111,e5110));if (M0.__eq_(M0.string_length(s5113),digits5109)!==false) {var if_res3176 = s5113;} else {var if_res3176 = M0.string_append(M0.make_string(digits5109-M0.string_length(s5113),$rjs_core.Char.charFromCodepoint(48)),s5113);}var if_res3177 = if_res3176;}return M0.format(temp3181,if_res3180,temp3178,if_res3177);};var cl3182 = function(n5114) {return real__gt_decimal_string5105(n5114,2);};var cl3183 = function(n5115, digits15116) {return real__gt_decimal_string5105(n5115,digits15116);};var real__gt_decimal_string = $rjs_core.attachProcedureArity(function() {var fixed_lam3184 = {'1':cl3182,'2':cl3183}[arguments.length];if (fixed_lam3184!==undefined) {return fixed_lam3184.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var regexp_quote_chars_s = $rjs_core.Regexp.fromString("[][.*?+|(){}\\$^]");var regexp_quote_chars_b = $rjs_core.Regexp.fromString("[][.*?+|(){}\\$^]");var regexp_quote5117 = function(s45118, case_sens_p35119) {var s5120 = s45118;if (false!==false) {var if_res3185 = true;} else {var if_res3185 = case_sens_p35119;}var case_sens_p5121 = if_res3185;if (M0.bytes_p(s5120)!==false) {var if_res3187 = true;} else {if (M0.string_p(s5120)!==false) {var if_res3186 = false;} else {var if_res3186 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-quote"),$rjs_core.UString.make("(or/c string? bytes?)"),s5120);}var if_res3187 = if_res3186;}var b_p5122 = if_res3187;if (b_p5122!==false) {var if_res3188 = M0.regexp_replace_times_(regexp_quote_chars_b,s5120,$rjs_core.Bytes.fromIntArray([92,92,38]));} else {var if_res3188 = M0.regexp_replace_times_(regexp_quote_chars_s,s5120,$rjs_core.UString.make("\\\\&"));}var s5123 = if_res3188;if (case_sens_p5121!==false) {var if_res3190 = s5123;} else {if (b_p5122!==false) {var if_res3189 = M0.bytes_append($rjs_core.Bytes.fromIntArray([40,63,105,58]),s5123,$rjs_core.Bytes.fromIntArray([41]));} else {var if_res3189 = M0.string_append($rjs_core.UString.make("(?i:"),s5123,$rjs_core.UString.make(")"));}var if_res3190 = if_res3189;}return if_res3190;};var cl3191 = function(s5124) {return regexp_quote5117(s5124,true);};var cl3192 = function(s5125, case_sens_p35126) {return regexp_quote5117(s5125,case_sens_p35126);};var regexp_quote = $rjs_core.attachProcedureArity(function() {var fixed_lam3193 = {'1':cl3191,'2':cl3192}[arguments.length];if (fixed_lam3193!==undefined) {return fixed_lam3193.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var regexp_replace_quote = function(s5127) {if (M0.bytes_p(s5127)!==false) {var if_res3195 = M0.regexp_replace_times_($rjs_core.Regexp.fromString("[&\\]"),s5127,$rjs_core.Bytes.fromIntArray([92,92,38]));} else {if (M0.string_p(s5127)!==false) {var if_res3194 = M0.regexp_replace_times_($rjs_core.Regexp.fromString("[&\\]"),s5127,$rjs_core.UString.make("\\\\&"));} else {var if_res3194 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace-quote"),$rjs_core.UString.make("(or/c string? bytes?)"),s5127);}var if_res3195 = if_res3194;}return if_res3195;};var no_empty_edge_table = M0.make_hash();var no_empty_edge_matches = function(rx5128, n5129) {var tweaker5130 = function(rx5131, n5132) {if (M0.bytes_p(rx5131)!==false) {var if_res3196 = M0.bytes_append($rjs_core.Bytes.fromIntArray([40,63,58]),rx5131,$rjs_core.Bytes.fromIntArray([41,40,63,60,61]),M0.make_bytes(n5132,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46))),$rjs_core.Bytes.fromIntArray([41]));} else {var if_res3196 = M0.format($rjs_core.UString.make("(?:~a)(?<=~a)"),rx5131,M0.make_bytes(n5132,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46))));}return if_res3196;};var run_tweak5133 = function() {if (M0.pregexp_p(rx5128)!==false) {var tweaked5134 = tweaker5130(M0.object_name(rx5128),n5129);var or_part5135 = M0.regexp_p(tweaked5134);if (or_part5135!==false) {var if_res3197 = or_part5135;} else {var if_res3197 = M0.byte_regexp_p(tweaked5134);}if (if_res3197!==false) {var if_res3199 = tweaked5134;} else {if (M0.bytes_p(tweaked5134)!==false) {var if_res3198 = M0.bytes__gt_string_by_utf_8(tweaked5134);} else {var if_res3198 = tweaked5134;}var if_res3199 = M0.pregexp(if_res3198);}var if_res3220 = if_res3199;} else {if (M0.regexp_p(rx5128)!==false) {var tweaked5136 = tweaker5130(M0.object_name(rx5128),n5129);var or_part5137 = M0.regexp_p(tweaked5136);if (or_part5137!==false) {var if_res3200 = or_part5137;} else {var if_res3200 = M0.byte_regexp_p(tweaked5136);}if (if_res3200!==false) {var if_res3202 = tweaked5136;} else {if (M0.bytes_p(tweaked5136)!==false) {var if_res3201 = M0.bytes__gt_string_by_utf_8(tweaked5136);} else {var if_res3201 = tweaked5136;}var if_res3202 = M0.regexp(if_res3201);}var if_res3219 = if_res3202;} else {if (M0.byte_pregexp_p(rx5128)!==false) {var tweaked5138 = tweaker5130(M0.object_name(rx5128),n5129);var or_part5139 = M0.regexp_p(tweaked5138);if (or_part5139!==false) {var if_res3203 = or_part5139;} else {var if_res3203 = M0.byte_regexp_p(tweaked5138);}if (if_res3203!==false) {var if_res3205 = tweaked5138;} else {if (M0.bytes_p(tweaked5138)!==false) {var if_res3204 = tweaked5138;} else {var if_res3204 = M0.string__gt_bytes_by_utf_8(tweaked5138);}var if_res3205 = M0.byte_pregexp(if_res3204);}var if_res3218 = if_res3205;} else {if (M0.byte_regexp_p(rx5128)!==false) {var tweaked5140 = tweaker5130(M0.object_name(rx5128),n5129);var or_part5141 = M0.regexp_p(tweaked5140);if (or_part5141!==false) {var if_res3206 = or_part5141;} else {var if_res3206 = M0.byte_regexp_p(tweaked5140);}if (if_res3206!==false) {var if_res3208 = tweaked5140;} else {if (M0.bytes_p(tweaked5140)!==false) {var if_res3207 = tweaked5140;} else {var if_res3207 = M0.string__gt_bytes_by_utf_8(tweaked5140);}var if_res3208 = M0.byte_regexp(if_res3207);}var if_res3217 = if_res3208;} else {if (M0.string_p(rx5128)!==false) {var tweaked5142 = tweaker5130((function(x5143) {return x5143;})(rx5128),n5129);var or_part5144 = M0.regexp_p(tweaked5142);if (or_part5144!==false) {var if_res3209 = or_part5144;} else {var if_res3209 = M0.byte_regexp_p(tweaked5142);}if (if_res3209!==false) {var if_res3211 = tweaked5142;} else {if (M0.bytes_p(tweaked5142)!==false) {var if_res3210 = M0.bytes__gt_string_by_utf_8(tweaked5142);} else {var if_res3210 = tweaked5142;}var if_res3211 = M0.regexp(if_res3210);}var if_res3216 = if_res3211;} else {if (M0.bytes_p(rx5128)!==false) {var tweaked5145 = tweaker5130((function(x5146) {return x5146;})(rx5128),n5129);var or_part5147 = M0.regexp_p(tweaked5145);if (or_part5147!==false) {var if_res3212 = or_part5147;} else {var if_res3212 = M0.byte_regexp_p(tweaked5145);}if (if_res3212!==false) {var if_res3214 = tweaked5145;} else {if (M0.bytes_p(tweaked5145)!==false) {var if_res3213 = tweaked5145;} else {var if_res3213 = M0.string__gt_bytes_by_utf_8(tweaked5145);}var if_res3214 = M0.byte_regexp(if_res3213);}var if_res3215 = if_res3214;} else {var if_res3215 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-tweaker"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),rx5128);}var if_res3216 = if_res3215;}var if_res3217 = if_res3216;}var if_res3218 = if_res3217;}var if_res3219 = if_res3218;}var if_res3220 = if_res3219;}return if_res3220;};var key5148 = M0.cons(n5129,rx5128);var or_part5149 = M0.hash_ref(no_empty_edge_table,key5148,false);if (or_part5149!==false) {var if_res3221 = or_part5149;} else {var rx_times_5150 = run_tweak5133();M0.hash_set_bang_(no_empty_edge_table,key5148,rx_times_5150);var if_res3221 = rx_times_5150;}return if_res3221;};var regexp_try_match5151 = function(pattern95152, input_port105153, start_k55154, end_k65155, out75156, prefix85157) {var pattern5158 = pattern95152;var input_port5159 = input_port105153;if (false!==false) {var if_res3222 = 0;} else {var if_res3222 = start_k55154;}var start_k5160 = if_res3222;if (false!==false) {var if_res3223 = false;} else {var if_res3223 = end_k65155;}var end_k5161 = if_res3223;if (false!==false) {var if_res3224 = false;} else {var if_res3224 = out75156;}var out5162 = if_res3224;if (false!==false) {var if_res3225 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3225 = prefix85157;}var prefix5163 = if_res3225;if (M0.input_port_p(input_port5159)!==false) {var if_res3226 = M0.rvoid();} else {var if_res3226 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-try-match"),$rjs_core.UString.make("input-port?"),input_port5159);}if_res3226;var or_part5164 = M0.not(out5162);if (or_part5164!==false) {var if_res3227 = or_part5164;} else {var if_res3227 = M0.output_port_p(out5162);}if (if_res3227!==false) {var if_res3228 = M0.rvoid();} else {var if_res3228 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-try-match"),$rjs_core.UString.make("(or/c output-port? #f)"),out5162);}if_res3228;var m5165 = M0.regexp_match_peek_positions(pattern5158,input_port5159,start_k5160,end_k5161,false,prefix5163);if (m5165!==false) {var drop5166 = M0.caar(m5165);var s5167 = M0.read_bytes(drop5166,input_port5159);if (out5162!==false) {var if_res3229 = M0.write_bytes(s5167,out5162);} else {var if_res3229 = M0.rvoid();}if_res3229;var s5168 = M0.read_bytes(M0.cdar(m5165)-drop5166,input_port5159);var if_res3231 = M0.cons(s5168,M1.map(function(p5169) {if (p5169!==false) {var if_res3230 = M0.subbytes(s5168,M0.car(p5169)-drop5166,M0.cdr(p5169)-drop5166);} else {var if_res3230 = false;}return if_res3230;},M0.cdr(m5165)));} else {var if_res3231 = false;}return if_res3231;};var cl3232 = function(pattern5170, input_port5171) {return regexp_try_match5151(pattern5170,input_port5171,0,false,false,$rjs_core.Bytes.fromIntArray([]));};var cl3233 = function(pattern5172, input_port5173, start_k5174, end_k5175, out5176, prefix85177) {return regexp_try_match5151(pattern5172,input_port5173,start_k5174,end_k5175,out5176,prefix85177);};var cl3234 = function(pattern5178, input_port5179, start_k5180, end_k5181, out75182) {return regexp_try_match5151(pattern5178,input_port5179,start_k5180,end_k5181,out75182,$rjs_core.Bytes.fromIntArray([]));};var cl3235 = function(pattern5183, input_port5184, start_k5185, end_k65186) {return regexp_try_match5151(pattern5183,input_port5184,start_k5185,end_k65186,false,$rjs_core.Bytes.fromIntArray([]));};var cl3236 = function(pattern5187, input_port5188, start_k55189) {return regexp_try_match5151(pattern5187,input_port5188,start_k55189,false,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_try_match = $rjs_core.attachProcedureArity(function() {var fixed_lam3237 = {'2':cl3232,'6':cl3233,'5':cl3234,'4':cl3235,'3':cl3236}[arguments.length];if (fixed_lam3237!==undefined) {return fixed_lam3237.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5,6]);var bstring_length = function(s5190) {if (M0.bytes_p(s5190)!==false) {var if_res3238 = M0.bytes_length(s5190);} else {var if_res3238 = M0.string_length(s5190);}return if_res3238;};var regexp_match_positions_times_ = function(match_select115191, pattern165192, string175193, start135194, end145195, ipre155196) {var pattern5197 = pattern165192;var string5198 = string175193;if (false!==false) {var if_res3239 = 0;} else {var if_res3239 = start135194;}var start5199 = if_res3239;if (false!==false) {var if_res3240 = false;} else {var if_res3240 = end145195;}var end5200 = if_res3240;if (false!==false) {var if_res3241 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3241 = ipre155196;}var ipre5201 = if_res3241;if (M0.eq_p(match_select115191,M7.unsafe_undefined)!==false) {var if_res3242 = M0.car;} else {var if_res3242 = match_select115191;}var match_select5202 = if_res3242;if (M0.procedure_p(match_select5202)!==false) {var if_res3243 = M0.rvoid();} else {var if_res3243 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("procedure?"),match_select5202);}if_res3243;if (M0.eq_p(match_select5202,M0.car)!==false) {if (M0.path_p(string5198)!==false) {var or_part5204 = M0.string_p(pattern5197);if (or_part5204!==false) {var if_res3244 = or_part5204;} else {var if_res3244 = M0.regexp_p(pattern5197);}if (if_res3244!==false) {var if_res3245 = M0.path__gt_string(string5198);} else {var if_res3245 = M0.path__gt_bytes(string5198);}var if_res3246 = if_res3245;} else {var if_res3246 = string5198;}var string5203 = if_res3246;if (M0.string_p(string5203)!==false) {var if_res3248 = M0.string_length(string5203);} else {if (M0.bytes_p(string5203)!==false) {var if_res3247 = M0.bytes_length(string5203);} else {var if_res3247 = false;}var if_res3248 = if_res3247;}var len5205 = if_res3248;if (M0.bytes_p(pattern5197)!==false) {var if_res3252 = M0.byte_regexp(pattern5197);} else {if (M0.string_p(pattern5197)!==false) {var if_res3251 = M0.regexp(pattern5197);} else {if (M0.regexp_p(pattern5197)!==false) {var if_res3250 = pattern5197;} else {if (M0.byte_regexp_p(pattern5197)!==false) {var if_res3249 = pattern5197;} else {var if_res3249 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5197);}var if_res3250 = if_res3249;}var if_res3251 = if_res3250;}var if_res3252 = if_res3251;}var orig_rx5206 = if_res3252;var max_lookbehind5207 = M0.regexp_max_lookbehind(orig_rx5206);if (false!==false) {if (M0.input_port_p(string5203)!==false) {var if_res3253 = M0.rvoid();} else {var if_res3253 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("input-port?"),string5203);}var if_res3256 = if_res3253;} else {var or_part5208 = len5205;if (or_part5208!==false) {var if_res3254 = or_part5208;} else {var if_res3254 = M0.input_port_p(string5203);}if (if_res3254!==false) {var if_res3255 = M0.rvoid();} else {var if_res3255 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5203);}var if_res3256 = if_res3255;}if_res3256;if (M0.number_p(start5199)!==false) {if (M0.exact_p(start5199)!==false) {if (M0.integer_p(start5199)!==false) {var if_res3257 = M0.__gt__eq_(start5199,0);} else {var if_res3257 = false;}var if_res3258 = if_res3257;} else {var if_res3258 = false;}var if_res3259 = if_res3258;} else {var if_res3259 = false;}if (if_res3259!==false) {var if_res3260 = M0.rvoid();} else {var if_res3260 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5199);}if_res3260;var or_part5209 = M0.not(end5200);if (or_part5209!==false) {var if_res3264 = or_part5209;} else {if (M0.number_p(end5200)!==false) {if (M0.exact_p(end5200)!==false) {if (M0.integer_p(end5200)!==false) {var if_res3261 = M0.__gt__eq_(end5200,0);} else {var if_res3261 = false;}var if_res3262 = if_res3261;} else {var if_res3262 = false;}var if_res3263 = if_res3262;} else {var if_res3263 = false;}var if_res3264 = if_res3263;}if (if_res3264!==false) {var if_res3265 = M0.rvoid();} else {var if_res3265 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5200);}if_res3265;if (M0.bytes_p(ipre5201)!==false) {var if_res3266 = M0.rvoid();} else {var if_res3266 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("bytes?"),ipre5201);}if_res3266;var or_part5210 = M0.input_port_p(string5203);if (or_part5210!==false) {var if_res3268 = or_part5210;} else {if (len5205!==false) {var if_res3267 = M0.__lt__eq_(start5199,len5205);} else {var if_res3267 = false;}var if_res3268 = if_res3267;}if (if_res3268!==false) {var if_res3269 = M0.rvoid();} else {var if_res3269 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5205),start5199);}if_res3269;var or_part5211 = M0.not(end5200);if (or_part5211!==false) {var if_res3273 = or_part5211;} else {if (M0.__lt__eq_(start5199,end5200)!==false) {var or_part5212 = M0.input_port_p(string5203);if (or_part5212!==false) {var if_res3271 = or_part5212;} else {if (len5205!==false) {var if_res3270 = M0.__lt__eq_(end5200,len5205);} else {var if_res3270 = false;}var if_res3271 = if_res3270;}var if_res3272 = if_res3271;} else {var if_res3272 = false;}var if_res3273 = if_res3272;}if (if_res3273!==false) {var if_res3274 = M0.rvoid();} else {var if_res3274 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5199,len5205),end5200);}if_res3274;var loop5213 = function(acc5214, start5215, end5216, ipre5217, _0_ok_p5218) {if (_0_ok_p5218!==false) {var if_res3275 = orig_rx5206;} else {var if_res3275 = no_empty_edge_matches(orig_rx5206,M0.add1(M0.bytes_length(ipre5217)));}var rx5219 = if_res3275;if (false!==false) {var if_res3276 = M0.input_port_p(string5203);} else {var if_res3276 = false;}if (if_res3276!==false) {if (M0.positive_p(start5215)!==false) {var s5221 = M0.make_bytes(4096);var loop5222 = function(n5223) {if (M0.__eq_(n5223,start5215)!==false) {var if_res3278 = M0.rvoid();} else {var m5224 = M0.read_bytes_avail_bang_(s5221,string5203,0,M0.min(start5215-n5223,4096));if (M0.eof_object_p(m5224)!==false) {var if_res3277 = M0.rvoid();} else {var if_res3277 = loop5222(n5223+m5224);}var if_res3278 = if_res3277;}return if_res3278;};var if_res3279 = loop5222(0);} else {var if_res3279 = M0.rvoid();}var _5220 = if_res3279;if (false!==false) {var if_res3280 = false;} else {var if_res3280 = 0;}var discarded_by_leftovers5225 = if_res3280;if (false!==false) {var if_res3281 = M0.open_output_bytes();} else {var if_res3281 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5227, start5228, end5229, flush_p5230, breakable_p5231) {var c5232 = end5229-start5228;discarded_by_leftovers5225 = c5232+discarded_by_leftovers5225;return c5232;},M0.rvoid);}var spitout5226 = if_res3281;if (end5216!==false) {var if_res3282 = end5216-start5215;} else {var if_res3282 = false;}var end5233 = if_res3282;var let_result3283 = M0.regexp_match_by_end(rx5219,string5203,0,end5233,spitout5226,ipre5217,max_lookbehind5207);var ms5234 = let_result3283.getAt(0);var ipre5235 = let_result3283.getAt(1);if (ms5234!==false) {var if_res3284 = M0.car(ms5234);} else {var if_res3284 = false;}var m5236 = if_res3284;if (false!==false) {var if_res3285 = M0.get_output_bytes(spitout5226);} else {var if_res3285 = discarded_by_leftovers5225;}var discarded_by_leftovers5237 = if_res3285;if (false!==false) {var if_res3286 = bstring_length(discarded_by_leftovers5237);} else {var if_res3286 = discarded_by_leftovers5237;}var skipped5238 = if_res3286;if (m5236!==false) {var if_res3287 = bstring_length(m5236);} else {var if_res3287 = false;}var got5239 = if_res3287;if (end5233!==false) {if (m5236!==false) {var if_res3288 = end5233-skipped5238-got5239;} else {var if_res3288 = false;}var if_res3289 = if_res3288;} else {var if_res3289 = false;}var end5240 = if_res3289;if (m5236!==false) {var _0_ok_p5241 = M0.not(M0.zero_p(got5239));var if_res3290 = loop5213(false(discarded_by_leftovers5237,ms5234,acc5214),0,end5240,ipre5235,_0_ok_p5241);} else {var if_res3290 = false(acc5214,discarded_by_leftovers5237);}var if_res3300 = if_res3290;} else {if (false!==false) {var if_res3291 = M0.regexp_match_peek_positions_by_end(rx5219,string5203,start5215,end5216,false,ipre5217,max_lookbehind5207);} else {var if_res3291 = M0.regexp_match_positions_by_end(rx5219,string5203,start5215,end5216,false,ipre5217,max_lookbehind5207);}var let_result3292 = if_res3291;var m5242 = let_result3292.getAt(0);var ipre5243 = let_result3292.getAt(1);if (M0.not(m5242)!==false) {var if_res3299 = (function(acc5244, start5245, end5246) {return acc5244;})(acc5214,start5215,end5216);} else {var mstart5247 = M0.caar(m5242);var mend5248 = M0.cdar(m5242);var _0_ok_p5249 = M0.not(M0.__eq_(mstart5247,mend5248));if (function(loop5250, acc5251, start5252, end5253, ms5254) {var mstart5255 = M0.caar(ms5254);var mend5256 = M0.cdar(ms5254);var temp3294 = $rjs_core.Pair.makeList();if (end5253!==false) {var if_res3293 = end5253-mend5256;} else {var if_res3293 = false;}return M0.append(M1.map(function(p5257) {return M0.cons(mend5256+M0.car(p5257),mend5256+M0.cdr(p5257));},loop5250(temp3294,0,if_res3293)),M0.cons(M0.car(ms5254),acc5251));}!==false) {var if_res3295 = M0.input_port_p(string5203);} else {var if_res3295 = false;}if (if_res3295!==false) {var if_res3298 = (function(loop5258, acc5259, start5260, end5261, ms5262) {var mstart5263 = M0.caar(ms5262);var mend5264 = M0.cdar(ms5262);var temp3297 = $rjs_core.Pair.makeList();if (end5261!==false) {var if_res3296 = end5261-mend5264;} else {var if_res3296 = false;}return M0.append(M1.map(function(p5265) {return M0.cons(mend5264+M0.car(p5265),mend5264+M0.cdr(p5265));},loop5258(temp3297,0,if_res3296)),M0.cons(M0.car(ms5262),acc5259));})(function(acc5266, new_start5267, new_end5268) {return loop5213(acc5266,new_start5267,new_end5268,ipre5243,_0_ok_p5249);},acc5214,start5215,end5216,m5242);} else {var if_res3298 = loop5213((function(start5269, ms5270, acc5271) {return M0.cons(M0.car(ms5270),acc5271);})(start5215,m5242,acc5214),mend5248,end5216,ipre5243,_0_ok_p5249);}var if_res3299 = if_res3298;}var if_res3300 = if_res3299;}return if_res3300;};var if_res3366 = M0.reverse(loop5213($rjs_core.Pair.makeList(),start5199,end5200,ipre5201,true));} else {if (M0.path_p(string5198)!==false) {var or_part5273 = M0.string_p(pattern5197);if (or_part5273!==false) {var if_res3301 = or_part5273;} else {var if_res3301 = M0.regexp_p(pattern5197);}if (if_res3301!==false) {var if_res3302 = M0.path__gt_string(string5198);} else {var if_res3302 = M0.path__gt_bytes(string5198);}var if_res3303 = if_res3302;} else {var if_res3303 = string5198;}var string5272 = if_res3303;if (M0.string_p(string5272)!==false) {var if_res3305 = M0.string_length(string5272);} else {if (M0.bytes_p(string5272)!==false) {var if_res3304 = M0.bytes_length(string5272);} else {var if_res3304 = false;}var if_res3305 = if_res3304;}var len5274 = if_res3305;if (M0.bytes_p(pattern5197)!==false) {var if_res3309 = M0.byte_regexp(pattern5197);} else {if (M0.string_p(pattern5197)!==false) {var if_res3308 = M0.regexp(pattern5197);} else {if (M0.regexp_p(pattern5197)!==false) {var if_res3307 = pattern5197;} else {if (M0.byte_regexp_p(pattern5197)!==false) {var if_res3306 = pattern5197;} else {var if_res3306 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5197);}var if_res3307 = if_res3306;}var if_res3308 = if_res3307;}var if_res3309 = if_res3308;}var orig_rx5275 = if_res3309;var max_lookbehind5276 = M0.regexp_max_lookbehind(orig_rx5275);if (false!==false) {if (M0.input_port_p(string5272)!==false) {var if_res3310 = M0.rvoid();} else {var if_res3310 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("input-port?"),string5272);}var if_res3313 = if_res3310;} else {var or_part5277 = len5274;if (or_part5277!==false) {var if_res3311 = or_part5277;} else {var if_res3311 = M0.input_port_p(string5272);}if (if_res3311!==false) {var if_res3312 = M0.rvoid();} else {var if_res3312 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5272);}var if_res3313 = if_res3312;}if_res3313;if (M0.number_p(start5199)!==false) {if (M0.exact_p(start5199)!==false) {if (M0.integer_p(start5199)!==false) {var if_res3314 = M0.__gt__eq_(start5199,0);} else {var if_res3314 = false;}var if_res3315 = if_res3314;} else {var if_res3315 = false;}var if_res3316 = if_res3315;} else {var if_res3316 = false;}if (if_res3316!==false) {var if_res3317 = M0.rvoid();} else {var if_res3317 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5199);}if_res3317;var or_part5278 = M0.not(end5200);if (or_part5278!==false) {var if_res3321 = or_part5278;} else {if (M0.number_p(end5200)!==false) {if (M0.exact_p(end5200)!==false) {if (M0.integer_p(end5200)!==false) {var if_res3318 = M0.__gt__eq_(end5200,0);} else {var if_res3318 = false;}var if_res3319 = if_res3318;} else {var if_res3319 = false;}var if_res3320 = if_res3319;} else {var if_res3320 = false;}var if_res3321 = if_res3320;}if (if_res3321!==false) {var if_res3322 = M0.rvoid();} else {var if_res3322 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5200);}if_res3322;if (M0.bytes_p(ipre5201)!==false) {var if_res3323 = M0.rvoid();} else {var if_res3323 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("bytes?"),ipre5201);}if_res3323;var or_part5279 = M0.input_port_p(string5272);if (or_part5279!==false) {var if_res3325 = or_part5279;} else {if (len5274!==false) {var if_res3324 = M0.__lt__eq_(start5199,len5274);} else {var if_res3324 = false;}var if_res3325 = if_res3324;}if (if_res3325!==false) {var if_res3326 = M0.rvoid();} else {var if_res3326 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5274),start5199);}if_res3326;var or_part5280 = M0.not(end5200);if (or_part5280!==false) {var if_res3330 = or_part5280;} else {if (M0.__lt__eq_(start5199,end5200)!==false) {var or_part5281 = M0.input_port_p(string5272);if (or_part5281!==false) {var if_res3328 = or_part5281;} else {if (len5274!==false) {var if_res3327 = M0.__lt__eq_(end5200,len5274);} else {var if_res3327 = false;}var if_res3328 = if_res3327;}var if_res3329 = if_res3328;} else {var if_res3329 = false;}var if_res3330 = if_res3329;}if (if_res3330!==false) {var if_res3331 = M0.rvoid();} else {var if_res3331 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5199,len5274),end5200);}if_res3331;var loop5282 = function(acc5283, start5284, end5285, ipre5286, _0_ok_p5287) {if (_0_ok_p5287!==false) {var if_res3332 = orig_rx5275;} else {var if_res3332 = no_empty_edge_matches(orig_rx5275,M0.add1(M0.bytes_length(ipre5286)));}var rx5288 = if_res3332;if (false!==false) {var if_res3333 = M0.input_port_p(string5272);} else {var if_res3333 = false;}if (if_res3333!==false) {if (M0.positive_p(start5284)!==false) {var s5290 = M0.make_bytes(4096);var loop5291 = function(n5292) {if (M0.__eq_(n5292,start5284)!==false) {var if_res3335 = M0.rvoid();} else {var m5293 = M0.read_bytes_avail_bang_(s5290,string5272,0,M0.min(start5284-n5292,4096));if (M0.eof_object_p(m5293)!==false) {var if_res3334 = M0.rvoid();} else {var if_res3334 = loop5291(n5292+m5293);}var if_res3335 = if_res3334;}return if_res3335;};var if_res3336 = loop5291(0);} else {var if_res3336 = M0.rvoid();}var _5289 = if_res3336;if (false!==false) {var if_res3337 = false;} else {var if_res3337 = 0;}var discarded_by_leftovers5294 = if_res3337;if (false!==false) {var if_res3338 = M0.open_output_bytes();} else {var if_res3338 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5296, start5297, end5298, flush_p5299, breakable_p5300) {var c5301 = end5298-start5297;discarded_by_leftovers5294 = c5301+discarded_by_leftovers5294;return c5301;},M0.rvoid);}var spitout5295 = if_res3338;if (end5285!==false) {var if_res3339 = end5285-start5284;} else {var if_res3339 = false;}var end5302 = if_res3339;var let_result3340 = M0.regexp_match_by_end(rx5288,string5272,0,end5302,spitout5295,ipre5286,max_lookbehind5276);var ms5303 = let_result3340.getAt(0);var ipre5304 = let_result3340.getAt(1);if (ms5303!==false) {var if_res3341 = M0.car(ms5303);} else {var if_res3341 = false;}var m5305 = if_res3341;if (false!==false) {var if_res3342 = M0.get_output_bytes(spitout5295);} else {var if_res3342 = discarded_by_leftovers5294;}var discarded_by_leftovers5306 = if_res3342;if (false!==false) {var if_res3343 = bstring_length(discarded_by_leftovers5306);} else {var if_res3343 = discarded_by_leftovers5306;}var skipped5307 = if_res3343;if (m5305!==false) {var if_res3344 = bstring_length(m5305);} else {var if_res3344 = false;}var got5308 = if_res3344;if (end5302!==false) {if (m5305!==false) {var if_res3345 = end5302-skipped5307-got5308;} else {var if_res3345 = false;}var if_res3346 = if_res3345;} else {var if_res3346 = false;}var end5309 = if_res3346;if (m5305!==false) {var _0_ok_p5310 = M0.not(M0.zero_p(got5308));var if_res3347 = loop5282(false(discarded_by_leftovers5306,ms5303,acc5283),0,end5309,ipre5304,_0_ok_p5310);} else {var if_res3347 = false(acc5283,discarded_by_leftovers5306);}var if_res3365 = if_res3347;} else {if (false!==false) {var if_res3348 = M0.regexp_match_peek_positions_by_end(rx5288,string5272,start5284,end5285,false,ipre5286,max_lookbehind5276);} else {var if_res3348 = M0.regexp_match_positions_by_end(rx5288,string5272,start5284,end5285,false,ipre5286,max_lookbehind5276);}var let_result3349 = if_res3348;var m5311 = let_result3349.getAt(0);var ipre5312 = let_result3349.getAt(1);if (M0.not(m5311)!==false) {var if_res3364 = (function(acc5313, start5314, end5315) {return acc5313;})(acc5283,start5284,end5285);} else {var mstart5316 = M0.caar(m5311);var mend5317 = M0.cdar(m5311);var _0_ok_p5318 = M0.not(M0.__eq_(mstart5316,mend5317));if (function(loop5319, acc5320, start5321, end5322, ms5323) {var mend5324 = M0.cdar(ms5323);var temp3351 = $rjs_core.Pair.makeList();if (end5322!==false) {var if_res3350 = end5322-mend5324;} else {var if_res3350 = false;}var rest5325 = loop5319(temp3351,0,if_res3350);var s5326 = match_select5202(ms5323);if (M0.pair_p(s5326)!==false) {var if_res3352 = M0.exact_integer_p(M0.car(s5326));} else {var if_res3352 = false;}var or_part5327 = if_res3352;if (or_part5327!==false) {var if_res3353 = or_part5327;} else {var if_res3353 = M0.not(s5326);}if (if_res3353!==false) {var if_res3355 = function(p5328) {return M0.cons(mend5324+M0.car(p5328),mend5324+M0.cdr(p5328));};} else {var if_res3355 = function(ps5329) {return M1.map(function(p5330) {if (p5330!==false) {var if_res3354 = M0.cons(mend5324+M0.car(p5330),mend5324+M0.cdr(p5330));} else {var if_res3354 = false;}return if_res3354;},ps5329);};}return M0.append(M1.map(if_res3355,rest5325),M0.cons(s5326,acc5320));}!==false) {var if_res3356 = M0.input_port_p(string5272);} else {var if_res3356 = false;}if (if_res3356!==false) {var if_res3363 = (function(loop5331, acc5332, start5333, end5334, ms5335) {var mend5336 = M0.cdar(ms5335);var temp3358 = $rjs_core.Pair.makeList();if (end5334!==false) {var if_res3357 = end5334-mend5336;} else {var if_res3357 = false;}var rest5337 = loop5331(temp3358,0,if_res3357);var s5338 = match_select5202(ms5335);if (M0.pair_p(s5338)!==false) {var if_res3359 = M0.exact_integer_p(M0.car(s5338));} else {var if_res3359 = false;}var or_part5339 = if_res3359;if (or_part5339!==false) {var if_res3360 = or_part5339;} else {var if_res3360 = M0.not(s5338);}if (if_res3360!==false) {var if_res3362 = function(p5340) {return M0.cons(mend5336+M0.car(p5340),mend5336+M0.cdr(p5340));};} else {var if_res3362 = function(ps5341) {return M1.map(function(p5342) {if (p5342!==false) {var if_res3361 = M0.cons(mend5336+M0.car(p5342),mend5336+M0.cdr(p5342));} else {var if_res3361 = false;}return if_res3361;},ps5341);};}return M0.append(M1.map(if_res3362,rest5337),M0.cons(s5338,acc5332));})(function(acc5343, new_start5344, new_end5345) {return loop5282(acc5343,new_start5344,new_end5345,ipre5312,_0_ok_p5318);},acc5283,start5284,end5285,m5311);} else {var if_res3363 = loop5282((function(start5346, ms5347, acc5348) {return M0.cons(match_select5202(ms5347),acc5348);})(start5284,m5311,acc5283),mend5317,end5285,ipre5312,_0_ok_p5318);}var if_res3364 = if_res3363;}var if_res3365 = if_res3364;}return if_res3365;};var if_res3366 = M0.reverse(loop5282($rjs_core.Pair.makeList(),start5199,end5200,ipre5201,true));}return if_res3366;};var regexp_match_positions_times_5102 = function(given_kws5349, given_args5350, pattern165351, string175352, start135353, end145354, ipre155355) {var match_select125356 = M0.pair_p(given_kws5349);if (match_select125356!==false) {var if_res3367 = M0.car(given_args5350);} else {var if_res3367 = M7.unsafe_undefined;}var match_select115357 = if_res3367;return regexp_match_positions_times_(match_select115357,pattern165351,string175352,start135353,end145354,ipre155355);};var cl3374 = function(given_kws5362, given_args5363, pattern5364, string5365) {return regexp_match_positions_times_5102(given_kws5362,given_args5363,pattern5364,string5365,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3375 = function(given_kws5366, given_args5367, pattern5368, string5369, start5370, end5371, ipre155372) {return regexp_match_positions_times_5102(given_kws5366,given_args5367,pattern5368,string5369,start5370,end5371,ipre155372);};var cl3376 = function(given_kws5373, given_args5374, pattern5375, string5376, start5377, end145378) {return regexp_match_positions_times_5102(given_kws5373,given_args5374,pattern5375,string5376,start5377,end145378,$rjs_core.Bytes.fromIntArray([]));};var cl3377 = function(given_kws5379, given_args5380, pattern5381, string5382, start135383) {return regexp_match_positions_times_5102(given_kws5379,given_args5380,pattern5381,string5382,start135383,false,$rjs_core.Bytes.fromIntArray([]));};var temp3379 = $rjs_core.attachProcedureArity(function() {var fixed_lam3378 = {'4':cl3374,'7':cl3375,'6':cl3376,'5':cl3377}[arguments.length];if (fixed_lam3378!==undefined) {return fixed_lam3378.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6,7]);var temp3373 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("match-select"));var cl3368 = function(pattern5384, string5385) {return regexp_match_positions_times_5102(M0.rnull,M0.rnull,pattern5384,string5385,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3369 = function(pattern5386, string5387, start5388, end5389, ipre155390) {return regexp_match_positions_times_5102(M0.rnull,M0.rnull,pattern5386,string5387,start5388,end5389,ipre155390);};var cl3370 = function(pattern5391, string5392, start5393, end145394) {return regexp_match_positions_times_5102(M0.rnull,M0.rnull,pattern5391,string5392,start5393,end145394,$rjs_core.Bytes.fromIntArray([]));};var cl3371 = function(pattern5395, string5396, start135397) {return regexp_match_positions_times_5102(M0.rnull,M0.rnull,pattern5395,string5396,start135397,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_match_positions_times_18 = M2.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws5358, given_argc5359) {if (M0.__gt__eq_(given_argc5359,4)!==false) {var if_res3380 = M0.__lt__eq_(given_argc5359,7);} else {var if_res3380 = false;}if (if_res3380!==false) {var l12191335360 = given_kws5358;if (M0.null_p(l12191335360)!==false) {var if_res3382 = l12191335360;} else {if (M0.eq_p(M0.car(l12191335360),$rjs_core.Keyword.make("match-select"))!==false) {var if_res3381 = M0.cdr(l12191335360);} else {var if_res3381 = l12191335360;}var if_res3382 = if_res3381;}var l12191335361 = if_res3382;var if_res3383 = M0.null_p(l12191335361);} else {var if_res3383 = false;}return if_res3383;},temp3379,M0.rnull,temp3373,$rjs_core.attachProcedureArity(function() {var fixed_lam3372 = {'2':cl3368,'5':cl3369,'4':cl3370,'3':cl3371}[arguments.length];if (fixed_lam3372!==undefined) {return fixed_lam3372.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]));var regexp_match_peek_positions_times_ = function(match_select195398, pattern245399, string255400, start215401, end225402, ipre235403) {var pattern5404 = pattern245399;var string5405 = string255400;if (false!==false) {var if_res3384 = 0;} else {var if_res3384 = start215401;}var start5406 = if_res3384;if (false!==false) {var if_res3385 = false;} else {var if_res3385 = end225402;}var end5407 = if_res3385;if (false!==false) {var if_res3386 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3386 = ipre235403;}var ipre5408 = if_res3386;if (M0.eq_p(match_select195398,M7.unsafe_undefined)!==false) {var if_res3387 = M0.car;} else {var if_res3387 = match_select195398;}var match_select5409 = if_res3387;if (M0.procedure_p(match_select5409)!==false) {var if_res3388 = M0.rvoid();} else {var if_res3388 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("procedure?"),match_select5409);}if_res3388;if (M0.eq_p(match_select5409,M0.car)!==false) {if (M0.path_p(string5405)!==false) {var or_part5411 = M0.string_p(pattern5404);if (or_part5411!==false) {var if_res3389 = or_part5411;} else {var if_res3389 = M0.regexp_p(pattern5404);}if (if_res3389!==false) {var if_res3390 = M0.path__gt_string(string5405);} else {var if_res3390 = M0.path__gt_bytes(string5405);}var if_res3391 = if_res3390;} else {var if_res3391 = string5405;}var string5410 = if_res3391;if (M0.string_p(string5410)!==false) {var if_res3393 = M0.string_length(string5410);} else {if (M0.bytes_p(string5410)!==false) {var if_res3392 = M0.bytes_length(string5410);} else {var if_res3392 = false;}var if_res3393 = if_res3392;}var len5412 = if_res3393;if (M0.bytes_p(pattern5404)!==false) {var if_res3397 = M0.byte_regexp(pattern5404);} else {if (M0.string_p(pattern5404)!==false) {var if_res3396 = M0.regexp(pattern5404);} else {if (M0.regexp_p(pattern5404)!==false) {var if_res3395 = pattern5404;} else {if (M0.byte_regexp_p(pattern5404)!==false) {var if_res3394 = pattern5404;} else {var if_res3394 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5404);}var if_res3395 = if_res3394;}var if_res3396 = if_res3395;}var if_res3397 = if_res3396;}var orig_rx5413 = if_res3397;var max_lookbehind5414 = M0.regexp_max_lookbehind(orig_rx5413);if (true!==false) {if (M0.input_port_p(string5410)!==false) {var if_res3398 = M0.rvoid();} else {var if_res3398 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("input-port?"),string5410);}var if_res3401 = if_res3398;} else {var or_part5415 = len5412;if (or_part5415!==false) {var if_res3399 = or_part5415;} else {var if_res3399 = M0.input_port_p(string5410);}if (if_res3399!==false) {var if_res3400 = M0.rvoid();} else {var if_res3400 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5410);}var if_res3401 = if_res3400;}if_res3401;if (M0.number_p(start5406)!==false) {if (M0.exact_p(start5406)!==false) {if (M0.integer_p(start5406)!==false) {var if_res3402 = M0.__gt__eq_(start5406,0);} else {var if_res3402 = false;}var if_res3403 = if_res3402;} else {var if_res3403 = false;}var if_res3404 = if_res3403;} else {var if_res3404 = false;}if (if_res3404!==false) {var if_res3405 = M0.rvoid();} else {var if_res3405 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5406);}if_res3405;var or_part5416 = M0.not(end5407);if (or_part5416!==false) {var if_res3409 = or_part5416;} else {if (M0.number_p(end5407)!==false) {if (M0.exact_p(end5407)!==false) {if (M0.integer_p(end5407)!==false) {var if_res3406 = M0.__gt__eq_(end5407,0);} else {var if_res3406 = false;}var if_res3407 = if_res3406;} else {var if_res3407 = false;}var if_res3408 = if_res3407;} else {var if_res3408 = false;}var if_res3409 = if_res3408;}if (if_res3409!==false) {var if_res3410 = M0.rvoid();} else {var if_res3410 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5407);}if_res3410;if (M0.bytes_p(ipre5408)!==false) {var if_res3411 = M0.rvoid();} else {var if_res3411 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("bytes?"),ipre5408);}if_res3411;var or_part5417 = M0.input_port_p(string5410);if (or_part5417!==false) {var if_res3413 = or_part5417;} else {if (len5412!==false) {var if_res3412 = M0.__lt__eq_(start5406,len5412);} else {var if_res3412 = false;}var if_res3413 = if_res3412;}if (if_res3413!==false) {var if_res3414 = M0.rvoid();} else {var if_res3414 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5412),start5406);}if_res3414;var or_part5418 = M0.not(end5407);if (or_part5418!==false) {var if_res3418 = or_part5418;} else {if (M0.__lt__eq_(start5406,end5407)!==false) {var or_part5419 = M0.input_port_p(string5410);if (or_part5419!==false) {var if_res3416 = or_part5419;} else {if (len5412!==false) {var if_res3415 = M0.__lt__eq_(end5407,len5412);} else {var if_res3415 = false;}var if_res3416 = if_res3415;}var if_res3417 = if_res3416;} else {var if_res3417 = false;}var if_res3418 = if_res3417;}if (if_res3418!==false) {var if_res3419 = M0.rvoid();} else {var if_res3419 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5406,len5412),end5407);}if_res3419;var loop5420 = function(acc5421, start5422, end5423, ipre5424, _0_ok_p5425) {if (_0_ok_p5425!==false) {var if_res3420 = orig_rx5413;} else {var if_res3420 = no_empty_edge_matches(orig_rx5413,M0.add1(M0.bytes_length(ipre5424)));}var rx5426 = if_res3420;if (false!==false) {var if_res3421 = M0.input_port_p(string5410);} else {var if_res3421 = false;}if (if_res3421!==false) {if (M0.positive_p(start5422)!==false) {var s5428 = M0.make_bytes(4096);var loop5429 = function(n5430) {if (M0.__eq_(n5430,start5422)!==false) {var if_res3423 = M0.rvoid();} else {var m5431 = M0.read_bytes_avail_bang_(s5428,string5410,0,M0.min(start5422-n5430,4096));if (M0.eof_object_p(m5431)!==false) {var if_res3422 = M0.rvoid();} else {var if_res3422 = loop5429(n5430+m5431);}var if_res3423 = if_res3422;}return if_res3423;};var if_res3424 = loop5429(0);} else {var if_res3424 = M0.rvoid();}var _5427 = if_res3424;if (false!==false) {var if_res3425 = false;} else {var if_res3425 = 0;}var discarded_by_leftovers5432 = if_res3425;if (false!==false) {var if_res3426 = M0.open_output_bytes();} else {var if_res3426 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5434, start5435, end5436, flush_p5437, breakable_p5438) {var c5439 = end5436-start5435;discarded_by_leftovers5432 = c5439+discarded_by_leftovers5432;return c5439;},M0.rvoid);}var spitout5433 = if_res3426;if (end5423!==false) {var if_res3427 = end5423-start5422;} else {var if_res3427 = false;}var end5440 = if_res3427;var let_result3428 = M0.regexp_match_by_end(rx5426,string5410,0,end5440,spitout5433,ipre5424,max_lookbehind5414);var ms5441 = let_result3428.getAt(0);var ipre5442 = let_result3428.getAt(1);if (ms5441!==false) {var if_res3429 = M0.car(ms5441);} else {var if_res3429 = false;}var m5443 = if_res3429;if (false!==false) {var if_res3430 = M0.get_output_bytes(spitout5433);} else {var if_res3430 = discarded_by_leftovers5432;}var discarded_by_leftovers5444 = if_res3430;if (false!==false) {var if_res3431 = bstring_length(discarded_by_leftovers5444);} else {var if_res3431 = discarded_by_leftovers5444;}var skipped5445 = if_res3431;if (m5443!==false) {var if_res3432 = bstring_length(m5443);} else {var if_res3432 = false;}var got5446 = if_res3432;if (end5440!==false) {if (m5443!==false) {var if_res3433 = end5440-skipped5445-got5446;} else {var if_res3433 = false;}var if_res3434 = if_res3433;} else {var if_res3434 = false;}var end5447 = if_res3434;if (m5443!==false) {var _0_ok_p5448 = M0.not(M0.zero_p(got5446));var if_res3435 = loop5420(false(discarded_by_leftovers5444,ms5441,acc5421),0,end5447,ipre5442,_0_ok_p5448);} else {var if_res3435 = false(acc5421,discarded_by_leftovers5444);}var if_res3441 = if_res3435;} else {if (true!==false) {var if_res3436 = M0.regexp_match_peek_positions_by_end(rx5426,string5410,start5422,end5423,false,ipre5424,max_lookbehind5414);} else {var if_res3436 = M0.regexp_match_positions_by_end(rx5426,string5410,start5422,end5423,false,ipre5424,max_lookbehind5414);}var let_result3437 = if_res3436;var m5449 = let_result3437.getAt(0);var ipre5450 = let_result3437.getAt(1);if (M0.not(m5449)!==false) {var if_res3440 = (function(acc5451, start5452, end5453) {return acc5451;})(acc5421,start5422,end5423);} else {var mstart5454 = M0.caar(m5449);var mend5455 = M0.cdar(m5449);var _0_ok_p5456 = M0.not(M0.__eq_(mstart5454,mend5455));if (false!==false) {var if_res3438 = M0.input_port_p(string5410);} else {var if_res3438 = false;}if (if_res3438!==false) {var if_res3439 = false(function(acc5457, new_start5458, new_end5459) {return loop5420(acc5457,new_start5458,new_end5459,ipre5450,_0_ok_p5456);},acc5421,start5422,end5423,m5449);} else {var if_res3439 = loop5420((function(start5460, ms5461, acc5462) {return M0.cons(M0.car(ms5461),acc5462);})(start5422,m5449,acc5421),mend5455,end5423,ipre5450,_0_ok_p5456);}var if_res3440 = if_res3439;}var if_res3441 = if_res3440;}return if_res3441;};var if_res3495 = M0.reverse(loop5420($rjs_core.Pair.makeList(),start5406,end5407,ipre5408,true));} else {if (M0.path_p(string5405)!==false) {var or_part5464 = M0.string_p(pattern5404);if (or_part5464!==false) {var if_res3442 = or_part5464;} else {var if_res3442 = M0.regexp_p(pattern5404);}if (if_res3442!==false) {var if_res3443 = M0.path__gt_string(string5405);} else {var if_res3443 = M0.path__gt_bytes(string5405);}var if_res3444 = if_res3443;} else {var if_res3444 = string5405;}var string5463 = if_res3444;if (M0.string_p(string5463)!==false) {var if_res3446 = M0.string_length(string5463);} else {if (M0.bytes_p(string5463)!==false) {var if_res3445 = M0.bytes_length(string5463);} else {var if_res3445 = false;}var if_res3446 = if_res3445;}var len5465 = if_res3446;if (M0.bytes_p(pattern5404)!==false) {var if_res3450 = M0.byte_regexp(pattern5404);} else {if (M0.string_p(pattern5404)!==false) {var if_res3449 = M0.regexp(pattern5404);} else {if (M0.regexp_p(pattern5404)!==false) {var if_res3448 = pattern5404;} else {if (M0.byte_regexp_p(pattern5404)!==false) {var if_res3447 = pattern5404;} else {var if_res3447 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5404);}var if_res3448 = if_res3447;}var if_res3449 = if_res3448;}var if_res3450 = if_res3449;}var orig_rx5466 = if_res3450;var max_lookbehind5467 = M0.regexp_max_lookbehind(orig_rx5466);if (true!==false) {if (M0.input_port_p(string5463)!==false) {var if_res3451 = M0.rvoid();} else {var if_res3451 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("input-port?"),string5463);}var if_res3454 = if_res3451;} else {var or_part5468 = len5465;if (or_part5468!==false) {var if_res3452 = or_part5468;} else {var if_res3452 = M0.input_port_p(string5463);}if (if_res3452!==false) {var if_res3453 = M0.rvoid();} else {var if_res3453 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5463);}var if_res3454 = if_res3453;}if_res3454;if (M0.number_p(start5406)!==false) {if (M0.exact_p(start5406)!==false) {if (M0.integer_p(start5406)!==false) {var if_res3455 = M0.__gt__eq_(start5406,0);} else {var if_res3455 = false;}var if_res3456 = if_res3455;} else {var if_res3456 = false;}var if_res3457 = if_res3456;} else {var if_res3457 = false;}if (if_res3457!==false) {var if_res3458 = M0.rvoid();} else {var if_res3458 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5406);}if_res3458;var or_part5469 = M0.not(end5407);if (or_part5469!==false) {var if_res3462 = or_part5469;} else {if (M0.number_p(end5407)!==false) {if (M0.exact_p(end5407)!==false) {if (M0.integer_p(end5407)!==false) {var if_res3459 = M0.__gt__eq_(end5407,0);} else {var if_res3459 = false;}var if_res3460 = if_res3459;} else {var if_res3460 = false;}var if_res3461 = if_res3460;} else {var if_res3461 = false;}var if_res3462 = if_res3461;}if (if_res3462!==false) {var if_res3463 = M0.rvoid();} else {var if_res3463 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5407);}if_res3463;if (M0.bytes_p(ipre5408)!==false) {var if_res3464 = M0.rvoid();} else {var if_res3464 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("bytes?"),ipre5408);}if_res3464;var or_part5470 = M0.input_port_p(string5463);if (or_part5470!==false) {var if_res3466 = or_part5470;} else {if (len5465!==false) {var if_res3465 = M0.__lt__eq_(start5406,len5465);} else {var if_res3465 = false;}var if_res3466 = if_res3465;}if (if_res3466!==false) {var if_res3467 = M0.rvoid();} else {var if_res3467 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5465),start5406);}if_res3467;var or_part5471 = M0.not(end5407);if (or_part5471!==false) {var if_res3471 = or_part5471;} else {if (M0.__lt__eq_(start5406,end5407)!==false) {var or_part5472 = M0.input_port_p(string5463);if (or_part5472!==false) {var if_res3469 = or_part5472;} else {if (len5465!==false) {var if_res3468 = M0.__lt__eq_(end5407,len5465);} else {var if_res3468 = false;}var if_res3469 = if_res3468;}var if_res3470 = if_res3469;} else {var if_res3470 = false;}var if_res3471 = if_res3470;}if (if_res3471!==false) {var if_res3472 = M0.rvoid();} else {var if_res3472 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5406,len5465),end5407);}if_res3472;var loop5473 = function(acc5474, start5475, end5476, ipre5477, _0_ok_p5478) {if (_0_ok_p5478!==false) {var if_res3473 = orig_rx5466;} else {var if_res3473 = no_empty_edge_matches(orig_rx5466,M0.add1(M0.bytes_length(ipre5477)));}var rx5479 = if_res3473;if (false!==false) {var if_res3474 = M0.input_port_p(string5463);} else {var if_res3474 = false;}if (if_res3474!==false) {if (M0.positive_p(start5475)!==false) {var s5481 = M0.make_bytes(4096);var loop5482 = function(n5483) {if (M0.__eq_(n5483,start5475)!==false) {var if_res3476 = M0.rvoid();} else {var m5484 = M0.read_bytes_avail_bang_(s5481,string5463,0,M0.min(start5475-n5483,4096));if (M0.eof_object_p(m5484)!==false) {var if_res3475 = M0.rvoid();} else {var if_res3475 = loop5482(n5483+m5484);}var if_res3476 = if_res3475;}return if_res3476;};var if_res3477 = loop5482(0);} else {var if_res3477 = M0.rvoid();}var _5480 = if_res3477;if (false!==false) {var if_res3478 = false;} else {var if_res3478 = 0;}var discarded_by_leftovers5485 = if_res3478;if (false!==false) {var if_res3479 = M0.open_output_bytes();} else {var if_res3479 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5487, start5488, end5489, flush_p5490, breakable_p5491) {var c5492 = end5489-start5488;discarded_by_leftovers5485 = c5492+discarded_by_leftovers5485;return c5492;},M0.rvoid);}var spitout5486 = if_res3479;if (end5476!==false) {var if_res3480 = end5476-start5475;} else {var if_res3480 = false;}var end5493 = if_res3480;var let_result3481 = M0.regexp_match_by_end(rx5479,string5463,0,end5493,spitout5486,ipre5477,max_lookbehind5467);var ms5494 = let_result3481.getAt(0);var ipre5495 = let_result3481.getAt(1);if (ms5494!==false) {var if_res3482 = M0.car(ms5494);} else {var if_res3482 = false;}var m5496 = if_res3482;if (false!==false) {var if_res3483 = M0.get_output_bytes(spitout5486);} else {var if_res3483 = discarded_by_leftovers5485;}var discarded_by_leftovers5497 = if_res3483;if (false!==false) {var if_res3484 = bstring_length(discarded_by_leftovers5497);} else {var if_res3484 = discarded_by_leftovers5497;}var skipped5498 = if_res3484;if (m5496!==false) {var if_res3485 = bstring_length(m5496);} else {var if_res3485 = false;}var got5499 = if_res3485;if (end5493!==false) {if (m5496!==false) {var if_res3486 = end5493-skipped5498-got5499;} else {var if_res3486 = false;}var if_res3487 = if_res3486;} else {var if_res3487 = false;}var end5500 = if_res3487;if (m5496!==false) {var _0_ok_p5501 = M0.not(M0.zero_p(got5499));var if_res3488 = loop5473(false(discarded_by_leftovers5497,ms5494,acc5474),0,end5500,ipre5495,_0_ok_p5501);} else {var if_res3488 = false(acc5474,discarded_by_leftovers5497);}var if_res3494 = if_res3488;} else {if (true!==false) {var if_res3489 = M0.regexp_match_peek_positions_by_end(rx5479,string5463,start5475,end5476,false,ipre5477,max_lookbehind5467);} else {var if_res3489 = M0.regexp_match_positions_by_end(rx5479,string5463,start5475,end5476,false,ipre5477,max_lookbehind5467);}var let_result3490 = if_res3489;var m5502 = let_result3490.getAt(0);var ipre5503 = let_result3490.getAt(1);if (M0.not(m5502)!==false) {var if_res3493 = (function(acc5504, start5505, end5506) {return acc5504;})(acc5474,start5475,end5476);} else {var mstart5507 = M0.caar(m5502);var mend5508 = M0.cdar(m5502);var _0_ok_p5509 = M0.not(M0.__eq_(mstart5507,mend5508));if (false!==false) {var if_res3491 = M0.input_port_p(string5463);} else {var if_res3491 = false;}if (if_res3491!==false) {var if_res3492 = false(function(acc5510, new_start5511, new_end5512) {return loop5473(acc5510,new_start5511,new_end5512,ipre5503,_0_ok_p5509);},acc5474,start5475,end5476,m5502);} else {var if_res3492 = loop5473((function(start5513, ms5514, acc5515) {return M0.cons(match_select5409(ms5514),acc5515);})(start5475,m5502,acc5474),mend5508,end5476,ipre5503,_0_ok_p5509);}var if_res3493 = if_res3492;}var if_res3494 = if_res3493;}return if_res3494;};var if_res3495 = M0.reverse(loop5473($rjs_core.Pair.makeList(),start5406,end5407,ipre5408,true));}return if_res3495;};var regexp_match_peek_positions_times_5103 = function(given_kws5516, given_args5517, pattern245518, string255519, start215520, end225521, ipre235522) {var match_select205523 = M0.pair_p(given_kws5516);if (match_select205523!==false) {var if_res3496 = M0.car(given_args5517);} else {var if_res3496 = M7.unsafe_undefined;}var match_select195524 = if_res3496;return regexp_match_peek_positions_times_(match_select195524,pattern245518,string255519,start215520,end225521,ipre235522);};var cl3503 = function(given_kws5529, given_args5530, pattern5531, string5532) {return regexp_match_peek_positions_times_5103(given_kws5529,given_args5530,pattern5531,string5532,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3504 = function(given_kws5533, given_args5534, pattern5535, string5536, start5537, end5538, ipre235539) {return regexp_match_peek_positions_times_5103(given_kws5533,given_args5534,pattern5535,string5536,start5537,end5538,ipre235539);};var cl3505 = function(given_kws5540, given_args5541, pattern5542, string5543, start5544, end225545) {return regexp_match_peek_positions_times_5103(given_kws5540,given_args5541,pattern5542,string5543,start5544,end225545,$rjs_core.Bytes.fromIntArray([]));};var cl3506 = function(given_kws5546, given_args5547, pattern5548, string5549, start215550) {return regexp_match_peek_positions_times_5103(given_kws5546,given_args5547,pattern5548,string5549,start215550,false,$rjs_core.Bytes.fromIntArray([]));};var temp3508 = $rjs_core.attachProcedureArity(function() {var fixed_lam3507 = {'4':cl3503,'7':cl3504,'6':cl3505,'5':cl3506}[arguments.length];if (fixed_lam3507!==undefined) {return fixed_lam3507.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6,7]);var temp3502 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("match-select"));var cl3497 = function(pattern5551, string5552) {return regexp_match_peek_positions_times_5103(M0.rnull,M0.rnull,pattern5551,string5552,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3498 = function(pattern5553, string5554, start5555, end5556, ipre235557) {return regexp_match_peek_positions_times_5103(M0.rnull,M0.rnull,pattern5553,string5554,start5555,end5556,ipre235557);};var cl3499 = function(pattern5558, string5559, start5560, end225561) {return regexp_match_peek_positions_times_5103(M0.rnull,M0.rnull,pattern5558,string5559,start5560,end225561,$rjs_core.Bytes.fromIntArray([]));};var cl3500 = function(pattern5562, string5563, start215564) {return regexp_match_peek_positions_times_5103(M0.rnull,M0.rnull,pattern5562,string5563,start215564,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_match_peek_positions_times_26 = M2.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws5525, given_argc5526) {if (M0.__gt__eq_(given_argc5526,4)!==false) {var if_res3509 = M0.__lt__eq_(given_argc5526,7);} else {var if_res3509 = false;}if (if_res3509!==false) {var l12191345527 = given_kws5525;if (M0.null_p(l12191345527)!==false) {var if_res3511 = l12191345527;} else {if (M0.eq_p(M0.car(l12191345527),$rjs_core.Keyword.make("match-select"))!==false) {var if_res3510 = M0.cdr(l12191345527);} else {var if_res3510 = l12191345527;}var if_res3511 = if_res3510;}var l12191345528 = if_res3511;var if_res3512 = M0.null_p(l12191345528);} else {var if_res3512 = false;}return if_res3512;},temp3508,M0.rnull,temp3502,$rjs_core.attachProcedureArity(function() {var fixed_lam3501 = {'2':cl3497,'5':cl3498,'4':cl3499,'3':cl3500}[arguments.length];if (fixed_lam3501!==undefined) {return fixed_lam3501.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]));var get_buf_plus_sub = function(string5565, pattern5566) {if (M0.string_p(string5565)!==false) {var or_part5568 = M0.byte_regexp_p(pattern5566);if (or_part5568!==false) {var if_res3513 = or_part5568;} else {var if_res3513 = M0.bytes_p(pattern5566);}var if_res3514 = if_res3513;} else {var if_res3514 = false;}if (if_res3514!==false) {var if_res3515 = M0.string__gt_bytes_by_utf_8(string5565,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res3515 = string5565;}var buf5567 = if_res3515;var or_part5569 = M0.bytes_p(buf5567);if (or_part5569!==false) {var if_res3518 = or_part5569;} else {if (M0.path_p(string5565)!==false) {var or_part5570 = M0.bytes_p(pattern5566);if (or_part5570!==false) {var if_res3516 = or_part5570;} else {var if_res3516 = M0.byte_regexp_p(pattern5566);}var if_res3517 = if_res3516;} else {var if_res3517 = false;}var if_res3518 = if_res3517;}if (if_res3518!==false) {var if_res3519 = M0.subbytes;} else {var if_res3519 = M0.substring;}return M0.values(buf5567,if_res3519);};var regexp_split5571 = function(pattern305572, string315573, start275574, end285575, ipre295576) {var pattern5577 = pattern305572;var string5578 = string315573;if (false!==false) {var if_res3520 = 0;} else {var if_res3520 = start275574;}var start5579 = if_res3520;if (false!==false) {var if_res3521 = false;} else {var if_res3521 = end285575;}var end5580 = if_res3521;if (false!==false) {var if_res3522 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3522 = ipre295576;}var ipre5581 = if_res3522;var let_result3523 = get_buf_plus_sub(string5578,pattern5577);var buf5582 = let_result3523.getAt(0);var sub5583 = let_result3523.getAt(1);if (M0.path_p(buf5582)!==false) {var or_part5585 = M0.string_p(pattern5577);if (or_part5585!==false) {var if_res3524 = or_part5585;} else {var if_res3524 = M0.regexp_p(pattern5577);}if (if_res3524!==false) {var if_res3525 = M0.path__gt_string(buf5582);} else {var if_res3525 = M0.path__gt_bytes(buf5582);}var if_res3526 = if_res3525;} else {var if_res3526 = buf5582;}var buf5584 = if_res3526;if (M0.string_p(buf5584)!==false) {var if_res3528 = M0.string_length(buf5584);} else {if (M0.bytes_p(buf5584)!==false) {var if_res3527 = M0.bytes_length(buf5584);} else {var if_res3527 = false;}var if_res3528 = if_res3527;}var len5586 = if_res3528;if (M0.bytes_p(pattern5577)!==false) {var if_res3532 = M0.byte_regexp(pattern5577);} else {if (M0.string_p(pattern5577)!==false) {var if_res3531 = M0.regexp(pattern5577);} else {if (M0.regexp_p(pattern5577)!==false) {var if_res3530 = pattern5577;} else {if (M0.byte_regexp_p(pattern5577)!==false) {var if_res3529 = pattern5577;} else {var if_res3529 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5577);}var if_res3530 = if_res3529;}var if_res3531 = if_res3530;}var if_res3532 = if_res3531;}var orig_rx5587 = if_res3532;var max_lookbehind5588 = M0.regexp_max_lookbehind(orig_rx5587);if (false!==false) {if (M0.input_port_p(buf5584)!==false) {var if_res3533 = M0.rvoid();} else {var if_res3533 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("input-port?"),buf5584);}var if_res3536 = if_res3533;} else {var or_part5589 = len5586;if (or_part5589!==false) {var if_res3534 = or_part5589;} else {var if_res3534 = M0.input_port_p(buf5584);}if (if_res3534!==false) {var if_res3535 = M0.rvoid();} else {var if_res3535 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5584);}var if_res3536 = if_res3535;}if_res3536;if (M0.number_p(start5579)!==false) {if (M0.exact_p(start5579)!==false) {if (M0.integer_p(start5579)!==false) {var if_res3537 = M0.__gt__eq_(start5579,0);} else {var if_res3537 = false;}var if_res3538 = if_res3537;} else {var if_res3538 = false;}var if_res3539 = if_res3538;} else {var if_res3539 = false;}if (if_res3539!==false) {var if_res3540 = M0.rvoid();} else {var if_res3540 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5579);}if_res3540;var or_part5590 = M0.not(end5580);if (or_part5590!==false) {var if_res3544 = or_part5590;} else {if (M0.number_p(end5580)!==false) {if (M0.exact_p(end5580)!==false) {if (M0.integer_p(end5580)!==false) {var if_res3541 = M0.__gt__eq_(end5580,0);} else {var if_res3541 = false;}var if_res3542 = if_res3541;} else {var if_res3542 = false;}var if_res3543 = if_res3542;} else {var if_res3543 = false;}var if_res3544 = if_res3543;}if (if_res3544!==false) {var if_res3545 = M0.rvoid();} else {var if_res3545 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5580);}if_res3545;if (M0.bytes_p(ipre5581)!==false) {var if_res3546 = M0.rvoid();} else {var if_res3546 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("bytes?"),ipre5581);}if_res3546;var or_part5591 = M0.input_port_p(buf5584);if (or_part5591!==false) {var if_res3548 = or_part5591;} else {if (len5586!==false) {var if_res3547 = M0.__lt__eq_(start5579,len5586);} else {var if_res3547 = false;}var if_res3548 = if_res3547;}if (if_res3548!==false) {var if_res3549 = M0.rvoid();} else {var if_res3549 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-split"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5586),start5579);}if_res3549;var or_part5592 = M0.not(end5580);if (or_part5592!==false) {var if_res3553 = or_part5592;} else {if (M0.__lt__eq_(start5579,end5580)!==false) {var or_part5593 = M0.input_port_p(buf5584);if (or_part5593!==false) {var if_res3551 = or_part5593;} else {if (len5586!==false) {var if_res3550 = M0.__lt__eq_(end5580,len5586);} else {var if_res3550 = false;}var if_res3551 = if_res3550;}var if_res3552 = if_res3551;} else {var if_res3552 = false;}var if_res3553 = if_res3552;}if (if_res3553!==false) {var if_res3554 = M0.rvoid();} else {var if_res3554 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-split"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5579,len5586),end5580);}if_res3554;var loop5594 = function(acc5595, start5596, end5597, ipre5598, _0_ok_p5599) {if (_0_ok_p5599!==false) {var if_res3555 = orig_rx5587;} else {var if_res3555 = no_empty_edge_matches(orig_rx5587,M0.add1(M0.bytes_length(ipre5598)));}var rx5600 = if_res3555;if (function(leftovers5601, ms5602, acc5603) {return M0.cons(leftovers5601,acc5603);}!==false) {var if_res3556 = M0.input_port_p(buf5584);} else {var if_res3556 = false;}if (if_res3556!==false) {if (M0.positive_p(start5596)!==false) {var s5605 = M0.make_bytes(4096);var loop5606 = function(n5607) {if (M0.__eq_(n5607,start5596)!==false) {var if_res3558 = M0.rvoid();} else {var m5608 = M0.read_bytes_avail_bang_(s5605,buf5584,0,M0.min(start5596-n5607,4096));if (M0.eof_object_p(m5608)!==false) {var if_res3557 = M0.rvoid();} else {var if_res3557 = loop5606(n5607+m5608);}var if_res3558 = if_res3557;}return if_res3558;};var if_res3559 = loop5606(0);} else {var if_res3559 = M0.rvoid();}var _5604 = if_res3559;if (true!==false) {var if_res3560 = false;} else {var if_res3560 = 0;}var discarded_by_leftovers5609 = if_res3560;if (true!==false) {var if_res3561 = M0.open_output_bytes();} else {var if_res3561 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5611, start5612, end5613, flush_p5614, breakable_p5615) {var c5616 = end5613-start5612;discarded_by_leftovers5609 = c5616+discarded_by_leftovers5609;return c5616;},M0.rvoid);}var spitout5610 = if_res3561;if (end5597!==false) {var if_res3562 = end5597-start5596;} else {var if_res3562 = false;}var end5617 = if_res3562;var let_result3563 = M0.regexp_match_by_end(rx5600,buf5584,0,end5617,spitout5610,ipre5598,max_lookbehind5588);var ms5618 = let_result3563.getAt(0);var ipre5619 = let_result3563.getAt(1);if (ms5618!==false) {var if_res3564 = M0.car(ms5618);} else {var if_res3564 = false;}var m5620 = if_res3564;if (true!==false) {var if_res3565 = M0.get_output_bytes(spitout5610);} else {var if_res3565 = discarded_by_leftovers5609;}var discarded_by_leftovers5621 = if_res3565;if (true!==false) {var if_res3566 = bstring_length(discarded_by_leftovers5621);} else {var if_res3566 = discarded_by_leftovers5621;}var skipped5622 = if_res3566;if (m5620!==false) {var if_res3567 = bstring_length(m5620);} else {var if_res3567 = false;}var got5623 = if_res3567;if (end5617!==false) {if (m5620!==false) {var if_res3568 = end5617-skipped5622-got5623;} else {var if_res3568 = false;}var if_res3569 = if_res3568;} else {var if_res3569 = false;}var end5624 = if_res3569;if (m5620!==false) {var _0_ok_p5625 = M0.not(M0.zero_p(got5623));var if_res3571 = loop5594((function(leftovers5626, ms5627, acc5628) {return M0.cons(leftovers5626,acc5628);})(discarded_by_leftovers5621,ms5618,acc5595),0,end5624,ipre5619,_0_ok_p5625);} else {var if_res3571 = (function(acc5629, leftover5630) {if (leftover5630!==false) {var if_res3570 = M0.cons(leftover5630,acc5629);} else {var if_res3570 = acc5629;}return if_res3570;})(acc5595,discarded_by_leftovers5621);}var if_res3578 = if_res3571;} else {if (false!==false) {var if_res3572 = M0.regexp_match_peek_positions_by_end(rx5600,buf5584,start5596,end5597,false,ipre5598,max_lookbehind5588);} else {var if_res3572 = M0.regexp_match_positions_by_end(rx5600,buf5584,start5596,end5597,false,ipre5598,max_lookbehind5588);}var let_result3573 = if_res3572;var m5631 = let_result3573.getAt(0);var ipre5632 = let_result3573.getAt(1);if (M0.not(m5631)!==false) {var if_res3577 = (function(acc5633, start5634, end5635) {if (end5635!==false) {var if_res3574 = sub5583(buf5584,start5634,end5635);} else {var if_res3574 = sub5583(buf5584,start5634);}return M0.cons(if_res3574,acc5633);})(acc5595,start5596,end5597);} else {var mstart5636 = M0.caar(m5631);var mend5637 = M0.cdar(m5631);var _0_ok_p5638 = M0.not(M0.__eq_(mstart5636,mend5637));if (false!==false) {var if_res3575 = M0.input_port_p(buf5584);} else {var if_res3575 = false;}if (if_res3575!==false) {var if_res3576 = false(function(acc5639, new_start5640, new_end5641) {return loop5594(acc5639,new_start5640,new_end5641,ipre5632,_0_ok_p5638);},acc5595,start5596,end5597,m5631);} else {var if_res3576 = loop5594((function(start5642, ms5643, acc5644) {return M0.cons(sub5583(buf5584,start5642,M0.caar(ms5643)),acc5644);})(start5596,m5631,acc5595),mend5637,end5597,ipre5632,_0_ok_p5638);}var if_res3577 = if_res3576;}var if_res3578 = if_res3577;}return if_res3578;};return M0.reverse(loop5594($rjs_core.Pair.makeList(),start5579,end5580,ipre5581,true));};var cl3579 = function(pattern5645, string5646) {return regexp_split5571(pattern5645,string5646,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3580 = function(pattern5647, string5648, start5649, end5650, ipre295651) {return regexp_split5571(pattern5647,string5648,start5649,end5650,ipre295651);};var cl3581 = function(pattern5652, string5653, start5654, end285655) {return regexp_split5571(pattern5652,string5653,start5654,end285655,$rjs_core.Bytes.fromIntArray([]));};var cl3582 = function(pattern5656, string5657, start275658) {return regexp_split5571(pattern5656,string5657,start275658,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_split = $rjs_core.attachProcedureArity(function() {var fixed_lam3583 = {'2':cl3579,'5':cl3580,'4':cl3581,'3':cl3582}[arguments.length];if (fixed_lam3583!==undefined) {return fixed_lam3583.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]);var regexp_replace_times_5660 = function(pattern455661, string465662, orig_replacement475663, start425664, end435665, ipre445666) {var pattern5667 = pattern455661;var string5668 = string465662;var orig_replacement5669 = orig_replacement475663;if (false!==false) {var if_res3584 = 0;} else {var if_res3584 = start425664;}var start5670 = if_res3584;if (false!==false) {var if_res3585 = false;} else {var if_res3585 = end435665;}var end5671 = if_res3585;if (false!==false) {var if_res3586 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3586 = ipre445666;}var ipre5672 = if_res3586;var let_result3587 = get_buf_plus_sub(string5668,pattern5667);var buf5673 = let_result3587.getAt(0);var sub5674 = let_result3587.getAt(1);var or_part5676 = M0.string_p(pattern5667);if (or_part5676!==false) {var if_res3588 = or_part5676;} else {var if_res3588 = M0.regexp_p(pattern5667);}if (if_res3588!==false) {var if_res3589 = M0.string_p(string5668);} else {var if_res3589 = false;}var needs_string_p5675 = if_res3589;if (M0.not(needs_string_p5675)!==false) {var if_res3590 = M0.string_p(orig_replacement5669);} else {var if_res3590 = false;}if (if_res3590!==false) {var if_res3591 = M0.string__gt_bytes_by_utf_8(orig_replacement5669);} else {var if_res3591 = orig_replacement5669;}var replacement5677 = if_res3591;var check5678 = function(proc5679, args5680) {var v5681 = M0.apply(proc5679,args5680);if (needs_string_p5675!==false) {var if_res3592 = M0.string_p(v5681);} else {var if_res3592 = M0.bytes_p(v5681);}if (if_res3592!==false) {var if_res3595 = M0.rvoid();} else {var temp3594 = $rjs_core.PrimitiveSymbol.make("regexp-replace* (calling given filter procedure)");if (needs_string_p5675!==false) {var if_res3593 = $rjs_core.UString.make("expected a string result: ");} else {var if_res3593 = $rjs_core.UString.make("expected a byte string result: ");}var if_res3595 = M0.raise_mismatch_error(temp3594,if_res3593,v5681);}if_res3595;return v5681;};if (M0.not(M0.procedure_p(replacement5677))!==false) {var if_res3596 = M0.regexp_match_p($rjs_core.Regexp.fromString("[\\&]"),replacement5677);} else {var if_res3596 = false;}var need_replac_p5682 = if_res3596;var replac5683 = function(ms5684, str5685) {if (need_replac_p5682!==false) {if (M0.string_p(str5685)!==false) {var if_res3612 = M0.bytes__gt_string_by_utf_8;} else {var if_res3612 = M0.values;}if (M0.string_p(str5685)!==false) {var if_res3597 = M0.string__gt_bytes_by_utf_8(str5685);} else {var if_res3597 = str5685;}var str5686 = if_res3597;var get_match5687 = function(n5688) {if (M0.__lt_(n5688,M0.length(ms5684))!==false) {var p5689 = M0.list_ref(ms5684,n5688);if (M0.pair_p(p5689)!==false) {var if_res3598 = sub5674(buf5673,M0.car(p5689),M0.cdr(p5689));} else {var if_res3598 = p5689;}var s5690 = if_res3598;if (M0.string_p(s5690)!==false) {var if_res3599 = M0.string__gt_bytes_by_utf_8(s5690);} else {var if_res3599 = s5690;}var if_res3600 = if_res3599;} else {var if_res3600 = $rjs_core.Bytes.fromIntArray([]);}return if_res3600;};var loop5691 = function(pos5692) {var m5693 = M0.regexp_match_positions($rjs_core.Regexp.fromString("[\\&]"),str5686,pos5692);if (m5693!==false) {var temp3610 = M0.subbytes(str5686,pos5692,M0.caar(m5693));if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(38)),M0.bytes_ref(str5686,M0.caar(m5693)))!==false) {var if_res3609 = M0.cons(get_match5687(0),loop5691(M0.cdar(m5693)));} else {if (M0.__eq_(M0.cdar(m5693),M0.bytes_length(str5686))!==false) {var if_res3608 = M0.list(get_match5687(0));} else {var next5695 = M0.bytes_ref(str5686,M0.cdar(m5693));if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(38)),next5695)!==false) {var if_res3601 = $rjs_core.Bytes.fromIntArray([38]);} else {var if_res3601 = false;}var or_part5696 = if_res3601;if (or_part5696!==false) {var if_res3605 = or_part5696;} else {if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(92)),next5695)!==false) {var if_res3602 = $rjs_core.Bytes.fromIntArray([92]);} else {var if_res3602 = false;}var or_part5697 = if_res3602;if (or_part5697!==false) {var if_res3604 = or_part5697;} else {if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(36)),next5695)!==false) {var if_res3603 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3603 = false;}var if_res3604 = if_res3603;}var if_res3605 = if_res3604;}var c15694 = if_res3605;if (c15694!==false) {var if_res3607 = (function(s5698) {return M0.cons(s5698,loop5691(M0.add1(M0.cdar(m5693))));})(c15694);} else {var n5699 = M0.regexp_match($rjs_core.Regexp.fromString("^[0-9]+"),str5686,M0.cdar(m5693));if (n5699!==false) {var if_res3606 = M0.cons(get_match5687(M0.string__gt_number(M0.bytes__gt_string_by_utf_8(M0.car(n5699)))),loop5691(M0.cdar(m5693)+M0.bytes_length(M0.car(n5699))));} else {var if_res3606 = M0.cons(get_match5687(0),loop5691(M0.cdar(m5693)));}var if_res3607 = if_res3606;}var if_res3608 = if_res3607;}var if_res3609 = if_res3608;}var if_res3611 = M0.cons(temp3610,if_res3609);} else {var if_res3611 = M0.list(M0.subbytes(str5686,pos5692));}return if_res3611;};var if_res3613 = if_res3612(M0.apply(M0.bytes_append,loop5691(0)));} else {var if_res3613 = str5685;}return if_res3613;};var or_part5700 = M0.string_p(pattern5667);if (or_part5700!==false) {var if_res3616 = or_part5700;} else {var or_part5701 = M0.bytes_p(pattern5667);if (or_part5701!==false) {var if_res3615 = or_part5701;} else {var or_part5702 = M0.regexp_p(pattern5667);if (or_part5702!==false) {var if_res3614 = or_part5702;} else {var if_res3614 = M0.byte_regexp_p(pattern5667);}var if_res3615 = if_res3614;}var if_res3616 = if_res3615;}if (if_res3616!==false) {var or_part5703 = M0.string_p(string5668);if (or_part5703!==false) {var if_res3617 = or_part5703;} else {var if_res3617 = M0.bytes_p(string5668);}if (if_res3617!==false) {var if_res3618 = M0.rvoid();} else {var if_res3618 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c string? bytes?)"),string5668);}if_res3618;var or_part5704 = M0.string_p(replacement5677);if (or_part5704!==false) {var if_res3620 = or_part5704;} else {var or_part5705 = M0.bytes_p(replacement5677);if (or_part5705!==false) {var if_res3619 = or_part5705;} else {var if_res3619 = M0.procedure_p(replacement5677);}var if_res3620 = if_res3619;}if (if_res3620!==false) {var if_res3621 = M0.rvoid();} else {var if_res3621 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c string? bytes? procedure?)"),replacement5677);}if_res3621;if (needs_string_p5675!==false) {var if_res3622 = M0.bytes_p(replacement5677);} else {var if_res3622 = false;}if (if_res3622!==false) {var if_res3623 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("cannot replace a string with a byte string: "),replacement5677);} else {var if_res3623 = M0.rvoid();}var if_res3624 = if_res3623;} else {var if_res3624 = M0.rvoid();}if_res3624;var let_result3625 = M0.values();if (M0.path_p(buf5673)!==false) {var or_part5708 = M0.string_p(pattern5667);if (or_part5708!==false) {var if_res3626 = or_part5708;} else {var if_res3626 = M0.regexp_p(pattern5667);}if (if_res3626!==false) {var if_res3627 = M0.path__gt_string(buf5673);} else {var if_res3627 = M0.path__gt_bytes(buf5673);}var if_res3628 = if_res3627;} else {var if_res3628 = buf5673;}var buf5707 = if_res3628;if (M0.string_p(buf5707)!==false) {var if_res3630 = M0.string_length(buf5707);} else {if (M0.bytes_p(buf5707)!==false) {var if_res3629 = M0.bytes_length(buf5707);} else {var if_res3629 = false;}var if_res3630 = if_res3629;}var len5709 = if_res3630;if (M0.bytes_p(pattern5667)!==false) {var if_res3634 = M0.byte_regexp(pattern5667);} else {if (M0.string_p(pattern5667)!==false) {var if_res3633 = M0.regexp(pattern5667);} else {if (M0.regexp_p(pattern5667)!==false) {var if_res3632 = pattern5667;} else {if (M0.byte_regexp_p(pattern5667)!==false) {var if_res3631 = pattern5667;} else {var if_res3631 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5667);}var if_res3632 = if_res3631;}var if_res3633 = if_res3632;}var if_res3634 = if_res3633;}var orig_rx5710 = if_res3634;var max_lookbehind5711 = M0.regexp_max_lookbehind(orig_rx5710);if (false!==false) {if (M0.input_port_p(buf5707)!==false) {var if_res3635 = M0.rvoid();} else {var if_res3635 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("input-port?"),buf5707);}var if_res3638 = if_res3635;} else {var or_part5712 = len5709;if (or_part5712!==false) {var if_res3636 = or_part5712;} else {var if_res3636 = M0.input_port_p(buf5707);}if (if_res3636!==false) {var if_res3637 = M0.rvoid();} else {var if_res3637 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5707);}var if_res3638 = if_res3637;}if_res3638;if (M0.number_p(start5670)!==false) {if (M0.exact_p(start5670)!==false) {if (M0.integer_p(start5670)!==false) {var if_res3639 = M0.__gt__eq_(start5670,0);} else {var if_res3639 = false;}var if_res3640 = if_res3639;} else {var if_res3640 = false;}var if_res3641 = if_res3640;} else {var if_res3641 = false;}if (if_res3641!==false) {var if_res3642 = M0.rvoid();} else {var if_res3642 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5670);}if_res3642;var or_part5713 = M0.not(end5671);if (or_part5713!==false) {var if_res3646 = or_part5713;} else {if (M0.number_p(end5671)!==false) {if (M0.exact_p(end5671)!==false) {if (M0.integer_p(end5671)!==false) {var if_res3643 = M0.__gt__eq_(end5671,0);} else {var if_res3643 = false;}var if_res3644 = if_res3643;} else {var if_res3644 = false;}var if_res3645 = if_res3644;} else {var if_res3645 = false;}var if_res3646 = if_res3645;}if (if_res3646!==false) {var if_res3647 = M0.rvoid();} else {var if_res3647 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5671);}if_res3647;if (M0.bytes_p(ipre5672)!==false) {var if_res3648 = M0.rvoid();} else {var if_res3648 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("bytes?"),ipre5672);}if_res3648;var or_part5714 = M0.input_port_p(buf5707);if (or_part5714!==false) {var if_res3650 = or_part5714;} else {if (len5709!==false) {var if_res3649 = M0.__lt__eq_(start5670,len5709);} else {var if_res3649 = false;}var if_res3650 = if_res3649;}if (if_res3650!==false) {var if_res3651 = M0.rvoid();} else {var if_res3651 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5709),start5670);}if_res3651;var or_part5715 = M0.not(end5671);if (or_part5715!==false) {var if_res3655 = or_part5715;} else {if (M0.__lt__eq_(start5670,end5671)!==false) {var or_part5716 = M0.input_port_p(buf5707);if (or_part5716!==false) {var if_res3653 = or_part5716;} else {if (len5709!==false) {var if_res3652 = M0.__lt__eq_(end5671,len5709);} else {var if_res3652 = false;}var if_res3653 = if_res3652;}var if_res3654 = if_res3653;} else {var if_res3654 = false;}var if_res3655 = if_res3654;}if (if_res3655!==false) {var if_res3656 = M0.rvoid();} else {var if_res3656 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5670,len5709),end5671);}if_res3656;var loop5717 = function(acc5718, start5719, end5720, ipre5721, _0_ok_p5722) {if (_0_ok_p5722!==false) {var if_res3657 = orig_rx5710;} else {var if_res3657 = no_empty_edge_matches(orig_rx5710,M0.add1(M0.bytes_length(ipre5721)));}var rx5723 = if_res3657;if (false!==false) {var if_res3658 = M0.input_port_p(buf5707);} else {var if_res3658 = false;}if (if_res3658!==false) {if (M0.positive_p(start5719)!==false) {var s5725 = M0.make_bytes(4096);var loop5726 = function(n5727) {if (M0.__eq_(n5727,start5719)!==false) {var if_res3660 = M0.rvoid();} else {var m5728 = M0.read_bytes_avail_bang_(s5725,buf5707,0,M0.min(start5719-n5727,4096));if (M0.eof_object_p(m5728)!==false) {var if_res3659 = M0.rvoid();} else {var if_res3659 = loop5726(n5727+m5728);}var if_res3660 = if_res3659;}return if_res3660;};var if_res3661 = loop5726(0);} else {var if_res3661 = M0.rvoid();}var _5724 = if_res3661;if (true!==false) {var if_res3662 = false;} else {var if_res3662 = 0;}var discarded_by_leftovers5729 = if_res3662;if (true!==false) {var if_res3663 = M0.open_output_bytes();} else {var if_res3663 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5731, start5732, end5733, flush_p5734, breakable_p5735) {var c5736 = end5733-start5732;discarded_by_leftovers5729 = c5736+discarded_by_leftovers5729;return c5736;},M0.rvoid);}var spitout5730 = if_res3663;if (end5720!==false) {var if_res3664 = end5720-start5719;} else {var if_res3664 = false;}var end5737 = if_res3664;var let_result3665 = M0.regexp_match_by_end(rx5723,buf5707,0,end5737,spitout5730,ipre5721,max_lookbehind5711);var ms5738 = let_result3665.getAt(0);var ipre5739 = let_result3665.getAt(1);if (ms5738!==false) {var if_res3666 = M0.car(ms5738);} else {var if_res3666 = false;}var m5740 = if_res3666;if (true!==false) {var if_res3667 = M0.get_output_bytes(spitout5730);} else {var if_res3667 = discarded_by_leftovers5729;}var discarded_by_leftovers5741 = if_res3667;if (true!==false) {var if_res3668 = bstring_length(discarded_by_leftovers5741);} else {var if_res3668 = discarded_by_leftovers5741;}var skipped5742 = if_res3668;if (m5740!==false) {var if_res3669 = bstring_length(m5740);} else {var if_res3669 = false;}var got5743 = if_res3669;if (end5737!==false) {if (m5740!==false) {var if_res3670 = end5737-skipped5742-got5743;} else {var if_res3670 = false;}var if_res3671 = if_res3670;} else {var if_res3671 = false;}var end5744 = if_res3671;if (m5740!==false) {var _0_ok_p5745 = M0.not(M0.zero_p(got5743));var if_res3672 = loop5717(false(discarded_by_leftovers5741,ms5738,acc5718),0,end5744,ipre5739,_0_ok_p5745);} else {var if_res3672 = false(acc5718,discarded_by_leftovers5741);}var if_res3692 = if_res3672;} else {if (false!==false) {var if_res3673 = M0.regexp_match_peek_positions_by_end(rx5723,buf5707,start5719,end5720,false,ipre5721,max_lookbehind5711);} else {var if_res3673 = M0.regexp_match_positions_by_end(rx5723,buf5707,start5719,end5720,false,ipre5721,max_lookbehind5711);}var let_result3674 = if_res3673;var m5746 = let_result3674.getAt(0);var ipre5747 = let_result3674.getAt(1);if (M0.not(m5746)!==false) {var if_res3691 = (function(acc5748, start5749, end5750) {if (end5750!==false) {var if_res3675 = sub5674(buf5707,start5749,end5750);} else {var if_res3675 = sub5674(buf5707,start5749);}return M0.cons(if_res3675,acc5748);})(acc5718,start5719,end5720);} else {var mstart5751 = M0.caar(m5746);var mend5752 = M0.cdar(m5746);var _0_ok_p5753 = M0.not(M0.__eq_(mstart5751,mend5752));if (false!==false) {var if_res3676 = M0.input_port_p(buf5707);} else {var if_res3676 = false;}if (if_res3676!==false) {var if_res3690 = false(function(acc5754, new_start5755, new_end5756) {return loop5717(acc5754,new_start5755,new_end5756,ipre5747,_0_ok_p5753);},acc5718,start5719,end5720,m5746);} else {var if_res3690 = loop5717((function(start5757, ms5758, acc5759) {if (M0.procedure_p(replacement5677)!==false) {var let_result3677 = M5.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("m")),ms5758);var pos__gt_vals5760 = let_result3677.getAt(0);var pos_pre_inc5761 = let_result3677.getAt(1);var pos_next5762 = let_result3677.getAt(2);var init5763 = let_result3677.getAt(3);var pos_cont_p5764 = let_result3677.getAt(4);var val_cont_p5765 = let_result3677.getAt(5);var all_cont_p5766 = let_result3677.getAt(6);M0.rvoid();var for_loop5767 = function(fold_var5768, pos5769) {if (pos_cont_p5764!==false) {var if_res3678 = pos_cont_p5764(pos5769);} else {var if_res3678 = true;}if (if_res3678!==false) {var m5773 = pos__gt_vals5760(pos5769);if (all_cont_p5766!==false) {var if_res3679 = function(pos5774) {return all_cont_p5766(pos5774,m5773);};} else {var if_res3679 = false;}var let_result3680 = M0.values(m5773,if_res3679);var m5770 = let_result3680.getAt(0);var all_cont_p_by_pos5771 = let_result3680.getAt(1);if (pos_pre_inc5761!==false) {var if_res3681 = pos_pre_inc5761(pos5769);} else {var if_res3681 = pos5769;}var pos5772 = if_res3681;if (val_cont_p5765!==false) {var if_res3682 = val_cont_p5765(m5770);} else {var if_res3682 = true;}if (if_res3682!==false) {var fold_var5776 = fold_var5768;if (m5770!==false) {var if_res3683 = sub5674(buf5707,M0.car(m5770),M0.cdr(m5770));} else {var if_res3683 = false;}var fold_var5777 = M0.cons(if_res3683,fold_var5776);var fold_var5775 = M0.values(fold_var5777);if (all_cont_p_by_pos5771!==false) {var if_res3684 = all_cont_p_by_pos5771(pos5772);} else {var if_res3684 = true;}if (if_res3684!==false) {var if_res3685 = M0.not(false);} else {var if_res3685 = false;}if (if_res3685!==false) {var if_res3686 = for_loop5767(fold_var5775,pos_next5762(pos5772));} else {var if_res3686 = fold_var5775;}var if_res3687 = if_res3686;} else {var if_res3687 = fold_var5768;}var if_res3688 = if_res3687;} else {var if_res3688 = fold_var5768;}return if_res3688;};var if_res3689 = check5678(replacement5677,M4.alt_reverse(for_loop5767(M0.rnull,init5763)));} else {var if_res3689 = replac5683(ms5758,replacement5677);}return M0.list_times_(if_res3689,sub5674(buf5707,start5757,M0.caar(ms5758)),acc5759);})(start5719,m5746,acc5718),mend5752,end5720,ipre5747,_0_ok_p5753);}var if_res3691 = if_res3690;}var if_res3692 = if_res3691;}return if_res3692;};var r5706 = M0.reverse(loop5717($rjs_core.Pair.makeList(),start5670,end5671,ipre5672,true));if (M0.bytes_p(buf5673)!==false) {var if_res3696 = M0.bytes_append;} else {var if_res3696 = M0.string_append;}if (M0.__eq_(start5670,0)!==false) {var if_res3693 = M0.not(end5671);} else {var if_res3693 = false;}if (if_res3693!==false) {var if_res3695 = r5706;} else {if (M0.not(end5671)!==false) {var if_res3694 = M0.cons(sub5674(string5668,0,start5670),r5706);} else {var if_res3694 = M0.list_times_(sub5674(string5668,0,start5670),M3.__rjs_quoted__.qq_append(r5706,M0.list(sub5674(string5668,end5671))));}var if_res3695 = if_res3694;}return M0.apply(if_res3696,if_res3695);};var cl3697 = function(pattern5778, string5779, orig_replacement5780) {return regexp_replace_times_5660(pattern5778,string5779,orig_replacement5780,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3698 = function(pattern5781, string5782, orig_replacement5783, start5784, end5785, ipre445786) {return regexp_replace_times_5660(pattern5781,string5782,orig_replacement5783,start5784,end5785,ipre445786);};var cl3699 = function(pattern5787, string5788, orig_replacement5789, start5790, end435791) {return regexp_replace_times_5660(pattern5787,string5788,orig_replacement5789,start5790,end435791,$rjs_core.Bytes.fromIntArray([]));};var cl3700 = function(pattern5792, string5793, orig_replacement5794, start425795) {return regexp_replace_times_5660(pattern5792,string5793,orig_replacement5794,start425795,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_replace_times_5659 = $rjs_core.attachProcedureArity(function() {var fixed_lam3701 = {'3':cl3697,'6':cl3698,'5':cl3699,'4':cl3700}[arguments.length];if (fixed_lam3701!==undefined) {return fixed_lam3701.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4,5,6]);var __regexp_replace_times_ = regexp_replace_times_5659;var regexp_match_times_ = function(gap_select_p335796, match_select325797, pattern395798, string405799, start365800, end375801, ipre385802) {var pattern5803 = pattern395798;var string5804 = string405799;if (false!==false) {var if_res3702 = 0;} else {var if_res3702 = start365800;}var start5805 = if_res3702;if (false!==false) {var if_res3703 = false;} else {var if_res3703 = end375801;}var end5806 = if_res3703;if (false!==false) {var if_res3704 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3704 = ipre385802;}var ipre5807 = if_res3704;if (M0.eq_p(match_select325797,M7.unsafe_undefined)!==false) {var if_res3705 = M0.car;} else {var if_res3705 = match_select325797;}var match_select5808 = if_res3705;if (false!==false) {var if_res3706 = false;} else {var if_res3706 = gap_select_p335796;}var gap_select5809 = if_res3706;if (M0.not(match_select5808)!==false) {var if_res3707 = M0.not(gap_select5809);} else {var if_res3707 = false;}if (if_res3707!==false) {var if_res3888 = M0.raise(M0.__rjs_quoted__.exn_fail_contract($rjs_core.UString.make("regexp-match*: one of `match-select' or `gap-select' must be non-#f"),M0.current_continuation_marks()));} else {if (M0.not(match_select5808)!==false) {var if_res3887 = regexp_split(pattern5803,string5804,start5805,end5806,ipre5807);} else {if (M0.not(M0.procedure_p(match_select5808))!==false) {var if_res3886 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c procedure? #f)"),match_select5808);} else {if (M0.not(M0.eq_p(match_select5808,M0.car))!==false) {var let_result3708 = get_buf_plus_sub(string5804,pattern5803);var buf5810 = let_result3708.getAt(0);var sub5811 = let_result3708.getAt(1);if (M0.path_p(buf5810)!==false) {var or_part5813 = M0.string_p(pattern5803);if (or_part5813!==false) {var if_res3709 = or_part5813;} else {var if_res3709 = M0.regexp_p(pattern5803);}if (if_res3709!==false) {var if_res3710 = M0.path__gt_string(buf5810);} else {var if_res3710 = M0.path__gt_bytes(buf5810);}var if_res3711 = if_res3710;} else {var if_res3711 = buf5810;}var buf5812 = if_res3711;if (M0.string_p(buf5812)!==false) {var if_res3713 = M0.string_length(buf5812);} else {if (M0.bytes_p(buf5812)!==false) {var if_res3712 = M0.bytes_length(buf5812);} else {var if_res3712 = false;}var if_res3713 = if_res3712;}var len5814 = if_res3713;if (M0.bytes_p(pattern5803)!==false) {var if_res3717 = M0.byte_regexp(pattern5803);} else {if (M0.string_p(pattern5803)!==false) {var if_res3716 = M0.regexp(pattern5803);} else {if (M0.regexp_p(pattern5803)!==false) {var if_res3715 = pattern5803;} else {if (M0.byte_regexp_p(pattern5803)!==false) {var if_res3714 = pattern5803;} else {var if_res3714 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5803);}var if_res3715 = if_res3714;}var if_res3716 = if_res3715;}var if_res3717 = if_res3716;}var orig_rx5815 = if_res3717;var max_lookbehind5816 = M0.regexp_max_lookbehind(orig_rx5815);if (false!==false) {if (M0.input_port_p(buf5812)!==false) {var if_res3718 = M0.rvoid();} else {var if_res3718 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("input-port?"),buf5812);}var if_res3721 = if_res3718;} else {var or_part5817 = len5814;if (or_part5817!==false) {var if_res3719 = or_part5817;} else {var if_res3719 = M0.input_port_p(buf5812);}if (if_res3719!==false) {var if_res3720 = M0.rvoid();} else {var if_res3720 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5812);}var if_res3721 = if_res3720;}if_res3721;if (M0.number_p(start5805)!==false) {if (M0.exact_p(start5805)!==false) {if (M0.integer_p(start5805)!==false) {var if_res3722 = M0.__gt__eq_(start5805,0);} else {var if_res3722 = false;}var if_res3723 = if_res3722;} else {var if_res3723 = false;}var if_res3724 = if_res3723;} else {var if_res3724 = false;}if (if_res3724!==false) {var if_res3725 = M0.rvoid();} else {var if_res3725 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5805);}if_res3725;var or_part5818 = M0.not(end5806);if (or_part5818!==false) {var if_res3729 = or_part5818;} else {if (M0.number_p(end5806)!==false) {if (M0.exact_p(end5806)!==false) {if (M0.integer_p(end5806)!==false) {var if_res3726 = M0.__gt__eq_(end5806,0);} else {var if_res3726 = false;}var if_res3727 = if_res3726;} else {var if_res3727 = false;}var if_res3728 = if_res3727;} else {var if_res3728 = false;}var if_res3729 = if_res3728;}if (if_res3729!==false) {var if_res3730 = M0.rvoid();} else {var if_res3730 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5806);}if_res3730;if (M0.bytes_p(ipre5807)!==false) {var if_res3731 = M0.rvoid();} else {var if_res3731 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("bytes?"),ipre5807);}if_res3731;var or_part5819 = M0.input_port_p(buf5812);if (or_part5819!==false) {var if_res3733 = or_part5819;} else {if (len5814!==false) {var if_res3732 = M0.__lt__eq_(start5805,len5814);} else {var if_res3732 = false;}var if_res3733 = if_res3732;}if (if_res3733!==false) {var if_res3734 = M0.rvoid();} else {var if_res3734 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5814),start5805);}if_res3734;var or_part5820 = M0.not(end5806);if (or_part5820!==false) {var if_res3738 = or_part5820;} else {if (M0.__lt__eq_(start5805,end5806)!==false) {var or_part5821 = M0.input_port_p(buf5812);if (or_part5821!==false) {var if_res3736 = or_part5821;} else {if (len5814!==false) {var if_res3735 = M0.__lt__eq_(end5806,len5814);} else {var if_res3735 = false;}var if_res3736 = if_res3735;}var if_res3737 = if_res3736;} else {var if_res3737 = false;}var if_res3738 = if_res3737;}if (if_res3738!==false) {var if_res3739 = M0.rvoid();} else {var if_res3739 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5805,len5814),end5806);}if_res3739;var loop5822 = function(acc5823, start5824, end5825, ipre5826, _0_ok_p5827) {if (_0_ok_p5827!==false) {var if_res3740 = orig_rx5815;} else {var if_res3740 = no_empty_edge_matches(orig_rx5815,M0.add1(M0.bytes_length(ipre5826)));}var rx5828 = if_res3740;if (function(leftovers5829, ms5830, acc5831) {var temp3742 = match_select5808(ms5830);if (gap_select5809!==false) {var if_res3741 = M0.cons(leftovers5829,acc5831);} else {var if_res3741 = acc5831;}return M0.cons(temp3742,if_res3741);}!==false) {var if_res3743 = M0.input_port_p(buf5812);} else {var if_res3743 = false;}if (if_res3743!==false) {if (M0.positive_p(start5824)!==false) {var s5833 = M0.make_bytes(4096);var loop5834 = function(n5835) {if (M0.__eq_(n5835,start5824)!==false) {var if_res3745 = M0.rvoid();} else {var m5836 = M0.read_bytes_avail_bang_(s5833,buf5812,0,M0.min(start5824-n5835,4096));if (M0.eof_object_p(m5836)!==false) {var if_res3744 = M0.rvoid();} else {var if_res3744 = loop5834(n5835+m5836);}var if_res3745 = if_res3744;}return if_res3745;};var if_res3746 = loop5834(0);} else {var if_res3746 = M0.rvoid();}var _5832 = if_res3746;if (gap_select5809!==false) {var if_res3747 = false;} else {var if_res3747 = 0;}var discarded_by_leftovers5837 = if_res3747;if (gap_select5809!==false) {var if_res3748 = M0.open_output_bytes();} else {var if_res3748 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5839, start5840, end5841, flush_p5842, breakable_p5843) {var c5844 = end5841-start5840;discarded_by_leftovers5837 = c5844+discarded_by_leftovers5837;return c5844;},M0.rvoid);}var spitout5838 = if_res3748;if (end5825!==false) {var if_res3749 = end5825-start5824;} else {var if_res3749 = false;}var end5845 = if_res3749;var let_result3750 = M0.regexp_match_by_end(rx5828,buf5812,0,end5845,spitout5838,ipre5826,max_lookbehind5816);var ms5846 = let_result3750.getAt(0);var ipre5847 = let_result3750.getAt(1);if (ms5846!==false) {var if_res3751 = M0.car(ms5846);} else {var if_res3751 = false;}var m5848 = if_res3751;if (gap_select5809!==false) {var if_res3752 = M0.get_output_bytes(spitout5838);} else {var if_res3752 = discarded_by_leftovers5837;}var discarded_by_leftovers5849 = if_res3752;if (gap_select5809!==false) {var if_res3753 = bstring_length(discarded_by_leftovers5849);} else {var if_res3753 = discarded_by_leftovers5849;}var skipped5850 = if_res3753;if (m5848!==false) {var if_res3754 = bstring_length(m5848);} else {var if_res3754 = false;}var got5851 = if_res3754;if (end5845!==false) {if (m5848!==false) {var if_res3755 = end5845-skipped5850-got5851;} else {var if_res3755 = false;}var if_res3756 = if_res3755;} else {var if_res3756 = false;}var end5852 = if_res3756;if (m5848!==false) {var _0_ok_p5853 = M0.not(M0.zero_p(got5851));var if_res3761 = loop5822((function(leftovers5854, ms5855, acc5856) {var temp3758 = match_select5808(ms5855);if (gap_select5809!==false) {var if_res3757 = M0.cons(leftovers5854,acc5856);} else {var if_res3757 = acc5856;}return M0.cons(temp3758,if_res3757);})(discarded_by_leftovers5849,ms5846,acc5823),0,end5852,ipre5847,_0_ok_p5853);} else {var if_res3761 = (function(acc5857, leftover5858) {if (gap_select5809!==false) {var if_res3759 = leftover5858;} else {var if_res3759 = false;}if (if_res3759!==false) {var if_res3760 = M0.cons(leftover5858,acc5857);} else {var if_res3760 = acc5857;}return if_res3760;})(acc5823,discarded_by_leftovers5849);}var if_res3773 = if_res3761;} else {if (false!==false) {var if_res3762 = M0.regexp_match_peek_positions_by_end(rx5828,buf5812,start5824,end5825,false,ipre5826,max_lookbehind5816);} else {var if_res3762 = M0.regexp_match_positions_by_end(rx5828,buf5812,start5824,end5825,false,ipre5826,max_lookbehind5816);}var let_result3763 = if_res3762;var m5859 = let_result3763.getAt(0);var ipre5860 = let_result3763.getAt(1);if (M0.not(m5859)!==false) {var if_res3772 = (function(acc5861, start5862, end5863) {if (gap_select5809!==false) {if (end5863!==false) {var if_res3764 = sub5811(buf5812,start5862,end5863);} else {var if_res3764 = sub5811(buf5812,start5862);}var if_res3765 = M0.cons(if_res3764,acc5861);} else {var if_res3765 = acc5861;}return if_res3765;})(acc5823,start5824,end5825);} else {var mstart5864 = M0.caar(m5859);var mend5865 = M0.cdar(m5859);var _0_ok_p5866 = M0.not(M0.__eq_(mstart5864,mend5865));if (false!==false) {var if_res3766 = M0.input_port_p(buf5812);} else {var if_res3766 = false;}if (if_res3766!==false) {var if_res3771 = false(function(acc5867, new_start5868, new_end5869) {return loop5822(acc5867,new_start5868,new_end5869,ipre5860,_0_ok_p5866);},acc5823,start5824,end5825,m5859);} else {var if_res3771 = loop5822((function(start5870, ms5871, acc5872) {var s5873 = match_select5808(ms5871);if (M0.not(M0.pair_p(s5873))!==false) {var if_res3770 = s5873;} else {if (M0.integer_p(M0.car(s5873))!==false) {var if_res3769 = sub5811(buf5812,M0.car(s5873),M0.cdr(s5873));} else {var if_res3769 = M1.map(function(m5874) {if (m5874!==false) {var if_res3768 = sub5811(buf5812,M0.car(m5874),M0.cdr(m5874));} else {var if_res3768 = false;}return if_res3768;},s5873);}var if_res3770 = if_res3769;}if (gap_select5809!==false) {var if_res3767 = M0.cons(sub5811(buf5812,start5870,M0.caar(ms5871)),acc5872);} else {var if_res3767 = acc5872;}return M0.cons(if_res3770,if_res3767);})(start5824,m5859,acc5823),mend5865,end5825,ipre5860,_0_ok_p5866);}var if_res3772 = if_res3771;}var if_res3773 = if_res3772;}return if_res3773;};var if_res3885 = M0.reverse(loop5822($rjs_core.Pair.makeList(),start5805,end5806,ipre5807,true));} else {if (gap_select5809!==false) {var let_result3774 = get_buf_plus_sub(string5804,pattern5803);var buf5875 = let_result3774.getAt(0);var sub5876 = let_result3774.getAt(1);if (M0.path_p(buf5875)!==false) {var or_part5878 = M0.string_p(pattern5803);if (or_part5878!==false) {var if_res3775 = or_part5878;} else {var if_res3775 = M0.regexp_p(pattern5803);}if (if_res3775!==false) {var if_res3776 = M0.path__gt_string(buf5875);} else {var if_res3776 = M0.path__gt_bytes(buf5875);}var if_res3777 = if_res3776;} else {var if_res3777 = buf5875;}var buf5877 = if_res3777;if (M0.string_p(buf5877)!==false) {var if_res3779 = M0.string_length(buf5877);} else {if (M0.bytes_p(buf5877)!==false) {var if_res3778 = M0.bytes_length(buf5877);} else {var if_res3778 = false;}var if_res3779 = if_res3778;}var len5879 = if_res3779;if (M0.bytes_p(pattern5803)!==false) {var if_res3783 = M0.byte_regexp(pattern5803);} else {if (M0.string_p(pattern5803)!==false) {var if_res3782 = M0.regexp(pattern5803);} else {if (M0.regexp_p(pattern5803)!==false) {var if_res3781 = pattern5803;} else {if (M0.byte_regexp_p(pattern5803)!==false) {var if_res3780 = pattern5803;} else {var if_res3780 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5803);}var if_res3781 = if_res3780;}var if_res3782 = if_res3781;}var if_res3783 = if_res3782;}var orig_rx5880 = if_res3783;var max_lookbehind5881 = M0.regexp_max_lookbehind(orig_rx5880);if (false!==false) {if (M0.input_port_p(buf5877)!==false) {var if_res3784 = M0.rvoid();} else {var if_res3784 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("input-port?"),buf5877);}var if_res3787 = if_res3784;} else {var or_part5882 = len5879;if (or_part5882!==false) {var if_res3785 = or_part5882;} else {var if_res3785 = M0.input_port_p(buf5877);}if (if_res3785!==false) {var if_res3786 = M0.rvoid();} else {var if_res3786 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5877);}var if_res3787 = if_res3786;}if_res3787;if (M0.number_p(start5805)!==false) {if (M0.exact_p(start5805)!==false) {if (M0.integer_p(start5805)!==false) {var if_res3788 = M0.__gt__eq_(start5805,0);} else {var if_res3788 = false;}var if_res3789 = if_res3788;} else {var if_res3789 = false;}var if_res3790 = if_res3789;} else {var if_res3790 = false;}if (if_res3790!==false) {var if_res3791 = M0.rvoid();} else {var if_res3791 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5805);}if_res3791;var or_part5883 = M0.not(end5806);if (or_part5883!==false) {var if_res3795 = or_part5883;} else {if (M0.number_p(end5806)!==false) {if (M0.exact_p(end5806)!==false) {if (M0.integer_p(end5806)!==false) {var if_res3792 = M0.__gt__eq_(end5806,0);} else {var if_res3792 = false;}var if_res3793 = if_res3792;} else {var if_res3793 = false;}var if_res3794 = if_res3793;} else {var if_res3794 = false;}var if_res3795 = if_res3794;}if (if_res3795!==false) {var if_res3796 = M0.rvoid();} else {var if_res3796 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5806);}if_res3796;if (M0.bytes_p(ipre5807)!==false) {var if_res3797 = M0.rvoid();} else {var if_res3797 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("bytes?"),ipre5807);}if_res3797;var or_part5884 = M0.input_port_p(buf5877);if (or_part5884!==false) {var if_res3799 = or_part5884;} else {if (len5879!==false) {var if_res3798 = M0.__lt__eq_(start5805,len5879);} else {var if_res3798 = false;}var if_res3799 = if_res3798;}if (if_res3799!==false) {var if_res3800 = M0.rvoid();} else {var if_res3800 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5879),start5805);}if_res3800;var or_part5885 = M0.not(end5806);if (or_part5885!==false) {var if_res3804 = or_part5885;} else {if (M0.__lt__eq_(start5805,end5806)!==false) {var or_part5886 = M0.input_port_p(buf5877);if (or_part5886!==false) {var if_res3802 = or_part5886;} else {if (len5879!==false) {var if_res3801 = M0.__lt__eq_(end5806,len5879);} else {var if_res3801 = false;}var if_res3802 = if_res3801;}var if_res3803 = if_res3802;} else {var if_res3803 = false;}var if_res3804 = if_res3803;}if (if_res3804!==false) {var if_res3805 = M0.rvoid();} else {var if_res3805 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5805,len5879),end5806);}if_res3805;var loop5887 = function(acc5888, start5889, end5890, ipre5891, _0_ok_p5892) {if (_0_ok_p5892!==false) {var if_res3806 = orig_rx5880;} else {var if_res3806 = no_empty_edge_matches(orig_rx5880,M0.add1(M0.bytes_length(ipre5891)));}var rx5893 = if_res3806;if (function(leftovers5894, ms5895, acc5896) {return M0.cons(M0.car(ms5895),M0.cons(leftovers5894,acc5896));}!==false) {var if_res3807 = M0.input_port_p(buf5877);} else {var if_res3807 = false;}if (if_res3807!==false) {if (M0.positive_p(start5889)!==false) {var s5898 = M0.make_bytes(4096);var loop5899 = function(n5900) {if (M0.__eq_(n5900,start5889)!==false) {var if_res3809 = M0.rvoid();} else {var m5901 = M0.read_bytes_avail_bang_(s5898,buf5877,0,M0.min(start5889-n5900,4096));if (M0.eof_object_p(m5901)!==false) {var if_res3808 = M0.rvoid();} else {var if_res3808 = loop5899(n5900+m5901);}var if_res3809 = if_res3808;}return if_res3809;};var if_res3810 = loop5899(0);} else {var if_res3810 = M0.rvoid();}var _5897 = if_res3810;if (gap_select5809!==false) {var if_res3811 = false;} else {var if_res3811 = 0;}var discarded_by_leftovers5902 = if_res3811;if (gap_select5809!==false) {var if_res3812 = M0.open_output_bytes();} else {var if_res3812 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5904, start5905, end5906, flush_p5907, breakable_p5908) {var c5909 = end5906-start5905;discarded_by_leftovers5902 = c5909+discarded_by_leftovers5902;return c5909;},M0.rvoid);}var spitout5903 = if_res3812;if (end5890!==false) {var if_res3813 = end5890-start5889;} else {var if_res3813 = false;}var end5910 = if_res3813;var let_result3814 = M0.regexp_match_by_end(rx5893,buf5877,0,end5910,spitout5903,ipre5891,max_lookbehind5881);var ms5911 = let_result3814.getAt(0);var ipre5912 = let_result3814.getAt(1);if (ms5911!==false) {var if_res3815 = M0.car(ms5911);} else {var if_res3815 = false;}var m5913 = if_res3815;if (gap_select5809!==false) {var if_res3816 = M0.get_output_bytes(spitout5903);} else {var if_res3816 = discarded_by_leftovers5902;}var discarded_by_leftovers5914 = if_res3816;if (gap_select5809!==false) {var if_res3817 = bstring_length(discarded_by_leftovers5914);} else {var if_res3817 = discarded_by_leftovers5914;}var skipped5915 = if_res3817;if (m5913!==false) {var if_res3818 = bstring_length(m5913);} else {var if_res3818 = false;}var got5916 = if_res3818;if (end5910!==false) {if (m5913!==false) {var if_res3819 = end5910-skipped5915-got5916;} else {var if_res3819 = false;}var if_res3820 = if_res3819;} else {var if_res3820 = false;}var end5917 = if_res3820;if (m5913!==false) {var _0_ok_p5918 = M0.not(M0.zero_p(got5916));var if_res3822 = loop5887((function(leftovers5919, ms5920, acc5921) {return M0.cons(M0.car(ms5920),M0.cons(leftovers5919,acc5921));})(discarded_by_leftovers5914,ms5911,acc5888),0,end5917,ipre5912,_0_ok_p5918);} else {var if_res3822 = (function(acc5922, leftover5923) {if (leftover5923!==false) {var if_res3821 = M0.cons(leftover5923,acc5922);} else {var if_res3821 = acc5922;}return if_res3821;})(acc5888,discarded_by_leftovers5914);}var if_res3829 = if_res3822;} else {if (false!==false) {var if_res3823 = M0.regexp_match_peek_positions_by_end(rx5893,buf5877,start5889,end5890,false,ipre5891,max_lookbehind5881);} else {var if_res3823 = M0.regexp_match_positions_by_end(rx5893,buf5877,start5889,end5890,false,ipre5891,max_lookbehind5881);}var let_result3824 = if_res3823;var m5924 = let_result3824.getAt(0);var ipre5925 = let_result3824.getAt(1);if (M0.not(m5924)!==false) {var if_res3828 = (function(acc5926, start5927, end5928) {if (end5928!==false) {var if_res3825 = sub5876(buf5877,start5927,end5928);} else {var if_res3825 = sub5876(buf5877,start5927);}return M0.cons(if_res3825,acc5926);})(acc5888,start5889,end5890);} else {var mstart5929 = M0.caar(m5924);var mend5930 = M0.cdar(m5924);var _0_ok_p5931 = M0.not(M0.__eq_(mstart5929,mend5930));if (false!==false) {var if_res3826 = M0.input_port_p(buf5877);} else {var if_res3826 = false;}if (if_res3826!==false) {var if_res3827 = false(function(acc5932, new_start5933, new_end5934) {return loop5887(acc5932,new_start5933,new_end5934,ipre5925,_0_ok_p5931);},acc5888,start5889,end5890,m5924);} else {var if_res3827 = loop5887((function(start5935, ms5936, acc5937) {return M0.cons(sub5876(buf5877,M0.caar(ms5936),M0.cdar(ms5936)),M0.cons(sub5876(buf5877,start5935,M0.caar(ms5936)),acc5937));})(start5889,m5924,acc5888),mend5930,end5890,ipre5925,_0_ok_p5931);}var if_res3828 = if_res3827;}var if_res3829 = if_res3828;}return if_res3829;};var if_res3884 = M0.reverse(loop5887($rjs_core.Pair.makeList(),start5805,end5806,ipre5807,true));} else {var let_result3830 = get_buf_plus_sub(string5804,pattern5803);var buf5938 = let_result3830.getAt(0);var sub5939 = let_result3830.getAt(1);if (M0.path_p(buf5938)!==false) {var or_part5941 = M0.string_p(pattern5803);if (or_part5941!==false) {var if_res3831 = or_part5941;} else {var if_res3831 = M0.regexp_p(pattern5803);}if (if_res3831!==false) {var if_res3832 = M0.path__gt_string(buf5938);} else {var if_res3832 = M0.path__gt_bytes(buf5938);}var if_res3833 = if_res3832;} else {var if_res3833 = buf5938;}var buf5940 = if_res3833;if (M0.string_p(buf5940)!==false) {var if_res3835 = M0.string_length(buf5940);} else {if (M0.bytes_p(buf5940)!==false) {var if_res3834 = M0.bytes_length(buf5940);} else {var if_res3834 = false;}var if_res3835 = if_res3834;}var len5942 = if_res3835;if (M0.bytes_p(pattern5803)!==false) {var if_res3839 = M0.byte_regexp(pattern5803);} else {if (M0.string_p(pattern5803)!==false) {var if_res3838 = M0.regexp(pattern5803);} else {if (M0.regexp_p(pattern5803)!==false) {var if_res3837 = pattern5803;} else {if (M0.byte_regexp_p(pattern5803)!==false) {var if_res3836 = pattern5803;} else {var if_res3836 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5803);}var if_res3837 = if_res3836;}var if_res3838 = if_res3837;}var if_res3839 = if_res3838;}var orig_rx5943 = if_res3839;var max_lookbehind5944 = M0.regexp_max_lookbehind(orig_rx5943);if (false!==false) {if (M0.input_port_p(buf5940)!==false) {var if_res3840 = M0.rvoid();} else {var if_res3840 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("input-port?"),buf5940);}var if_res3843 = if_res3840;} else {var or_part5945 = len5942;if (or_part5945!==false) {var if_res3841 = or_part5945;} else {var if_res3841 = M0.input_port_p(buf5940);}if (if_res3841!==false) {var if_res3842 = M0.rvoid();} else {var if_res3842 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5940);}var if_res3843 = if_res3842;}if_res3843;if (M0.number_p(start5805)!==false) {if (M0.exact_p(start5805)!==false) {if (M0.integer_p(start5805)!==false) {var if_res3844 = M0.__gt__eq_(start5805,0);} else {var if_res3844 = false;}var if_res3845 = if_res3844;} else {var if_res3845 = false;}var if_res3846 = if_res3845;} else {var if_res3846 = false;}if (if_res3846!==false) {var if_res3847 = M0.rvoid();} else {var if_res3847 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5805);}if_res3847;var or_part5946 = M0.not(end5806);if (or_part5946!==false) {var if_res3851 = or_part5946;} else {if (M0.number_p(end5806)!==false) {if (M0.exact_p(end5806)!==false) {if (M0.integer_p(end5806)!==false) {var if_res3848 = M0.__gt__eq_(end5806,0);} else {var if_res3848 = false;}var if_res3849 = if_res3848;} else {var if_res3849 = false;}var if_res3850 = if_res3849;} else {var if_res3850 = false;}var if_res3851 = if_res3850;}if (if_res3851!==false) {var if_res3852 = M0.rvoid();} else {var if_res3852 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5806);}if_res3852;if (M0.bytes_p(ipre5807)!==false) {var if_res3853 = M0.rvoid();} else {var if_res3853 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("bytes?"),ipre5807);}if_res3853;var or_part5947 = M0.input_port_p(buf5940);if (or_part5947!==false) {var if_res3855 = or_part5947;} else {if (len5942!==false) {var if_res3854 = M0.__lt__eq_(start5805,len5942);} else {var if_res3854 = false;}var if_res3855 = if_res3854;}if (if_res3855!==false) {var if_res3856 = M0.rvoid();} else {var if_res3856 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5942),start5805);}if_res3856;var or_part5948 = M0.not(end5806);if (or_part5948!==false) {var if_res3860 = or_part5948;} else {if (M0.__lt__eq_(start5805,end5806)!==false) {var or_part5949 = M0.input_port_p(buf5940);if (or_part5949!==false) {var if_res3858 = or_part5949;} else {if (len5942!==false) {var if_res3857 = M0.__lt__eq_(end5806,len5942);} else {var if_res3857 = false;}var if_res3858 = if_res3857;}var if_res3859 = if_res3858;} else {var if_res3859 = false;}var if_res3860 = if_res3859;}if (if_res3860!==false) {var if_res3861 = M0.rvoid();} else {var if_res3861 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5805,len5942),end5806);}if_res3861;var loop5950 = function(acc5951, start5952, end5953, ipre5954, _0_ok_p5955) {if (_0_ok_p5955!==false) {var if_res3862 = orig_rx5943;} else {var if_res3862 = no_empty_edge_matches(orig_rx5943,M0.add1(M0.bytes_length(ipre5954)));}var rx5956 = if_res3862;if (function(leftovers5957, ms5958, acc5959) {return M0.cons(M0.car(ms5958),acc5959);}!==false) {var if_res3863 = M0.input_port_p(buf5940);} else {var if_res3863 = false;}if (if_res3863!==false) {if (M0.positive_p(start5952)!==false) {var s5961 = M0.make_bytes(4096);var loop5962 = function(n5963) {if (M0.__eq_(n5963,start5952)!==false) {var if_res3865 = M0.rvoid();} else {var m5964 = M0.read_bytes_avail_bang_(s5961,buf5940,0,M0.min(start5952-n5963,4096));if (M0.eof_object_p(m5964)!==false) {var if_res3864 = M0.rvoid();} else {var if_res3864 = loop5962(n5963+m5964);}var if_res3865 = if_res3864;}return if_res3865;};var if_res3866 = loop5962(0);} else {var if_res3866 = M0.rvoid();}var _5960 = if_res3866;if (false!==false) {var if_res3867 = false;} else {var if_res3867 = 0;}var discarded_by_leftovers5965 = if_res3867;if (false!==false) {var if_res3868 = M0.open_output_bytes();} else {var if_res3868 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5967, start5968, end5969, flush_p5970, breakable_p5971) {var c5972 = end5969-start5968;discarded_by_leftovers5965 = c5972+discarded_by_leftovers5965;return c5972;},M0.rvoid);}var spitout5966 = if_res3868;if (end5953!==false) {var if_res3869 = end5953-start5952;} else {var if_res3869 = false;}var end5973 = if_res3869;var let_result3870 = M0.regexp_match_by_end(rx5956,buf5940,0,end5973,spitout5966,ipre5954,max_lookbehind5944);var ms5974 = let_result3870.getAt(0);var ipre5975 = let_result3870.getAt(1);if (ms5974!==false) {var if_res3871 = M0.car(ms5974);} else {var if_res3871 = false;}var m5976 = if_res3871;if (false!==false) {var if_res3872 = M0.get_output_bytes(spitout5966);} else {var if_res3872 = discarded_by_leftovers5965;}var discarded_by_leftovers5977 = if_res3872;if (false!==false) {var if_res3873 = bstring_length(discarded_by_leftovers5977);} else {var if_res3873 = discarded_by_leftovers5977;}var skipped5978 = if_res3873;if (m5976!==false) {var if_res3874 = bstring_length(m5976);} else {var if_res3874 = false;}var got5979 = if_res3874;if (end5973!==false) {if (m5976!==false) {var if_res3875 = end5973-skipped5978-got5979;} else {var if_res3875 = false;}var if_res3876 = if_res3875;} else {var if_res3876 = false;}var end5980 = if_res3876;if (m5976!==false) {var _0_ok_p5981 = M0.not(M0.zero_p(got5979));var if_res3877 = loop5950((function(leftovers5982, ms5983, acc5984) {return M0.cons(M0.car(ms5983),acc5984);})(discarded_by_leftovers5977,ms5974,acc5951),0,end5980,ipre5975,_0_ok_p5981);} else {var if_res3877 = (function(acc5985, leftover5986) {return acc5985;})(acc5951,discarded_by_leftovers5977);}var if_res3883 = if_res3877;} else {if (false!==false) {var if_res3878 = M0.regexp_match_peek_positions_by_end(rx5956,buf5940,start5952,end5953,false,ipre5954,max_lookbehind5944);} else {var if_res3878 = M0.regexp_match_positions_by_end(rx5956,buf5940,start5952,end5953,false,ipre5954,max_lookbehind5944);}var let_result3879 = if_res3878;var m5987 = let_result3879.getAt(0);var ipre5988 = let_result3879.getAt(1);if (M0.not(m5987)!==false) {var if_res3882 = (function(acc5989, start5990, end5991) {return acc5989;})(acc5951,start5952,end5953);} else {var mstart5992 = M0.caar(m5987);var mend5993 = M0.cdar(m5987);var _0_ok_p5994 = M0.not(M0.__eq_(mstart5992,mend5993));if (false!==false) {var if_res3880 = M0.input_port_p(buf5940);} else {var if_res3880 = false;}if (if_res3880!==false) {var if_res3881 = false(function(acc5995, new_start5996, new_end5997) {return loop5950(acc5995,new_start5996,new_end5997,ipre5988,_0_ok_p5994);},acc5951,start5952,end5953,m5987);} else {var if_res3881 = loop5950((function(start5998, ms5999, acc6000) {return M0.cons(sub5939(buf5940,M0.caar(ms5999),M0.cdar(ms5999)),acc6000);})(start5952,m5987,acc5951),mend5993,end5953,ipre5988,_0_ok_p5994);}var if_res3882 = if_res3881;}var if_res3883 = if_res3882;}return if_res3883;};var if_res3884 = M0.reverse(loop5950($rjs_core.Pair.makeList(),start5805,end5806,ipre5807,true));}var if_res3885 = if_res3884;}var if_res3886 = if_res3885;}var if_res3887 = if_res3886;}var if_res3888 = if_res3887;}return if_res3888;};var regexp_match_times_5104 = function(given_kws6001, given_args6002, pattern396003, string406004, start366005, end376006, ipre386007) {if (M0.pair_p(given_kws6001)!==false) {var if_res3889 = M0.eq_p($rjs_core.Keyword.make("gap-select?"),M0.car(given_kws6001));} else {var if_res3889 = false;}var gap_select_p356008 = if_res3889;if (gap_select_p356008!==false) {var if_res3890 = M0.car(given_args6002);} else {var if_res3890 = false;}var gap_select_p336009 = if_res3890;if (gap_select_p356008!==false) {var if_res3891 = M0.cdr(given_kws6001);} else {var if_res3891 = given_kws6001;}var kws2191356010 = if_res3891;if (gap_select_p356008!==false) {var if_res3892 = M0.cdr(given_args6002);} else {var if_res3892 = given_args6002;}var kw_args2191366011 = if_res3892;var match_select346012 = M0.pair_p(kws2191356010);if (match_select346012!==false) {var if_res3893 = M0.car(kw_args2191366011);} else {var if_res3893 = M7.unsafe_undefined;}var match_select326013 = if_res3893;return regexp_match_times_(gap_select_p336009,match_select326013,pattern396003,string406004,start366005,end376006,ipre386007);};var cl3900 = function(given_kws6020, given_args6021, pattern6022, string6023) {return regexp_match_times_5104(given_kws6020,given_args6021,pattern6022,string6023,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3901 = function(given_kws6024, given_args6025, pattern6026, string6027, start6028, end6029, ipre386030) {return regexp_match_times_5104(given_kws6024,given_args6025,pattern6026,string6027,start6028,end6029,ipre386030);};var cl3902 = function(given_kws6031, given_args6032, pattern6033, string6034, start6035, end376036) {return regexp_match_times_5104(given_kws6031,given_args6032,pattern6033,string6034,start6035,end376036,$rjs_core.Bytes.fromIntArray([]));};var cl3903 = function(given_kws6037, given_args6038, pattern6039, string6040, start366041) {return regexp_match_times_5104(given_kws6037,given_args6038,pattern6039,string6040,start366041,false,$rjs_core.Bytes.fromIntArray([]));};var temp3905 = $rjs_core.attachProcedureArity(function() {var fixed_lam3904 = {'4':cl3900,'7':cl3901,'6':cl3902,'5':cl3903}[arguments.length];if (fixed_lam3904!==undefined) {return fixed_lam3904.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6,7]);var temp3899 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("gap-select?"),$rjs_core.Keyword.make("match-select"));var cl3894 = function(pattern6042, string6043) {return regexp_match_times_5104(M0.rnull,M0.rnull,pattern6042,string6043,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3895 = function(pattern6044, string6045, start6046, end6047, ipre386048) {return regexp_match_times_5104(M0.rnull,M0.rnull,pattern6044,string6045,start6046,end6047,ipre386048);};var cl3896 = function(pattern6049, string6050, start6051, end376052) {return regexp_match_times_5104(M0.rnull,M0.rnull,pattern6049,string6050,start6051,end376052,$rjs_core.Bytes.fromIntArray([]));};var cl3897 = function(pattern6053, string6054, start366055) {return regexp_match_times_5104(M0.rnull,M0.rnull,pattern6053,string6054,start366055,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_match_times_41 = M2.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws6014, given_argc6015) {if (M0.__gt__eq_(given_argc6015,4)!==false) {var if_res3906 = M0.__lt__eq_(given_argc6015,7);} else {var if_res3906 = false;}if (if_res3906!==false) {var l12191376016 = given_kws6014;if (M0.null_p(l12191376016)!==false) {var if_res3908 = l12191376016;} else {if (M0.eq_p(M0.car(l12191376016),$rjs_core.Keyword.make("gap-select?"))!==false) {var if_res3907 = M0.cdr(l12191376016);} else {var if_res3907 = l12191376016;}var if_res3908 = if_res3907;}var l12191376017 = if_res3908;var l12191386018 = l12191376017;if (M0.null_p(l12191386018)!==false) {var if_res3910 = l12191386018;} else {if (M0.eq_p(M0.car(l12191386018),$rjs_core.Keyword.make("match-select"))!==false) {var if_res3909 = M0.cdr(l12191386018);} else {var if_res3909 = l12191386018;}var if_res3910 = if_res3909;}var l12191386019 = if_res3910;var if_res3911 = M0.null_p(l12191386019);} else {var if_res3911 = false;}return if_res3911;},temp3905,M0.rnull,temp3899,$rjs_core.attachProcedureArity(function() {var fixed_lam3898 = {'2':cl3894,'5':cl3895,'4':cl3896,'3':cl3897}[arguments.length];if (fixed_lam3898!==undefined) {return fixed_lam3898.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]));var regexp_match_exact_p = function(p6056, s6057) {var m6058 = M0.regexp_match_positions(p6056,s6057);if (m6058!==false) {if (M0.zero_p(M0.caar(m6058))!==false) {var temp3917 = M0.cdar(m6058);if (M0.bytes_p(s6057)!==false) {var if_res3916 = M0.bytes_length(s6057);} else {var or_part6059 = M0.byte_regexp_p(p6056);if (or_part6059!==false) {var if_res3912 = or_part6059;} else {var if_res3912 = M0.bytes_p(p6056);}if (if_res3912!==false) {if (M0.path_p(s6057)!==false) {var if_res3913 = M0.bytes_length(M0.path__gt_bytes(s6057));} else {var if_res3913 = M0.string_utf_8_length(s6057);}var if_res3915 = if_res3913;} else {if (M0.path_p(s6057)!==false) {var if_res3914 = M0.string_length(M0.path__gt_string(s6057));} else {var if_res3914 = M0.string_length(s6057);}var if_res3915 = if_res3914;}var if_res3916 = if_res3915;}var if_res3918 = M0.__eq_(temp3917,if_res3916);} else {var if_res3918 = false;}var if_res3919 = if_res3918;} else {var if_res3919 = false;}return if_res3919;};var regexp_replaces = function(string6060, replacements6061) {var loop6062 = function(str6063, rs6064) {if (M0.null_p(rs6064)!==false) {var if_res3920 = str6063;} else {var if_res3920 = loop6062(M0.regexp_replace_times_(M0.caar(rs6064),str6063,M0.cadar(rs6064)),M0.cdr(rs6064));}return if_res3920;};return loop6062(string6060,replacements6061);};var __rjs_quoted__ = {};__rjs_quoted__.regexp_match_times_ = regexp_match_times_;__rjs_quoted__.regexp_match_peek_positions_times_ = regexp_match_peek_positions_times_;__rjs_quoted__.regexp_match_times_41 = regexp_match_times_41;__rjs_quoted__.regexp_match_positions_times_18 = regexp_match_positions_times_18;__rjs_quoted__.no_empty_edge_matches = no_empty_edge_matches;__rjs_quoted__.regexp_match_positions_times_ = regexp_match_positions_times_;__rjs_quoted__.regexp_match_peek_positions_times_26 = regexp_match_peek_positions_times_26;__rjs_quoted__.bstring_length = bstring_length;export { __rjs_quoted__,regexp_replaces,__regexp_replace_times_,regexp_try_match,regexp_match_exact_p,regexp_split,regexp_match_peek_positions_times_,regexp_match_positions_times_,regexp_match_times_,regexp_replace_quote,regexp_quote,real__gt_decimal_string };