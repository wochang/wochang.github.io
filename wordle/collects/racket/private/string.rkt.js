import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "./map.rkt.js";import * as M2 from "./kw.rkt.js";import * as M3 from "./qq-and-or.rkt.js";import * as M4 from "./reverse.rkt.js";import * as M5 from "./for.rkt.js";import * as M6 from "../../../runtime/read.rkt.js";import * as M7 from "../../../runtime/unsafe.rkt.js";var real__gt_decimal_string5102 = function(n25103, digits15104) {var n5105 = n25103;if (false!==false) {var if_res3168 = 2;} else {var if_res3168 = digits15104;}var digits5106 = if_res3168;if (M0.rational_p(n5105)!==false) {var if_res3169 = M0.rvoid();} else {var if_res3169 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("real->decimal-string"),$rjs_core.UString.make("rational?"),n5105);}if_res3169;if (M0.exact_nonnegative_integer_p(digits5106)!==false) {var if_res3170 = M0.rvoid();} else {var if_res3170 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("real->decimal-string"),$rjs_core.UString.make("exact-nonnegative-integer?"),digits5106);}if_res3170;var e5107 = M0.expt(10,digits5106);var num5108 = M0.round(M0.abs(e5107*M0.inexact__gt_exact(n5105)));var temp3176 = $rjs_core.UString.make("~a~a.~a");var or_part5109 = M0.negative_p(n5105);if (or_part5109!==false) {var if_res3174 = or_part5109;} else {var if_res3174 = M0.equal_p(n5105,-0.0);}if (if_res3174!==false) {var if_res3175 = $rjs_core.UString.make("-");} else {var if_res3175 = $rjs_core.UString.make("");}var temp3173 = M0.quotient(num5108,e5107);if (M0.zero_p(digits5106)!==false) {var if_res3172 = $rjs_core.UString.make("");} else {var s5110 = M0.number__gt_string(M0.remainder(num5108,e5107));if (M0.__eq_(M0.string_length(s5110),digits5106)!==false) {var if_res3171 = s5110;} else {var if_res3171 = M0.string_append(M0.make_string(digits5106-M0.string_length(s5110),$rjs_core.Char.charFromCodepoint(48)),s5110);}var if_res3172 = if_res3171;}return M0.format(temp3176,if_res3175,temp3173,if_res3172);};var cl3177 = function(n5111) {return real__gt_decimal_string5102(n5111,2);};var cl3178 = function(n5112, digits15113) {return real__gt_decimal_string5102(n5112,digits15113);};var real__gt_decimal_string = $rjs_core.attachProcedureArity(function() {var fixed_lam3179 = {'1':cl3177,'2':cl3178}[arguments.length];if (fixed_lam3179!==undefined) {return fixed_lam3179.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var regexp_quote_chars_s = $rjs_core.Regexp.fromString("[][.*?+|(){}\\$^]");var regexp_quote_chars_b = $rjs_core.Regexp.fromString("[][.*?+|(){}\\$^]");var regexp_quote5114 = function(s45115, case_sens_p35116) {var s5117 = s45115;if (false!==false) {var if_res3180 = true;} else {var if_res3180 = case_sens_p35116;}var case_sens_p5118 = if_res3180;if (M0.bytes_p(s5117)!==false) {var if_res3182 = true;} else {if (M0.string_p(s5117)!==false) {var if_res3181 = false;} else {var if_res3181 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-quote"),$rjs_core.UString.make("(or/c string? bytes?)"),s5117);}var if_res3182 = if_res3181;}var b_p5119 = if_res3182;if (b_p5119!==false) {var if_res3183 = M0.regexp_replace_times_(regexp_quote_chars_b,s5117,$rjs_core.Bytes.fromIntArray([92,92,38]));} else {var if_res3183 = M0.regexp_replace_times_(regexp_quote_chars_s,s5117,$rjs_core.UString.make("\\\\&"));}var s5120 = if_res3183;if (case_sens_p5118!==false) {var if_res3185 = s5120;} else {if (b_p5119!==false) {var if_res3184 = M0.bytes_append($rjs_core.Bytes.fromIntArray([40,63,105,58]),s5120,$rjs_core.Bytes.fromIntArray([41]));} else {var if_res3184 = M0.string_append($rjs_core.UString.make("(?i:"),s5120,$rjs_core.UString.make(")"));}var if_res3185 = if_res3184;}return if_res3185;};var cl3186 = function(s5121) {return regexp_quote5114(s5121,true);};var cl3187 = function(s5122, case_sens_p35123) {return regexp_quote5114(s5122,case_sens_p35123);};var regexp_quote = $rjs_core.attachProcedureArity(function() {var fixed_lam3188 = {'1':cl3186,'2':cl3187}[arguments.length];if (fixed_lam3188!==undefined) {return fixed_lam3188.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var regexp_replace_quote = function(s5124) {if (M0.bytes_p(s5124)!==false) {var if_res3190 = M0.regexp_replace_times_($rjs_core.Regexp.fromString("[&\\]"),s5124,$rjs_core.Bytes.fromIntArray([92,92,38]));} else {if (M0.string_p(s5124)!==false) {var if_res3189 = M0.regexp_replace_times_($rjs_core.Regexp.fromString("[&\\]"),s5124,$rjs_core.UString.make("\\\\&"));} else {var if_res3189 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace-quote"),$rjs_core.UString.make("(or/c string? bytes?)"),s5124);}var if_res3190 = if_res3189;}return if_res3190;};var no_empty_edge_table = M0.make_hash();var no_empty_edge_matches = function(rx5125, n5126) {var tweaker5127 = function(rx5128, n5129) {if (M0.bytes_p(rx5128)!==false) {var if_res3191 = M0.bytes_append($rjs_core.Bytes.fromIntArray([40,63,58]),rx5128,$rjs_core.Bytes.fromIntArray([41,40,63,60,61]),M0.make_bytes(n5129,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46))),$rjs_core.Bytes.fromIntArray([41]));} else {var if_res3191 = M0.format($rjs_core.UString.make("(?:~a)(?<=~a)"),rx5128,M0.make_bytes(n5129,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(46))));}return if_res3191;};var run_tweak5130 = function() {if (M0.pregexp_p(rx5125)!==false) {var tweaked5131 = tweaker5127(M0.object_name(rx5125),n5126);var or_part5132 = M0.regexp_p(tweaked5131);if (or_part5132!==false) {var if_res3192 = or_part5132;} else {var if_res3192 = M0.byte_regexp_p(tweaked5131);}if (if_res3192!==false) {var if_res3194 = tweaked5131;} else {if (M0.bytes_p(tweaked5131)!==false) {var if_res3193 = M0.bytes__gt_string_by_utf_8(tweaked5131);} else {var if_res3193 = tweaked5131;}var if_res3194 = M0.pregexp(if_res3193);}var if_res3215 = if_res3194;} else {if (M0.regexp_p(rx5125)!==false) {var tweaked5133 = tweaker5127(M0.object_name(rx5125),n5126);var or_part5134 = M0.regexp_p(tweaked5133);if (or_part5134!==false) {var if_res3195 = or_part5134;} else {var if_res3195 = M0.byte_regexp_p(tweaked5133);}if (if_res3195!==false) {var if_res3197 = tweaked5133;} else {if (M0.bytes_p(tweaked5133)!==false) {var if_res3196 = M0.bytes__gt_string_by_utf_8(tweaked5133);} else {var if_res3196 = tweaked5133;}var if_res3197 = M0.regexp(if_res3196);}var if_res3214 = if_res3197;} else {if (M0.byte_pregexp_p(rx5125)!==false) {var tweaked5135 = tweaker5127(M0.object_name(rx5125),n5126);var or_part5136 = M0.regexp_p(tweaked5135);if (or_part5136!==false) {var if_res3198 = or_part5136;} else {var if_res3198 = M0.byte_regexp_p(tweaked5135);}if (if_res3198!==false) {var if_res3200 = tweaked5135;} else {if (M0.bytes_p(tweaked5135)!==false) {var if_res3199 = tweaked5135;} else {var if_res3199 = M0.string__gt_bytes_by_utf_8(tweaked5135);}var if_res3200 = M0.byte_pregexp(if_res3199);}var if_res3213 = if_res3200;} else {if (M0.byte_regexp_p(rx5125)!==false) {var tweaked5137 = tweaker5127(M0.object_name(rx5125),n5126);var or_part5138 = M0.regexp_p(tweaked5137);if (or_part5138!==false) {var if_res3201 = or_part5138;} else {var if_res3201 = M0.byte_regexp_p(tweaked5137);}if (if_res3201!==false) {var if_res3203 = tweaked5137;} else {if (M0.bytes_p(tweaked5137)!==false) {var if_res3202 = tweaked5137;} else {var if_res3202 = M0.string__gt_bytes_by_utf_8(tweaked5137);}var if_res3203 = M0.byte_regexp(if_res3202);}var if_res3212 = if_res3203;} else {if (M0.string_p(rx5125)!==false) {var tweaked5139 = tweaker5127((function(x5140) {return x5140;})(rx5125),n5126);var or_part5141 = M0.regexp_p(tweaked5139);if (or_part5141!==false) {var if_res3204 = or_part5141;} else {var if_res3204 = M0.byte_regexp_p(tweaked5139);}if (if_res3204!==false) {var if_res3206 = tweaked5139;} else {if (M0.bytes_p(tweaked5139)!==false) {var if_res3205 = M0.bytes__gt_string_by_utf_8(tweaked5139);} else {var if_res3205 = tweaked5139;}var if_res3206 = M0.regexp(if_res3205);}var if_res3211 = if_res3206;} else {if (M0.bytes_p(rx5125)!==false) {var tweaked5142 = tweaker5127((function(x5143) {return x5143;})(rx5125),n5126);var or_part5144 = M0.regexp_p(tweaked5142);if (or_part5144!==false) {var if_res3207 = or_part5144;} else {var if_res3207 = M0.byte_regexp_p(tweaked5142);}if (if_res3207!==false) {var if_res3209 = tweaked5142;} else {if (M0.bytes_p(tweaked5142)!==false) {var if_res3208 = tweaked5142;} else {var if_res3208 = M0.string__gt_bytes_by_utf_8(tweaked5142);}var if_res3209 = M0.byte_regexp(if_res3208);}var if_res3210 = if_res3209;} else {var if_res3210 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-tweaker"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),rx5125);}var if_res3211 = if_res3210;}var if_res3212 = if_res3211;}var if_res3213 = if_res3212;}var if_res3214 = if_res3213;}var if_res3215 = if_res3214;}return if_res3215;};var key5145 = M0.cons(n5126,rx5125);var or_part5146 = M0.hash_ref(no_empty_edge_table,key5145,false);if (or_part5146!==false) {var if_res3216 = or_part5146;} else {var rx_times_5147 = run_tweak5130();M0.hash_set_bang_(no_empty_edge_table,key5145,rx_times_5147);var if_res3216 = rx_times_5147;}return if_res3216;};var regexp_try_match5148 = function(pattern95149, input_port105150, start_k55151, end_k65152, out75153, prefix85154) {var pattern5155 = pattern95149;var input_port5156 = input_port105150;if (false!==false) {var if_res3217 = 0;} else {var if_res3217 = start_k55151;}var start_k5157 = if_res3217;if (false!==false) {var if_res3218 = false;} else {var if_res3218 = end_k65152;}var end_k5158 = if_res3218;if (false!==false) {var if_res3219 = false;} else {var if_res3219 = out75153;}var out5159 = if_res3219;if (false!==false) {var if_res3220 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3220 = prefix85154;}var prefix5160 = if_res3220;if (M0.input_port_p(input_port5156)!==false) {var if_res3221 = M0.rvoid();} else {var if_res3221 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-try-match"),$rjs_core.UString.make("input-port?"),input_port5156);}if_res3221;var or_part5161 = M0.not(out5159);if (or_part5161!==false) {var if_res3222 = or_part5161;} else {var if_res3222 = M0.output_port_p(out5159);}if (if_res3222!==false) {var if_res3223 = M0.rvoid();} else {var if_res3223 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-try-match"),$rjs_core.UString.make("(or/c output-port? #f)"),out5159);}if_res3223;var m5162 = M0.regexp_match_peek_positions(pattern5155,input_port5156,start_k5157,end_k5158,false,prefix5160);if (m5162!==false) {var drop5163 = M0.caar(m5162);var s5164 = M0.read_bytes(drop5163,input_port5156);if (out5159!==false) {var if_res3224 = M0.write_bytes(s5164,out5159);} else {var if_res3224 = M0.rvoid();}if_res3224;var s5165 = M0.read_bytes(M0.cdar(m5162)-drop5163,input_port5156);var if_res3226 = M0.cons(s5165,M1.map(function(p5166) {if (p5166!==false) {var if_res3225 = M0.subbytes(s5165,M0.car(p5166)-drop5163,M0.cdr(p5166)-drop5163);} else {var if_res3225 = false;}return if_res3225;},M0.cdr(m5162)));} else {var if_res3226 = false;}return if_res3226;};var cl3227 = function(pattern5167, input_port5168) {return regexp_try_match5148(pattern5167,input_port5168,0,false,false,$rjs_core.Bytes.fromIntArray([]));};var cl3228 = function(pattern5169, input_port5170, start_k5171, end_k5172, out5173, prefix85174) {return regexp_try_match5148(pattern5169,input_port5170,start_k5171,end_k5172,out5173,prefix85174);};var cl3229 = function(pattern5175, input_port5176, start_k5177, end_k5178, out75179) {return regexp_try_match5148(pattern5175,input_port5176,start_k5177,end_k5178,out75179,$rjs_core.Bytes.fromIntArray([]));};var cl3230 = function(pattern5180, input_port5181, start_k5182, end_k65183) {return regexp_try_match5148(pattern5180,input_port5181,start_k5182,end_k65183,false,$rjs_core.Bytes.fromIntArray([]));};var cl3231 = function(pattern5184, input_port5185, start_k55186) {return regexp_try_match5148(pattern5184,input_port5185,start_k55186,false,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_try_match = $rjs_core.attachProcedureArity(function() {var fixed_lam3232 = {'2':cl3227,'6':cl3228,'5':cl3229,'4':cl3230,'3':cl3231}[arguments.length];if (fixed_lam3232!==undefined) {return fixed_lam3232.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5,6]);var bstring_length = function(s5187) {if (M0.bytes_p(s5187)!==false) {var if_res3233 = M0.bytes_length(s5187);} else {var if_res3233 = M0.string_length(s5187);}return if_res3233;};var regexp_match_positions_times_ = function(match_select115188, pattern165189, string175190, start135191, end145192, ipre155193) {var pattern5194 = pattern165189;var string5195 = string175190;if (false!==false) {var if_res3234 = 0;} else {var if_res3234 = start135191;}var start5196 = if_res3234;if (false!==false) {var if_res3235 = false;} else {var if_res3235 = end145192;}var end5197 = if_res3235;if (false!==false) {var if_res3236 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3236 = ipre155193;}var ipre5198 = if_res3236;if (M0.eq_p(match_select115188,M7.unsafe_undefined)!==false) {var if_res3237 = M0.car;} else {var if_res3237 = match_select115188;}var match_select5199 = if_res3237;if (M0.procedure_p(match_select5199)!==false) {var if_res3238 = M0.rvoid();} else {var if_res3238 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("procedure?"),match_select5199);}if_res3238;if (M0.eq_p(match_select5199,M0.car)!==false) {if (M0.path_p(string5195)!==false) {var or_part5201 = M0.string_p(pattern5194);if (or_part5201!==false) {var if_res3239 = or_part5201;} else {var if_res3239 = M0.regexp_p(pattern5194);}if (if_res3239!==false) {var if_res3240 = M0.path__gt_string(string5195);} else {var if_res3240 = M0.path__gt_bytes(string5195);}var if_res3241 = if_res3240;} else {var if_res3241 = string5195;}var string5200 = if_res3241;if (M0.string_p(string5200)!==false) {var if_res3243 = M0.string_length(string5200);} else {if (M0.bytes_p(string5200)!==false) {var if_res3242 = M0.bytes_length(string5200);} else {var if_res3242 = false;}var if_res3243 = if_res3242;}var len5202 = if_res3243;if (M0.bytes_p(pattern5194)!==false) {var if_res3247 = M0.byte_regexp(pattern5194);} else {if (M0.string_p(pattern5194)!==false) {var if_res3246 = M0.regexp(pattern5194);} else {if (M0.regexp_p(pattern5194)!==false) {var if_res3245 = pattern5194;} else {if (M0.byte_regexp_p(pattern5194)!==false) {var if_res3244 = pattern5194;} else {var if_res3244 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5194);}var if_res3245 = if_res3244;}var if_res3246 = if_res3245;}var if_res3247 = if_res3246;}var orig_rx5203 = if_res3247;var max_lookbehind5204 = M0.regexp_max_lookbehind(orig_rx5203);if (false!==false) {if (M0.input_port_p(string5200)!==false) {var if_res3248 = M0.rvoid();} else {var if_res3248 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("input-port?"),string5200);}var if_res3251 = if_res3248;} else {var or_part5205 = len5202;if (or_part5205!==false) {var if_res3249 = or_part5205;} else {var if_res3249 = M0.input_port_p(string5200);}if (if_res3249!==false) {var if_res3250 = M0.rvoid();} else {var if_res3250 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5200);}var if_res3251 = if_res3250;}if_res3251;if (M0.number_p(start5196)!==false) {if (M0.exact_p(start5196)!==false) {if (M0.integer_p(start5196)!==false) {var if_res3252 = M0.__gt__eq_(start5196,0);} else {var if_res3252 = false;}var if_res3253 = if_res3252;} else {var if_res3253 = false;}var if_res3254 = if_res3253;} else {var if_res3254 = false;}if (if_res3254!==false) {var if_res3255 = M0.rvoid();} else {var if_res3255 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5196);}if_res3255;var or_part5206 = M0.not(end5197);if (or_part5206!==false) {var if_res3259 = or_part5206;} else {if (M0.number_p(end5197)!==false) {if (M0.exact_p(end5197)!==false) {if (M0.integer_p(end5197)!==false) {var if_res3256 = M0.__gt__eq_(end5197,0);} else {var if_res3256 = false;}var if_res3257 = if_res3256;} else {var if_res3257 = false;}var if_res3258 = if_res3257;} else {var if_res3258 = false;}var if_res3259 = if_res3258;}if (if_res3259!==false) {var if_res3260 = M0.rvoid();} else {var if_res3260 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5197);}if_res3260;if (M0.bytes_p(ipre5198)!==false) {var if_res3261 = M0.rvoid();} else {var if_res3261 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("bytes?"),ipre5198);}if_res3261;var or_part5207 = M0.input_port_p(string5200);if (or_part5207!==false) {var if_res3263 = or_part5207;} else {if (len5202!==false) {var if_res3262 = M0.__lt__eq_(start5196,len5202);} else {var if_res3262 = false;}var if_res3263 = if_res3262;}if (if_res3263!==false) {var if_res3264 = M0.rvoid();} else {var if_res3264 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5202),start5196);}if_res3264;var or_part5208 = M0.not(end5197);if (or_part5208!==false) {var if_res3268 = or_part5208;} else {if (M0.__lt__eq_(start5196,end5197)!==false) {var or_part5209 = M0.input_port_p(string5200);if (or_part5209!==false) {var if_res3266 = or_part5209;} else {if (len5202!==false) {var if_res3265 = M0.__lt__eq_(end5197,len5202);} else {var if_res3265 = false;}var if_res3266 = if_res3265;}var if_res3267 = if_res3266;} else {var if_res3267 = false;}var if_res3268 = if_res3267;}if (if_res3268!==false) {var if_res3269 = M0.rvoid();} else {var if_res3269 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5196,len5202),end5197);}if_res3269;var loop5210 = function(acc5211, start5212, end5213, ipre5214, _0_ok_p5215) {if (_0_ok_p5215!==false) {var if_res3270 = orig_rx5203;} else {var if_res3270 = no_empty_edge_matches(orig_rx5203,M0.add1(M0.bytes_length(ipre5214)));}var rx5216 = if_res3270;if (false!==false) {var if_res3271 = M0.input_port_p(string5200);} else {var if_res3271 = false;}if (if_res3271!==false) {if (M0.positive_p(start5212)!==false) {var s5218 = M0.make_bytes(4096);var loop5219 = function(n5220) {if (M0.__eq_(n5220,start5212)!==false) {var if_res3273 = M0.rvoid();} else {var m5221 = M0.read_bytes_avail_bang_(s5218,string5200,0,M0.min(start5212-n5220,4096));if (M0.eof_object_p(m5221)!==false) {var if_res3272 = M0.rvoid();} else {var if_res3272 = loop5219(n5220+m5221);}var if_res3273 = if_res3272;}return if_res3273;};var if_res3274 = loop5219(0);} else {var if_res3274 = M0.rvoid();}var _5217 = if_res3274;if (false!==false) {var if_res3275 = false;} else {var if_res3275 = 0;}var discarded_by_leftovers5222 = if_res3275;if (false!==false) {var if_res3276 = M0.open_output_bytes();} else {var if_res3276 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5224, start5225, end5226, flush_p5227, breakable_p5228) {var c5229 = end5226-start5225;discarded_by_leftovers5222 = c5229+discarded_by_leftovers5222;return c5229;},M0.rvoid);}var spitout5223 = if_res3276;if (end5213!==false) {var if_res3277 = end5213-start5212;} else {var if_res3277 = false;}var end5230 = if_res3277;var let_result3278 = M0.regexp_match_by_end(rx5216,string5200,0,end5230,spitout5223,ipre5214,max_lookbehind5204);var ms5231 = let_result3278.getAt(0);var ipre5232 = let_result3278.getAt(1);if (ms5231!==false) {var if_res3279 = M0.car(ms5231);} else {var if_res3279 = false;}var m5233 = if_res3279;if (false!==false) {var if_res3280 = M0.get_output_bytes(spitout5223);} else {var if_res3280 = discarded_by_leftovers5222;}var discarded_by_leftovers5234 = if_res3280;if (false!==false) {var if_res3281 = bstring_length(discarded_by_leftovers5234);} else {var if_res3281 = discarded_by_leftovers5234;}var skipped5235 = if_res3281;if (m5233!==false) {var if_res3282 = bstring_length(m5233);} else {var if_res3282 = false;}var got5236 = if_res3282;if (end5230!==false) {if (m5233!==false) {var if_res3283 = end5230-skipped5235-got5236;} else {var if_res3283 = false;}var if_res3284 = if_res3283;} else {var if_res3284 = false;}var end5237 = if_res3284;if (m5233!==false) {var _0_ok_p5238 = M0.not(M0.zero_p(got5236));var if_res3285 = loop5210(false(discarded_by_leftovers5234,ms5231,acc5211),0,end5237,ipre5232,_0_ok_p5238);} else {var if_res3285 = false(acc5211,discarded_by_leftovers5234);}var if_res3295 = if_res3285;} else {if (false!==false) {var if_res3286 = M0.regexp_match_peek_positions_by_end(rx5216,string5200,start5212,end5213,false,ipre5214,max_lookbehind5204);} else {var if_res3286 = M0.regexp_match_positions_by_end(rx5216,string5200,start5212,end5213,false,ipre5214,max_lookbehind5204);}var let_result3287 = if_res3286;var m5239 = let_result3287.getAt(0);var ipre5240 = let_result3287.getAt(1);if (M0.not(m5239)!==false) {var if_res3294 = (function(acc5241, start5242, end5243) {return acc5241;})(acc5211,start5212,end5213);} else {var mstart5244 = M0.caar(m5239);var mend5245 = M0.cdar(m5239);var _0_ok_p5246 = M0.not(M0.__eq_(mstart5244,mend5245));if (function(loop5247, acc5248, start5249, end5250, ms5251) {var mstart5252 = M0.caar(ms5251);var mend5253 = M0.cdar(ms5251);var temp3289 = $rjs_core.Pair.makeList();if (end5250!==false) {var if_res3288 = end5250-mend5253;} else {var if_res3288 = false;}return M0.append(M1.map(function(p5254) {return M0.cons(mend5253+M0.car(p5254),mend5253+M0.cdr(p5254));},loop5247(temp3289,0,if_res3288)),M0.cons(M0.car(ms5251),acc5248));}!==false) {var if_res3290 = M0.input_port_p(string5200);} else {var if_res3290 = false;}if (if_res3290!==false) {var if_res3293 = (function(loop5255, acc5256, start5257, end5258, ms5259) {var mstart5260 = M0.caar(ms5259);var mend5261 = M0.cdar(ms5259);var temp3292 = $rjs_core.Pair.makeList();if (end5258!==false) {var if_res3291 = end5258-mend5261;} else {var if_res3291 = false;}return M0.append(M1.map(function(p5262) {return M0.cons(mend5261+M0.car(p5262),mend5261+M0.cdr(p5262));},loop5255(temp3292,0,if_res3291)),M0.cons(M0.car(ms5259),acc5256));})(function(acc5263, new_start5264, new_end5265) {return loop5210(acc5263,new_start5264,new_end5265,ipre5240,_0_ok_p5246);},acc5211,start5212,end5213,m5239);} else {var if_res3293 = loop5210((function(start5266, ms5267, acc5268) {return M0.cons(M0.car(ms5267),acc5268);})(start5212,m5239,acc5211),mend5245,end5213,ipre5240,_0_ok_p5246);}var if_res3294 = if_res3293;}var if_res3295 = if_res3294;}return if_res3295;};var if_res3361 = M0.reverse(loop5210($rjs_core.Pair.makeList(),start5196,end5197,ipre5198,true));} else {if (M0.path_p(string5195)!==false) {var or_part5270 = M0.string_p(pattern5194);if (or_part5270!==false) {var if_res3296 = or_part5270;} else {var if_res3296 = M0.regexp_p(pattern5194);}if (if_res3296!==false) {var if_res3297 = M0.path__gt_string(string5195);} else {var if_res3297 = M0.path__gt_bytes(string5195);}var if_res3298 = if_res3297;} else {var if_res3298 = string5195;}var string5269 = if_res3298;if (M0.string_p(string5269)!==false) {var if_res3300 = M0.string_length(string5269);} else {if (M0.bytes_p(string5269)!==false) {var if_res3299 = M0.bytes_length(string5269);} else {var if_res3299 = false;}var if_res3300 = if_res3299;}var len5271 = if_res3300;if (M0.bytes_p(pattern5194)!==false) {var if_res3304 = M0.byte_regexp(pattern5194);} else {if (M0.string_p(pattern5194)!==false) {var if_res3303 = M0.regexp(pattern5194);} else {if (M0.regexp_p(pattern5194)!==false) {var if_res3302 = pattern5194;} else {if (M0.byte_regexp_p(pattern5194)!==false) {var if_res3301 = pattern5194;} else {var if_res3301 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5194);}var if_res3302 = if_res3301;}var if_res3303 = if_res3302;}var if_res3304 = if_res3303;}var orig_rx5272 = if_res3304;var max_lookbehind5273 = M0.regexp_max_lookbehind(orig_rx5272);if (false!==false) {if (M0.input_port_p(string5269)!==false) {var if_res3305 = M0.rvoid();} else {var if_res3305 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("input-port?"),string5269);}var if_res3308 = if_res3305;} else {var or_part5274 = len5271;if (or_part5274!==false) {var if_res3306 = or_part5274;} else {var if_res3306 = M0.input_port_p(string5269);}if (if_res3306!==false) {var if_res3307 = M0.rvoid();} else {var if_res3307 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5269);}var if_res3308 = if_res3307;}if_res3308;if (M0.number_p(start5196)!==false) {if (M0.exact_p(start5196)!==false) {if (M0.integer_p(start5196)!==false) {var if_res3309 = M0.__gt__eq_(start5196,0);} else {var if_res3309 = false;}var if_res3310 = if_res3309;} else {var if_res3310 = false;}var if_res3311 = if_res3310;} else {var if_res3311 = false;}if (if_res3311!==false) {var if_res3312 = M0.rvoid();} else {var if_res3312 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5196);}if_res3312;var or_part5275 = M0.not(end5197);if (or_part5275!==false) {var if_res3316 = or_part5275;} else {if (M0.number_p(end5197)!==false) {if (M0.exact_p(end5197)!==false) {if (M0.integer_p(end5197)!==false) {var if_res3313 = M0.__gt__eq_(end5197,0);} else {var if_res3313 = false;}var if_res3314 = if_res3313;} else {var if_res3314 = false;}var if_res3315 = if_res3314;} else {var if_res3315 = false;}var if_res3316 = if_res3315;}if (if_res3316!==false) {var if_res3317 = M0.rvoid();} else {var if_res3317 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5197);}if_res3317;if (M0.bytes_p(ipre5198)!==false) {var if_res3318 = M0.rvoid();} else {var if_res3318 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),$rjs_core.UString.make("bytes?"),ipre5198);}if_res3318;var or_part5276 = M0.input_port_p(string5269);if (or_part5276!==false) {var if_res3320 = or_part5276;} else {if (len5271!==false) {var if_res3319 = M0.__lt__eq_(start5196,len5271);} else {var if_res3319 = false;}var if_res3320 = if_res3319;}if (if_res3320!==false) {var if_res3321 = M0.rvoid();} else {var if_res3321 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5271),start5196);}if_res3321;var or_part5277 = M0.not(end5197);if (or_part5277!==false) {var if_res3325 = or_part5277;} else {if (M0.__lt__eq_(start5196,end5197)!==false) {var or_part5278 = M0.input_port_p(string5269);if (or_part5278!==false) {var if_res3323 = or_part5278;} else {if (len5271!==false) {var if_res3322 = M0.__lt__eq_(end5197,len5271);} else {var if_res3322 = false;}var if_res3323 = if_res3322;}var if_res3324 = if_res3323;} else {var if_res3324 = false;}var if_res3325 = if_res3324;}if (if_res3325!==false) {var if_res3326 = M0.rvoid();} else {var if_res3326 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5196,len5271),end5197);}if_res3326;var loop5279 = function(acc5280, start5281, end5282, ipre5283, _0_ok_p5284) {if (_0_ok_p5284!==false) {var if_res3327 = orig_rx5272;} else {var if_res3327 = no_empty_edge_matches(orig_rx5272,M0.add1(M0.bytes_length(ipre5283)));}var rx5285 = if_res3327;if (false!==false) {var if_res3328 = M0.input_port_p(string5269);} else {var if_res3328 = false;}if (if_res3328!==false) {if (M0.positive_p(start5281)!==false) {var s5287 = M0.make_bytes(4096);var loop5288 = function(n5289) {if (M0.__eq_(n5289,start5281)!==false) {var if_res3330 = M0.rvoid();} else {var m5290 = M0.read_bytes_avail_bang_(s5287,string5269,0,M0.min(start5281-n5289,4096));if (M0.eof_object_p(m5290)!==false) {var if_res3329 = M0.rvoid();} else {var if_res3329 = loop5288(n5289+m5290);}var if_res3330 = if_res3329;}return if_res3330;};var if_res3331 = loop5288(0);} else {var if_res3331 = M0.rvoid();}var _5286 = if_res3331;if (false!==false) {var if_res3332 = false;} else {var if_res3332 = 0;}var discarded_by_leftovers5291 = if_res3332;if (false!==false) {var if_res3333 = M0.open_output_bytes();} else {var if_res3333 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5293, start5294, end5295, flush_p5296, breakable_p5297) {var c5298 = end5295-start5294;discarded_by_leftovers5291 = c5298+discarded_by_leftovers5291;return c5298;},M0.rvoid);}var spitout5292 = if_res3333;if (end5282!==false) {var if_res3334 = end5282-start5281;} else {var if_res3334 = false;}var end5299 = if_res3334;var let_result3335 = M0.regexp_match_by_end(rx5285,string5269,0,end5299,spitout5292,ipre5283,max_lookbehind5273);var ms5300 = let_result3335.getAt(0);var ipre5301 = let_result3335.getAt(1);if (ms5300!==false) {var if_res3336 = M0.car(ms5300);} else {var if_res3336 = false;}var m5302 = if_res3336;if (false!==false) {var if_res3337 = M0.get_output_bytes(spitout5292);} else {var if_res3337 = discarded_by_leftovers5291;}var discarded_by_leftovers5303 = if_res3337;if (false!==false) {var if_res3338 = bstring_length(discarded_by_leftovers5303);} else {var if_res3338 = discarded_by_leftovers5303;}var skipped5304 = if_res3338;if (m5302!==false) {var if_res3339 = bstring_length(m5302);} else {var if_res3339 = false;}var got5305 = if_res3339;if (end5299!==false) {if (m5302!==false) {var if_res3340 = end5299-skipped5304-got5305;} else {var if_res3340 = false;}var if_res3341 = if_res3340;} else {var if_res3341 = false;}var end5306 = if_res3341;if (m5302!==false) {var _0_ok_p5307 = M0.not(M0.zero_p(got5305));var if_res3342 = loop5279(false(discarded_by_leftovers5303,ms5300,acc5280),0,end5306,ipre5301,_0_ok_p5307);} else {var if_res3342 = false(acc5280,discarded_by_leftovers5303);}var if_res3360 = if_res3342;} else {if (false!==false) {var if_res3343 = M0.regexp_match_peek_positions_by_end(rx5285,string5269,start5281,end5282,false,ipre5283,max_lookbehind5273);} else {var if_res3343 = M0.regexp_match_positions_by_end(rx5285,string5269,start5281,end5282,false,ipre5283,max_lookbehind5273);}var let_result3344 = if_res3343;var m5308 = let_result3344.getAt(0);var ipre5309 = let_result3344.getAt(1);if (M0.not(m5308)!==false) {var if_res3359 = (function(acc5310, start5311, end5312) {return acc5310;})(acc5280,start5281,end5282);} else {var mstart5313 = M0.caar(m5308);var mend5314 = M0.cdar(m5308);var _0_ok_p5315 = M0.not(M0.__eq_(mstart5313,mend5314));if (function(loop5316, acc5317, start5318, end5319, ms5320) {var mend5321 = M0.cdar(ms5320);var temp3346 = $rjs_core.Pair.makeList();if (end5319!==false) {var if_res3345 = end5319-mend5321;} else {var if_res3345 = false;}var rest5322 = loop5316(temp3346,0,if_res3345);var s5323 = match_select5199(ms5320);if (M0.pair_p(s5323)!==false) {var if_res3347 = M0.exact_integer_p(M0.car(s5323));} else {var if_res3347 = false;}var or_part5324 = if_res3347;if (or_part5324!==false) {var if_res3348 = or_part5324;} else {var if_res3348 = M0.not(s5323);}if (if_res3348!==false) {var if_res3350 = function(p5325) {return M0.cons(mend5321+M0.car(p5325),mend5321+M0.cdr(p5325));};} else {var if_res3350 = function(ps5326) {return M1.map(function(p5327) {if (p5327!==false) {var if_res3349 = M0.cons(mend5321+M0.car(p5327),mend5321+M0.cdr(p5327));} else {var if_res3349 = false;}return if_res3349;},ps5326);};}return M0.append(M1.map(if_res3350,rest5322),M0.cons(s5323,acc5317));}!==false) {var if_res3351 = M0.input_port_p(string5269);} else {var if_res3351 = false;}if (if_res3351!==false) {var if_res3358 = (function(loop5328, acc5329, start5330, end5331, ms5332) {var mend5333 = M0.cdar(ms5332);var temp3353 = $rjs_core.Pair.makeList();if (end5331!==false) {var if_res3352 = end5331-mend5333;} else {var if_res3352 = false;}var rest5334 = loop5328(temp3353,0,if_res3352);var s5335 = match_select5199(ms5332);if (M0.pair_p(s5335)!==false) {var if_res3354 = M0.exact_integer_p(M0.car(s5335));} else {var if_res3354 = false;}var or_part5336 = if_res3354;if (or_part5336!==false) {var if_res3355 = or_part5336;} else {var if_res3355 = M0.not(s5335);}if (if_res3355!==false) {var if_res3357 = function(p5337) {return M0.cons(mend5333+M0.car(p5337),mend5333+M0.cdr(p5337));};} else {var if_res3357 = function(ps5338) {return M1.map(function(p5339) {if (p5339!==false) {var if_res3356 = M0.cons(mend5333+M0.car(p5339),mend5333+M0.cdr(p5339));} else {var if_res3356 = false;}return if_res3356;},ps5338);};}return M0.append(M1.map(if_res3357,rest5334),M0.cons(s5335,acc5329));})(function(acc5340, new_start5341, new_end5342) {return loop5279(acc5340,new_start5341,new_end5342,ipre5309,_0_ok_p5315);},acc5280,start5281,end5282,m5308);} else {var if_res3358 = loop5279((function(start5343, ms5344, acc5345) {return M0.cons(match_select5199(ms5344),acc5345);})(start5281,m5308,acc5280),mend5314,end5282,ipre5309,_0_ok_p5315);}var if_res3359 = if_res3358;}var if_res3360 = if_res3359;}return if_res3360;};var if_res3361 = M0.reverse(loop5279($rjs_core.Pair.makeList(),start5196,end5197,ipre5198,true));}return if_res3361;};var regexp_match_positions_times_5099 = function(given_kws5346, given_args5347, pattern165348, string175349, start135350, end145351, ipre155352) {var match_select125353 = M0.pair_p(given_kws5346);if (match_select125353!==false) {var if_res3362 = M0.car(given_args5347);} else {var if_res3362 = M7.unsafe_undefined;}var match_select115354 = if_res3362;return regexp_match_positions_times_(match_select115354,pattern165348,string175349,start135350,end145351,ipre155352);};var cl3369 = function(given_kws5359, given_args5360, pattern5361, string5362) {return regexp_match_positions_times_5099(given_kws5359,given_args5360,pattern5361,string5362,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3370 = function(given_kws5363, given_args5364, pattern5365, string5366, start5367, end5368, ipre155369) {return regexp_match_positions_times_5099(given_kws5363,given_args5364,pattern5365,string5366,start5367,end5368,ipre155369);};var cl3371 = function(given_kws5370, given_args5371, pattern5372, string5373, start5374, end145375) {return regexp_match_positions_times_5099(given_kws5370,given_args5371,pattern5372,string5373,start5374,end145375,$rjs_core.Bytes.fromIntArray([]));};var cl3372 = function(given_kws5376, given_args5377, pattern5378, string5379, start135380) {return regexp_match_positions_times_5099(given_kws5376,given_args5377,pattern5378,string5379,start135380,false,$rjs_core.Bytes.fromIntArray([]));};var temp3374 = $rjs_core.attachProcedureArity(function() {var fixed_lam3373 = {'4':cl3369,'7':cl3370,'6':cl3371,'5':cl3372}[arguments.length];if (fixed_lam3373!==undefined) {return fixed_lam3373.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6,7]);var temp3368 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("match-select"));var cl3363 = function(pattern5381, string5382) {return regexp_match_positions_times_5099(M0.rnull,M0.rnull,pattern5381,string5382,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3364 = function(pattern5383, string5384, start5385, end5386, ipre155387) {return regexp_match_positions_times_5099(M0.rnull,M0.rnull,pattern5383,string5384,start5385,end5386,ipre155387);};var cl3365 = function(pattern5388, string5389, start5390, end145391) {return regexp_match_positions_times_5099(M0.rnull,M0.rnull,pattern5388,string5389,start5390,end145391,$rjs_core.Bytes.fromIntArray([]));};var cl3366 = function(pattern5392, string5393, start135394) {return regexp_match_positions_times_5099(M0.rnull,M0.rnull,pattern5392,string5393,start135394,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_match_positions_times_18 = M2.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws5355, given_argc5356) {if (M0.__gt__eq_(given_argc5356,4)!==false) {var if_res3375 = M0.__lt__eq_(given_argc5356,7);} else {var if_res3375 = false;}if (if_res3375!==false) {var l12060455357 = given_kws5355;if (M0.null_p(l12060455357)!==false) {var if_res3377 = l12060455357;} else {if (M0.eq_p(M0.car(l12060455357),$rjs_core.Keyword.make("match-select"))!==false) {var if_res3376 = M0.cdr(l12060455357);} else {var if_res3376 = l12060455357;}var if_res3377 = if_res3376;}var l12060455358 = if_res3377;var if_res3378 = M0.null_p(l12060455358);} else {var if_res3378 = false;}return if_res3378;},temp3374,M0.rnull,temp3368,$rjs_core.attachProcedureArity(function() {var fixed_lam3367 = {'2':cl3363,'5':cl3364,'4':cl3365,'3':cl3366}[arguments.length];if (fixed_lam3367!==undefined) {return fixed_lam3367.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]));var regexp_match_peek_positions_times_ = function(match_select195395, pattern245396, string255397, start215398, end225399, ipre235400) {var pattern5401 = pattern245396;var string5402 = string255397;if (false!==false) {var if_res3379 = 0;} else {var if_res3379 = start215398;}var start5403 = if_res3379;if (false!==false) {var if_res3380 = false;} else {var if_res3380 = end225399;}var end5404 = if_res3380;if (false!==false) {var if_res3381 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3381 = ipre235400;}var ipre5405 = if_res3381;if (M0.eq_p(match_select195395,M7.unsafe_undefined)!==false) {var if_res3382 = M0.car;} else {var if_res3382 = match_select195395;}var match_select5406 = if_res3382;if (M0.procedure_p(match_select5406)!==false) {var if_res3383 = M0.rvoid();} else {var if_res3383 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("procedure?"),match_select5406);}if_res3383;if (M0.eq_p(match_select5406,M0.car)!==false) {if (M0.path_p(string5402)!==false) {var or_part5408 = M0.string_p(pattern5401);if (or_part5408!==false) {var if_res3384 = or_part5408;} else {var if_res3384 = M0.regexp_p(pattern5401);}if (if_res3384!==false) {var if_res3385 = M0.path__gt_string(string5402);} else {var if_res3385 = M0.path__gt_bytes(string5402);}var if_res3386 = if_res3385;} else {var if_res3386 = string5402;}var string5407 = if_res3386;if (M0.string_p(string5407)!==false) {var if_res3388 = M0.string_length(string5407);} else {if (M0.bytes_p(string5407)!==false) {var if_res3387 = M0.bytes_length(string5407);} else {var if_res3387 = false;}var if_res3388 = if_res3387;}var len5409 = if_res3388;if (M0.bytes_p(pattern5401)!==false) {var if_res3392 = M0.byte_regexp(pattern5401);} else {if (M0.string_p(pattern5401)!==false) {var if_res3391 = M0.regexp(pattern5401);} else {if (M0.regexp_p(pattern5401)!==false) {var if_res3390 = pattern5401;} else {if (M0.byte_regexp_p(pattern5401)!==false) {var if_res3389 = pattern5401;} else {var if_res3389 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5401);}var if_res3390 = if_res3389;}var if_res3391 = if_res3390;}var if_res3392 = if_res3391;}var orig_rx5410 = if_res3392;var max_lookbehind5411 = M0.regexp_max_lookbehind(orig_rx5410);if (true!==false) {if (M0.input_port_p(string5407)!==false) {var if_res3393 = M0.rvoid();} else {var if_res3393 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("input-port?"),string5407);}var if_res3396 = if_res3393;} else {var or_part5412 = len5409;if (or_part5412!==false) {var if_res3394 = or_part5412;} else {var if_res3394 = M0.input_port_p(string5407);}if (if_res3394!==false) {var if_res3395 = M0.rvoid();} else {var if_res3395 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5407);}var if_res3396 = if_res3395;}if_res3396;if (M0.number_p(start5403)!==false) {if (M0.exact_p(start5403)!==false) {if (M0.integer_p(start5403)!==false) {var if_res3397 = M0.__gt__eq_(start5403,0);} else {var if_res3397 = false;}var if_res3398 = if_res3397;} else {var if_res3398 = false;}var if_res3399 = if_res3398;} else {var if_res3399 = false;}if (if_res3399!==false) {var if_res3400 = M0.rvoid();} else {var if_res3400 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5403);}if_res3400;var or_part5413 = M0.not(end5404);if (or_part5413!==false) {var if_res3404 = or_part5413;} else {if (M0.number_p(end5404)!==false) {if (M0.exact_p(end5404)!==false) {if (M0.integer_p(end5404)!==false) {var if_res3401 = M0.__gt__eq_(end5404,0);} else {var if_res3401 = false;}var if_res3402 = if_res3401;} else {var if_res3402 = false;}var if_res3403 = if_res3402;} else {var if_res3403 = false;}var if_res3404 = if_res3403;}if (if_res3404!==false) {var if_res3405 = M0.rvoid();} else {var if_res3405 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5404);}if_res3405;if (M0.bytes_p(ipre5405)!==false) {var if_res3406 = M0.rvoid();} else {var if_res3406 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("bytes?"),ipre5405);}if_res3406;var or_part5414 = M0.input_port_p(string5407);if (or_part5414!==false) {var if_res3408 = or_part5414;} else {if (len5409!==false) {var if_res3407 = M0.__lt__eq_(start5403,len5409);} else {var if_res3407 = false;}var if_res3408 = if_res3407;}if (if_res3408!==false) {var if_res3409 = M0.rvoid();} else {var if_res3409 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5409),start5403);}if_res3409;var or_part5415 = M0.not(end5404);if (or_part5415!==false) {var if_res3413 = or_part5415;} else {if (M0.__lt__eq_(start5403,end5404)!==false) {var or_part5416 = M0.input_port_p(string5407);if (or_part5416!==false) {var if_res3411 = or_part5416;} else {if (len5409!==false) {var if_res3410 = M0.__lt__eq_(end5404,len5409);} else {var if_res3410 = false;}var if_res3411 = if_res3410;}var if_res3412 = if_res3411;} else {var if_res3412 = false;}var if_res3413 = if_res3412;}if (if_res3413!==false) {var if_res3414 = M0.rvoid();} else {var if_res3414 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5403,len5409),end5404);}if_res3414;var loop5417 = function(acc5418, start5419, end5420, ipre5421, _0_ok_p5422) {if (_0_ok_p5422!==false) {var if_res3415 = orig_rx5410;} else {var if_res3415 = no_empty_edge_matches(orig_rx5410,M0.add1(M0.bytes_length(ipre5421)));}var rx5423 = if_res3415;if (false!==false) {var if_res3416 = M0.input_port_p(string5407);} else {var if_res3416 = false;}if (if_res3416!==false) {if (M0.positive_p(start5419)!==false) {var s5425 = M0.make_bytes(4096);var loop5426 = function(n5427) {if (M0.__eq_(n5427,start5419)!==false) {var if_res3418 = M0.rvoid();} else {var m5428 = M0.read_bytes_avail_bang_(s5425,string5407,0,M0.min(start5419-n5427,4096));if (M0.eof_object_p(m5428)!==false) {var if_res3417 = M0.rvoid();} else {var if_res3417 = loop5426(n5427+m5428);}var if_res3418 = if_res3417;}return if_res3418;};var if_res3419 = loop5426(0);} else {var if_res3419 = M0.rvoid();}var _5424 = if_res3419;if (false!==false) {var if_res3420 = false;} else {var if_res3420 = 0;}var discarded_by_leftovers5429 = if_res3420;if (false!==false) {var if_res3421 = M0.open_output_bytes();} else {var if_res3421 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5431, start5432, end5433, flush_p5434, breakable_p5435) {var c5436 = end5433-start5432;discarded_by_leftovers5429 = c5436+discarded_by_leftovers5429;return c5436;},M0.rvoid);}var spitout5430 = if_res3421;if (end5420!==false) {var if_res3422 = end5420-start5419;} else {var if_res3422 = false;}var end5437 = if_res3422;var let_result3423 = M0.regexp_match_by_end(rx5423,string5407,0,end5437,spitout5430,ipre5421,max_lookbehind5411);var ms5438 = let_result3423.getAt(0);var ipre5439 = let_result3423.getAt(1);if (ms5438!==false) {var if_res3424 = M0.car(ms5438);} else {var if_res3424 = false;}var m5440 = if_res3424;if (false!==false) {var if_res3425 = M0.get_output_bytes(spitout5430);} else {var if_res3425 = discarded_by_leftovers5429;}var discarded_by_leftovers5441 = if_res3425;if (false!==false) {var if_res3426 = bstring_length(discarded_by_leftovers5441);} else {var if_res3426 = discarded_by_leftovers5441;}var skipped5442 = if_res3426;if (m5440!==false) {var if_res3427 = bstring_length(m5440);} else {var if_res3427 = false;}var got5443 = if_res3427;if (end5437!==false) {if (m5440!==false) {var if_res3428 = end5437-skipped5442-got5443;} else {var if_res3428 = false;}var if_res3429 = if_res3428;} else {var if_res3429 = false;}var end5444 = if_res3429;if (m5440!==false) {var _0_ok_p5445 = M0.not(M0.zero_p(got5443));var if_res3430 = loop5417(false(discarded_by_leftovers5441,ms5438,acc5418),0,end5444,ipre5439,_0_ok_p5445);} else {var if_res3430 = false(acc5418,discarded_by_leftovers5441);}var if_res3436 = if_res3430;} else {if (true!==false) {var if_res3431 = M0.regexp_match_peek_positions_by_end(rx5423,string5407,start5419,end5420,false,ipre5421,max_lookbehind5411);} else {var if_res3431 = M0.regexp_match_positions_by_end(rx5423,string5407,start5419,end5420,false,ipre5421,max_lookbehind5411);}var let_result3432 = if_res3431;var m5446 = let_result3432.getAt(0);var ipre5447 = let_result3432.getAt(1);if (M0.not(m5446)!==false) {var if_res3435 = (function(acc5448, start5449, end5450) {return acc5448;})(acc5418,start5419,end5420);} else {var mstart5451 = M0.caar(m5446);var mend5452 = M0.cdar(m5446);var _0_ok_p5453 = M0.not(M0.__eq_(mstart5451,mend5452));if (false!==false) {var if_res3433 = M0.input_port_p(string5407);} else {var if_res3433 = false;}if (if_res3433!==false) {var if_res3434 = false(function(acc5454, new_start5455, new_end5456) {return loop5417(acc5454,new_start5455,new_end5456,ipre5447,_0_ok_p5453);},acc5418,start5419,end5420,m5446);} else {var if_res3434 = loop5417((function(start5457, ms5458, acc5459) {return M0.cons(M0.car(ms5458),acc5459);})(start5419,m5446,acc5418),mend5452,end5420,ipre5447,_0_ok_p5453);}var if_res3435 = if_res3434;}var if_res3436 = if_res3435;}return if_res3436;};var if_res3490 = M0.reverse(loop5417($rjs_core.Pair.makeList(),start5403,end5404,ipre5405,true));} else {if (M0.path_p(string5402)!==false) {var or_part5461 = M0.string_p(pattern5401);if (or_part5461!==false) {var if_res3437 = or_part5461;} else {var if_res3437 = M0.regexp_p(pattern5401);}if (if_res3437!==false) {var if_res3438 = M0.path__gt_string(string5402);} else {var if_res3438 = M0.path__gt_bytes(string5402);}var if_res3439 = if_res3438;} else {var if_res3439 = string5402;}var string5460 = if_res3439;if (M0.string_p(string5460)!==false) {var if_res3441 = M0.string_length(string5460);} else {if (M0.bytes_p(string5460)!==false) {var if_res3440 = M0.bytes_length(string5460);} else {var if_res3440 = false;}var if_res3441 = if_res3440;}var len5462 = if_res3441;if (M0.bytes_p(pattern5401)!==false) {var if_res3445 = M0.byte_regexp(pattern5401);} else {if (M0.string_p(pattern5401)!==false) {var if_res3444 = M0.regexp(pattern5401);} else {if (M0.regexp_p(pattern5401)!==false) {var if_res3443 = pattern5401;} else {if (M0.byte_regexp_p(pattern5401)!==false) {var if_res3442 = pattern5401;} else {var if_res3442 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5401);}var if_res3443 = if_res3442;}var if_res3444 = if_res3443;}var if_res3445 = if_res3444;}var orig_rx5463 = if_res3445;var max_lookbehind5464 = M0.regexp_max_lookbehind(orig_rx5463);if (true!==false) {if (M0.input_port_p(string5460)!==false) {var if_res3446 = M0.rvoid();} else {var if_res3446 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("input-port?"),string5460);}var if_res3449 = if_res3446;} else {var or_part5465 = len5462;if (or_part5465!==false) {var if_res3447 = or_part5465;} else {var if_res3447 = M0.input_port_p(string5460);}if (if_res3447!==false) {var if_res3448 = M0.rvoid();} else {var if_res3448 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),string5460);}var if_res3449 = if_res3448;}if_res3449;if (M0.number_p(start5403)!==false) {if (M0.exact_p(start5403)!==false) {if (M0.integer_p(start5403)!==false) {var if_res3450 = M0.__gt__eq_(start5403,0);} else {var if_res3450 = false;}var if_res3451 = if_res3450;} else {var if_res3451 = false;}var if_res3452 = if_res3451;} else {var if_res3452 = false;}if (if_res3452!==false) {var if_res3453 = M0.rvoid();} else {var if_res3453 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5403);}if_res3453;var or_part5466 = M0.not(end5404);if (or_part5466!==false) {var if_res3457 = or_part5466;} else {if (M0.number_p(end5404)!==false) {if (M0.exact_p(end5404)!==false) {if (M0.integer_p(end5404)!==false) {var if_res3454 = M0.__gt__eq_(end5404,0);} else {var if_res3454 = false;}var if_res3455 = if_res3454;} else {var if_res3455 = false;}var if_res3456 = if_res3455;} else {var if_res3456 = false;}var if_res3457 = if_res3456;}if (if_res3457!==false) {var if_res3458 = M0.rvoid();} else {var if_res3458 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5404);}if_res3458;if (M0.bytes_p(ipre5405)!==false) {var if_res3459 = M0.rvoid();} else {var if_res3459 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),$rjs_core.UString.make("bytes?"),ipre5405);}if_res3459;var or_part5467 = M0.input_port_p(string5460);if (or_part5467!==false) {var if_res3461 = or_part5467;} else {if (len5462!==false) {var if_res3460 = M0.__lt__eq_(start5403,len5462);} else {var if_res3460 = false;}var if_res3461 = if_res3460;}if (if_res3461!==false) {var if_res3462 = M0.rvoid();} else {var if_res3462 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5462),start5403);}if_res3462;var or_part5468 = M0.not(end5404);if (or_part5468!==false) {var if_res3466 = or_part5468;} else {if (M0.__lt__eq_(start5403,end5404)!==false) {var or_part5469 = M0.input_port_p(string5460);if (or_part5469!==false) {var if_res3464 = or_part5469;} else {if (len5462!==false) {var if_res3463 = M0.__lt__eq_(end5404,len5462);} else {var if_res3463 = false;}var if_res3464 = if_res3463;}var if_res3465 = if_res3464;} else {var if_res3465 = false;}var if_res3466 = if_res3465;}if (if_res3466!==false) {var if_res3467 = M0.rvoid();} else {var if_res3467 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match-peek-positions*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5403,len5462),end5404);}if_res3467;var loop5470 = function(acc5471, start5472, end5473, ipre5474, _0_ok_p5475) {if (_0_ok_p5475!==false) {var if_res3468 = orig_rx5463;} else {var if_res3468 = no_empty_edge_matches(orig_rx5463,M0.add1(M0.bytes_length(ipre5474)));}var rx5476 = if_res3468;if (false!==false) {var if_res3469 = M0.input_port_p(string5460);} else {var if_res3469 = false;}if (if_res3469!==false) {if (M0.positive_p(start5472)!==false) {var s5478 = M0.make_bytes(4096);var loop5479 = function(n5480) {if (M0.__eq_(n5480,start5472)!==false) {var if_res3471 = M0.rvoid();} else {var m5481 = M0.read_bytes_avail_bang_(s5478,string5460,0,M0.min(start5472-n5480,4096));if (M0.eof_object_p(m5481)!==false) {var if_res3470 = M0.rvoid();} else {var if_res3470 = loop5479(n5480+m5481);}var if_res3471 = if_res3470;}return if_res3471;};var if_res3472 = loop5479(0);} else {var if_res3472 = M0.rvoid();}var _5477 = if_res3472;if (false!==false) {var if_res3473 = false;} else {var if_res3473 = 0;}var discarded_by_leftovers5482 = if_res3473;if (false!==false) {var if_res3474 = M0.open_output_bytes();} else {var if_res3474 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5484, start5485, end5486, flush_p5487, breakable_p5488) {var c5489 = end5486-start5485;discarded_by_leftovers5482 = c5489+discarded_by_leftovers5482;return c5489;},M0.rvoid);}var spitout5483 = if_res3474;if (end5473!==false) {var if_res3475 = end5473-start5472;} else {var if_res3475 = false;}var end5490 = if_res3475;var let_result3476 = M0.regexp_match_by_end(rx5476,string5460,0,end5490,spitout5483,ipre5474,max_lookbehind5464);var ms5491 = let_result3476.getAt(0);var ipre5492 = let_result3476.getAt(1);if (ms5491!==false) {var if_res3477 = M0.car(ms5491);} else {var if_res3477 = false;}var m5493 = if_res3477;if (false!==false) {var if_res3478 = M0.get_output_bytes(spitout5483);} else {var if_res3478 = discarded_by_leftovers5482;}var discarded_by_leftovers5494 = if_res3478;if (false!==false) {var if_res3479 = bstring_length(discarded_by_leftovers5494);} else {var if_res3479 = discarded_by_leftovers5494;}var skipped5495 = if_res3479;if (m5493!==false) {var if_res3480 = bstring_length(m5493);} else {var if_res3480 = false;}var got5496 = if_res3480;if (end5490!==false) {if (m5493!==false) {var if_res3481 = end5490-skipped5495-got5496;} else {var if_res3481 = false;}var if_res3482 = if_res3481;} else {var if_res3482 = false;}var end5497 = if_res3482;if (m5493!==false) {var _0_ok_p5498 = M0.not(M0.zero_p(got5496));var if_res3483 = loop5470(false(discarded_by_leftovers5494,ms5491,acc5471),0,end5497,ipre5492,_0_ok_p5498);} else {var if_res3483 = false(acc5471,discarded_by_leftovers5494);}var if_res3489 = if_res3483;} else {if (true!==false) {var if_res3484 = M0.regexp_match_peek_positions_by_end(rx5476,string5460,start5472,end5473,false,ipre5474,max_lookbehind5464);} else {var if_res3484 = M0.regexp_match_positions_by_end(rx5476,string5460,start5472,end5473,false,ipre5474,max_lookbehind5464);}var let_result3485 = if_res3484;var m5499 = let_result3485.getAt(0);var ipre5500 = let_result3485.getAt(1);if (M0.not(m5499)!==false) {var if_res3488 = (function(acc5501, start5502, end5503) {return acc5501;})(acc5471,start5472,end5473);} else {var mstart5504 = M0.caar(m5499);var mend5505 = M0.cdar(m5499);var _0_ok_p5506 = M0.not(M0.__eq_(mstart5504,mend5505));if (false!==false) {var if_res3486 = M0.input_port_p(string5460);} else {var if_res3486 = false;}if (if_res3486!==false) {var if_res3487 = false(function(acc5507, new_start5508, new_end5509) {return loop5470(acc5507,new_start5508,new_end5509,ipre5500,_0_ok_p5506);},acc5471,start5472,end5473,m5499);} else {var if_res3487 = loop5470((function(start5510, ms5511, acc5512) {return M0.cons(match_select5406(ms5511),acc5512);})(start5472,m5499,acc5471),mend5505,end5473,ipre5500,_0_ok_p5506);}var if_res3488 = if_res3487;}var if_res3489 = if_res3488;}return if_res3489;};var if_res3490 = M0.reverse(loop5470($rjs_core.Pair.makeList(),start5403,end5404,ipre5405,true));}return if_res3490;};var regexp_match_peek_positions_times_5100 = function(given_kws5513, given_args5514, pattern245515, string255516, start215517, end225518, ipre235519) {var match_select205520 = M0.pair_p(given_kws5513);if (match_select205520!==false) {var if_res3491 = M0.car(given_args5514);} else {var if_res3491 = M7.unsafe_undefined;}var match_select195521 = if_res3491;return regexp_match_peek_positions_times_(match_select195521,pattern245515,string255516,start215517,end225518,ipre235519);};var cl3498 = function(given_kws5526, given_args5527, pattern5528, string5529) {return regexp_match_peek_positions_times_5100(given_kws5526,given_args5527,pattern5528,string5529,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3499 = function(given_kws5530, given_args5531, pattern5532, string5533, start5534, end5535, ipre235536) {return regexp_match_peek_positions_times_5100(given_kws5530,given_args5531,pattern5532,string5533,start5534,end5535,ipre235536);};var cl3500 = function(given_kws5537, given_args5538, pattern5539, string5540, start5541, end225542) {return regexp_match_peek_positions_times_5100(given_kws5537,given_args5538,pattern5539,string5540,start5541,end225542,$rjs_core.Bytes.fromIntArray([]));};var cl3501 = function(given_kws5543, given_args5544, pattern5545, string5546, start215547) {return regexp_match_peek_positions_times_5100(given_kws5543,given_args5544,pattern5545,string5546,start215547,false,$rjs_core.Bytes.fromIntArray([]));};var temp3503 = $rjs_core.attachProcedureArity(function() {var fixed_lam3502 = {'4':cl3498,'7':cl3499,'6':cl3500,'5':cl3501}[arguments.length];if (fixed_lam3502!==undefined) {return fixed_lam3502.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6,7]);var temp3497 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("match-select"));var cl3492 = function(pattern5548, string5549) {return regexp_match_peek_positions_times_5100(M0.rnull,M0.rnull,pattern5548,string5549,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3493 = function(pattern5550, string5551, start5552, end5553, ipre235554) {return regexp_match_peek_positions_times_5100(M0.rnull,M0.rnull,pattern5550,string5551,start5552,end5553,ipre235554);};var cl3494 = function(pattern5555, string5556, start5557, end225558) {return regexp_match_peek_positions_times_5100(M0.rnull,M0.rnull,pattern5555,string5556,start5557,end225558,$rjs_core.Bytes.fromIntArray([]));};var cl3495 = function(pattern5559, string5560, start215561) {return regexp_match_peek_positions_times_5100(M0.rnull,M0.rnull,pattern5559,string5560,start215561,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_match_peek_positions_times_26 = M2.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws5522, given_argc5523) {if (M0.__gt__eq_(given_argc5523,4)!==false) {var if_res3504 = M0.__lt__eq_(given_argc5523,7);} else {var if_res3504 = false;}if (if_res3504!==false) {var l12060465524 = given_kws5522;if (M0.null_p(l12060465524)!==false) {var if_res3506 = l12060465524;} else {if (M0.eq_p(M0.car(l12060465524),$rjs_core.Keyword.make("match-select"))!==false) {var if_res3505 = M0.cdr(l12060465524);} else {var if_res3505 = l12060465524;}var if_res3506 = if_res3505;}var l12060465525 = if_res3506;var if_res3507 = M0.null_p(l12060465525);} else {var if_res3507 = false;}return if_res3507;},temp3503,M0.rnull,temp3497,$rjs_core.attachProcedureArity(function() {var fixed_lam3496 = {'2':cl3492,'5':cl3493,'4':cl3494,'3':cl3495}[arguments.length];if (fixed_lam3496!==undefined) {return fixed_lam3496.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]));var get_buf_plus_sub = function(string5562, pattern5563) {if (M0.string_p(string5562)!==false) {var or_part5565 = M0.byte_regexp_p(pattern5563);if (or_part5565!==false) {var if_res3508 = or_part5565;} else {var if_res3508 = M0.bytes_p(pattern5563);}var if_res3509 = if_res3508;} else {var if_res3509 = false;}if (if_res3509!==false) {var if_res3510 = M0.string__gt_bytes_by_utf_8(string5562,M0.char__gt_integer($rjs_core.Char.charFromCodepoint(63)));} else {var if_res3510 = string5562;}var buf5564 = if_res3510;var or_part5566 = M0.bytes_p(buf5564);if (or_part5566!==false) {var if_res3513 = or_part5566;} else {if (M0.path_p(string5562)!==false) {var or_part5567 = M0.bytes_p(pattern5563);if (or_part5567!==false) {var if_res3511 = or_part5567;} else {var if_res3511 = M0.byte_regexp_p(pattern5563);}var if_res3512 = if_res3511;} else {var if_res3512 = false;}var if_res3513 = if_res3512;}if (if_res3513!==false) {var if_res3514 = M0.subbytes;} else {var if_res3514 = M0.substring;}return M0.values(buf5564,if_res3514);};var regexp_split5568 = function(pattern305569, string315570, start275571, end285572, ipre295573) {var pattern5574 = pattern305569;var string5575 = string315570;if (false!==false) {var if_res3515 = 0;} else {var if_res3515 = start275571;}var start5576 = if_res3515;if (false!==false) {var if_res3516 = false;} else {var if_res3516 = end285572;}var end5577 = if_res3516;if (false!==false) {var if_res3517 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3517 = ipre295573;}var ipre5578 = if_res3517;var let_result3518 = get_buf_plus_sub(string5575,pattern5574);var buf5579 = let_result3518.getAt(0);var sub5580 = let_result3518.getAt(1);if (M0.path_p(buf5579)!==false) {var or_part5582 = M0.string_p(pattern5574);if (or_part5582!==false) {var if_res3519 = or_part5582;} else {var if_res3519 = M0.regexp_p(pattern5574);}if (if_res3519!==false) {var if_res3520 = M0.path__gt_string(buf5579);} else {var if_res3520 = M0.path__gt_bytes(buf5579);}var if_res3521 = if_res3520;} else {var if_res3521 = buf5579;}var buf5581 = if_res3521;if (M0.string_p(buf5581)!==false) {var if_res3523 = M0.string_length(buf5581);} else {if (M0.bytes_p(buf5581)!==false) {var if_res3522 = M0.bytes_length(buf5581);} else {var if_res3522 = false;}var if_res3523 = if_res3522;}var len5583 = if_res3523;if (M0.bytes_p(pattern5574)!==false) {var if_res3527 = M0.byte_regexp(pattern5574);} else {if (M0.string_p(pattern5574)!==false) {var if_res3526 = M0.regexp(pattern5574);} else {if (M0.regexp_p(pattern5574)!==false) {var if_res3525 = pattern5574;} else {if (M0.byte_regexp_p(pattern5574)!==false) {var if_res3524 = pattern5574;} else {var if_res3524 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5574);}var if_res3525 = if_res3524;}var if_res3526 = if_res3525;}var if_res3527 = if_res3526;}var orig_rx5584 = if_res3527;var max_lookbehind5585 = M0.regexp_max_lookbehind(orig_rx5584);if (false!==false) {if (M0.input_port_p(buf5581)!==false) {var if_res3528 = M0.rvoid();} else {var if_res3528 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("input-port?"),buf5581);}var if_res3531 = if_res3528;} else {var or_part5586 = len5583;if (or_part5586!==false) {var if_res3529 = or_part5586;} else {var if_res3529 = M0.input_port_p(buf5581);}if (if_res3529!==false) {var if_res3530 = M0.rvoid();} else {var if_res3530 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5581);}var if_res3531 = if_res3530;}if_res3531;if (M0.number_p(start5576)!==false) {if (M0.exact_p(start5576)!==false) {if (M0.integer_p(start5576)!==false) {var if_res3532 = M0.__gt__eq_(start5576,0);} else {var if_res3532 = false;}var if_res3533 = if_res3532;} else {var if_res3533 = false;}var if_res3534 = if_res3533;} else {var if_res3534 = false;}if (if_res3534!==false) {var if_res3535 = M0.rvoid();} else {var if_res3535 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5576);}if_res3535;var or_part5587 = M0.not(end5577);if (or_part5587!==false) {var if_res3539 = or_part5587;} else {if (M0.number_p(end5577)!==false) {if (M0.exact_p(end5577)!==false) {if (M0.integer_p(end5577)!==false) {var if_res3536 = M0.__gt__eq_(end5577,0);} else {var if_res3536 = false;}var if_res3537 = if_res3536;} else {var if_res3537 = false;}var if_res3538 = if_res3537;} else {var if_res3538 = false;}var if_res3539 = if_res3538;}if (if_res3539!==false) {var if_res3540 = M0.rvoid();} else {var if_res3540 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5577);}if_res3540;if (M0.bytes_p(ipre5578)!==false) {var if_res3541 = M0.rvoid();} else {var if_res3541 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-split"),$rjs_core.UString.make("bytes?"),ipre5578);}if_res3541;var or_part5588 = M0.input_port_p(buf5581);if (or_part5588!==false) {var if_res3543 = or_part5588;} else {if (len5583!==false) {var if_res3542 = M0.__lt__eq_(start5576,len5583);} else {var if_res3542 = false;}var if_res3543 = if_res3542;}if (if_res3543!==false) {var if_res3544 = M0.rvoid();} else {var if_res3544 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-split"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5583),start5576);}if_res3544;var or_part5589 = M0.not(end5577);if (or_part5589!==false) {var if_res3548 = or_part5589;} else {if (M0.__lt__eq_(start5576,end5577)!==false) {var or_part5590 = M0.input_port_p(buf5581);if (or_part5590!==false) {var if_res3546 = or_part5590;} else {if (len5583!==false) {var if_res3545 = M0.__lt__eq_(end5577,len5583);} else {var if_res3545 = false;}var if_res3546 = if_res3545;}var if_res3547 = if_res3546;} else {var if_res3547 = false;}var if_res3548 = if_res3547;}if (if_res3548!==false) {var if_res3549 = M0.rvoid();} else {var if_res3549 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-split"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5576,len5583),end5577);}if_res3549;var loop5591 = function(acc5592, start5593, end5594, ipre5595, _0_ok_p5596) {if (_0_ok_p5596!==false) {var if_res3550 = orig_rx5584;} else {var if_res3550 = no_empty_edge_matches(orig_rx5584,M0.add1(M0.bytes_length(ipre5595)));}var rx5597 = if_res3550;if (function(leftovers5598, ms5599, acc5600) {return M0.cons(leftovers5598,acc5600);}!==false) {var if_res3551 = M0.input_port_p(buf5581);} else {var if_res3551 = false;}if (if_res3551!==false) {if (M0.positive_p(start5593)!==false) {var s5602 = M0.make_bytes(4096);var loop5603 = function(n5604) {if (M0.__eq_(n5604,start5593)!==false) {var if_res3553 = M0.rvoid();} else {var m5605 = M0.read_bytes_avail_bang_(s5602,buf5581,0,M0.min(start5593-n5604,4096));if (M0.eof_object_p(m5605)!==false) {var if_res3552 = M0.rvoid();} else {var if_res3552 = loop5603(n5604+m5605);}var if_res3553 = if_res3552;}return if_res3553;};var if_res3554 = loop5603(0);} else {var if_res3554 = M0.rvoid();}var _5601 = if_res3554;if (true!==false) {var if_res3555 = false;} else {var if_res3555 = 0;}var discarded_by_leftovers5606 = if_res3555;if (true!==false) {var if_res3556 = M0.open_output_bytes();} else {var if_res3556 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5608, start5609, end5610, flush_p5611, breakable_p5612) {var c5613 = end5610-start5609;discarded_by_leftovers5606 = c5613+discarded_by_leftovers5606;return c5613;},M0.rvoid);}var spitout5607 = if_res3556;if (end5594!==false) {var if_res3557 = end5594-start5593;} else {var if_res3557 = false;}var end5614 = if_res3557;var let_result3558 = M0.regexp_match_by_end(rx5597,buf5581,0,end5614,spitout5607,ipre5595,max_lookbehind5585);var ms5615 = let_result3558.getAt(0);var ipre5616 = let_result3558.getAt(1);if (ms5615!==false) {var if_res3559 = M0.car(ms5615);} else {var if_res3559 = false;}var m5617 = if_res3559;if (true!==false) {var if_res3560 = M0.get_output_bytes(spitout5607);} else {var if_res3560 = discarded_by_leftovers5606;}var discarded_by_leftovers5618 = if_res3560;if (true!==false) {var if_res3561 = bstring_length(discarded_by_leftovers5618);} else {var if_res3561 = discarded_by_leftovers5618;}var skipped5619 = if_res3561;if (m5617!==false) {var if_res3562 = bstring_length(m5617);} else {var if_res3562 = false;}var got5620 = if_res3562;if (end5614!==false) {if (m5617!==false) {var if_res3563 = end5614-skipped5619-got5620;} else {var if_res3563 = false;}var if_res3564 = if_res3563;} else {var if_res3564 = false;}var end5621 = if_res3564;if (m5617!==false) {var _0_ok_p5622 = M0.not(M0.zero_p(got5620));var if_res3566 = loop5591((function(leftovers5623, ms5624, acc5625) {return M0.cons(leftovers5623,acc5625);})(discarded_by_leftovers5618,ms5615,acc5592),0,end5621,ipre5616,_0_ok_p5622);} else {var if_res3566 = (function(acc5626, leftover5627) {if (leftover5627!==false) {var if_res3565 = M0.cons(leftover5627,acc5626);} else {var if_res3565 = acc5626;}return if_res3565;})(acc5592,discarded_by_leftovers5618);}var if_res3573 = if_res3566;} else {if (false!==false) {var if_res3567 = M0.regexp_match_peek_positions_by_end(rx5597,buf5581,start5593,end5594,false,ipre5595,max_lookbehind5585);} else {var if_res3567 = M0.regexp_match_positions_by_end(rx5597,buf5581,start5593,end5594,false,ipre5595,max_lookbehind5585);}var let_result3568 = if_res3567;var m5628 = let_result3568.getAt(0);var ipre5629 = let_result3568.getAt(1);if (M0.not(m5628)!==false) {var if_res3572 = (function(acc5630, start5631, end5632) {if (end5632!==false) {var if_res3569 = sub5580(buf5581,start5631,end5632);} else {var if_res3569 = sub5580(buf5581,start5631);}return M0.cons(if_res3569,acc5630);})(acc5592,start5593,end5594);} else {var mstart5633 = M0.caar(m5628);var mend5634 = M0.cdar(m5628);var _0_ok_p5635 = M0.not(M0.__eq_(mstart5633,mend5634));if (false!==false) {var if_res3570 = M0.input_port_p(buf5581);} else {var if_res3570 = false;}if (if_res3570!==false) {var if_res3571 = false(function(acc5636, new_start5637, new_end5638) {return loop5591(acc5636,new_start5637,new_end5638,ipre5629,_0_ok_p5635);},acc5592,start5593,end5594,m5628);} else {var if_res3571 = loop5591((function(start5639, ms5640, acc5641) {return M0.cons(sub5580(buf5581,start5639,M0.caar(ms5640)),acc5641);})(start5593,m5628,acc5592),mend5634,end5594,ipre5629,_0_ok_p5635);}var if_res3572 = if_res3571;}var if_res3573 = if_res3572;}return if_res3573;};return M0.reverse(loop5591($rjs_core.Pair.makeList(),start5576,end5577,ipre5578,true));};var cl3574 = function(pattern5642, string5643) {return regexp_split5568(pattern5642,string5643,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3575 = function(pattern5644, string5645, start5646, end5647, ipre295648) {return regexp_split5568(pattern5644,string5645,start5646,end5647,ipre295648);};var cl3576 = function(pattern5649, string5650, start5651, end285652) {return regexp_split5568(pattern5649,string5650,start5651,end285652,$rjs_core.Bytes.fromIntArray([]));};var cl3577 = function(pattern5653, string5654, start275655) {return regexp_split5568(pattern5653,string5654,start275655,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_split = $rjs_core.attachProcedureArity(function() {var fixed_lam3578 = {'2':cl3574,'5':cl3575,'4':cl3576,'3':cl3577}[arguments.length];if (fixed_lam3578!==undefined) {return fixed_lam3578.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]);var regexp_replace_times_5657 = function(pattern455658, string465659, orig_replacement475660, start425661, end435662, ipre445663) {var pattern5664 = pattern455658;var string5665 = string465659;var orig_replacement5666 = orig_replacement475660;if (false!==false) {var if_res3579 = 0;} else {var if_res3579 = start425661;}var start5667 = if_res3579;if (false!==false) {var if_res3580 = false;} else {var if_res3580 = end435662;}var end5668 = if_res3580;if (false!==false) {var if_res3581 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3581 = ipre445663;}var ipre5669 = if_res3581;var let_result3582 = get_buf_plus_sub(string5665,pattern5664);var buf5670 = let_result3582.getAt(0);var sub5671 = let_result3582.getAt(1);var or_part5673 = M0.string_p(pattern5664);if (or_part5673!==false) {var if_res3583 = or_part5673;} else {var if_res3583 = M0.regexp_p(pattern5664);}if (if_res3583!==false) {var if_res3584 = M0.string_p(string5665);} else {var if_res3584 = false;}var needs_string_p5672 = if_res3584;if (M0.not(needs_string_p5672)!==false) {var if_res3585 = M0.string_p(orig_replacement5666);} else {var if_res3585 = false;}if (if_res3585!==false) {var if_res3586 = M0.string__gt_bytes_by_utf_8(orig_replacement5666);} else {var if_res3586 = orig_replacement5666;}var replacement5674 = if_res3586;var check5675 = function(proc5676, args5677) {var v5678 = M0.apply(proc5676,args5677);if (needs_string_p5672!==false) {var if_res3587 = M0.string_p(v5678);} else {var if_res3587 = M0.bytes_p(v5678);}if (if_res3587!==false) {var if_res3590 = M0.rvoid();} else {var temp3589 = $rjs_core.PrimitiveSymbol.make("regexp-replace* (calling given filter procedure)");if (needs_string_p5672!==false) {var if_res3588 = $rjs_core.UString.make("expected a string result: ");} else {var if_res3588 = $rjs_core.UString.make("expected a byte string result: ");}var if_res3590 = M0.raise_mismatch_error(temp3589,if_res3588,v5678);}if_res3590;return v5678;};if (M0.not(M0.procedure_p(replacement5674))!==false) {var if_res3591 = M0.regexp_match_p($rjs_core.Regexp.fromString("[\\&]"),replacement5674);} else {var if_res3591 = false;}var need_replac_p5679 = if_res3591;var replac5680 = function(ms5681, str5682) {if (need_replac_p5679!==false) {if (M0.string_p(str5682)!==false) {var if_res3607 = M0.bytes__gt_string_by_utf_8;} else {var if_res3607 = M0.values;}if (M0.string_p(str5682)!==false) {var if_res3592 = M0.string__gt_bytes_by_utf_8(str5682);} else {var if_res3592 = str5682;}var str5683 = if_res3592;var get_match5684 = function(n5685) {if (M0.__lt_(n5685,M0.length(ms5681))!==false) {var p5686 = M0.list_ref(ms5681,n5685);if (M0.pair_p(p5686)!==false) {var if_res3593 = sub5671(buf5670,M0.car(p5686),M0.cdr(p5686));} else {var if_res3593 = p5686;}var s5687 = if_res3593;if (M0.string_p(s5687)!==false) {var if_res3594 = M0.string__gt_bytes_by_utf_8(s5687);} else {var if_res3594 = s5687;}var if_res3595 = if_res3594;} else {var if_res3595 = $rjs_core.Bytes.fromIntArray([]);}return if_res3595;};var loop5688 = function(pos5689) {var m5690 = M0.regexp_match_positions($rjs_core.Regexp.fromString("[\\&]"),str5683,pos5689);if (m5690!==false) {var temp3605 = M0.subbytes(str5683,pos5689,M0.caar(m5690));if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(38)),M0.bytes_ref(str5683,M0.caar(m5690)))!==false) {var if_res3604 = M0.cons(get_match5684(0),loop5688(M0.cdar(m5690)));} else {if (M0.__eq_(M0.cdar(m5690),M0.bytes_length(str5683))!==false) {var if_res3603 = M0.list(get_match5684(0));} else {var next5692 = M0.bytes_ref(str5683,M0.cdar(m5690));if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(38)),next5692)!==false) {var if_res3596 = $rjs_core.Bytes.fromIntArray([38]);} else {var if_res3596 = false;}var or_part5693 = if_res3596;if (or_part5693!==false) {var if_res3600 = or_part5693;} else {if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(92)),next5692)!==false) {var if_res3597 = $rjs_core.Bytes.fromIntArray([92]);} else {var if_res3597 = false;}var or_part5694 = if_res3597;if (or_part5694!==false) {var if_res3599 = or_part5694;} else {if (M0.equal_p(M0.char__gt_integer($rjs_core.Char.charFromCodepoint(36)),next5692)!==false) {var if_res3598 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3598 = false;}var if_res3599 = if_res3598;}var if_res3600 = if_res3599;}var c15691 = if_res3600;if (c15691!==false) {var if_res3602 = (function(s5695) {return M0.cons(s5695,loop5688(M0.add1(M0.cdar(m5690))));})(c15691);} else {var n5696 = M0.regexp_match($rjs_core.Regexp.fromString("^[0-9]+"),str5683,M0.cdar(m5690));if (n5696!==false) {var if_res3601 = M0.cons(get_match5684(M0.string__gt_number(M0.bytes__gt_string_by_utf_8(M0.car(n5696)))),loop5688(M0.cdar(m5690)+M0.bytes_length(M0.car(n5696))));} else {var if_res3601 = M0.cons(get_match5684(0),loop5688(M0.cdar(m5690)));}var if_res3602 = if_res3601;}var if_res3603 = if_res3602;}var if_res3604 = if_res3603;}var if_res3606 = M0.cons(temp3605,if_res3604);} else {var if_res3606 = M0.list(M0.subbytes(str5683,pos5689));}return if_res3606;};var if_res3608 = if_res3607(M0.apply(M0.bytes_append,loop5688(0)));} else {var if_res3608 = str5682;}return if_res3608;};var or_part5697 = M0.string_p(pattern5664);if (or_part5697!==false) {var if_res3611 = or_part5697;} else {var or_part5698 = M0.bytes_p(pattern5664);if (or_part5698!==false) {var if_res3610 = or_part5698;} else {var or_part5699 = M0.regexp_p(pattern5664);if (or_part5699!==false) {var if_res3609 = or_part5699;} else {var if_res3609 = M0.byte_regexp_p(pattern5664);}var if_res3610 = if_res3609;}var if_res3611 = if_res3610;}if (if_res3611!==false) {var or_part5700 = M0.string_p(string5665);if (or_part5700!==false) {var if_res3612 = or_part5700;} else {var if_res3612 = M0.bytes_p(string5665);}if (if_res3612!==false) {var if_res3613 = M0.rvoid();} else {var if_res3613 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c string? bytes?)"),string5665);}if_res3613;var or_part5701 = M0.string_p(replacement5674);if (or_part5701!==false) {var if_res3615 = or_part5701;} else {var or_part5702 = M0.bytes_p(replacement5674);if (or_part5702!==false) {var if_res3614 = or_part5702;} else {var if_res3614 = M0.procedure_p(replacement5674);}var if_res3615 = if_res3614;}if (if_res3615!==false) {var if_res3616 = M0.rvoid();} else {var if_res3616 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c string? bytes? procedure?)"),replacement5674);}if_res3616;if (needs_string_p5672!==false) {var if_res3617 = M0.bytes_p(replacement5674);} else {var if_res3617 = false;}if (if_res3617!==false) {var if_res3618 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("cannot replace a string with a byte string: "),replacement5674);} else {var if_res3618 = M0.rvoid();}var if_res3619 = if_res3618;} else {var if_res3619 = M0.rvoid();}if_res3619;var let_result3620 = M0.values();if (M0.path_p(buf5670)!==false) {var or_part5705 = M0.string_p(pattern5664);if (or_part5705!==false) {var if_res3621 = or_part5705;} else {var if_res3621 = M0.regexp_p(pattern5664);}if (if_res3621!==false) {var if_res3622 = M0.path__gt_string(buf5670);} else {var if_res3622 = M0.path__gt_bytes(buf5670);}var if_res3623 = if_res3622;} else {var if_res3623 = buf5670;}var buf5704 = if_res3623;if (M0.string_p(buf5704)!==false) {var if_res3625 = M0.string_length(buf5704);} else {if (M0.bytes_p(buf5704)!==false) {var if_res3624 = M0.bytes_length(buf5704);} else {var if_res3624 = false;}var if_res3625 = if_res3624;}var len5706 = if_res3625;if (M0.bytes_p(pattern5664)!==false) {var if_res3629 = M0.byte_regexp(pattern5664);} else {if (M0.string_p(pattern5664)!==false) {var if_res3628 = M0.regexp(pattern5664);} else {if (M0.regexp_p(pattern5664)!==false) {var if_res3627 = pattern5664;} else {if (M0.byte_regexp_p(pattern5664)!==false) {var if_res3626 = pattern5664;} else {var if_res3626 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5664);}var if_res3627 = if_res3626;}var if_res3628 = if_res3627;}var if_res3629 = if_res3628;}var orig_rx5707 = if_res3629;var max_lookbehind5708 = M0.regexp_max_lookbehind(orig_rx5707);if (false!==false) {if (M0.input_port_p(buf5704)!==false) {var if_res3630 = M0.rvoid();} else {var if_res3630 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("input-port?"),buf5704);}var if_res3633 = if_res3630;} else {var or_part5709 = len5706;if (or_part5709!==false) {var if_res3631 = or_part5709;} else {var if_res3631 = M0.input_port_p(buf5704);}if (if_res3631!==false) {var if_res3632 = M0.rvoid();} else {var if_res3632 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5704);}var if_res3633 = if_res3632;}if_res3633;if (M0.number_p(start5667)!==false) {if (M0.exact_p(start5667)!==false) {if (M0.integer_p(start5667)!==false) {var if_res3634 = M0.__gt__eq_(start5667,0);} else {var if_res3634 = false;}var if_res3635 = if_res3634;} else {var if_res3635 = false;}var if_res3636 = if_res3635;} else {var if_res3636 = false;}if (if_res3636!==false) {var if_res3637 = M0.rvoid();} else {var if_res3637 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5667);}if_res3637;var or_part5710 = M0.not(end5668);if (or_part5710!==false) {var if_res3641 = or_part5710;} else {if (M0.number_p(end5668)!==false) {if (M0.exact_p(end5668)!==false) {if (M0.integer_p(end5668)!==false) {var if_res3638 = M0.__gt__eq_(end5668,0);} else {var if_res3638 = false;}var if_res3639 = if_res3638;} else {var if_res3639 = false;}var if_res3640 = if_res3639;} else {var if_res3640 = false;}var if_res3641 = if_res3640;}if (if_res3641!==false) {var if_res3642 = M0.rvoid();} else {var if_res3642 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5668);}if_res3642;if (M0.bytes_p(ipre5669)!==false) {var if_res3643 = M0.rvoid();} else {var if_res3643 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),$rjs_core.UString.make("bytes?"),ipre5669);}if_res3643;var or_part5711 = M0.input_port_p(buf5704);if (or_part5711!==false) {var if_res3645 = or_part5711;} else {if (len5706!==false) {var if_res3644 = M0.__lt__eq_(start5667,len5706);} else {var if_res3644 = false;}var if_res3645 = if_res3644;}if (if_res3645!==false) {var if_res3646 = M0.rvoid();} else {var if_res3646 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5706),start5667);}if_res3646;var or_part5712 = M0.not(end5668);if (or_part5712!==false) {var if_res3650 = or_part5712;} else {if (M0.__lt__eq_(start5667,end5668)!==false) {var or_part5713 = M0.input_port_p(buf5704);if (or_part5713!==false) {var if_res3648 = or_part5713;} else {if (len5706!==false) {var if_res3647 = M0.__lt__eq_(end5668,len5706);} else {var if_res3647 = false;}var if_res3648 = if_res3647;}var if_res3649 = if_res3648;} else {var if_res3649 = false;}var if_res3650 = if_res3649;}if (if_res3650!==false) {var if_res3651 = M0.rvoid();} else {var if_res3651 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-replace*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5667,len5706),end5668);}if_res3651;var loop5714 = function(acc5715, start5716, end5717, ipre5718, _0_ok_p5719) {if (_0_ok_p5719!==false) {var if_res3652 = orig_rx5707;} else {var if_res3652 = no_empty_edge_matches(orig_rx5707,M0.add1(M0.bytes_length(ipre5718)));}var rx5720 = if_res3652;if (false!==false) {var if_res3653 = M0.input_port_p(buf5704);} else {var if_res3653 = false;}if (if_res3653!==false) {if (M0.positive_p(start5716)!==false) {var s5722 = M0.make_bytes(4096);var loop5723 = function(n5724) {if (M0.__eq_(n5724,start5716)!==false) {var if_res3655 = M0.rvoid();} else {var m5725 = M0.read_bytes_avail_bang_(s5722,buf5704,0,M0.min(start5716-n5724,4096));if (M0.eof_object_p(m5725)!==false) {var if_res3654 = M0.rvoid();} else {var if_res3654 = loop5723(n5724+m5725);}var if_res3655 = if_res3654;}return if_res3655;};var if_res3656 = loop5723(0);} else {var if_res3656 = M0.rvoid();}var _5721 = if_res3656;if (true!==false) {var if_res3657 = false;} else {var if_res3657 = 0;}var discarded_by_leftovers5726 = if_res3657;if (true!==false) {var if_res3658 = M0.open_output_bytes();} else {var if_res3658 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5728, start5729, end5730, flush_p5731, breakable_p5732) {var c5733 = end5730-start5729;discarded_by_leftovers5726 = c5733+discarded_by_leftovers5726;return c5733;},M0.rvoid);}var spitout5727 = if_res3658;if (end5717!==false) {var if_res3659 = end5717-start5716;} else {var if_res3659 = false;}var end5734 = if_res3659;var let_result3660 = M0.regexp_match_by_end(rx5720,buf5704,0,end5734,spitout5727,ipre5718,max_lookbehind5708);var ms5735 = let_result3660.getAt(0);var ipre5736 = let_result3660.getAt(1);if (ms5735!==false) {var if_res3661 = M0.car(ms5735);} else {var if_res3661 = false;}var m5737 = if_res3661;if (true!==false) {var if_res3662 = M0.get_output_bytes(spitout5727);} else {var if_res3662 = discarded_by_leftovers5726;}var discarded_by_leftovers5738 = if_res3662;if (true!==false) {var if_res3663 = bstring_length(discarded_by_leftovers5738);} else {var if_res3663 = discarded_by_leftovers5738;}var skipped5739 = if_res3663;if (m5737!==false) {var if_res3664 = bstring_length(m5737);} else {var if_res3664 = false;}var got5740 = if_res3664;if (end5734!==false) {if (m5737!==false) {var if_res3665 = end5734-skipped5739-got5740;} else {var if_res3665 = false;}var if_res3666 = if_res3665;} else {var if_res3666 = false;}var end5741 = if_res3666;if (m5737!==false) {var _0_ok_p5742 = M0.not(M0.zero_p(got5740));var if_res3667 = loop5714(false(discarded_by_leftovers5738,ms5735,acc5715),0,end5741,ipre5736,_0_ok_p5742);} else {var if_res3667 = false(acc5715,discarded_by_leftovers5738);}var if_res3687 = if_res3667;} else {if (false!==false) {var if_res3668 = M0.regexp_match_peek_positions_by_end(rx5720,buf5704,start5716,end5717,false,ipre5718,max_lookbehind5708);} else {var if_res3668 = M0.regexp_match_positions_by_end(rx5720,buf5704,start5716,end5717,false,ipre5718,max_lookbehind5708);}var let_result3669 = if_res3668;var m5743 = let_result3669.getAt(0);var ipre5744 = let_result3669.getAt(1);if (M0.not(m5743)!==false) {var if_res3686 = (function(acc5745, start5746, end5747) {if (end5747!==false) {var if_res3670 = sub5671(buf5704,start5746,end5747);} else {var if_res3670 = sub5671(buf5704,start5746);}return M0.cons(if_res3670,acc5745);})(acc5715,start5716,end5717);} else {var mstart5748 = M0.caar(m5743);var mend5749 = M0.cdar(m5743);var _0_ok_p5750 = M0.not(M0.__eq_(mstart5748,mend5749));if (false!==false) {var if_res3671 = M0.input_port_p(buf5704);} else {var if_res3671 = false;}if (if_res3671!==false) {var if_res3685 = false(function(acc5751, new_start5752, new_end5753) {return loop5714(acc5751,new_start5752,new_end5753,ipre5744,_0_ok_p5750);},acc5715,start5716,end5717,m5743);} else {var if_res3685 = loop5714((function(start5754, ms5755, acc5756) {if (M0.procedure_p(replacement5674)!==false) {var let_result3672 = M5.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("m")),ms5755);var pos__gt_vals5757 = let_result3672.getAt(0);var pos_pre_inc5758 = let_result3672.getAt(1);var pos_next5759 = let_result3672.getAt(2);var init5760 = let_result3672.getAt(3);var pos_cont_p5761 = let_result3672.getAt(4);var val_cont_p5762 = let_result3672.getAt(5);var all_cont_p5763 = let_result3672.getAt(6);M0.rvoid();var for_loop5764 = function(fold_var5765, pos5766) {if (pos_cont_p5761!==false) {var if_res3673 = pos_cont_p5761(pos5766);} else {var if_res3673 = true;}if (if_res3673!==false) {var m5770 = pos__gt_vals5757(pos5766);if (all_cont_p5763!==false) {var if_res3674 = function(pos5771) {return all_cont_p5763(pos5771,m5770);};} else {var if_res3674 = false;}var let_result3675 = M0.values(m5770,if_res3674);var m5767 = let_result3675.getAt(0);var all_cont_p_by_pos5768 = let_result3675.getAt(1);if (pos_pre_inc5758!==false) {var if_res3676 = pos_pre_inc5758(pos5766);} else {var if_res3676 = pos5766;}var pos5769 = if_res3676;if (val_cont_p5762!==false) {var if_res3677 = val_cont_p5762(m5767);} else {var if_res3677 = true;}if (if_res3677!==false) {var fold_var5773 = fold_var5765;if (m5767!==false) {var if_res3678 = sub5671(buf5704,M0.car(m5767),M0.cdr(m5767));} else {var if_res3678 = false;}var fold_var5774 = M0.cons(if_res3678,fold_var5773);var fold_var5772 = M0.values(fold_var5774);if (all_cont_p_by_pos5768!==false) {var if_res3679 = all_cont_p_by_pos5768(pos5769);} else {var if_res3679 = true;}if (if_res3679!==false) {var if_res3680 = M0.not(false);} else {var if_res3680 = false;}if (if_res3680!==false) {var if_res3681 = for_loop5764(fold_var5772,pos_next5759(pos5769));} else {var if_res3681 = fold_var5772;}var if_res3682 = if_res3681;} else {var if_res3682 = fold_var5765;}var if_res3683 = if_res3682;} else {var if_res3683 = fold_var5765;}return if_res3683;};var if_res3684 = check5675(replacement5674,M4.alt_reverse(for_loop5764(M0.rnull,init5760)));} else {var if_res3684 = replac5680(ms5755,replacement5674);}return M0.list_times_(if_res3684,sub5671(buf5704,start5754,M0.caar(ms5755)),acc5756);})(start5716,m5743,acc5715),mend5749,end5717,ipre5744,_0_ok_p5750);}var if_res3686 = if_res3685;}var if_res3687 = if_res3686;}return if_res3687;};var r5703 = M0.reverse(loop5714($rjs_core.Pair.makeList(),start5667,end5668,ipre5669,true));if (M0.bytes_p(buf5670)!==false) {var if_res3691 = M0.bytes_append;} else {var if_res3691 = M0.string_append;}if (M0.__eq_(start5667,0)!==false) {var if_res3688 = M0.not(end5668);} else {var if_res3688 = false;}if (if_res3688!==false) {var if_res3690 = r5703;} else {if (M0.not(end5668)!==false) {var if_res3689 = M0.cons(sub5671(string5665,0,start5667),r5703);} else {var if_res3689 = M0.list_times_(sub5671(string5665,0,start5667),M3.__rjs_quoted__.qq_append(r5703,M0.list(sub5671(string5665,end5668))));}var if_res3690 = if_res3689;}return M0.apply(if_res3691,if_res3690);};var cl3692 = function(pattern5775, string5776, orig_replacement5777) {return regexp_replace_times_5657(pattern5775,string5776,orig_replacement5777,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3693 = function(pattern5778, string5779, orig_replacement5780, start5781, end5782, ipre445783) {return regexp_replace_times_5657(pattern5778,string5779,orig_replacement5780,start5781,end5782,ipre445783);};var cl3694 = function(pattern5784, string5785, orig_replacement5786, start5787, end435788) {return regexp_replace_times_5657(pattern5784,string5785,orig_replacement5786,start5787,end435788,$rjs_core.Bytes.fromIntArray([]));};var cl3695 = function(pattern5789, string5790, orig_replacement5791, start425792) {return regexp_replace_times_5657(pattern5789,string5790,orig_replacement5791,start425792,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_replace_times_5656 = $rjs_core.attachProcedureArity(function() {var fixed_lam3696 = {'3':cl3692,'6':cl3693,'5':cl3694,'4':cl3695}[arguments.length];if (fixed_lam3696!==undefined) {return fixed_lam3696.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4,5,6]);var __regexp_replace_times_ = regexp_replace_times_5656;var regexp_match_times_ = function(gap_select_p335793, match_select325794, pattern395795, string405796, start365797, end375798, ipre385799) {var pattern5800 = pattern395795;var string5801 = string405796;if (false!==false) {var if_res3697 = 0;} else {var if_res3697 = start365797;}var start5802 = if_res3697;if (false!==false) {var if_res3698 = false;} else {var if_res3698 = end375798;}var end5803 = if_res3698;if (false!==false) {var if_res3699 = $rjs_core.Bytes.fromIntArray([]);} else {var if_res3699 = ipre385799;}var ipre5804 = if_res3699;if (M0.eq_p(match_select325794,M7.unsafe_undefined)!==false) {var if_res3700 = M0.car;} else {var if_res3700 = match_select325794;}var match_select5805 = if_res3700;if (false!==false) {var if_res3701 = false;} else {var if_res3701 = gap_select_p335793;}var gap_select5806 = if_res3701;if (M0.not(match_select5805)!==false) {var if_res3702 = M0.not(gap_select5806);} else {var if_res3702 = false;}if (if_res3702!==false) {var if_res3883 = M0.raise(M0.__rjs_quoted__.exn_fail_contract($rjs_core.UString.make("regexp-match*: one of `match-select' or `gap-select' must be non-#f"),M0.current_continuation_marks()));} else {if (M0.not(match_select5805)!==false) {var if_res3882 = regexp_split(pattern5800,string5801,start5802,end5803,ipre5804);} else {if (M0.not(M0.procedure_p(match_select5805))!==false) {var if_res3881 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c procedure? #f)"),match_select5805);} else {if (M0.not(M0.eq_p(match_select5805,M0.car))!==false) {var let_result3703 = get_buf_plus_sub(string5801,pattern5800);var buf5807 = let_result3703.getAt(0);var sub5808 = let_result3703.getAt(1);if (M0.path_p(buf5807)!==false) {var or_part5810 = M0.string_p(pattern5800);if (or_part5810!==false) {var if_res3704 = or_part5810;} else {var if_res3704 = M0.regexp_p(pattern5800);}if (if_res3704!==false) {var if_res3705 = M0.path__gt_string(buf5807);} else {var if_res3705 = M0.path__gt_bytes(buf5807);}var if_res3706 = if_res3705;} else {var if_res3706 = buf5807;}var buf5809 = if_res3706;if (M0.string_p(buf5809)!==false) {var if_res3708 = M0.string_length(buf5809);} else {if (M0.bytes_p(buf5809)!==false) {var if_res3707 = M0.bytes_length(buf5809);} else {var if_res3707 = false;}var if_res3708 = if_res3707;}var len5811 = if_res3708;if (M0.bytes_p(pattern5800)!==false) {var if_res3712 = M0.byte_regexp(pattern5800);} else {if (M0.string_p(pattern5800)!==false) {var if_res3711 = M0.regexp(pattern5800);} else {if (M0.regexp_p(pattern5800)!==false) {var if_res3710 = pattern5800;} else {if (M0.byte_regexp_p(pattern5800)!==false) {var if_res3709 = pattern5800;} else {var if_res3709 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5800);}var if_res3710 = if_res3709;}var if_res3711 = if_res3710;}var if_res3712 = if_res3711;}var orig_rx5812 = if_res3712;var max_lookbehind5813 = M0.regexp_max_lookbehind(orig_rx5812);if (false!==false) {if (M0.input_port_p(buf5809)!==false) {var if_res3713 = M0.rvoid();} else {var if_res3713 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("input-port?"),buf5809);}var if_res3716 = if_res3713;} else {var or_part5814 = len5811;if (or_part5814!==false) {var if_res3714 = or_part5814;} else {var if_res3714 = M0.input_port_p(buf5809);}if (if_res3714!==false) {var if_res3715 = M0.rvoid();} else {var if_res3715 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5809);}var if_res3716 = if_res3715;}if_res3716;if (M0.number_p(start5802)!==false) {if (M0.exact_p(start5802)!==false) {if (M0.integer_p(start5802)!==false) {var if_res3717 = M0.__gt__eq_(start5802,0);} else {var if_res3717 = false;}var if_res3718 = if_res3717;} else {var if_res3718 = false;}var if_res3719 = if_res3718;} else {var if_res3719 = false;}if (if_res3719!==false) {var if_res3720 = M0.rvoid();} else {var if_res3720 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5802);}if_res3720;var or_part5815 = M0.not(end5803);if (or_part5815!==false) {var if_res3724 = or_part5815;} else {if (M0.number_p(end5803)!==false) {if (M0.exact_p(end5803)!==false) {if (M0.integer_p(end5803)!==false) {var if_res3721 = M0.__gt__eq_(end5803,0);} else {var if_res3721 = false;}var if_res3722 = if_res3721;} else {var if_res3722 = false;}var if_res3723 = if_res3722;} else {var if_res3723 = false;}var if_res3724 = if_res3723;}if (if_res3724!==false) {var if_res3725 = M0.rvoid();} else {var if_res3725 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5803);}if_res3725;if (M0.bytes_p(ipre5804)!==false) {var if_res3726 = M0.rvoid();} else {var if_res3726 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("bytes?"),ipre5804);}if_res3726;var or_part5816 = M0.input_port_p(buf5809);if (or_part5816!==false) {var if_res3728 = or_part5816;} else {if (len5811!==false) {var if_res3727 = M0.__lt__eq_(start5802,len5811);} else {var if_res3727 = false;}var if_res3728 = if_res3727;}if (if_res3728!==false) {var if_res3729 = M0.rvoid();} else {var if_res3729 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5811),start5802);}if_res3729;var or_part5817 = M0.not(end5803);if (or_part5817!==false) {var if_res3733 = or_part5817;} else {if (M0.__lt__eq_(start5802,end5803)!==false) {var or_part5818 = M0.input_port_p(buf5809);if (or_part5818!==false) {var if_res3731 = or_part5818;} else {if (len5811!==false) {var if_res3730 = M0.__lt__eq_(end5803,len5811);} else {var if_res3730 = false;}var if_res3731 = if_res3730;}var if_res3732 = if_res3731;} else {var if_res3732 = false;}var if_res3733 = if_res3732;}if (if_res3733!==false) {var if_res3734 = M0.rvoid();} else {var if_res3734 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5802,len5811),end5803);}if_res3734;var loop5819 = function(acc5820, start5821, end5822, ipre5823, _0_ok_p5824) {if (_0_ok_p5824!==false) {var if_res3735 = orig_rx5812;} else {var if_res3735 = no_empty_edge_matches(orig_rx5812,M0.add1(M0.bytes_length(ipre5823)));}var rx5825 = if_res3735;if (function(leftovers5826, ms5827, acc5828) {var temp3737 = match_select5805(ms5827);if (gap_select5806!==false) {var if_res3736 = M0.cons(leftovers5826,acc5828);} else {var if_res3736 = acc5828;}return M0.cons(temp3737,if_res3736);}!==false) {var if_res3738 = M0.input_port_p(buf5809);} else {var if_res3738 = false;}if (if_res3738!==false) {if (M0.positive_p(start5821)!==false) {var s5830 = M0.make_bytes(4096);var loop5831 = function(n5832) {if (M0.__eq_(n5832,start5821)!==false) {var if_res3740 = M0.rvoid();} else {var m5833 = M0.read_bytes_avail_bang_(s5830,buf5809,0,M0.min(start5821-n5832,4096));if (M0.eof_object_p(m5833)!==false) {var if_res3739 = M0.rvoid();} else {var if_res3739 = loop5831(n5832+m5833);}var if_res3740 = if_res3739;}return if_res3740;};var if_res3741 = loop5831(0);} else {var if_res3741 = M0.rvoid();}var _5829 = if_res3741;if (gap_select5806!==false) {var if_res3742 = false;} else {var if_res3742 = 0;}var discarded_by_leftovers5834 = if_res3742;if (gap_select5806!==false) {var if_res3743 = M0.open_output_bytes();} else {var if_res3743 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5836, start5837, end5838, flush_p5839, breakable_p5840) {var c5841 = end5838-start5837;discarded_by_leftovers5834 = c5841+discarded_by_leftovers5834;return c5841;},M0.rvoid);}var spitout5835 = if_res3743;if (end5822!==false) {var if_res3744 = end5822-start5821;} else {var if_res3744 = false;}var end5842 = if_res3744;var let_result3745 = M0.regexp_match_by_end(rx5825,buf5809,0,end5842,spitout5835,ipre5823,max_lookbehind5813);var ms5843 = let_result3745.getAt(0);var ipre5844 = let_result3745.getAt(1);if (ms5843!==false) {var if_res3746 = M0.car(ms5843);} else {var if_res3746 = false;}var m5845 = if_res3746;if (gap_select5806!==false) {var if_res3747 = M0.get_output_bytes(spitout5835);} else {var if_res3747 = discarded_by_leftovers5834;}var discarded_by_leftovers5846 = if_res3747;if (gap_select5806!==false) {var if_res3748 = bstring_length(discarded_by_leftovers5846);} else {var if_res3748 = discarded_by_leftovers5846;}var skipped5847 = if_res3748;if (m5845!==false) {var if_res3749 = bstring_length(m5845);} else {var if_res3749 = false;}var got5848 = if_res3749;if (end5842!==false) {if (m5845!==false) {var if_res3750 = end5842-skipped5847-got5848;} else {var if_res3750 = false;}var if_res3751 = if_res3750;} else {var if_res3751 = false;}var end5849 = if_res3751;if (m5845!==false) {var _0_ok_p5850 = M0.not(M0.zero_p(got5848));var if_res3756 = loop5819((function(leftovers5851, ms5852, acc5853) {var temp3753 = match_select5805(ms5852);if (gap_select5806!==false) {var if_res3752 = M0.cons(leftovers5851,acc5853);} else {var if_res3752 = acc5853;}return M0.cons(temp3753,if_res3752);})(discarded_by_leftovers5846,ms5843,acc5820),0,end5849,ipre5844,_0_ok_p5850);} else {var if_res3756 = (function(acc5854, leftover5855) {if (gap_select5806!==false) {var if_res3754 = leftover5855;} else {var if_res3754 = false;}if (if_res3754!==false) {var if_res3755 = M0.cons(leftover5855,acc5854);} else {var if_res3755 = acc5854;}return if_res3755;})(acc5820,discarded_by_leftovers5846);}var if_res3768 = if_res3756;} else {if (false!==false) {var if_res3757 = M0.regexp_match_peek_positions_by_end(rx5825,buf5809,start5821,end5822,false,ipre5823,max_lookbehind5813);} else {var if_res3757 = M0.regexp_match_positions_by_end(rx5825,buf5809,start5821,end5822,false,ipre5823,max_lookbehind5813);}var let_result3758 = if_res3757;var m5856 = let_result3758.getAt(0);var ipre5857 = let_result3758.getAt(1);if (M0.not(m5856)!==false) {var if_res3767 = (function(acc5858, start5859, end5860) {if (gap_select5806!==false) {if (end5860!==false) {var if_res3759 = sub5808(buf5809,start5859,end5860);} else {var if_res3759 = sub5808(buf5809,start5859);}var if_res3760 = M0.cons(if_res3759,acc5858);} else {var if_res3760 = acc5858;}return if_res3760;})(acc5820,start5821,end5822);} else {var mstart5861 = M0.caar(m5856);var mend5862 = M0.cdar(m5856);var _0_ok_p5863 = M0.not(M0.__eq_(mstart5861,mend5862));if (false!==false) {var if_res3761 = M0.input_port_p(buf5809);} else {var if_res3761 = false;}if (if_res3761!==false) {var if_res3766 = false(function(acc5864, new_start5865, new_end5866) {return loop5819(acc5864,new_start5865,new_end5866,ipre5857,_0_ok_p5863);},acc5820,start5821,end5822,m5856);} else {var if_res3766 = loop5819((function(start5867, ms5868, acc5869) {var s5870 = match_select5805(ms5868);if (M0.not(M0.pair_p(s5870))!==false) {var if_res3765 = s5870;} else {if (M0.integer_p(M0.car(s5870))!==false) {var if_res3764 = sub5808(buf5809,M0.car(s5870),M0.cdr(s5870));} else {var if_res3764 = M1.map(function(m5871) {if (m5871!==false) {var if_res3763 = sub5808(buf5809,M0.car(m5871),M0.cdr(m5871));} else {var if_res3763 = false;}return if_res3763;},s5870);}var if_res3765 = if_res3764;}if (gap_select5806!==false) {var if_res3762 = M0.cons(sub5808(buf5809,start5867,M0.caar(ms5868)),acc5869);} else {var if_res3762 = acc5869;}return M0.cons(if_res3765,if_res3762);})(start5821,m5856,acc5820),mend5862,end5822,ipre5857,_0_ok_p5863);}var if_res3767 = if_res3766;}var if_res3768 = if_res3767;}return if_res3768;};var if_res3880 = M0.reverse(loop5819($rjs_core.Pair.makeList(),start5802,end5803,ipre5804,true));} else {if (gap_select5806!==false) {var let_result3769 = get_buf_plus_sub(string5801,pattern5800);var buf5872 = let_result3769.getAt(0);var sub5873 = let_result3769.getAt(1);if (M0.path_p(buf5872)!==false) {var or_part5875 = M0.string_p(pattern5800);if (or_part5875!==false) {var if_res3770 = or_part5875;} else {var if_res3770 = M0.regexp_p(pattern5800);}if (if_res3770!==false) {var if_res3771 = M0.path__gt_string(buf5872);} else {var if_res3771 = M0.path__gt_bytes(buf5872);}var if_res3772 = if_res3771;} else {var if_res3772 = buf5872;}var buf5874 = if_res3772;if (M0.string_p(buf5874)!==false) {var if_res3774 = M0.string_length(buf5874);} else {if (M0.bytes_p(buf5874)!==false) {var if_res3773 = M0.bytes_length(buf5874);} else {var if_res3773 = false;}var if_res3774 = if_res3773;}var len5876 = if_res3774;if (M0.bytes_p(pattern5800)!==false) {var if_res3778 = M0.byte_regexp(pattern5800);} else {if (M0.string_p(pattern5800)!==false) {var if_res3777 = M0.regexp(pattern5800);} else {if (M0.regexp_p(pattern5800)!==false) {var if_res3776 = pattern5800;} else {if (M0.byte_regexp_p(pattern5800)!==false) {var if_res3775 = pattern5800;} else {var if_res3775 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5800);}var if_res3776 = if_res3775;}var if_res3777 = if_res3776;}var if_res3778 = if_res3777;}var orig_rx5877 = if_res3778;var max_lookbehind5878 = M0.regexp_max_lookbehind(orig_rx5877);if (false!==false) {if (M0.input_port_p(buf5874)!==false) {var if_res3779 = M0.rvoid();} else {var if_res3779 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("input-port?"),buf5874);}var if_res3782 = if_res3779;} else {var or_part5879 = len5876;if (or_part5879!==false) {var if_res3780 = or_part5879;} else {var if_res3780 = M0.input_port_p(buf5874);}if (if_res3780!==false) {var if_res3781 = M0.rvoid();} else {var if_res3781 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5874);}var if_res3782 = if_res3781;}if_res3782;if (M0.number_p(start5802)!==false) {if (M0.exact_p(start5802)!==false) {if (M0.integer_p(start5802)!==false) {var if_res3783 = M0.__gt__eq_(start5802,0);} else {var if_res3783 = false;}var if_res3784 = if_res3783;} else {var if_res3784 = false;}var if_res3785 = if_res3784;} else {var if_res3785 = false;}if (if_res3785!==false) {var if_res3786 = M0.rvoid();} else {var if_res3786 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5802);}if_res3786;var or_part5880 = M0.not(end5803);if (or_part5880!==false) {var if_res3790 = or_part5880;} else {if (M0.number_p(end5803)!==false) {if (M0.exact_p(end5803)!==false) {if (M0.integer_p(end5803)!==false) {var if_res3787 = M0.__gt__eq_(end5803,0);} else {var if_res3787 = false;}var if_res3788 = if_res3787;} else {var if_res3788 = false;}var if_res3789 = if_res3788;} else {var if_res3789 = false;}var if_res3790 = if_res3789;}if (if_res3790!==false) {var if_res3791 = M0.rvoid();} else {var if_res3791 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5803);}if_res3791;if (M0.bytes_p(ipre5804)!==false) {var if_res3792 = M0.rvoid();} else {var if_res3792 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),$rjs_core.UString.make("bytes?"),ipre5804);}if_res3792;var or_part5881 = M0.input_port_p(buf5874);if (or_part5881!==false) {var if_res3794 = or_part5881;} else {if (len5876!==false) {var if_res3793 = M0.__lt__eq_(start5802,len5876);} else {var if_res3793 = false;}var if_res3794 = if_res3793;}if (if_res3794!==false) {var if_res3795 = M0.rvoid();} else {var if_res3795 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5876),start5802);}if_res3795;var or_part5882 = M0.not(end5803);if (or_part5882!==false) {var if_res3799 = or_part5882;} else {if (M0.__lt__eq_(start5802,end5803)!==false) {var or_part5883 = M0.input_port_p(buf5874);if (or_part5883!==false) {var if_res3797 = or_part5883;} else {if (len5876!==false) {var if_res3796 = M0.__lt__eq_(end5803,len5876);} else {var if_res3796 = false;}var if_res3797 = if_res3796;}var if_res3798 = if_res3797;} else {var if_res3798 = false;}var if_res3799 = if_res3798;}if (if_res3799!==false) {var if_res3800 = M0.rvoid();} else {var if_res3800 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-explode"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5802,len5876),end5803);}if_res3800;var loop5884 = function(acc5885, start5886, end5887, ipre5888, _0_ok_p5889) {if (_0_ok_p5889!==false) {var if_res3801 = orig_rx5877;} else {var if_res3801 = no_empty_edge_matches(orig_rx5877,M0.add1(M0.bytes_length(ipre5888)));}var rx5890 = if_res3801;if (function(leftovers5891, ms5892, acc5893) {return M0.cons(M0.car(ms5892),M0.cons(leftovers5891,acc5893));}!==false) {var if_res3802 = M0.input_port_p(buf5874);} else {var if_res3802 = false;}if (if_res3802!==false) {if (M0.positive_p(start5886)!==false) {var s5895 = M0.make_bytes(4096);var loop5896 = function(n5897) {if (M0.__eq_(n5897,start5886)!==false) {var if_res3804 = M0.rvoid();} else {var m5898 = M0.read_bytes_avail_bang_(s5895,buf5874,0,M0.min(start5886-n5897,4096));if (M0.eof_object_p(m5898)!==false) {var if_res3803 = M0.rvoid();} else {var if_res3803 = loop5896(n5897+m5898);}var if_res3804 = if_res3803;}return if_res3804;};var if_res3805 = loop5896(0);} else {var if_res3805 = M0.rvoid();}var _5894 = if_res3805;if (gap_select5806!==false) {var if_res3806 = false;} else {var if_res3806 = 0;}var discarded_by_leftovers5899 = if_res3806;if (gap_select5806!==false) {var if_res3807 = M0.open_output_bytes();} else {var if_res3807 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5901, start5902, end5903, flush_p5904, breakable_p5905) {var c5906 = end5903-start5902;discarded_by_leftovers5899 = c5906+discarded_by_leftovers5899;return c5906;},M0.rvoid);}var spitout5900 = if_res3807;if (end5887!==false) {var if_res3808 = end5887-start5886;} else {var if_res3808 = false;}var end5907 = if_res3808;var let_result3809 = M0.regexp_match_by_end(rx5890,buf5874,0,end5907,spitout5900,ipre5888,max_lookbehind5878);var ms5908 = let_result3809.getAt(0);var ipre5909 = let_result3809.getAt(1);if (ms5908!==false) {var if_res3810 = M0.car(ms5908);} else {var if_res3810 = false;}var m5910 = if_res3810;if (gap_select5806!==false) {var if_res3811 = M0.get_output_bytes(spitout5900);} else {var if_res3811 = discarded_by_leftovers5899;}var discarded_by_leftovers5911 = if_res3811;if (gap_select5806!==false) {var if_res3812 = bstring_length(discarded_by_leftovers5911);} else {var if_res3812 = discarded_by_leftovers5911;}var skipped5912 = if_res3812;if (m5910!==false) {var if_res3813 = bstring_length(m5910);} else {var if_res3813 = false;}var got5913 = if_res3813;if (end5907!==false) {if (m5910!==false) {var if_res3814 = end5907-skipped5912-got5913;} else {var if_res3814 = false;}var if_res3815 = if_res3814;} else {var if_res3815 = false;}var end5914 = if_res3815;if (m5910!==false) {var _0_ok_p5915 = M0.not(M0.zero_p(got5913));var if_res3817 = loop5884((function(leftovers5916, ms5917, acc5918) {return M0.cons(M0.car(ms5917),M0.cons(leftovers5916,acc5918));})(discarded_by_leftovers5911,ms5908,acc5885),0,end5914,ipre5909,_0_ok_p5915);} else {var if_res3817 = (function(acc5919, leftover5920) {if (leftover5920!==false) {var if_res3816 = M0.cons(leftover5920,acc5919);} else {var if_res3816 = acc5919;}return if_res3816;})(acc5885,discarded_by_leftovers5911);}var if_res3824 = if_res3817;} else {if (false!==false) {var if_res3818 = M0.regexp_match_peek_positions_by_end(rx5890,buf5874,start5886,end5887,false,ipre5888,max_lookbehind5878);} else {var if_res3818 = M0.regexp_match_positions_by_end(rx5890,buf5874,start5886,end5887,false,ipre5888,max_lookbehind5878);}var let_result3819 = if_res3818;var m5921 = let_result3819.getAt(0);var ipre5922 = let_result3819.getAt(1);if (M0.not(m5921)!==false) {var if_res3823 = (function(acc5923, start5924, end5925) {if (end5925!==false) {var if_res3820 = sub5873(buf5874,start5924,end5925);} else {var if_res3820 = sub5873(buf5874,start5924);}return M0.cons(if_res3820,acc5923);})(acc5885,start5886,end5887);} else {var mstart5926 = M0.caar(m5921);var mend5927 = M0.cdar(m5921);var _0_ok_p5928 = M0.not(M0.__eq_(mstart5926,mend5927));if (false!==false) {var if_res3821 = M0.input_port_p(buf5874);} else {var if_res3821 = false;}if (if_res3821!==false) {var if_res3822 = false(function(acc5929, new_start5930, new_end5931) {return loop5884(acc5929,new_start5930,new_end5931,ipre5922,_0_ok_p5928);},acc5885,start5886,end5887,m5921);} else {var if_res3822 = loop5884((function(start5932, ms5933, acc5934) {return M0.cons(sub5873(buf5874,M0.caar(ms5933),M0.cdar(ms5933)),M0.cons(sub5873(buf5874,start5932,M0.caar(ms5933)),acc5934));})(start5886,m5921,acc5885),mend5927,end5887,ipre5922,_0_ok_p5928);}var if_res3823 = if_res3822;}var if_res3824 = if_res3823;}return if_res3824;};var if_res3879 = M0.reverse(loop5884($rjs_core.Pair.makeList(),start5802,end5803,ipre5804,true));} else {var let_result3825 = get_buf_plus_sub(string5801,pattern5800);var buf5935 = let_result3825.getAt(0);var sub5936 = let_result3825.getAt(1);if (M0.path_p(buf5935)!==false) {var or_part5938 = M0.string_p(pattern5800);if (or_part5938!==false) {var if_res3826 = or_part5938;} else {var if_res3826 = M0.regexp_p(pattern5800);}if (if_res3826!==false) {var if_res3827 = M0.path__gt_string(buf5935);} else {var if_res3827 = M0.path__gt_bytes(buf5935);}var if_res3828 = if_res3827;} else {var if_res3828 = buf5935;}var buf5937 = if_res3828;if (M0.string_p(buf5937)!==false) {var if_res3830 = M0.string_length(buf5937);} else {if (M0.bytes_p(buf5937)!==false) {var if_res3829 = M0.bytes_length(buf5937);} else {var if_res3829 = false;}var if_res3830 = if_res3829;}var len5939 = if_res3830;if (M0.bytes_p(pattern5800)!==false) {var if_res3834 = M0.byte_regexp(pattern5800);} else {if (M0.string_p(pattern5800)!==false) {var if_res3833 = M0.regexp(pattern5800);} else {if (M0.regexp_p(pattern5800)!==false) {var if_res3832 = pattern5800;} else {if (M0.byte_regexp_p(pattern5800)!==false) {var if_res3831 = pattern5800;} else {var if_res3831 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c regexp? byte-regexp? string? bytes?)"),pattern5800);}var if_res3832 = if_res3831;}var if_res3833 = if_res3832;}var if_res3834 = if_res3833;}var orig_rx5940 = if_res3834;var max_lookbehind5941 = M0.regexp_max_lookbehind(orig_rx5940);if (false!==false) {if (M0.input_port_p(buf5937)!==false) {var if_res3835 = M0.rvoid();} else {var if_res3835 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("input-port?"),buf5937);}var if_res3838 = if_res3835;} else {var or_part5942 = len5939;if (or_part5942!==false) {var if_res3836 = or_part5942;} else {var if_res3836 = M0.input_port_p(buf5937);}if (if_res3836!==false) {var if_res3837 = M0.rvoid();} else {var if_res3837 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c string? bytes? path? input-port?)"),buf5937);}var if_res3838 = if_res3837;}if_res3838;if (M0.number_p(start5802)!==false) {if (M0.exact_p(start5802)!==false) {if (M0.integer_p(start5802)!==false) {var if_res3839 = M0.__gt__eq_(start5802,0);} else {var if_res3839 = false;}var if_res3840 = if_res3839;} else {var if_res3840 = false;}var if_res3841 = if_res3840;} else {var if_res3841 = false;}if (if_res3841!==false) {var if_res3842 = M0.rvoid();} else {var if_res3842 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("exact-nonnegative-integer?"),start5802);}if_res3842;var or_part5943 = M0.not(end5803);if (or_part5943!==false) {var if_res3846 = or_part5943;} else {if (M0.number_p(end5803)!==false) {if (M0.exact_p(end5803)!==false) {if (M0.integer_p(end5803)!==false) {var if_res3843 = M0.__gt__eq_(end5803,0);} else {var if_res3843 = false;}var if_res3844 = if_res3843;} else {var if_res3844 = false;}var if_res3845 = if_res3844;} else {var if_res3845 = false;}var if_res3846 = if_res3845;}if (if_res3846!==false) {var if_res3847 = M0.rvoid();} else {var if_res3847 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("(or/c exact-nonnegative-integer? #f)"),end5803);}if_res3847;if (M0.bytes_p(ipre5804)!==false) {var if_res3848 = M0.rvoid();} else {var if_res3848 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),$rjs_core.UString.make("bytes?"),ipre5804);}if_res3848;var or_part5944 = M0.input_port_p(buf5937);if (or_part5944!==false) {var if_res3850 = or_part5944;} else {if (len5939!==false) {var if_res3849 = M0.__lt__eq_(start5802,len5939);} else {var if_res3849 = false;}var if_res3850 = if_res3849;}if (if_res3850!==false) {var if_res3851 = M0.rvoid();} else {var if_res3851 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),M0.format($rjs_core.UString.make("starting offset index out of range [0,~a]: "),len5939),start5802);}if_res3851;var or_part5945 = M0.not(end5803);if (or_part5945!==false) {var if_res3855 = or_part5945;} else {if (M0.__lt__eq_(start5802,end5803)!==false) {var or_part5946 = M0.input_port_p(buf5937);if (or_part5946!==false) {var if_res3853 = or_part5946;} else {if (len5939!==false) {var if_res3852 = M0.__lt__eq_(end5803,len5939);} else {var if_res3852 = false;}var if_res3853 = if_res3852;}var if_res3854 = if_res3853;} else {var if_res3854 = false;}var if_res3855 = if_res3854;}if (if_res3855!==false) {var if_res3856 = M0.rvoid();} else {var if_res3856 = M0.raise_mismatch_error($rjs_core.PrimitiveSymbol.make("regexp-match*"),M0.format($rjs_core.UString.make("ending offset index out of range [~a,~a]: "),start5802,len5939),end5803);}if_res3856;var loop5947 = function(acc5948, start5949, end5950, ipre5951, _0_ok_p5952) {if (_0_ok_p5952!==false) {var if_res3857 = orig_rx5940;} else {var if_res3857 = no_empty_edge_matches(orig_rx5940,M0.add1(M0.bytes_length(ipre5951)));}var rx5953 = if_res3857;if (function(leftovers5954, ms5955, acc5956) {return M0.cons(M0.car(ms5955),acc5956);}!==false) {var if_res3858 = M0.input_port_p(buf5937);} else {var if_res3858 = false;}if (if_res3858!==false) {if (M0.positive_p(start5949)!==false) {var s5958 = M0.make_bytes(4096);var loop5959 = function(n5960) {if (M0.__eq_(n5960,start5949)!==false) {var if_res3860 = M0.rvoid();} else {var m5961 = M0.read_bytes_avail_bang_(s5958,buf5937,0,M0.min(start5949-n5960,4096));if (M0.eof_object_p(m5961)!==false) {var if_res3859 = M0.rvoid();} else {var if_res3859 = loop5959(n5960+m5961);}var if_res3860 = if_res3859;}return if_res3860;};var if_res3861 = loop5959(0);} else {var if_res3861 = M0.rvoid();}var _5957 = if_res3861;if (false!==false) {var if_res3862 = false;} else {var if_res3862 = 0;}var discarded_by_leftovers5962 = if_res3862;if (false!==false) {var if_res3863 = M0.open_output_bytes();} else {var if_res3863 = M0.make_output_port($rjs_core.PrimitiveSymbol.make("counter"),M0.always_evt,function(s5964, start5965, end5966, flush_p5967, breakable_p5968) {var c5969 = end5966-start5965;discarded_by_leftovers5962 = c5969+discarded_by_leftovers5962;return c5969;},M0.rvoid);}var spitout5963 = if_res3863;if (end5950!==false) {var if_res3864 = end5950-start5949;} else {var if_res3864 = false;}var end5970 = if_res3864;var let_result3865 = M0.regexp_match_by_end(rx5953,buf5937,0,end5970,spitout5963,ipre5951,max_lookbehind5941);var ms5971 = let_result3865.getAt(0);var ipre5972 = let_result3865.getAt(1);if (ms5971!==false) {var if_res3866 = M0.car(ms5971);} else {var if_res3866 = false;}var m5973 = if_res3866;if (false!==false) {var if_res3867 = M0.get_output_bytes(spitout5963);} else {var if_res3867 = discarded_by_leftovers5962;}var discarded_by_leftovers5974 = if_res3867;if (false!==false) {var if_res3868 = bstring_length(discarded_by_leftovers5974);} else {var if_res3868 = discarded_by_leftovers5974;}var skipped5975 = if_res3868;if (m5973!==false) {var if_res3869 = bstring_length(m5973);} else {var if_res3869 = false;}var got5976 = if_res3869;if (end5970!==false) {if (m5973!==false) {var if_res3870 = end5970-skipped5975-got5976;} else {var if_res3870 = false;}var if_res3871 = if_res3870;} else {var if_res3871 = false;}var end5977 = if_res3871;if (m5973!==false) {var _0_ok_p5978 = M0.not(M0.zero_p(got5976));var if_res3872 = loop5947((function(leftovers5979, ms5980, acc5981) {return M0.cons(M0.car(ms5980),acc5981);})(discarded_by_leftovers5974,ms5971,acc5948),0,end5977,ipre5972,_0_ok_p5978);} else {var if_res3872 = (function(acc5982, leftover5983) {return acc5982;})(acc5948,discarded_by_leftovers5974);}var if_res3878 = if_res3872;} else {if (false!==false) {var if_res3873 = M0.regexp_match_peek_positions_by_end(rx5953,buf5937,start5949,end5950,false,ipre5951,max_lookbehind5941);} else {var if_res3873 = M0.regexp_match_positions_by_end(rx5953,buf5937,start5949,end5950,false,ipre5951,max_lookbehind5941);}var let_result3874 = if_res3873;var m5984 = let_result3874.getAt(0);var ipre5985 = let_result3874.getAt(1);if (M0.not(m5984)!==false) {var if_res3877 = (function(acc5986, start5987, end5988) {return acc5986;})(acc5948,start5949,end5950);} else {var mstart5989 = M0.caar(m5984);var mend5990 = M0.cdar(m5984);var _0_ok_p5991 = M0.not(M0.__eq_(mstart5989,mend5990));if (false!==false) {var if_res3875 = M0.input_port_p(buf5937);} else {var if_res3875 = false;}if (if_res3875!==false) {var if_res3876 = false(function(acc5992, new_start5993, new_end5994) {return loop5947(acc5992,new_start5993,new_end5994,ipre5985,_0_ok_p5991);},acc5948,start5949,end5950,m5984);} else {var if_res3876 = loop5947((function(start5995, ms5996, acc5997) {return M0.cons(sub5936(buf5937,M0.caar(ms5996),M0.cdar(ms5996)),acc5997);})(start5949,m5984,acc5948),mend5990,end5950,ipre5985,_0_ok_p5991);}var if_res3877 = if_res3876;}var if_res3878 = if_res3877;}return if_res3878;};var if_res3879 = M0.reverse(loop5947($rjs_core.Pair.makeList(),start5802,end5803,ipre5804,true));}var if_res3880 = if_res3879;}var if_res3881 = if_res3880;}var if_res3882 = if_res3881;}var if_res3883 = if_res3882;}return if_res3883;};var regexp_match_times_5101 = function(given_kws5998, given_args5999, pattern396000, string406001, start366002, end376003, ipre386004) {if (M0.pair_p(given_kws5998)!==false) {var if_res3884 = M0.eq_p($rjs_core.Keyword.make("gap-select?"),M0.car(given_kws5998));} else {var if_res3884 = false;}var gap_select_p356005 = if_res3884;if (gap_select_p356005!==false) {var if_res3885 = M0.car(given_args5999);} else {var if_res3885 = false;}var gap_select_p336006 = if_res3885;if (gap_select_p356005!==false) {var if_res3886 = M0.cdr(given_kws5998);} else {var if_res3886 = given_kws5998;}var kws2060476007 = if_res3886;if (gap_select_p356005!==false) {var if_res3887 = M0.cdr(given_args5999);} else {var if_res3887 = given_args5999;}var kw_args2060486008 = if_res3887;var match_select346009 = M0.pair_p(kws2060476007);if (match_select346009!==false) {var if_res3888 = M0.car(kw_args2060486008);} else {var if_res3888 = M7.unsafe_undefined;}var match_select326010 = if_res3888;return regexp_match_times_(gap_select_p336006,match_select326010,pattern396000,string406001,start366002,end376003,ipre386004);};var cl3895 = function(given_kws6017, given_args6018, pattern6019, string6020) {return regexp_match_times_5101(given_kws6017,given_args6018,pattern6019,string6020,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3896 = function(given_kws6021, given_args6022, pattern6023, string6024, start6025, end6026, ipre386027) {return regexp_match_times_5101(given_kws6021,given_args6022,pattern6023,string6024,start6025,end6026,ipre386027);};var cl3897 = function(given_kws6028, given_args6029, pattern6030, string6031, start6032, end376033) {return regexp_match_times_5101(given_kws6028,given_args6029,pattern6030,string6031,start6032,end376033,$rjs_core.Bytes.fromIntArray([]));};var cl3898 = function(given_kws6034, given_args6035, pattern6036, string6037, start366038) {return regexp_match_times_5101(given_kws6034,given_args6035,pattern6036,string6037,start366038,false,$rjs_core.Bytes.fromIntArray([]));};var temp3900 = $rjs_core.attachProcedureArity(function() {var fixed_lam3899 = {'4':cl3895,'7':cl3896,'6':cl3897,'5':cl3898}[arguments.length];if (fixed_lam3899!==undefined) {return fixed_lam3899.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6,7]);var temp3894 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("gap-select?"),$rjs_core.Keyword.make("match-select"));var cl3889 = function(pattern6039, string6040) {return regexp_match_times_5101(M0.rnull,M0.rnull,pattern6039,string6040,0,false,$rjs_core.Bytes.fromIntArray([]));};var cl3890 = function(pattern6041, string6042, start6043, end6044, ipre386045) {return regexp_match_times_5101(M0.rnull,M0.rnull,pattern6041,string6042,start6043,end6044,ipre386045);};var cl3891 = function(pattern6046, string6047, start6048, end376049) {return regexp_match_times_5101(M0.rnull,M0.rnull,pattern6046,string6047,start6048,end376049,$rjs_core.Bytes.fromIntArray([]));};var cl3892 = function(pattern6050, string6051, start366052) {return regexp_match_times_5101(M0.rnull,M0.rnull,pattern6050,string6051,start366052,false,$rjs_core.Bytes.fromIntArray([]));};var regexp_match_times_41 = M2.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws6011, given_argc6012) {if (M0.__gt__eq_(given_argc6012,4)!==false) {var if_res3901 = M0.__lt__eq_(given_argc6012,7);} else {var if_res3901 = false;}if (if_res3901!==false) {var l12060496013 = given_kws6011;if (M0.null_p(l12060496013)!==false) {var if_res3903 = l12060496013;} else {if (M0.eq_p(M0.car(l12060496013),$rjs_core.Keyword.make("gap-select?"))!==false) {var if_res3902 = M0.cdr(l12060496013);} else {var if_res3902 = l12060496013;}var if_res3903 = if_res3902;}var l12060496014 = if_res3903;var l12060506015 = l12060496014;if (M0.null_p(l12060506015)!==false) {var if_res3905 = l12060506015;} else {if (M0.eq_p(M0.car(l12060506015),$rjs_core.Keyword.make("match-select"))!==false) {var if_res3904 = M0.cdr(l12060506015);} else {var if_res3904 = l12060506015;}var if_res3905 = if_res3904;}var l12060506016 = if_res3905;var if_res3906 = M0.null_p(l12060506016);} else {var if_res3906 = false;}return if_res3906;},temp3900,M0.rnull,temp3894,$rjs_core.attachProcedureArity(function() {var fixed_lam3893 = {'2':cl3889,'5':cl3890,'4':cl3891,'3':cl3892}[arguments.length];if (fixed_lam3893!==undefined) {return fixed_lam3893.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4,5]));var regexp_match_exact_p = function(p6053, s6054) {var m6055 = M0.regexp_match_positions(p6053,s6054);if (m6055!==false) {if (M0.zero_p(M0.caar(m6055))!==false) {var temp3912 = M0.cdar(m6055);if (M0.bytes_p(s6054)!==false) {var if_res3911 = M0.bytes_length(s6054);} else {var or_part6056 = M0.byte_regexp_p(p6053);if (or_part6056!==false) {var if_res3907 = or_part6056;} else {var if_res3907 = M0.bytes_p(p6053);}if (if_res3907!==false) {if (M0.path_p(s6054)!==false) {var if_res3908 = M0.bytes_length(M0.path__gt_bytes(s6054));} else {var if_res3908 = M0.string_utf_8_length(s6054);}var if_res3910 = if_res3908;} else {if (M0.path_p(s6054)!==false) {var if_res3909 = M0.string_length(M0.path__gt_string(s6054));} else {var if_res3909 = M0.string_length(s6054);}var if_res3910 = if_res3909;}var if_res3911 = if_res3910;}var if_res3913 = M0.__eq_(temp3912,if_res3911);} else {var if_res3913 = false;}var if_res3914 = if_res3913;} else {var if_res3914 = false;}return if_res3914;};var regexp_replaces = function(string6057, replacements6058) {var loop6059 = function(str6060, rs6061) {if (M0.null_p(rs6061)!==false) {var if_res3915 = str6060;} else {var if_res3915 = loop6059(M0.regexp_replace_times_(M0.caar(rs6061),str6060,M0.cadar(rs6061)),M0.cdr(rs6061));}return if_res3915;};return loop6059(string6057,replacements6058);};var __rjs_quoted__ = {};__rjs_quoted__.regexp_match_times_ = regexp_match_times_;__rjs_quoted__.regexp_match_peek_positions_times_ = regexp_match_peek_positions_times_;__rjs_quoted__.regexp_match_times_41 = regexp_match_times_41;__rjs_quoted__.regexp_match_positions_times_18 = regexp_match_positions_times_18;__rjs_quoted__.no_empty_edge_matches = no_empty_edge_matches;__rjs_quoted__.regexp_match_positions_times_ = regexp_match_positions_times_;__rjs_quoted__.regexp_match_peek_positions_times_26 = regexp_match_peek_positions_times_26;__rjs_quoted__.bstring_length = bstring_length;export { __rjs_quoted__,regexp_replaces,__regexp_replace_times_,regexp_try_match,regexp_match_exact_p,regexp_split,regexp_match_peek_positions_times_,regexp_match_positions_times_,regexp_match_times_,regexp_replace_quote,regexp_quote,real__gt_decimal_string };