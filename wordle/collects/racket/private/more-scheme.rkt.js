import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/paramz.rkt.js";var current_parameterization = function() {return M0.continuation_mark_set_first(false,M1.parameterization_key);};var call_with_parameterization = function(paramz4072, thunk4073) {if (M0.__rjs_quoted__.parameterization_p(paramz4072)!==false) {var if_res2351 = M0.rvoid();} else {var if_res2351 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("parameterization?"),0,paramz4072,thunk4073);}if_res2351;if (M0.procedure_p(thunk4073)!==false) {var if_res2352 = M0.procedure_arity_includes_p(thunk4073,0);} else {var if_res2352 = false;}if (if_res2352!==false) {var if_res2353 = M0.rvoid();} else {var if_res2353 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz4072,thunk4073);}if_res2353;var __context2354 = $rjs_core.Marks.getFrames();var __context2355;try {__context2355 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.parameterization_key,paramz4072);var __wcm_result2356 = thunk4073();} finally {$rjs_core.Marks.updateFrame(__context2354,__context2355);}return __wcm_result2356;};var let_result2358 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false);var struct_break_paramz = let_result2358.getAt(0);var make_break_paramz = let_result2358.getAt(1);var break_paramz_p = let_result2358.getAt(2);var break_paramz_ref = let_result2358.getAt(3);var break_paramz_set_bang_ = let_result2358.getAt(4);var let_result2359 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false,M0.rnull,M0.current_inspector());var type4074 = let_result2359.getAt(0);var maker4075 = let_result2359.getAt(1);var pred4076 = let_result2359.getAt(2);var access4077 = let_result2359.getAt(3);var mutate4078 = let_result2359.getAt(4);var let_result2360 = M0.values(type4074,maker4075,pred4076,M0.make_struct_field_accessor(access4077,0,$rjs_core.PrimitiveSymbol.make("cell")),M0.make_struct_field_mutator(mutate4078,0,$rjs_core.PrimitiveSymbol.make("cell")));var struct_break_parameterization = let_result2360.getAt(0);var make_break_parameterization = let_result2360.getAt(1);var break_parameterization_p = let_result2360.getAt(2);var break_parameterization_cell = let_result2360.getAt(3);var set_break_parameterization_cell_bang_ = let_result2360.getAt(4);var current_break_parameterization = function() {return make_break_paramz(M0.continuation_mark_set_first(false,M1.break_enabled_key));};var call_with_break_parameterization = function(paramz4079, thunk4080) {if (break_paramz_p(paramz4079)!==false) {var if_res2361 = M0.rvoid();} else {var if_res2361 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-break-parameterization"),$rjs_core.UString.make("break-parameterization?"),0,paramz4079,thunk4080);}if_res2361;if (M0.procedure_p(thunk4080)!==false) {var if_res2362 = M0.procedure_arity_includes_p(thunk4080,0);} else {var if_res2362 = false;}if (if_res2362!==false) {var if_res2363 = M0.rvoid();} else {var if_res2363 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz4079,thunk4080);}if_res2363;var __context2365 = $rjs_core.Marks.getFrames();var __context2366;try {__context2366 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,break_paramz_ref(paramz4079,0));M1.check_for_break();var __wcm_result2367 = thunk4080();} finally {$rjs_core.Marks.updateFrame(__context2365,__context2366);}var begin_res2364 = __wcm_result2367;M1.check_for_break();return begin_res2364;};var select_handler_by_no_breaks = function(e4081, bpz4082, l4083) {var __context2376 = $rjs_core.Marks.getFrames();var __context2377;try {__context2377 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,M0.make_thread_cell(false));var loop4084 = function(l4085) {if (M0.null_p(l4085)!==false) {var if_res2375 = M0.raise(e4081);} else {if (M0.caar(l4085)(e4081)!==false) {var begin_res2369 = M0.cdar(l4085)(e4081);var __context2370 = $rjs_core.Marks.getFrames();var __context2371;try {__context2371 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz4082);var __wcm_result2372 = M1.check_for_break();} finally {$rjs_core.Marks.updateFrame(__context2370,__context2371);}__wcm_result2372;var if_res2374 = begin_res2369;} else {var if_res2374 = loop4084(M0.cdr(l4085));}var if_res2375 = if_res2374;}return if_res2375;};var __wcm_result2378 = loop4084(l4083);} finally {$rjs_core.Marks.updateFrame(__context2376,__context2377);}return __wcm_result2378;};var select_handler_by_breaks_as_is = function(e4086, bpz4087, l4088) {if (M0.null_p(l4088)!==false) {var if_res2385 = M0.raise(e4086);} else {if (M0.caar(l4088)(e4086)!==false) {var __context2380 = $rjs_core.Marks.getFrames();var __context2381;try {__context2381 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz4087);M1.check_for_break();var __wcm_result2382 = M0.cdar(l4088)(e4086);} finally {$rjs_core.Marks.updateFrame(__context2380,__context2381);}var if_res2384 = __wcm_result2382;} else {var if_res2384 = select_handler_by_breaks_as_is(e4086,bpz4087,M0.cdr(l4088));}var if_res2385 = if_res2384;}return if_res2385;};var false_thread_cell = M0.make_thread_cell(false);var check_with_handlers_in_context = function(handler_prompt_key4089) {if (M0.__rjs_quoted__.continuation_prompt_available_p(handler_prompt_key4089)!==false) {var if_res2386 = M0.rvoid();} else {var if_res2386 = M0.error($rjs_core.PrimitiveSymbol.make("with-handlers"),$rjs_core.UString.make("exception handler used out of context"));}return if_res2386;};var handler_prompt_key = M0.make_continuation_prompt_tag($rjs_core.PrimitiveSymbol.make("handler-prompt-tag"));var call_handled_body = function(bpz4090, handle_proc4091, body_thunk4092) {var __context2395 = $rjs_core.Marks.getFrames();var __context2396;try {__context2396 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,false_thread_cell);var __wcm_result2397 = M0.call_with_continuation_prompt(function(bpz4093, body_thunk4094) {var __context2391 = $rjs_core.Marks.getFrames();var __context2392;try {__context2392 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz4093);var __context2387 = $rjs_core.Marks.getFrames();var __context2388;try {__context2388 = __context2387;$rjs_core.Marks.setMark(M1.exception_handler_key,function(e4095) {return M0.abort_current_continuation(handler_prompt_key,e4095);});var __wcm_result2389 = body_thunk4094();} finally {$rjs_core.Marks.updateFrame(__context2387,__context2388);}var __wcm_result2393 = __wcm_result2389;} finally {$rjs_core.Marks.updateFrame(__context2391,__context2392);}return __wcm_result2393;},handler_prompt_key,handle_proc4091,bpz4090,body_thunk4092);} finally {$rjs_core.Marks.updateFrame(__context2395,__context2396);}return __wcm_result2397;};var call_with_exception_handler = function(exnh4096, thunk4097) {var __context2400 = $rjs_core.Marks.getFrames();var __context2401;try {__context2401 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.exception_handler_key,exnh4096);var __wcm_result2402 = thunk4097();} finally {$rjs_core.Marks.updateFrame(__context2400,__context2401);}var begin_res2399 = __wcm_result2402;M0.rvoid();return begin_res2399;};var call_by_cc = M0.__rjs_quoted__.call_with_current_continuation;var not_there = M0.gensym();var do_hash_update = function(who4098, mut_p4099, set4100, ht4101, key4102, xform4103, default4104) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res2410 = M0.rvoid();} else {if (M0.hash_p(ht4101)!==false) {if (mut_p4099!==false) {var if_res2404 = M0.not(M0.immutable_p(ht4101));} else {var if_res2404 = M0.immutable_p(ht4101);}var if_res2405 = if_res2404;} else {var if_res2405 = false;}if (if_res2405!==false) {var if_res2407 = M0.rvoid();} else {if (mut_p4099!==false) {var if_res2406 = $rjs_core.UString.make("(and/c hash? (not/c immutable?))");} else {var if_res2406 = $rjs_core.UString.make("(and/c hash? immutable?)");}var if_res2407 = M0.raise_argument_error(who4098,if_res2406,ht4101);}if_res2407;if (M0.procedure_p(xform4103)!==false) {var if_res2408 = M0.procedure_arity_includes_p(xform4103,1);} else {var if_res2408 = false;}if (if_res2408!==false) {var if_res2409 = M0.rvoid();} else {var if_res2409 = M0.raise_argument_error(who4098,$rjs_core.UString.make("(any/c . -> . any/c)"),xform4103);}var if_res2410 = if_res2409;}if_res2410;var v4105 = M0.hash_ref(ht4101,key4102,default4104);if (M0.eq_p(v4105,not_there)!==false) {var if_res2411 = M0.raise_mismatch_error(who4098,$rjs_core.UString.make("no value found for key: "),key4102);} else {var if_res2411 = set4100(ht4101,key4102,xform4103(v4105));}return if_res2411;};var cl2412 = function(ht4106, key4107, xform4108, default4109) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update"),false,M0.hash_set,ht4106,key4107,xform4108,default4109);};var cl2413 = function(ht4110, key4111, xform4112) {return hash_update(ht4110,key4111,xform4112,not_there);};var hash_update = $rjs_core.attachProcedureArity(function() {var fixed_lam2414 = {'4':cl2412,'3':cl2413}[arguments.length];if (fixed_lam2414!==undefined) {return fixed_lam2414.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var cl2415 = function(ht4113, key4114, xform4115, default4116) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update!"),true,M0.hash_set_bang_,ht4113,key4114,xform4115,default4116);};var cl2416 = function(ht4117, key4118, xform4119) {return hash_update_bang_(ht4117,key4118,xform4119,not_there);};var hash_update_bang_ = $rjs_core.attachProcedureArity(function() {var fixed_lam2417 = {'4':cl2415,'3':cl2416}[arguments.length];if (fixed_lam2417!==undefined) {return fixed_lam2417.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var hash_has_key_p = function(ht4120, key4121) {if (M0.hash_p(ht4120)!==false) {var if_res2418 = M0.rvoid();} else {var if_res2418 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-has-key?"),$rjs_core.UString.make("hash?"),0,ht4120,key4121);}if_res2418;return M0.not(M0.eq_p(not_there,M0.hash_ref(ht4120,key4121,not_there)));};var hash_ref_bang_ = function(ht4122, key4123, new4124) {if (M0.hash_p(ht4122)!==false) {var if_res2419 = M0.not(M0.immutable_p(ht4122));} else {var if_res2419 = false;}if (if_res2419!==false) {var if_res2420 = M0.rvoid();} else {var if_res2420 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-ref!"),$rjs_core.UString.make("(and/c hash? (not/c immutable?))"),0,ht4122,key4123,new4124);}if_res2420;var v4125 = M0.hash_ref(ht4122,key4123,not_there);if (M0.eq_p(not_there,v4125)!==false) {if (M0.procedure_p(new4124)!==false) {var if_res2421 = new4124();} else {var if_res2421 = new4124;}var n4126 = if_res2421;M0.hash_set_bang_(ht4122,key4123,n4126);var if_res2422 = n4126;} else {var if_res2422 = v4125;}return if_res2422;};var __rjs_quoted__ = {};__rjs_quoted__.call_by_cc = call_by_cc;__rjs_quoted__.select_handler_by_no_breaks = select_handler_by_no_breaks;__rjs_quoted__.call_handled_body = call_handled_body;__rjs_quoted__.select_handler_by_breaks_as_is = select_handler_by_breaks_as_is;export { __rjs_quoted__,hash_update_bang_,hash_update,hash_has_key_p,hash_ref_bang_,call_by_cc,call_with_exception_handler,break_paramz_p as break_parameterization_p,call_with_break_parameterization,current_break_parameterization,call_with_parameterization,current_parameterization };