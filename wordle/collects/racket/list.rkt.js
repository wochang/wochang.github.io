import * as $rjs_core from '../../runtime/core.js';import * as M0 from "../../runtime/kernel.rkt.js";import * as M1 from "./private/pre-base.rkt.js";import * as M2 from "./private/list.rkt.js";import * as M3 from "./private/map.rkt.js";import * as M4 from "./private/kw.rkt.js";import * as M5 from "./private/qq-and-or.rkt.js";import * as M6 from "./private/member.rkt.js";import * as M7 from "./private/more-scheme.rkt.js";import * as M8 from "./private/reverse.rkt.js";import * as M9 from "./private/for.rkt.js";import * as M10 from "../../runtime/unsafe.rkt.js";var first = function(x1269) {if (M0.pair_p(x1269)!==false) {var if_res675 = M0.list_p(x1269);} else {var if_res675 = false;}if (if_res675!==false) {var if_res676 = M0.car(x1269);} else {var if_res676 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("first"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),x1269);}return if_res676;};var second = function(l01270) {if (M0.list_p(l01270)!==false) {var loop1271 = function(l1272, pos1273) {if (M0.pair_p(l1272)!==false) {if (M0.eq_p(pos1273,1)!==false) {var if_res677 = M0.car(l1272);} else {var if_res677 = loop1271(M0.cdr(l1272),M0.sub1(pos1273));}var if_res678 = if_res677;} else {var if_res678 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01270);}return if_res678;};var if_res679 = loop1271(l01270,2);} else {var if_res679 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list?"),l01270);}return if_res679;};var third = function(l01274) {if (M0.list_p(l01274)!==false) {var loop1275 = function(l1276, pos1277) {if (M0.pair_p(l1276)!==false) {if (M0.eq_p(pos1277,1)!==false) {var if_res680 = M0.car(l1276);} else {var if_res680 = loop1275(M0.cdr(l1276),M0.sub1(pos1277));}var if_res681 = if_res680;} else {var if_res681 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01274);}return if_res681;};var if_res682 = loop1275(l01274,3);} else {var if_res682 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list?"),l01274);}return if_res682;};var fourth = function(l01278) {if (M0.list_p(l01278)!==false) {var loop1279 = function(l1280, pos1281) {if (M0.pair_p(l1280)!==false) {if (M0.eq_p(pos1281,1)!==false) {var if_res683 = M0.car(l1280);} else {var if_res683 = loop1279(M0.cdr(l1280),M0.sub1(pos1281));}var if_res684 = if_res683;} else {var if_res684 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01278);}return if_res684;};var if_res685 = loop1279(l01278,4);} else {var if_res685 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list?"),l01278);}return if_res685;};var fifth = function(l01282) {if (M0.list_p(l01282)!==false) {var loop1283 = function(l1284, pos1285) {if (M0.pair_p(l1284)!==false) {if (M0.eq_p(pos1285,1)!==false) {var if_res686 = M0.car(l1284);} else {var if_res686 = loop1283(M0.cdr(l1284),M0.sub1(pos1285));}var if_res687 = if_res686;} else {var if_res687 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01282);}return if_res687;};var if_res688 = loop1283(l01282,5);} else {var if_res688 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list?"),l01282);}return if_res688;};var sixth = function(l01286) {if (M0.list_p(l01286)!==false) {var loop1287 = function(l1288, pos1289) {if (M0.pair_p(l1288)!==false) {if (M0.eq_p(pos1289,1)!==false) {var if_res689 = M0.car(l1288);} else {var if_res689 = loop1287(M0.cdr(l1288),M0.sub1(pos1289));}var if_res690 = if_res689;} else {var if_res690 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01286);}return if_res690;};var if_res691 = loop1287(l01286,6);} else {var if_res691 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list?"),l01286);}return if_res691;};var seventh = function(l01290) {if (M0.list_p(l01290)!==false) {var loop1291 = function(l1292, pos1293) {if (M0.pair_p(l1292)!==false) {if (M0.eq_p(pos1293,1)!==false) {var if_res692 = M0.car(l1292);} else {var if_res692 = loop1291(M0.cdr(l1292),M0.sub1(pos1293));}var if_res693 = if_res692;} else {var if_res693 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01290);}return if_res693;};var if_res694 = loop1291(l01290,7);} else {var if_res694 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list?"),l01290);}return if_res694;};var eighth = function(l01294) {if (M0.list_p(l01294)!==false) {var loop1295 = function(l1296, pos1297) {if (M0.pair_p(l1296)!==false) {if (M0.eq_p(pos1297,1)!==false) {var if_res695 = M0.car(l1296);} else {var if_res695 = loop1295(M0.cdr(l1296),M0.sub1(pos1297));}var if_res696 = if_res695;} else {var if_res696 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01294);}return if_res696;};var if_res697 = loop1295(l01294,8);} else {var if_res697 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list?"),l01294);}return if_res697;};var ninth = function(l01298) {if (M0.list_p(l01298)!==false) {var loop1299 = function(l1300, pos1301) {if (M0.pair_p(l1300)!==false) {if (M0.eq_p(pos1301,1)!==false) {var if_res698 = M0.car(l1300);} else {var if_res698 = loop1299(M0.cdr(l1300),M0.sub1(pos1301));}var if_res699 = if_res698;} else {var if_res699 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01298);}return if_res699;};var if_res700 = loop1299(l01298,9);} else {var if_res700 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list?"),l01298);}return if_res700;};var tenth = function(l01302) {if (M0.list_p(l01302)!==false) {var loop1303 = function(l1304, pos1305) {if (M0.pair_p(l1304)!==false) {if (M0.eq_p(pos1305,1)!==false) {var if_res701 = M0.car(l1304);} else {var if_res701 = loop1303(M0.cdr(l1304),M0.sub1(pos1305));}var if_res702 = if_res701;} else {var if_res702 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01302);}return if_res702;};var if_res703 = loop1303(l01302,10);} else {var if_res703 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list?"),l01302);}return if_res703;};var last_pair = function(l1306) {if (M0.pair_p(l1306)!==false) {var loop1307 = function(l1308, x1309) {if (M0.pair_p(x1309)!==false) {var if_res704 = loop1307(x1309,M0.cdr(x1309));} else {var if_res704 = l1308;}return if_res704;};var if_res705 = loop1307(l1306,M0.cdr(l1306));} else {var if_res705 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("last-pair"),$rjs_core.UString.make("pair?"),l1306);}return if_res705;};var last = function(l1310) {if (M0.pair_p(l1310)!==false) {var if_res706 = M0.list_p(l1310);} else {var if_res706 = false;}if (if_res706!==false) {var loop1311 = function(l1312, x1313) {if (M0.pair_p(x1313)!==false) {var if_res707 = loop1311(x1313,M0.cdr(x1313));} else {var if_res707 = M0.car(l1312);}return if_res707;};var if_res708 = loop1311(l1310,M0.cdr(l1310));} else {var if_res708 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("last"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l1310);}return if_res708;};var rest = function(l1314) {if (M0.pair_p(l1314)!==false) {var if_res709 = M0.list_p(l1314);} else {var if_res709 = false;}if (if_res709!==false) {var if_res710 = M0.cdr(l1314);} else {var if_res710 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("rest"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l1314);}return if_res710;};var empty = $rjs_core.Pair.makeList();var make_list = function(n1315, x1316) {if (M0.exact_nonnegative_integer_p(n1315)!==false) {var if_res711 = M0.rvoid();} else {var if_res711 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("make-list"),$rjs_core.UString.make("exact-nonnegative-integer?"),0,n1315,x1316);}if_res711;var loop1317 = function(n1318, r1319) {if (M0.zero_p(n1318)!==false) {var if_res712 = r1319;} else {var if_res712 = loop1317(M0.sub1(n1318),M0.cons(x1316,r1319));}return if_res712;};return loop1317(n1315,$rjs_core.Pair.makeList());};var list_update = function(l1320, i1321, f1322) {if (M0.list_p(l1320)!==false) {var if_res713 = M0.rvoid();} else {var if_res713 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("list?"),0,l1320,i1321,f1322);}if_res713;if (M0.exact_nonnegative_integer_p(i1321)!==false) {var if_res714 = M0.rvoid();} else {var if_res714 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1320,i1321,f1322);}if_res714;if (M0.procedure_p(f1322)!==false) {var if_res715 = M0.procedure_arity_includes_p(f1322,1);} else {var if_res715 = false;}if (if_res715!==false) {var if_res716 = M0.rvoid();} else {var if_res716 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("(-> any/c any/c)"),2,l1320,i1321,f1322);}if_res716;if (M0.zero_p(i1321)!==false) {var if_res717 = M0.cons(f1322(M0.car(l1320)),M0.cdr(l1320));} else {var if_res717 = M0.cons(M0.car(l1320),list_update(M0.cdr(l1320),M0.sub1(i1321),f1322));}return if_res717;};var list_set = function(l1323, k1324, v1325) {if (M0.list_p(l1323)!==false) {var if_res718 = M0.rvoid();} else {var if_res718 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("list?"),0,l1323,k1324,v1325);}if_res718;if (M0.exact_nonnegative_integer_p(k1324)!==false) {var if_res719 = M0.rvoid();} else {var if_res719 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1323,k1324,v1325);}if_res719;return list_update(l1323,k1324,function(_1326) {return v1325;});};var drop_times_ = function(list1327, n1328) {if (M0.zero_p(n1328)!==false) {var if_res721 = list1327;} else {if (M0.pair_p(list1327)!==false) {var if_res720 = drop_times_(M0.cdr(list1327),M0.sub1(n1328));} else {var if_res720 = false;}var if_res721 = if_res720;}return if_res721;};var too_large = function(who1329, list1330, n1331) {var proper_p1332 = M0.list_p(list1330);var temp724 = $rjs_core.UString.make("a ~alist with at least ~a ~a");if (proper_p1332!==false) {var if_res723 = $rjs_core.UString.make("");} else {var if_res723 = $rjs_core.UString.make("(possibly improper) ");}if (proper_p1332!==false) {var if_res722 = $rjs_core.UString.make("elements");} else {var if_res722 = $rjs_core.UString.make("pairs");}return M0.raise_argument_error(who1329,M0.format(temp724,if_res723,n1331,if_res722),list1330);};var take = function(list01333, n01334) {if (M0.exact_nonnegative_integer_p(n01334)!==false) {var if_res725 = M0.rvoid();} else {var if_res725 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("take"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list01333,n01334);}if_res725;var loop1335 = function(list1336, n1337) {if (M0.zero_p(n1337)!==false) {var if_res727 = $rjs_core.Pair.makeList();} else {if (M0.pair_p(list1336)!==false) {var if_res726 = M0.cons(M0.car(list1336),loop1335(M0.cdr(list1336),M0.sub1(n1337)));} else {var if_res726 = too_large($rjs_core.PrimitiveSymbol.make("take"),list01333,n01334);}var if_res727 = if_res726;}return if_res727;};return loop1335(list01333,n01334);};var drop = function(list1338, n1339) {if (M0.exact_nonnegative_integer_p(n1339)!==false) {var if_res728 = M0.rvoid();} else {var if_res728 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1338,n1339);}if_res728;var or_part1340 = drop_times_(list1338,n1339);if (or_part1340!==false) {var if_res729 = or_part1340;} else {var if_res729 = too_large($rjs_core.PrimitiveSymbol.make("drop"),list1338,n1339);}return if_res729;};var split_at = function(list01341, n01342) {if (M0.exact_nonnegative_integer_p(n01342)!==false) {var if_res730 = M0.rvoid();} else {var if_res730 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list01341,n01342);}if_res730;var loop1343 = function(list1344, n1345, pfx1346) {if (M0.zero_p(n1345)!==false) {var if_res732 = M0.values(M8.alt_reverse(pfx1346),list1344);} else {if (M0.pair_p(list1344)!==false) {var if_res731 = loop1343(M0.cdr(list1344),M0.sub1(n1345),M0.cons(M0.car(list1344),pfx1346));} else {var if_res731 = too_large($rjs_core.PrimitiveSymbol.make("split-at"),list01341,n01342);}var if_res732 = if_res731;}return if_res732;};return loop1343(list01341,n01342,$rjs_core.Pair.makeList());};var takef = function(list1347, pred1348) {if (M0.procedure_p(pred1348)!==false) {var if_res733 = M0.rvoid();} else {var if_res733 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("takef"),$rjs_core.UString.make("procedure?"),1,list1347,pred1348);}if_res733;var loop1349 = function(list1350) {if (M0.pair_p(list1350)!==false) {var x1351 = M0.car(list1350);if (pred1348(x1351)!==false) {var if_res734 = M0.cons(x1351,loop1349(M0.cdr(list1350)));} else {var if_res734 = $rjs_core.Pair.makeList();}var if_res735 = if_res734;} else {var if_res735 = $rjs_core.Pair.makeList();}return if_res735;};return loop1349(list1347);};var dropf = function(list1352, pred1353) {if (M0.procedure_p(pred1353)!==false) {var if_res736 = M0.rvoid();} else {var if_res736 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("dropf"),$rjs_core.UString.make("procedure?"),1,list1352,pred1353);}if_res736;var loop1354 = function(list1355) {if (M0.pair_p(list1355)!==false) {var if_res737 = pred1353(M0.car(list1355));} else {var if_res737 = false;}if (if_res737!==false) {var if_res738 = loop1354(M0.cdr(list1355));} else {var if_res738 = list1355;}return if_res738;};return loop1354(list1352);};var splitf_at = function(list1356, pred1357) {if (M0.procedure_p(pred1357)!==false) {var if_res739 = M0.rvoid();} else {var if_res739 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("splitf-at"),$rjs_core.UString.make("procedure?"),1,list1356,pred1357);}if_res739;var loop1358 = function(list1359, pfx1360) {if (M0.pair_p(list1359)!==false) {var if_res740 = pred1357(M0.car(list1359));} else {var if_res740 = false;}if (if_res740!==false) {var if_res741 = loop1358(M0.cdr(list1359),M0.cons(M0.car(list1359),pfx1360));} else {var if_res741 = M0.values(M8.alt_reverse(pfx1360),list1359);}return if_res741;};return loop1358(list1356,$rjs_core.Pair.makeList());};var take_right = function(list1361, n1362) {if (M0.exact_nonnegative_integer_p(n1362)!==false) {var if_res742 = M0.rvoid();} else {var if_res742 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("take-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1361,n1362);}if_res742;var loop1363 = function(list1364, lead1365) {if (M0.pair_p(lead1365)!==false) {var if_res744 = loop1363(M0.cdr(list1364),M0.cdr(lead1365));} else {var if_res744 = list1364;}return if_res744;};var or_part1366 = drop_times_(list1361,n1362);if (or_part1366!==false) {var if_res743 = or_part1366;} else {var if_res743 = too_large($rjs_core.PrimitiveSymbol.make("take-right"),list1361,n1362);}return loop1363(list1361,if_res743);};var drop_right = function(list1367, n1368) {if (M0.exact_nonnegative_integer_p(n1368)!==false) {var if_res745 = M0.rvoid();} else {var if_res745 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1367,n1368);}if_res745;var loop1369 = function(list1370, lead1371) {if (M0.pair_p(lead1371)!==false) {var if_res747 = M0.cons(M0.car(list1370),loop1369(M0.cdr(list1370),M0.cdr(lead1371)));} else {var if_res747 = $rjs_core.Pair.makeList();}return if_res747;};var or_part1372 = drop_times_(list1367,n1368);if (or_part1372!==false) {var if_res746 = or_part1372;} else {var if_res746 = too_large($rjs_core.PrimitiveSymbol.make("drop-right"),list1367,n1368);}return loop1369(list1367,if_res746);};var split_at_right = function(list1373, n1374) {if (M0.exact_nonnegative_integer_p(n1374)!==false) {var if_res748 = M0.rvoid();} else {var if_res748 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1373,n1374);}if_res748;var loop1375 = function(list1376, lead1377, pfx1378) {if (M0.pair_p(lead1377)!==false) {var if_res750 = loop1375(M0.cdr(list1376),M0.cdr(lead1377),M0.cons(M0.car(list1376),pfx1378));} else {var if_res750 = M0.values(M8.alt_reverse(pfx1378),list1376);}return if_res750;};var or_part1379 = drop_times_(list1373,n1374);if (or_part1379!==false) {var if_res749 = or_part1379;} else {var if_res749 = too_large($rjs_core.PrimitiveSymbol.make("split-at-right"),list1373,n1374);}return loop1375(list1373,if_res749,$rjs_core.Pair.makeList());};var count_from_right = function(who1380, list1381, pred1382) {if (M0.procedure_p(pred1382)!==false) {var if_res751 = M0.rvoid();} else {var if_res751 = M0.raise_argument_error(who1380,$rjs_core.UString.make("procedure?"),1,list1381,pred1382);}if_res751;var loop1383 = function(list1384, rev1385, n1386) {if (M0.pair_p(list1384)!==false) {var if_res754 = loop1383(M0.cdr(list1384),M0.cons(M0.car(list1384),rev1385),M0.add1(n1386));} else {var loop1387 = function(n1388, list1389) {if (M0.pair_p(list1389)!==false) {var if_res752 = pred1382(M0.car(list1389));} else {var if_res752 = false;}if (if_res752!==false) {var if_res753 = loop1387(M0.sub1(n1388),M0.cdr(list1389));} else {var if_res753 = n1388;}return if_res753;};var if_res754 = loop1387(n1386,rev1385);}return if_res754;};return loop1383(list1381,$rjs_core.Pair.makeList(),0);};var takef_right = function(list1390, pred1391) {return drop(list1390,count_from_right($rjs_core.PrimitiveSymbol.make("takef-right"),list1390,pred1391));};var dropf_right = function(list1392, pred1393) {return take(list1392,count_from_right($rjs_core.PrimitiveSymbol.make("dropf-right"),list1392,pred1393));};var splitf_at_right = function(list1394, pred1395) {return split_at(list1394,count_from_right($rjs_core.PrimitiveSymbol.make("splitf-at-right"),list1394,pred1395));};var list_prefix_p1396 = function(ls21397, rs31398, same_p11399) {var ls1400 = ls21397;var rs1401 = rs31398;if (M0.eq_p(same_p11399,M10.unsafe_undefined)!==false) {var if_res755 = M0.equal_p;} else {var if_res755 = same_p11399;}var same_p1402 = if_res755;if (M0.list_p(ls1400)!==false) {var if_res756 = M0.rvoid();} else {var if_res756 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),0,ls1400,rs1401);}if_res756;if (M0.list_p(rs1401)!==false) {var if_res757 = M0.rvoid();} else {var if_res757 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),1,ls1400,rs1401);}if_res757;if (M0.procedure_p(same_p1402)!==false) {var if_res758 = M0.procedure_arity_includes_p(same_p1402,2);} else {var if_res758 = false;}if (if_res758!==false) {var if_res759 = M0.rvoid();} else {var if_res759 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,ls1400,rs1401,same_p1402);}if_res759;var or_part1403 = M0.null_p(ls1400);if (or_part1403!==false) {var if_res762 = or_part1403;} else {if (M0.pair_p(rs1401)!==false) {if (same_p1402(M0.car(ls1400),M0.car(rs1401))!==false) {var if_res760 = list_prefix_p(M0.cdr(ls1400),M0.cdr(rs1401));} else {var if_res760 = false;}var if_res761 = if_res760;} else {var if_res761 = false;}var if_res762 = if_res761;}return if_res762;};var cl763 = function(ls1404, rs1405) {return list_prefix_p1396(ls1404,rs1405,M10.unsafe_undefined);};var cl764 = function(ls1406, rs1407, same_p11408) {return list_prefix_p1396(ls1406,rs1407,same_p11408);};var list_prefix_p = $rjs_core.attachProcedureArity(function() {var fixed_lam765 = {'2':cl763,'3':cl764}[arguments.length];if (fixed_lam765!==undefined) {return fixed_lam765.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var internal_split_common_prefix = function(as1409, bs1410, same_p1411, keep_prefix_p1412, name1413) {if (M0.list_p(as1409)!==false) {var if_res766 = M0.rvoid();} else {var if_res766 = M0.raise_argument_error(name1413,$rjs_core.UString.make("list?"),0,as1409,bs1410);}if_res766;if (M0.list_p(bs1410)!==false) {var if_res767 = M0.rvoid();} else {var if_res767 = M0.raise_argument_error(name1413,$rjs_core.UString.make("list?"),1,as1409,bs1410);}if_res767;if (M0.procedure_p(same_p1411)!==false) {var if_res768 = M0.procedure_arity_includes_p(same_p1411,2);} else {var if_res768 = false;}if (if_res768!==false) {var if_res769 = M0.rvoid();} else {var if_res769 = M0.raise_argument_error(name1413,$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,as1409,bs1410,same_p1411);}if_res769;var loop1414 = function(as1415, bs1416) {if (M0.pair_p(as1415)!==false) {if (M0.pair_p(bs1416)!==false) {var if_res770 = same_p1411(M0.car(as1415),M0.car(bs1416));} else {var if_res770 = false;}var if_res771 = if_res770;} else {var if_res771 = false;}if (if_res771!==false) {var let_result772 = loop1414(M0.cdr(as1415),M0.cdr(bs1416));var prefix1417 = let_result772.getAt(0);var atail1418 = let_result772.getAt(1);var btail1419 = let_result772.getAt(2);if (keep_prefix_p1412!==false) {var if_res773 = M0.cons(M0.car(as1415),prefix1417);} else {var if_res773 = false;}var if_res774 = M0.values(if_res773,atail1418,btail1419);} else {var if_res774 = M0.values(M0.rnull,as1415,bs1416);}return if_res774;};return loop1414(as1409,bs1410);};var split_common_prefix1420 = function(as51421, bs61422, same_p41423) {var as1424 = as51421;var bs1425 = bs61422;if (M0.eq_p(same_p41423,M10.unsafe_undefined)!==false) {var if_res775 = M0.equal_p;} else {var if_res775 = same_p41423;}var same_p1426 = if_res775;return internal_split_common_prefix(as1424,bs1425,same_p1426,true,$rjs_core.PrimitiveSymbol.make("split-common-prefix"));};var cl776 = function(as1427, bs1428) {return split_common_prefix1420(as1427,bs1428,M10.unsafe_undefined);};var cl777 = function(as1429, bs1430, same_p41431) {return split_common_prefix1420(as1429,bs1430,same_p41431);};var split_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam778 = {'2':cl776,'3':cl777}[arguments.length];if (fixed_lam778!==undefined) {return fixed_lam778.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var take_common_prefix1432 = function(as81433, bs91434, same_p71435) {var as1436 = as81433;var bs1437 = bs91434;if (M0.eq_p(same_p71435,M10.unsafe_undefined)!==false) {var if_res779 = M0.equal_p;} else {var if_res779 = same_p71435;}var same_p1438 = if_res779;var let_result780 = internal_split_common_prefix(as1436,bs1437,same_p1438,true,$rjs_core.PrimitiveSymbol.make("take-common-prefix"));var prefix1439 = let_result780.getAt(0);var atail1440 = let_result780.getAt(1);var btail1441 = let_result780.getAt(2);return prefix1439;};var cl781 = function(as1442, bs1443) {return take_common_prefix1432(as1442,bs1443,M10.unsafe_undefined);};var cl782 = function(as1444, bs1445, same_p71446) {return take_common_prefix1432(as1444,bs1445,same_p71446);};var take_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam783 = {'2':cl781,'3':cl782}[arguments.length];if (fixed_lam783!==undefined) {return fixed_lam783.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var drop_common_prefix1447 = function(as111448, bs121449, same_p101450) {var as1451 = as111448;var bs1452 = bs121449;if (M0.eq_p(same_p101450,M10.unsafe_undefined)!==false) {var if_res784 = M0.equal_p;} else {var if_res784 = same_p101450;}var same_p1453 = if_res784;var let_result785 = internal_split_common_prefix(as1451,bs1452,same_p1453,false,$rjs_core.PrimitiveSymbol.make("drop-common-prefix"));var prefix1454 = let_result785.getAt(0);var atail1455 = let_result785.getAt(1);var btail1456 = let_result785.getAt(2);return M0.values(atail1455,btail1456);};var cl786 = function(as1457, bs1458) {return drop_common_prefix1447(as1457,bs1458,M10.unsafe_undefined);};var cl787 = function(as1459, bs1460, same_p101461) {return drop_common_prefix1447(as1459,bs1460,same_p101461);};var drop_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam788 = {'2':cl786,'3':cl787}[arguments.length];if (fixed_lam788!==undefined) {return fixed_lam788.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cl789 = function(ls1462) {return M0.apply(M0.append,ls1462);};var cl790 = function(l11463, l21464) {return M0.apply(M0.append,l11463,l21464);};var cl791 = function(l11465, l21466, l31467) {return M0.apply(M0.append,l11465,l21466,l31467);};var cl792 = function(l11468, l21469, l31470, l41471) {return M0.apply(M0.append,l11468,l21469,l31470,l41471);};var cl793 = $rjs_core.attachProcedureArity(function(l1472, ...lss1473796) {var lss1473 = $rjs_core.Pair.listFromArray(lss1473796);return M0.apply(M1.new_apply_proc,M0.append,l1472,lss1473);});var append_times_ = $rjs_core.attachProcedureArity(function() {var fixed_lam794 = {'1':cl789,'2':cl790,'3':cl791,'4':cl792}[arguments.length];if (fixed_lam794!==undefined) {return fixed_lam794.apply(null,arguments);} else {if (M0.__gt__eq_(cl793.length,1)!==false) {var if_res795 = cl793.apply(null,arguments);} else {var if_res795 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res795;}},[M0.make_arity_at_least(1)]);var flatten = function(orig_sexp1474) {var loop1475 = function(sexp1476, acc1477) {if (M0.null_p(sexp1476)!==false) {var if_res798 = acc1477;} else {if (M0.pair_p(sexp1476)!==false) {var if_res797 = loop1475(M0.car(sexp1476),loop1475(M0.cdr(sexp1476),acc1477));} else {var if_res797 = M0.cons(sexp1476,acc1477);}var if_res798 = if_res797;}return if_res798;};return loop1475(orig_sexp1474,M0.rnull);};var add_between = function(after_last161478, before_first141479, before_last151480, splice_p131481, l211482, x221483) {var l1484 = l211482;var x1485 = x221483;if (false!==false) {var if_res799 = false;} else {var if_res799 = splice_p131481;}var splice_p1486 = if_res799;if (false!==false) {var if_res800 = $rjs_core.Pair.makeList();} else {var if_res800 = before_first141479;}var before_first1487 = if_res800;if (M0.eq_p(before_last151480,M10.unsafe_undefined)!==false) {var if_res801 = x1485;} else {var if_res801 = before_last151480;}var before_last1488 = if_res801;if (false!==false) {var if_res802 = $rjs_core.Pair.makeList();} else {var if_res802 = after_last161478;}var after_last1489 = if_res802;if (M0.list_p(l1484)!==false) {var if_res803 = M0.rvoid();} else {var if_res803 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("add-between"),$rjs_core.UString.make("list?"),0,l1484,x1485);}if_res803;if (splice_p1486!==false) {var check_list1490 = function(x1491, which1492) {if (M0.list_p(x1491)!==false) {var if_res804 = M0.rvoid();} else {var if_res804 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M0.string_append($rjs_core.UString.make("list needed in splicing mode"),which1492),$rjs_core.UString.make("given"),x1491,$rjs_core.UString.make("given list..."),l1484);}return if_res804;};check_list1490(x1485,$rjs_core.UString.make(""));check_list1490(before_first1487,$rjs_core.UString.make(" for #:before-first"));check_list1490(before_last1488,$rjs_core.UString.make(" for #:before-last"));var if_res806 = check_list1490(after_last1489,$rjs_core.UString.make(" for #:after-last"));} else {var check_not_given1493 = function(x1494, which1495) {if (M0.eq_p($rjs_core.Pair.makeList(),x1494)!==false) {var if_res805 = M0.rvoid();} else {var if_res805 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M0.string_append(which1495,$rjs_core.UString.make(" can only be used in splicing mode")),$rjs_core.UString.make("given"),x1494,$rjs_core.UString.make("given list..."),l1484);}return if_res805;};check_not_given1493(before_first1487,$rjs_core.UString.make("#:before-first"));var if_res806 = check_not_given1493(after_last1489,$rjs_core.UString.make("#:after-last"));}if_res806;var or_part1496 = M0.null_p(l1484);if (or_part1496!==false) {var if_res807 = or_part1496;} else {var if_res807 = M0.null_p(M0.cdr(l1484));}if (if_res807!==false) {if (splice_p1486!==false) {var if_res808 = M0.append(before_first1487,l1484,after_last1489);} else {var if_res808 = l1484;}var if_res813 = if_res808;} else {if (splice_p1486!==false) {var x1497 = M8.alt_reverse(x1485);var loop1499 = function(i1500, l1501, r1502) {if (M0.pair_p(l1501)!==false) {var if_res809 = loop1499(M0.car(l1501),M0.cdr(l1501),M0.cons(i1500,M0.append(x1497,r1502)));} else {var if_res809 = M0.cons(i1500,M0.append(M8.alt_reverse(before_last1488),r1502));}return if_res809;};var r1498 = loop1499(M0.cadr(l1484),M0.cddr(l1484),$rjs_core.Pair.makeList());var r1503 = M8.alt_reverse(M0.append(M8.alt_reverse(after_last1489),r1498));var r1504 = M5.__rjs_quoted__.qq_append(before_first1487,M0.list_times_(M0.car(l1484),r1503));var if_res812 = r1504;} else {var temp811 = M0.car(l1484);var loop1505 = function(i1506, l1507, r1508) {if (M0.pair_p(l1507)!==false) {var if_res810 = loop1505(M0.car(l1507),M0.cdr(l1507),M0.cons(i1506,M0.cons(x1485,r1508)));} else {var if_res810 = M0.cons(i1506,M0.cons(before_last1488,r1508));}return if_res810;};var if_res812 = M0.cons(temp811,M8.alt_reverse(loop1505(M0.cadr(l1484),M0.cddr(l1484),$rjs_core.Pair.makeList())));}var if_res813 = if_res812;}return if_res813;};var add_between1266 = function(given_kws1509, given_args1510, l211511, x221512) {if (M0.pair_p(given_kws1509)!==false) {var if_res814 = M0.eq_p($rjs_core.Keyword.make("after-last"),M0.car(given_kws1509));} else {var if_res814 = false;}var after_last201513 = if_res814;if (after_last201513!==false) {var if_res815 = M0.car(given_args1510);} else {var if_res815 = $rjs_core.Pair.makeList();}var after_last161514 = if_res815;if (after_last201513!==false) {var if_res816 = M0.cdr(given_kws1509);} else {var if_res816 = given_kws1509;}var kws793981515 = if_res816;if (after_last201513!==false) {var if_res817 = M0.cdr(given_args1510);} else {var if_res817 = given_args1510;}var kw_args793991516 = if_res817;if (M0.pair_p(kws793981515)!==false) {var if_res818 = M0.eq_p($rjs_core.Keyword.make("before-first"),M0.car(kws793981515));} else {var if_res818 = false;}var before_first181517 = if_res818;if (before_first181517!==false) {var if_res819 = M0.car(kw_args793991516);} else {var if_res819 = $rjs_core.Pair.makeList();}var before_first141518 = if_res819;if (before_first181517!==false) {var if_res820 = M0.cdr(kws793981515);} else {var if_res820 = kws793981515;}var kws794001519 = if_res820;if (before_first181517!==false) {var if_res821 = M0.cdr(kw_args793991516);} else {var if_res821 = kw_args793991516;}var kw_args794011520 = if_res821;if (M0.pair_p(kws794001519)!==false) {var if_res822 = M0.eq_p($rjs_core.Keyword.make("before-last"),M0.car(kws794001519));} else {var if_res822 = false;}var before_last191521 = if_res822;if (before_last191521!==false) {var if_res823 = M0.car(kw_args794011520);} else {var if_res823 = M10.unsafe_undefined;}var before_last151522 = if_res823;if (before_last191521!==false) {var if_res824 = M0.cdr(kws794001519);} else {var if_res824 = kws794001519;}var kws794021523 = if_res824;if (before_last191521!==false) {var if_res825 = M0.cdr(kw_args794011520);} else {var if_res825 = kw_args794011520;}var kw_args794031524 = if_res825;var splice_p171525 = M0.pair_p(kws794021523);if (splice_p171525!==false) {var if_res826 = M0.car(kw_args794031524);} else {var if_res826 = false;}var splice_p131526 = if_res826;return add_between(after_last161514,before_first141518,before_last151522,splice_p131526,l211511,x221512);};var cl830 = function(given_kws1537, given_args1538, l1539, x1540) {return add_between1266(given_kws1537,given_args1538,l1539,x1540);};var temp832 = $rjs_core.attachProcedureArity(function() {var fixed_lam831 = {'4':cl830}[arguments.length];if (fixed_lam831!==undefined) {return fixed_lam831.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4]);var temp829 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("after-last"),$rjs_core.Keyword.make("before-first"),$rjs_core.Keyword.make("before-last"),$rjs_core.Keyword.make("splice?"));var cl827 = function(l1541, x1542) {return add_between1266(M0.rnull,M0.rnull,l1541,x1542);};var add_between23 = M4.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1527, given_argc1528) {if (M0.__eq_(given_argc1528,4)!==false) {var l1794041529 = given_kws1527;if (M0.null_p(l1794041529)!==false) {var if_res834 = l1794041529;} else {if (M0.eq_p(M0.car(l1794041529),$rjs_core.Keyword.make("after-last"))!==false) {var if_res833 = M0.cdr(l1794041529);} else {var if_res833 = l1794041529;}var if_res834 = if_res833;}var l1794041530 = if_res834;var l1794051531 = l1794041530;if (M0.null_p(l1794051531)!==false) {var if_res836 = l1794051531;} else {if (M0.eq_p(M0.car(l1794051531),$rjs_core.Keyword.make("before-first"))!==false) {var if_res835 = M0.cdr(l1794051531);} else {var if_res835 = l1794051531;}var if_res836 = if_res835;}var l1794051532 = if_res836;var l1794061533 = l1794051532;if (M0.null_p(l1794061533)!==false) {var if_res838 = l1794061533;} else {if (M0.eq_p(M0.car(l1794061533),$rjs_core.Keyword.make("before-last"))!==false) {var if_res837 = M0.cdr(l1794061533);} else {var if_res837 = l1794061533;}var if_res838 = if_res837;}var l1794061534 = if_res838;var l1794071535 = l1794061534;if (M0.null_p(l1794071535)!==false) {var if_res840 = l1794071535;} else {if (M0.eq_p(M0.car(l1794071535),$rjs_core.Keyword.make("splice?"))!==false) {var if_res839 = M0.cdr(l1794071535);} else {var if_res839 = l1794071535;}var if_res840 = if_res839;}var l1794071536 = if_res840;var if_res841 = M0.null_p(l1794071536);} else {var if_res841 = false;}return if_res841;},temp832,M0.rnull,temp829,$rjs_core.attachProcedureArity(function() {var fixed_lam828 = {'2':cl827}[arguments.length];if (fixed_lam828!==undefined) {return fixed_lam828.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2]));var remove_duplicates = function(key241543, l271544, __eq__p261545) {var l1546 = l271544;if (M0.eq_p(__eq__p261545,M10.unsafe_undefined)!==false) {var if_res842 = M0.equal_p;} else {var if_res842 = __eq__p261545;}var __eq__p1547 = if_res842;if (false!==false) {var if_res843 = false;} else {var if_res843 = key241543;}var key1548 = if_res843;if (M0.list_p(l1546)!==false) {var if_res844 = M0.rvoid();} else {var if_res844 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remove-duplicates"),$rjs_core.UString.make("list?"),l1546);}if_res844;var len1549 = M0.length(l1546);if (M0.__lt__eq_(len1549,1)!==false) {var if_res848 = true;} else {if (M0.__lt__eq_(len1549,40)!==false) {var if_res847 = false;} else {if (M0.eq_p(__eq__p1547,M0.eq_p)!==false) {var if_res846 = M0.make_hasheq();} else {if (M0.eq_p(__eq__p1547,M0.equal_p)!==false) {var if_res845 = M0.make_hash();} else {var if_res845 = false;}var if_res846 = if_res845;}var if_res847 = if_res846;}var if_res848 = if_res847;}var h1550 = if_res848;var tmp1551 = h1550;if (M0.equal_p(tmp1551,true)!==false) {var if_res867 = l1546;} else {if (M0.equal_p(tmp1551,false)!==false) {var or_part1553 = key1548;if (or_part1553!==false) {var if_res849 = or_part1553;} else {var if_res849 = function(x1554) {return x1554;};}var key1552 = if_res849;if (M0.eq_p(__eq__p1547,M0.equal_p)!==false) {var loop1555 = function(l1556, seen1557) {if (M0.null_p(l1556)!==false) {var if_res851 = l1556;} else {var x1558 = M0.car(l1556);var k1559 = key1552(x1558);var l1560 = M0.cdr(l1556);if (M6.member(k1559,seen1557)!==false) {var if_res850 = loop1555(l1560,seen1557);} else {var if_res850 = M0.cons(x1558,loop1555(l1560,M0.cons(k1559,seen1557)));}var if_res851 = if_res850;}return if_res851;};var if_res860 = loop1555(l1546,M0.rnull);} else {if (M0.eq_p(__eq__p1547,M0.eq_p)!==false) {var loop1561 = function(l1562, seen1563) {if (M0.null_p(l1562)!==false) {var if_res853 = l1562;} else {var x1564 = M0.car(l1562);var k1565 = key1552(x1564);var l1566 = M0.cdr(l1562);if (M0.memq(k1565,seen1563)!==false) {var if_res852 = loop1561(l1566,seen1563);} else {var if_res852 = M0.cons(x1564,loop1561(l1566,M0.cons(k1565,seen1563)));}var if_res853 = if_res852;}return if_res853;};var if_res859 = loop1561(l1546,M0.rnull);} else {if (M0.eq_p(__eq__p1547,M0.eqv_p)!==false) {var loop1567 = function(l1568, seen1569) {if (M0.null_p(l1568)!==false) {var if_res855 = l1568;} else {var x1570 = M0.car(l1568);var k1571 = key1552(x1570);var l1572 = M0.cdr(l1568);if (M0.memv(k1571,seen1569)!==false) {var if_res854 = loop1567(l1572,seen1569);} else {var if_res854 = M0.cons(x1570,loop1567(l1572,M0.cons(k1571,seen1569)));}var if_res855 = if_res854;}return if_res855;};var if_res858 = loop1567(l1546,M0.rnull);} else {var loop1573 = function(l1574, seen1575) {if (M0.null_p(l1574)!==false) {var if_res857 = l1574;} else {var x1576 = M0.car(l1574);var k1577 = key1552(x1576);var l1578 = M0.cdr(l1574);if ((function(x1579, seen1580) {return M3.ormap(function(y1581) {return __eq__p1547(x1579,y1581);},seen1580);})(k1577,seen1575)!==false) {var if_res856 = loop1573(l1578,seen1575);} else {var if_res856 = M0.cons(x1576,loop1573(l1578,M0.cons(k1577,seen1575)));}var if_res857 = if_res856;}return if_res857;};var if_res858 = loop1573(l1546,M0.rnull);}var if_res859 = if_res858;}var if_res860 = if_res859;}var if_res866 = if_res860;} else {if (key1548!==false) {var loop1582 = function(l1583) {if (M0.null_p(l1583)!==false) {var if_res862 = l1583;} else {var x1584 = M0.car(l1583);var k1585 = key1548(x1584);var l1586 = M0.cdr(l1583);if (M0.hash_ref(h1550,k1585,false)!==false) {var if_res861 = loop1582(l1586);} else {M0.hash_set_bang_(h1550,k1585,true);var if_res861 = M0.cons(x1584,loop1582(l1586));}var if_res862 = if_res861;}return if_res862;};var if_res865 = loop1582(l1546);} else {var loop1587 = function(l1588) {if (M0.null_p(l1588)!==false) {var if_res864 = l1588;} else {var x1589 = M0.car(l1588);var k1590 = x1589;var l1591 = M0.cdr(l1588);if (M0.hash_ref(h1550,k1590,false)!==false) {var if_res863 = loop1587(l1591);} else {M0.hash_set_bang_(h1550,k1590,true);var if_res863 = M0.cons(x1589,loop1587(l1591));}var if_res864 = if_res863;}return if_res864;};var if_res865 = loop1587(l1546);}var if_res866 = if_res865;}var if_res867 = if_res866;}return if_res867;};var remove_duplicates1267 = function(given_kws1592, given_args1593, l271594, __eq__p261595) {var key251596 = M0.pair_p(given_kws1592);if (key251596!==false) {var if_res868 = M0.car(given_args1593);} else {var if_res868 = false;}var key241597 = if_res868;return remove_duplicates(key241597,l271594,__eq__p261595);};var cl873 = function(given_kws1602, given_args1603, l1604) {return remove_duplicates1267(given_kws1602,given_args1603,l1604,M10.unsafe_undefined);};var cl874 = function(given_kws1605, given_args1606, l1607, __eq__p261608) {return remove_duplicates1267(given_kws1605,given_args1606,l1607,__eq__p261608);};var temp876 = $rjs_core.attachProcedureArity(function() {var fixed_lam875 = {'3':cl873,'4':cl874}[arguments.length];if (fixed_lam875!==undefined) {return fixed_lam875.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp872 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("key"));var cl869 = function(l1609) {return remove_duplicates1267(M0.rnull,M0.rnull,l1609,M10.unsafe_undefined);};var cl870 = function(l1610, __eq__p261611) {return remove_duplicates1267(M0.rnull,M0.rnull,l1610,__eq__p261611);};var remove_duplicates28 = M4.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1598, given_argc1599) {if (M0.__gt__eq_(given_argc1599,3)!==false) {var if_res877 = M0.__lt__eq_(given_argc1599,4);} else {var if_res877 = false;}if (if_res877!==false) {var l1794161600 = given_kws1598;if (M0.null_p(l1794161600)!==false) {var if_res879 = l1794161600;} else {if (M0.eq_p(M0.car(l1794161600),$rjs_core.Keyword.make("key"))!==false) {var if_res878 = M0.cdr(l1794161600);} else {var if_res878 = l1794161600;}var if_res879 = if_res878;}var l1794161601 = if_res879;var if_res880 = M0.null_p(l1794161601);} else {var if_res880 = false;}return if_res880;},temp876,M0.rnull,temp872,$rjs_core.attachProcedureArity(function() {var fixed_lam871 = {'1':cl869,'2':cl870}[arguments.length];if (fixed_lam871!==undefined) {return fixed_lam871.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates = function(default301612, key291613, items341614, same_p331615) {var items1616 = items341614;if (M0.eq_p(same_p331615,M10.unsafe_undefined)!==false) {var if_res881 = M0.equal_p;} else {var if_res881 = same_p331615;}var same_p1617 = if_res881;if (M0.eq_p(key291613,M10.unsafe_undefined)!==false) {var if_res882 = M0.values;} else {var if_res882 = key291613;}var key1618 = if_res882;if (M0.eq_p(default301612,M10.unsafe_undefined)!==false) {var if_res883 = function() {return false;};} else {var if_res883 = default301612;}var failure_result1619 = if_res883;if (M0.list_p(items1616)!==false) {var if_res884 = M0.rvoid();} else {var if_res884 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("list?"),0,items1616);}if_res884;if (M0.procedure_p(key1618)!==false) {var if_res885 = M0.procedure_arity_includes_p(key1618,1);} else {var if_res885 = false;}if (if_res885!==false) {var if_res886 = M0.rvoid();} else {var if_res886 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(-> any/c any/c)"),key1618);}if_res886;if (M0.procedure_p(failure_result1619)!==false) {var if_res887 = failure_result1619;} else {var if_res887 = function() {return failure_result1619;};}var fail_k1620 = if_res887;if (M0.eq_p(same_p1617,M0.equal_p)!==false) {var if_res892 = check_duplicates_by_t(items1616,key1618,M0.make_hash(),fail_k1620);} else {if (M0.eq_p(same_p1617,M0.eq_p)!==false) {var if_res891 = check_duplicates_by_t(items1616,key1618,M0.make_hasheq(),fail_k1620);} else {if (M0.eq_p(same_p1617,M0.eqv_p)!==false) {var if_res890 = check_duplicates_by_t(items1616,key1618,M0.make_hasheqv(),fail_k1620);} else {if (M0.procedure_p(same_p1617)!==false) {var if_res888 = M0.procedure_arity_includes_p(same_p1617,2);} else {var if_res888 = false;}if (if_res888!==false) {var if_res889 = M0.rvoid();} else {var if_res889 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),1,items1616,same_p1617);}if_res889;var if_res890 = check_duplicates_by_list(items1616,key1618,same_p1617,fail_k1620);}var if_res891 = if_res890;}var if_res892 = if_res891;}return if_res892;};var check_duplicates1268 = function(given_kws1621, given_args1622, items341623, same_p331624) {if (M0.pair_p(given_kws1621)!==false) {var if_res893 = M0.eq_p($rjs_core.Keyword.make("default"),M0.car(given_kws1621));} else {var if_res893 = false;}var default321625 = if_res893;if (default321625!==false) {var if_res894 = M0.car(given_args1622);} else {var if_res894 = M10.unsafe_undefined;}var default301626 = if_res894;if (default321625!==false) {var if_res895 = M0.cdr(given_kws1621);} else {var if_res895 = given_kws1621;}var kws794171627 = if_res895;if (default321625!==false) {var if_res896 = M0.cdr(given_args1622);} else {var if_res896 = given_args1622;}var kw_args794181628 = if_res896;var key311629 = M0.pair_p(kws794171627);if (key311629!==false) {var if_res897 = M0.car(kw_args794181628);} else {var if_res897 = M10.unsafe_undefined;}var key291630 = if_res897;return check_duplicates(default301626,key291630,items341623,same_p331624);};var cl902 = function(given_kws1637, given_args1638, items1639) {return check_duplicates1268(given_kws1637,given_args1638,items1639,M10.unsafe_undefined);};var cl903 = function(given_kws1640, given_args1641, items1642, same_p331643) {return check_duplicates1268(given_kws1640,given_args1641,items1642,same_p331643);};var temp905 = $rjs_core.attachProcedureArity(function() {var fixed_lam904 = {'3':cl902,'4':cl903}[arguments.length];if (fixed_lam904!==undefined) {return fixed_lam904.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp901 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("default"),$rjs_core.Keyword.make("key"));var cl898 = function(items1644) {return check_duplicates1268(M0.rnull,M0.rnull,items1644,M10.unsafe_undefined);};var cl899 = function(items1645, same_p331646) {return check_duplicates1268(M0.rnull,M0.rnull,items1645,same_p331646);};var check_duplicates35 = M4.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1631, given_argc1632) {if (M0.__gt__eq_(given_argc1632,3)!==false) {var if_res906 = M0.__lt__eq_(given_argc1632,4);} else {var if_res906 = false;}if (if_res906!==false) {var l1794191633 = given_kws1631;if (M0.null_p(l1794191633)!==false) {var if_res908 = l1794191633;} else {if (M0.eq_p(M0.car(l1794191633),$rjs_core.Keyword.make("default"))!==false) {var if_res907 = M0.cdr(l1794191633);} else {var if_res907 = l1794191633;}var if_res908 = if_res907;}var l1794191634 = if_res908;var l1794201635 = l1794191634;if (M0.null_p(l1794201635)!==false) {var if_res910 = l1794201635;} else {if (M0.eq_p(M0.car(l1794201635),$rjs_core.Keyword.make("key"))!==false) {var if_res909 = M0.cdr(l1794201635);} else {var if_res909 = l1794201635;}var if_res910 = if_res909;}var l1794201636 = if_res910;var if_res911 = M0.null_p(l1794201636);} else {var if_res911 = false;}return if_res911;},temp905,M0.rnull,temp901,$rjs_core.attachProcedureArity(function() {var fixed_lam900 = {'1':cl898,'2':cl899}[arguments.length];if (fixed_lam900!==undefined) {return fixed_lam900.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates_by_t = function(items1647, key1648, table1649, fail_k1650) {var loop1651 = function(items1652) {if (M0.pair_p(items1652)!==false) {var key_item1653 = key1648(M0.car(items1652));if (M0.hash_ref(table1649,key_item1653,false)!==false) {var if_res912 = M0.car(items1652);} else {M0.hash_set_bang_(table1649,key_item1653,true);var if_res912 = loop1651(M0.cdr(items1652));}var if_res913 = if_res912;} else {var if_res913 = fail_k1650();}return if_res913;};return loop1651(items1647);};var check_duplicates_by_list = function(items1654, key1655, same_p1656, fail_k1657) {var loop1658 = function(items1659, sofar1660) {if (M0.pair_p(items1659)!==false) {var key_item1661 = key1655(M0.car(items1659));var lst1662 = sofar1660;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res914 = M0.rvoid();} else {var if_res914 = M9.__rjs_quoted__.check_list(lst1662);}if_res914;var for_loop1663 = function(result1664, lst1665) {if (M0.pair_p(lst1665)!==false) {var prev1666 = M10.unsafe_car(lst1665);var rest1667 = M10.unsafe_cdr(lst1665);if (true!==false) {var result1669 = result1664;var result1670 = same_p1656(key_item1661,prev1666);var result1668 = M0.values(result1670);if (true!==false) {var if_res916 = M0.not($rjs_core.attachProcedureArity(function(...x1671915) {var x1671 = $rjs_core.Pair.listFromArray(x1671915);return result1668;})(prev1666));} else {var if_res916 = false;}if (if_res916!==false) {var if_res917 = M0.not(false);} else {var if_res917 = false;}if (if_res917!==false) {var if_res918 = for_loop1663(result1668,rest1667);} else {var if_res918 = result1668;}var if_res919 = if_res918;} else {var if_res919 = result1664;}var if_res920 = if_res919;} else {var if_res920 = result1664;}return if_res920;};if (for_loop1663(false,lst1662)!==false) {var if_res921 = M0.car(items1659);} else {var if_res921 = loop1658(M0.cdr(items1659),M0.cons(key_item1661,sofar1660));}var if_res922 = if_res921;} else {var if_res922 = fail_k1657();}return if_res922;};return loop1658(items1654,M0.rnull);};var check_filter_arguments = function(who1672, f1673, l1674, ls1675) {if (M0.procedure_p(f1673)!==false) {var if_res923 = M0.rvoid();} else {var if_res923 = M0.apply(M0.raise_argument_error,who1672,$rjs_core.UString.make("procedure?"),0,f1673,l1674,ls1675);}if_res923;if (M0.procedure_arity_includes_p(f1673,M0.add1(M0.length(ls1675)))!==false) {var if_res924 = M0.rvoid();} else {var if_res924 = M0.raise_arguments_error(who1672,$rjs_core.UString.make("mismatch between procedure arity and argument count"),$rjs_core.UString.make("procedure"),f1673,$rjs_core.UString.make("expected arity"),M0.add1(M0.length(ls1675)));}if_res924;if (M0.list_p(l1674)!==false) {var if_res925 = M3.andmap(M0.list_p,ls1675);} else {var if_res925 = false;}if (if_res925!==false) {var if_res945 = M0.rvoid();} else {var let_result926 = M9.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),M0.cons(l1674,ls1675));var pos__gt_vals1676 = let_result926.getAt(0);var pos_pre_inc1677 = let_result926.getAt(1);var pos_next1678 = let_result926.getAt(2);var init1679 = let_result926.getAt(3);var pos_cont_p1680 = let_result926.getAt(4);var val_cont_p1681 = let_result926.getAt(5);var all_cont_p1682 = let_result926.getAt(6);var start1683 = 0;if (M0.rvoid()!==false) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res927 = M0.rvoid();} else {var if_res927 = M9.__rjs_quoted__.check_naturals(start1683);}var if_res928 = if_res927;} else {var if_res928 = false;}if_res928;var for_loop1684 = function(pos1685, pos1686) {if (pos_cont_p1680!==false) {var if_res929 = pos_cont_p1680(pos1685);} else {var if_res929 = true;}if (if_res929!==false) {var if_res930 = true;} else {var if_res930 = false;}if (if_res930!==false) {var x1691 = pos__gt_vals1676(pos1685);if (all_cont_p1682!==false) {var if_res931 = function(pos1692) {return all_cont_p1682(pos1692,x1691);};} else {var if_res931 = false;}var let_result932 = M0.values(x1691,if_res931);var x1687 = let_result932.getAt(0);var all_cont_p_by_pos1688 = let_result932.getAt(1);if (pos_pre_inc1677!==false) {var if_res933 = pos_pre_inc1677(pos1685);} else {var if_res933 = pos1685;}var pos1689 = if_res933;var i1690 = pos1686;if (val_cont_p1681!==false) {var if_res934 = val_cont_p1681(x1687);} else {var if_res934 = true;}if (if_res934!==false) {var if_res935 = true;} else {var if_res935 = false;}if (if_res935!==false) {if (M0.list_p(x1687)!==false) {var if_res936 = M0.rvoid();} else {var if_res936 = M0.apply(M0.raise_argument_error,who1672,$rjs_core.UString.make("list?"),M0.add1(i1690),f1673,l1674,ls1675);}if_res936;var let_result937 = M0.values();var let_result938 = M0.values();if (all_cont_p_by_pos1688!==false) {var if_res939 = all_cont_p_by_pos1688(pos1689);} else {var if_res939 = true;}if (if_res939!==false) {var if_res940 = true;} else {var if_res940 = false;}if (if_res940!==false) {var if_res941 = M0.not(false);} else {var if_res941 = false;}if (if_res941!==false) {var if_res942 = for_loop1684(pos_next1678(pos1689),pos1686+1);} else {var if_res942 = M0.values();}var if_res943 = if_res942;} else {var if_res943 = M0.values();}var if_res944 = if_res943;} else {var if_res944 = M0.values();}return if_res944;};for_loop1684(init1679,start1683);var if_res945 = M0.rvoid();}return if_res945;};var filter_map = $rjs_core.attachProcedureArity(function(f1693, l1694, ...ls1695946) {var ls1695 = $rjs_core.Pair.listFromArray(ls1695946);check_filter_arguments($rjs_core.PrimitiveSymbol.make("filter-map"),f1693,l1694,ls1695);if (M0.pair_p(ls1695)!==false) {var len1696 = M0.length(l1694);if (M3.andmap(function(l1697) {return M0.__eq_(len1696,M0.length(l1697));},ls1695)!==false) {var loop1698 = function(l1699, ls1700) {if (M0.null_p(l1699)!==false) {var if_res948 = M0.rnull;} else {var x1701 = M0.apply(f1693,M0.car(l1699),M3.map(M0.car,ls1700));if (x1701!==false) {var if_res947 = M0.cons(x1701,loop1698(M0.cdr(l1699),M3.map(M0.cdr,ls1700)));} else {var if_res947 = loop1698(M0.cdr(l1699),M3.map(M0.cdr,ls1700));}var if_res948 = if_res947;}return if_res948;};var if_res949 = loop1698(l1694,ls1695);} else {var if_res949 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("filter-map"),$rjs_core.UString.make("all lists must have same size"));}var if_res952 = if_res949;} else {var loop1702 = function(l1703) {if (M0.null_p(l1703)!==false) {var if_res951 = M0.rnull;} else {var x1704 = f1693(M0.car(l1703));if (x1704!==false) {var if_res950 = M0.cons(x1704,loop1702(M0.cdr(l1703)));} else {var if_res950 = loop1702(M0.cdr(l1703));}var if_res951 = if_res950;}return if_res951;};var if_res952 = loop1702(l1694);}return if_res952;});var count = $rjs_core.attachProcedureArity(function(f1705, l1706, ...ls1707953) {var ls1707 = $rjs_core.Pair.listFromArray(ls1707953);check_filter_arguments($rjs_core.PrimitiveSymbol.make("count"),f1705,l1706,ls1707);if (M0.pair_p(ls1707)!==false) {var len1708 = M0.length(l1706);if (M3.andmap(function(l1709) {return M0.__eq_(len1708,M0.length(l1709));},ls1707)!==false) {var loop1710 = function(l1711, ls1712, c1713) {if (M0.null_p(l1711)!==false) {var if_res957 = c1713;} else {var temp956 = M0.cdr(l1711);var temp955 = M3.map(M0.cdr,ls1712);if (M0.apply(f1705,M0.car(l1711),M3.map(M0.car,ls1712))!==false) {var if_res954 = M0.add1(c1713);} else {var if_res954 = c1713;}var if_res957 = loop1710(temp956,temp955,if_res954);}return if_res957;};var if_res958 = loop1710(l1706,ls1707,0);} else {var if_res958 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("count"),$rjs_core.UString.make("all lists must have same size"));}var if_res962 = if_res958;} else {var loop1714 = function(l1715, c1716) {if (M0.null_p(l1715)!==false) {var if_res961 = c1716;} else {var temp960 = M0.cdr(l1715);if (f1705(M0.car(l1715))!==false) {var if_res959 = M0.add1(c1716);} else {var if_res959 = c1716;}var if_res961 = loop1714(temp960,if_res959);}return if_res961;};var if_res962 = loop1714(l1706,0);}return if_res962;});var partition = function(pred1717, l1718) {if (M0.procedure_p(pred1717)!==false) {var if_res963 = M0.procedure_arity_includes_p(pred1717,1);} else {var if_res963 = false;}if (if_res963!==false) {var if_res964 = M0.rvoid();} else {var if_res964 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,pred1717,l1718);}if_res964;if (M0.list_p(l1718)!==false) {var if_res965 = M0.rvoid();} else {var if_res965 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("list?"),1,pred1717,l1718);}if_res965;var loop1719 = function(l1720, i1721, o1722) {if (M0.null_p(l1720)!==false) {var if_res967 = M0.values(M8.alt_reverse(i1721),M8.alt_reverse(o1722));} else {var x1723 = M0.car(l1720);var l1724 = M0.cdr(l1720);if (pred1717(x1723)!==false) {var if_res966 = loop1719(l1724,M0.cons(x1723,i1721),o1722);} else {var if_res966 = loop1719(l1724,i1721,M0.cons(x1723,o1722));}var if_res967 = if_res966;}return if_res967;};return loop1719(l1718,$rjs_core.Pair.makeList(),$rjs_core.Pair.makeList());};var cl968 = function(end1726) {var start1727 = 0;var end1728 = end1726;var inc1729 = 1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res972 = M0.rvoid();} else {var if_res972 = M9.__rjs_quoted__.check_range(start1727,end1728,inc1729);}if_res972;var for_loop1730 = function(fold_var1731, pos1732) {if (M0.__lt_(pos1732,end1728)!==false) {var i1733 = pos1732;if (true!==false) {var fold_var1735 = fold_var1731;var fold_var1736 = M0.cons(i1733,fold_var1735);var fold_var1734 = M0.values(fold_var1736);if (true!==false) {var if_res973 = M0.not(false);} else {var if_res973 = false;}if (if_res973!==false) {var if_res974 = for_loop1730(fold_var1734,pos1732+inc1729);} else {var if_res974 = fold_var1734;}var if_res975 = if_res974;} else {var if_res975 = fold_var1731;}var if_res976 = if_res975;} else {var if_res976 = fold_var1731;}return if_res976;};return M8.alt_reverse(for_loop1730(M0.rnull,start1727));};var cl969 = function(start1737, end1738) {var start1739 = start1737;var end1740 = end1738;var inc1741 = 1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res977 = M0.rvoid();} else {var if_res977 = M9.__rjs_quoted__.check_range(start1739,end1740,inc1741);}if_res977;var for_loop1742 = function(fold_var1743, pos1744) {if (M0.__lt_(pos1744,end1740)!==false) {var i1745 = pos1744;if (true!==false) {var fold_var1747 = fold_var1743;var fold_var1748 = M0.cons(i1745,fold_var1747);var fold_var1746 = M0.values(fold_var1748);if (true!==false) {var if_res978 = M0.not(false);} else {var if_res978 = false;}if (if_res978!==false) {var if_res979 = for_loop1742(fold_var1746,pos1744+inc1741);} else {var if_res979 = fold_var1746;}var if_res980 = if_res979;} else {var if_res980 = fold_var1743;}var if_res981 = if_res980;} else {var if_res981 = fold_var1743;}return if_res981;};return M8.alt_reverse(for_loop1742(M0.rnull,start1739));};var cl970 = function(start1749, end1750, step1751) {var start1752 = start1749;var end1753 = end1750;var inc1754 = step1751;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res982 = M0.rvoid();} else {var if_res982 = M9.__rjs_quoted__.check_range(start1752,end1753,inc1754);}if_res982;var for_loop1755 = function(fold_var1756, pos1757) {if (M0.__gt__eq_(step1751,0)!==false) {var if_res983 = M0.__lt_(pos1757,end1753);} else {var if_res983 = M0.__gt_(pos1757,end1753);}if (if_res983!==false) {var i1758 = pos1757;if (true!==false) {var fold_var1760 = fold_var1756;var fold_var1761 = M0.cons(i1758,fold_var1760);var fold_var1759 = M0.values(fold_var1761);if (true!==false) {var if_res984 = M0.not(false);} else {var if_res984 = false;}if (if_res984!==false) {var if_res985 = for_loop1755(fold_var1759,pos1757+inc1754);} else {var if_res985 = fold_var1759;}var if_res986 = if_res985;} else {var if_res986 = fold_var1756;}var if_res987 = if_res986;} else {var if_res987 = fold_var1756;}return if_res987;};return M8.alt_reverse(for_loop1755(M0.rnull,start1752));};var range1725 = $rjs_core.attachProcedureArity(function() {var fixed_lam971 = {'1':cl968,'2':cl969,'3':cl970}[arguments.length];if (fixed_lam971!==undefined) {return fixed_lam971.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2,3]);var range_proc = range1725;var cl988 = function(start1763, end1764) {var start1765 = start1763;var end1766 = end1764;var inc1767 = 1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res991 = M0.rvoid();} else {var if_res991 = M9.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start1765,end1766,inc1767);}if_res991;var for_loop1768 = function(fold_var1769, pos1770) {if (M0.__lt__eq_(pos1770,end1766)!==false) {var i1771 = pos1770;if (true!==false) {var fold_var1773 = fold_var1769;var fold_var1774 = M0.cons(i1771,fold_var1773);var fold_var1772 = M0.values(fold_var1774);if (true!==false) {var if_res992 = M0.not(false);} else {var if_res992 = false;}if (if_res992!==false) {var if_res993 = for_loop1768(fold_var1772,pos1770+inc1767);} else {var if_res993 = fold_var1772;}var if_res994 = if_res993;} else {var if_res994 = fold_var1769;}var if_res995 = if_res994;} else {var if_res995 = fold_var1769;}return if_res995;};return M8.alt_reverse(for_loop1768(M0.rnull,start1765));};var cl989 = function(start1775, end1776, step1777) {var start1778 = start1775;var end1779 = end1776;var inc1780 = step1777;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res996 = M0.rvoid();} else {var if_res996 = M9.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start1778,end1779,inc1780);}if_res996;var for_loop1781 = function(fold_var1782, pos1783) {if (M0.__gt__eq_(step1777,0)!==false) {var if_res997 = M0.__lt__eq_(pos1783,end1779);} else {var if_res997 = M0.__gt__eq_(pos1783,end1779);}if (if_res997!==false) {var i1784 = pos1783;if (true!==false) {var fold_var1786 = fold_var1782;var fold_var1787 = M0.cons(i1784,fold_var1786);var fold_var1785 = M0.values(fold_var1787);if (true!==false) {var if_res998 = M0.not(false);} else {var if_res998 = false;}if (if_res998!==false) {var if_res999 = for_loop1781(fold_var1785,pos1783+inc1780);} else {var if_res999 = fold_var1785;}var if_res1000 = if_res999;} else {var if_res1000 = fold_var1782;}var if_res1001 = if_res1000;} else {var if_res1001 = fold_var1782;}return if_res1001;};return M8.alt_reverse(for_loop1781(M0.rnull,start1778));};var inclusive_range1762 = $rjs_core.attachProcedureArity(function() {var fixed_lam990 = {'2':cl988,'3':cl989}[arguments.length];if (fixed_lam990!==undefined) {return fixed_lam990.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var inclusive_range_proc = inclusive_range1762;var cl1002 = function(f1788, l1789) {return M0.apply(M0.append,M3.map(f1788,l1789));};var cl1003 = function(f1790, l11791, l21792) {return M0.apply(M0.append,M3.map(f1790,l11791,l21792));};var cl1004 = $rjs_core.attachProcedureArity(function(f1793, l1794, ...ls17951007) {var ls1795 = $rjs_core.Pair.listFromArray(ls17951007);return M0.apply(M0.append,M0.apply(M3.map,f1793,l1794,ls1795));});var append_map = $rjs_core.attachProcedureArity(function() {var fixed_lam1005 = {'2':cl1002,'3':cl1003}[arguments.length];if (fixed_lam1005!==undefined) {return fixed_lam1005.apply(null,arguments);} else {if (M0.__gt__eq_(cl1004.length,1)!==false) {var if_res1006 = cl1004.apply(null,arguments);} else {var if_res1006 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1006;}},[M0.make_arity_at_least(2)]);var filter_not = function(f1796, list1797) {if (M0.procedure_p(f1796)!==false) {var if_res1008 = M0.procedure_arity_includes_p(f1796,1);} else {var if_res1008 = false;}if (if_res1008!==false) {var if_res1009 = M0.rvoid();} else {var if_res1009 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,f1796,list1797);}if_res1009;if (M0.list_p(list1797)!==false) {var if_res1010 = M0.rvoid();} else {var if_res1010 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("list?"),1,f1796,list1797);}if_res1010;var loop1798 = function(l1799, result1800) {if (M0.null_p(l1799)!==false) {var if_res1013 = M8.alt_reverse(result1800);} else {var temp1012 = M0.cdr(l1799);if (f1796(M0.car(l1799))!==false) {var if_res1011 = result1800;} else {var if_res1011 = M0.cons(M0.car(l1799),result1800);}var if_res1013 = loop1798(temp1012,if_res1011);}return if_res1013;};return loop1798(list1797,M0.rnull);};var shuffle = function(l1801) {if (M0.list_p(l1801)!==false) {var if_res1014 = M0.rvoid();} else {var if_res1014 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("shuffle"),$rjs_core.UString.make("list?"),0,l1801);}if_res1014;var let_result1015 = M0.values();var a1802 = M0.make_vector(M0.length(l1801));var lst1803 = l1801;var start1804 = 0;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1016 = M0.rvoid();} else {var if_res1016 = M9.__rjs_quoted__.check_list(lst1803);}if_res1016;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1017 = M0.rvoid();} else {var if_res1017 = M9.__rjs_quoted__.check_naturals(start1804);}if_res1017;var for_loop1805 = function(lst1806, pos1807) {if (M0.pair_p(lst1806)!==false) {var if_res1018 = true;} else {var if_res1018 = false;}if (if_res1018!==false) {var x1808 = M10.unsafe_car(lst1806);var rest1809 = M10.unsafe_cdr(lst1806);var i1810 = pos1807;if (true!==false) {var if_res1019 = true;} else {var if_res1019 = false;}if (if_res1019!==false) {var j1811 = M1.random(M0.add1(i1810));if (M0.__eq_(j1811,i1810)!==false) {var if_res1020 = M0.rvoid();} else {var if_res1020 = M0.vector_set_bang_(a1802,i1810,M0.vector_ref(a1802,j1811));}if_res1020;M0.vector_set_bang_(a1802,j1811,x1808);var let_result1021 = M0.values();var let_result1022 = M0.values();if (true!==false) {if (true!==false) {var if_res1023 = M0.not(false);} else {var if_res1023 = false;}var if_res1024 = if_res1023;} else {var if_res1024 = false;}if (if_res1024!==false) {var if_res1025 = for_loop1805(rest1809,pos1807+1);} else {var if_res1025 = M0.values();}var if_res1026 = if_res1025;} else {var if_res1026 = M0.values();}var if_res1027 = if_res1026;} else {var if_res1027 = M0.values();}return if_res1027;};for_loop1805(lst1803,start1804);M0.rvoid();return M0.vector__gt_list(a1802);};var combinations1812 = function(l371813, k361814) {var l1815 = l371813;if (false!==false) {var if_res1028 = false;} else {var if_res1028 = k361814;}var k1816 = if_res1028;var let_result1029 = M9.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),in_combinations(l1815,k1816));var pos__gt_vals1817 = let_result1029.getAt(0);var pos_pre_inc1818 = let_result1029.getAt(1);var pos_next1819 = let_result1029.getAt(2);var init1820 = let_result1029.getAt(3);var pos_cont_p1821 = let_result1029.getAt(4);var val_cont_p1822 = let_result1029.getAt(5);var all_cont_p1823 = let_result1029.getAt(6);M0.rvoid();var for_loop1824 = function(fold_var1825, pos1826) {if (pos_cont_p1821!==false) {var if_res1030 = pos_cont_p1821(pos1826);} else {var if_res1030 = true;}if (if_res1030!==false) {var x1830 = pos__gt_vals1817(pos1826);if (all_cont_p1823!==false) {var if_res1031 = function(pos1831) {return all_cont_p1823(pos1831,x1830);};} else {var if_res1031 = false;}var let_result1032 = M0.values(x1830,if_res1031);var x1827 = let_result1032.getAt(0);var all_cont_p_by_pos1828 = let_result1032.getAt(1);if (pos_pre_inc1818!==false) {var if_res1033 = pos_pre_inc1818(pos1826);} else {var if_res1033 = pos1826;}var pos1829 = if_res1033;if (val_cont_p1822!==false) {var if_res1034 = val_cont_p1822(x1827);} else {var if_res1034 = true;}if (if_res1034!==false) {var fold_var1833 = fold_var1825;var fold_var1834 = M0.cons(x1827,fold_var1833);var fold_var1832 = M0.values(fold_var1834);if (all_cont_p_by_pos1828!==false) {var if_res1035 = all_cont_p_by_pos1828(pos1829);} else {var if_res1035 = true;}if (if_res1035!==false) {var if_res1036 = M0.not(false);} else {var if_res1036 = false;}if (if_res1036!==false) {var if_res1037 = for_loop1824(fold_var1832,pos_next1819(pos1829));} else {var if_res1037 = fold_var1832;}var if_res1038 = if_res1037;} else {var if_res1038 = fold_var1825;}var if_res1039 = if_res1038;} else {var if_res1039 = fold_var1825;}return if_res1039;};return M8.alt_reverse(for_loop1824(M0.rnull,init1820));};var cl1040 = function(l1835) {return combinations1812(l1835,false);};var cl1041 = function(l1836, k361837) {return combinations1812(l1836,k361837);};var combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam1042 = {'1':cl1040,'2':cl1041}[arguments.length];if (fixed_lam1042!==undefined) {return fixed_lam1042.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var in_combinations1838 = function(l391839, k381840) {var l1841 = l391839;if (false!==false) {var if_res1043 = false;} else {var if_res1043 = k381840;}var k1842 = if_res1043;if (M0.list_p(l1841)!==false) {var if_res1044 = M0.rvoid();} else {var if_res1044 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("list?"),0,l1841);}if_res1044;var let_result1045 = M0.values();if (k1842!==false) {var if_res1046 = M0.not(M0.exact_nonnegative_integer_p(k1842));} else {var if_res1046 = false;}if (if_res1046!==false) {var if_res1047 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1841,k1842);} else {var if_res1047 = M0.rvoid();}if_res1047;var let_result1048 = M0.values();var v1843 = M0.list__gt_vector(l1841);var N1844 = M0.vector_length(v1843);var N_11845 = N1844-1;if (M0.not(k1842)!==false) {var limit1847 = M0.expt(2,N1844);var curr_box1848 = M0.box(0);var if_res1085 = function() {var curr1849 = M0.unbox(curr_box1848);if (M0.__lt_(curr1849,limit1847)!==false) {var start1850 = N_11845;var end1851 = -1;var inc1852 = -1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1050 = M0.rvoid();} else {var if_res1050 = M9.__rjs_quoted__.check_range(start1850,end1851,inc1852);}if_res1050;var for_loop1853 = function(acc1854, pos1855) {if (M0.__gt_(pos1855,end1851)!==false) {var i1856 = pos1855;if (true!==false) {var acc1858 = acc1854;if (M0.bitwise_bit_set_p(curr1849,i1856)!==false) {var if_res1051 = M0.cons(M0.vector_ref(v1843,i1856),acc1858);} else {var if_res1051 = acc1858;}var acc1859 = if_res1051;var acc1857 = M0.values(acc1859);if (true!==false) {var if_res1052 = M0.not(false);} else {var if_res1052 = false;}if (if_res1052!==false) {var if_res1053 = for_loop1853(acc1857,pos1855+inc1852);} else {var if_res1053 = acc1857;}var if_res1054 = if_res1053;} else {var if_res1054 = acc1854;}var if_res1055 = if_res1054;} else {var if_res1055 = acc1854;}return if_res1055;};var begin_res1049 = for_loop1853($rjs_core.Pair.makeList(),start1850);M0.set_box_bang_(curr_box1848,curr1849+1);var if_res1056 = begin_res1049;} else {var if_res1056 = false;}return if_res1056;};} else {if (M0.__lt_(N1844,k1842)!==false) {var if_res1084 = function() {return false;};} else {var running_p1860 = true;var k_times_1861 = M2.build_vector(k1842,function(i1862) {return i1862;});var k_11863 = k1842-1;var if_res1084 = function() {if (running_p1860!==false) {var vec1866 = k_times_1861;M9.__rjs_quoted__.check_vector(vec1866);var let_result1058 = M0.values(vec1866,M10.unsafe_vector_length(vec1866));var vec1864 = let_result1058.getAt(0);var len1865 = let_result1058.getAt(1);false;var for_loop1867 = function(fold_var1868, pos1869) {if (M10.unsafe_fx_lt_(pos1869,len1865)!==false) {var i1870 = M10.unsafe_vector_ref(vec1864,pos1869);if (true!==false) {var fold_var1872 = fold_var1868;var fold_var1873 = M0.cons(M0.vector_ref(v1843,i1870),fold_var1872);var fold_var1871 = M0.values(fold_var1873);if (true!==false) {var if_res1059 = M0.not(false);} else {var if_res1059 = false;}if (if_res1059!==false) {var if_res1060 = for_loop1867(fold_var1871,M10.unsafe_fx_plus_(1,pos1869));} else {var if_res1060 = fold_var1871;}var if_res1061 = if_res1060;} else {var if_res1061 = fold_var1868;}var if_res1062 = if_res1061;} else {var if_res1062 = fold_var1868;}return if_res1062;};var begin_res1057 = M8.alt_reverse(for_loop1867(M0.rnull,0));var index_to_change1874 = false;var start1875 = k_11863;var end1876 = -1;var inc1877 = -1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1063 = M0.rvoid();} else {var if_res1063 = M9.__rjs_quoted__.check_range(start1875,end1876,inc1877);}if_res1063;var for_loop1878 = function(pos1879) {if (M0.__gt_(pos1879,end1876)!==false) {var i1880 = pos1879;if (true!==false) {var next_k_proc1881 = function() {if (true!==false) {var if_res1064 = for_loop1878(pos1879+inc1877);} else {var if_res1064 = M0.values();}return if_res1064;};if (M0.not(M0.eq_p(M0.vector_ref(k_times_1861,i1880),i1880+N1844+M0.__(k1842)))!==false) {index_to_change1874 = i1880;var if_res1065 = true;} else {var if_res1065 = false;}if (if_res1065!==false) {var if_res1068 = M0.values();} else {M0.rvoid();var let_result1066 = M0.values();if (false!==false) {var if_res1067 = M0.values();} else {var if_res1067 = next_k_proc1881();}var if_res1068 = if_res1067;}var if_res1069 = if_res1068;} else {var if_res1069 = M0.values();}var if_res1070 = if_res1069;} else {var if_res1070 = M0.values();}return if_res1070;};for_loop1878(start1875);M0.rvoid();if (index_to_change1874!==false) {var val_to_change1882 = M0.add1(M0.vector_ref(k_times_1861,index_to_change1874));var start1883 = index_to_change1874;var end1884 = k1842;var inc1885 = 1;var start1886 = val_to_change1882;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1071 = M0.rvoid();} else {var if_res1071 = M9.__rjs_quoted__.check_range(start1883,end1884,inc1885);}if_res1071;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1072 = M0.rvoid();} else {var if_res1072 = M9.__rjs_quoted__.check_naturals(start1886);}if_res1072;var for_loop1887 = function(pos1888, pos1889) {if (M0.__lt_(pos1888,end1884)!==false) {var if_res1073 = true;} else {var if_res1073 = false;}if (if_res1073!==false) {var i1890 = pos1888;var v1891 = pos1889;if (true!==false) {var if_res1074 = true;} else {var if_res1074 = false;}if (if_res1074!==false) {M0.vector_set_bang_(k_times_1861,i1890,v1891);var let_result1075 = M0.values();var let_result1076 = M0.values();if (true!==false) {if (true!==false) {var if_res1077 = M0.not(false);} else {var if_res1077 = false;}var if_res1078 = if_res1077;} else {var if_res1078 = false;}if (if_res1078!==false) {var if_res1079 = for_loop1887(pos1888+inc1885,pos1889+1);} else {var if_res1079 = M0.values();}var if_res1080 = if_res1079;} else {var if_res1080 = M0.values();}var if_res1081 = if_res1080;} else {var if_res1081 = M0.values();}return if_res1081;};for_loop1887(start1883,start1886);var if_res1082 = M0.rvoid();} else {running_p1860 = false;var if_res1082 = null;}if_res1082;var if_res1083 = begin_res1057;} else {var if_res1083 = false;}return if_res1083;};}var if_res1085 = if_res1084;}var gen_combinations1846 = if_res1085;return M9.__rjs_quoted__.in_producer(gen_combinations1846,false);};var cl1086 = function(l1892) {return in_combinations1838(l1892,false);};var cl1087 = function(l1893, k381894) {return in_combinations1838(l1893,k381894);};var in_combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam1088 = {'1':cl1086,'2':cl1087}[arguments.length];if (fixed_lam1088!==undefined) {return fixed_lam1088.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var swap_plus_flip = function(l1895, i1896, j1897) {var tmp1898 = j1897;if (M0.equal_p(tmp1898,0)!==false) {var if_res1096 = M0.list_times_(M0.cadr(l1895),M0.car(l1895),M0.cddr(l1895));} else {if (M0.equal_p(tmp1898,1)!==false) {var a1899 = M0.car(l1895);var b1900 = M0.cadr(l1895);var c1901 = M0.caddr(l1895);var l1902 = M0.cdddr(l1895);var tmp1903 = i1896;if (M0.equal_p(tmp1903,0)!==false) {var if_res1089 = M0.list_times_(b1900,c1901,a1899,l1902);} else {var if_res1089 = M0.list_times_(c1901,a1899,b1900,l1902);}var if_res1095 = if_res1089;} else {if (M0.equal_p(tmp1898,2)!==false) {var a1904 = M0.car(l1895);var b1905 = M0.cadr(l1895);var c1906 = M0.caddr(l1895);var d1907 = M0.cadddr(l1895);var l1908 = M0.cddddr(l1895);var tmp1909 = i1896;if (M0.equal_p(tmp1909,0)!==false) {var if_res1091 = M0.list_times_(c1906,b1905,d1907,a1904,l1908);} else {if (M0.equal_p(tmp1909,1)!==false) {var if_res1090 = M0.list_times_(c1906,d1907,a1904,b1905,l1908);} else {var if_res1090 = M0.list_times_(d1907,b1905,a1904,c1906,l1908);}var if_res1091 = if_res1090;}var if_res1094 = if_res1091;} else {var loop1910 = function(n1911, l11912, r11913) {if (M0.__gt_(n1911,0)!==false) {var if_res1093 = loop1910(M0.sub1(n1911),M0.cons(M0.car(r11913),l11912),M0.cdr(r11913));} else {var loop1914 = function(n1915, l21916, r21917) {if (M0.__gt_(n1915,0)!==false) {var if_res1092 = loop1914(M0.sub1(n1915),M0.cons(M0.car(r21917),l21916),M0.cdr(r21917));} else {var if_res1092 = M5.__rjs_quoted__.qq_append(l21916,M0.list_times_(M0.car(r21917),M5.__rjs_quoted__.qq_append(l11912,M0.list_times_(M0.car(r11913),M0.cdr(r21917)))));}return if_res1092;};var if_res1093 = loop1914(j1897-i1896,$rjs_core.Pair.makeList(),M0.cdr(r11913));}return if_res1093;};var if_res1094 = loop1910(i1896,$rjs_core.Pair.makeList(),l1895);}var if_res1095 = if_res1094;}var if_res1096 = if_res1095;}return if_res1096;};var permutations = function(l1918) {if (M0.not(M0.list_p(l1918))!==false) {var if_res1103 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("list?"),0,l1918);} else {var or_part1919 = M0.null_p(l1918);if (or_part1919!==false) {var if_res1097 = or_part1919;} else {var if_res1097 = M0.null_p(M0.cdr(l1918));}if (if_res1097!==false) {var if_res1102 = M0.list(l1918);} else {var N1920 = M0.length(l1918)-2;if (M0.__gt_(N1920,254)!==false) {var if_res1098 = M0.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l1918);} else {var if_res1098 = M0.rvoid();}if_res1098;var let_result1099 = M0.values();var c1921 = M0.make_bytes(M0.add1(N1920),0);var loop1922 = function(i1923, acc1924) {var ci1925 = M0.bytes_ref(c1921,i1923);if (M0.__lt__eq_(ci1925,i1923)!==false) {M0.bytes_set_bang_(c1921,i1923,M0.add1(ci1925));var if_res1101 = loop1922(0,M0.cons(swap_plus_flip(M0.car(acc1924),ci1925,i1923),acc1924));} else {if (M0.__lt_(i1923,N1920)!==false) {M0.bytes_set_bang_(c1921,i1923,0);var if_res1100 = loop1922(M0.add1(i1923),acc1924);} else {var if_res1100 = acc1924;}var if_res1101 = if_res1100;}return if_res1101;};var if_res1102 = loop1922(0,M0.list(M8.alt_reverse(l1918)));}var if_res1103 = if_res1102;}return if_res1103;};var in_permutations = function(l1926) {if (M0.not(M0.list_p(l1926))!==false) {var if_res1112 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-permutations"),$rjs_core.UString.make("list?"),0,l1926);} else {var or_part1927 = M0.null_p(l1926);if (or_part1927!==false) {var if_res1104 = or_part1927;} else {var if_res1104 = M0.null_p(M0.cdr(l1926));}if (if_res1104!==false) {var if_res1111 = M9.__rjs_quoted__.in_value(l1926);} else {var N1928 = M0.length(l1926)-2;if (M0.__gt_(N1928,254)!==false) {var if_res1105 = M0.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l1926);} else {var if_res1105 = M0.rvoid();}if_res1105;var let_result1106 = M0.values();var c1929 = M0.make_bytes(M0.add1(N1928),0);var i1930 = 0;var cur1931 = M8.alt_reverse(l1926);var next1932 = function() {var r1933 = cur1931;var ci1934 = M0.bytes_ref(c1929,i1930);if (M0.__lt__eq_(ci1934,i1930)!==false) {M0.bytes_set_bang_(c1929,i1930,M0.add1(ci1934));var begin_res1107 = swap_plus_flip(cur1931,ci1934,i1930);i1930 = 0;var if_res1109 = begin_res1107;} else {if (M0.__lt_(i1930,N1928)!==false) {M0.bytes_set_bang_(c1929,i1930,0);i1930 = M0.add1(i1930);var if_res1108 = next1932();} else {var if_res1108 = false;}var if_res1109 = if_res1108;}return if_res1109;};var if_res1111 = M9.__rjs_quoted__.in_producer(function() {var begin_res1110 = cur1931;cur1931 = next1932();return begin_res1110;},false);}var if_res1112 = if_res1111;}return if_res1112;};var mk_min = function(cmp1935, name1936, f1937, xs1938) {if (M0.procedure_p(f1937)!==false) {var if_res1113 = M0.procedure_arity_includes_p(f1937,1);} else {var if_res1113 = false;}if (if_res1113!==false) {var if_res1114 = M0.rvoid();} else {var if_res1114 = M0.raise_argument_error(name1936,$rjs_core.UString.make("(any/c . -> . real?)"),0,f1937,xs1938);}if_res1114;if (M0.list_p(xs1938)!==false) {var if_res1115 = M0.pair_p(xs1938);} else {var if_res1115 = false;}if (if_res1115!==false) {var if_res1116 = M0.rvoid();} else {var if_res1116 = M0.raise_argument_error(name1936,$rjs_core.UString.make("(and/c list? (not/c empty?))"),1,f1937,xs1938);}if_res1116;var init_min_var1939 = f1937(M0.car(xs1938));if (M0.real_p(init_min_var1939)!==false) {var if_res1117 = M0.rvoid();} else {var if_res1117 = M0.raise_result_error(name1936,$rjs_core.UString.make("real?"),init_min_var1939);}if_res1117;var loop1940 = function(min1941, min_var1942, xs1943) {if (M0.null_p(xs1943)!==false) {var if_res1120 = min1941;} else {var new_min1944 = f1937(M0.car(xs1943));if (M0.real_p(new_min1944)!==false) {var if_res1118 = M0.rvoid();} else {var if_res1118 = M0.raise_result_error(name1936,$rjs_core.UString.make("real?"),new_min1944);}if_res1118;if (cmp1935(new_min1944,min_var1942)!==false) {var if_res1119 = loop1940(M0.car(xs1943),new_min1944,M0.cdr(xs1943));} else {var if_res1119 = loop1940(min1941,min_var1942,M0.cdr(xs1943));}var if_res1120 = if_res1119;}return if_res1120;};return loop1940(M0.car(xs1938),init_min_var1939,M0.cdr(xs1938));};var argmin = function(f1945, xs1946) {return mk_min(M0.__lt_,$rjs_core.PrimitiveSymbol.make("argmin"),f1945,xs1946);};var argmax = function(f1947, xs1948) {return mk_min(M0.__gt_,$rjs_core.PrimitiveSymbol.make("argmax"),f1947,xs1948);};var group_by1949 = function(key411950, l421951, __eq__p401952) {var key1953 = key411950;var l1954 = l421951;if (M0.eq_p(__eq__p401952,M10.unsafe_undefined)!==false) {var if_res1121 = M0.equal_p;} else {var if_res1121 = __eq__p401952;}var __eq__p1955 = if_res1121;if (M0.procedure_p(key1953)!==false) {var if_res1122 = M0.procedure_arity_includes_p(key1953,1);} else {var if_res1122 = false;}if (if_res1122!==false) {var if_res1123 = M0.rvoid();} else {var if_res1123 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(-> any/c any/c)"),0,key1953,l1954);}if_res1123;var let_result1124 = M0.values();if (M0.procedure_p(__eq__p1955)!==false) {var if_res1125 = M0.procedure_arity_includes_p(__eq__p1955,2);} else {var if_res1125 = false;}if (if_res1125!==false) {var if_res1126 = M0.rvoid();} else {var if_res1126 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,key1953,l1954,__eq__p1955);}if_res1126;var let_result1127 = M0.values();if (M0.list_p(l1954)!==false) {var if_res1128 = M0.rvoid();} else {var if_res1128 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("list?"),1,key1953,l1954);}if_res1128;var let_result1129 = M0.values();var alist_update1956 = function(al1957, k1958, up1959, fail1960) {var loop1961 = function(al1962) {if (M0.null_p(al1962)!==false) {var if_res1131 = M0.list(M0.cons(k1958,up1959($rjs_core.Pair.makeList())));} else {if (__eq__p1955(M0.car(M0.car(al1962)),k1958)!==false) {var if_res1130 = M0.cons(M0.cons(k1958,up1959(M0.cdr(M0.car(al1962)))),M0.cdr(al1962));} else {var if_res1130 = M0.cons(M0.car(al1962),loop1961(M0.cdr(al1962)));}var if_res1131 = if_res1130;}return if_res1131;};return loop1961(al1957);};if (M0.equal_p(__eq__p1955,M0.eq_p)!==false) {var if_res1134 = M0.values(M0.hasheq(),M7.hash_update);} else {if (M0.equal_p(__eq__p1955,M0.eqv_p)!==false) {var if_res1133 = M0.values(M0.hasheqv(),M7.hash_update);} else {if (M0.equal_p(__eq__p1955,M0.equal_p)!==false) {var if_res1132 = M0.values(M0.hash(),M7.hash_update);} else {var if_res1132 = M0.values($rjs_core.Pair.makeList(),alist_update1956);}var if_res1133 = if_res1132;}var if_res1134 = if_res1133;}var let_result1135 = if_res1134;var base1963 = let_result1135.getAt(0);var update1964 = let_result1135.getAt(1);var lst1966 = l1954;var start1967 = 0;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1136 = M0.rvoid();} else {var if_res1136 = M9.__rjs_quoted__.check_list(lst1966);}if_res1136;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1137 = M0.rvoid();} else {var if_res1137 = M9.__rjs_quoted__.check_naturals(start1967);}if_res1137;var for_loop1968 = function(res1969, lst1970, pos1971) {if (M0.pair_p(lst1970)!==false) {var if_res1138 = true;} else {var if_res1138 = false;}if (if_res1138!==false) {var elt1972 = M10.unsafe_car(lst1970);var rest1973 = M10.unsafe_cdr(lst1970);var idx1974 = pos1971;if (true!==false) {var if_res1139 = true;} else {var if_res1139 = false;}if (if_res1139!==false) {var res1976 = res1969;var k1978 = key1953(elt1972);var v1979 = M0.cons(idx1974,elt1972);var res1977 = update1964(res1976,k1978,function(o1980) {return M0.cons(v1979,o1980);},$rjs_core.Pair.makeList());var res1975 = M0.values(res1977);if (true!==false) {if (true!==false) {var if_res1140 = M0.not(false);} else {var if_res1140 = false;}var if_res1141 = if_res1140;} else {var if_res1141 = false;}if (if_res1141!==false) {var if_res1142 = for_loop1968(res1975,rest1973,pos1971+1);} else {var if_res1142 = res1975;}var if_res1143 = if_res1142;} else {var if_res1143 = res1969;}var if_res1144 = if_res1143;} else {var if_res1144 = res1969;}return if_res1144;};var classes1965 = for_loop1968(base1963,lst1966,start1967);if (M0.list_p(classes1965)!==false) {var lst1982 = classes1965;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1145 = M0.rvoid();} else {var if_res1145 = M9.__rjs_quoted__.check_list(lst1982);}if_res1145;var for_loop1983 = function(fold_var1984, lst1985) {if (M0.pair_p(lst1985)!==false) {var p1986 = M10.unsafe_car(lst1985);var rest1987 = M10.unsafe_cdr(lst1985);if (true!==false) {var fold_var1989 = fold_var1984;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__338851991 = M2.__rjs_quoted__.sort7;var temp531992 = M0.cdr(p1986);var __lt_541993 = M0.__lt_;var car551994 = M0.car;if (M0.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1146 = M2.__rjs_quoted__.sort(false,car551994,temp531992,__lt_541993);} else {var if_res1146 = M0.checked_procedure_check_and_extract(M4.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__338851991,M4.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M0.list(car551994),temp531992,__lt_541993);}var fold_var1990 = M0.cons(if_res1146,fold_var1989);var fold_var1988 = M0.values(fold_var1990);if (true!==false) {var if_res1147 = M0.not(false);} else {var if_res1147 = false;}if (if_res1147!==false) {var if_res1148 = for_loop1983(fold_var1988,rest1987);} else {var if_res1148 = fold_var1988;}var if_res1149 = if_res1148;} else {var if_res1149 = fold_var1984;}var if_res1150 = if_res1149;} else {var if_res1150 = fold_var1984;}return if_res1150;};var if_res1158 = M8.alt_reverse(for_loop1983(M0.rnull,lst1982));} else {var ht1995 = classes1965;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1151 = M0.rvoid();} else {var if_res1151 = M9.__rjs_quoted__.check_in_hash(ht1995);}if_res1151;var for_loop1996 = function(fold_var1997, i1998) {if (i1998!==false) {var let_result1152 = M0.hash_iterate_key_plus_value(ht1995,i1998);var _1999 = let_result1152.getAt(0);var c2000 = let_result1152.getAt(1);if (true!==false) {var fold_var2002 = fold_var1997;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__339692004 = M2.__rjs_quoted__.sort7;var c562005 = c2000;var __lt_572006 = M0.__lt_;var car582007 = M0.car;if (M0.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1153 = M2.__rjs_quoted__.sort(false,car582007,c562005,__lt_572006);} else {var if_res1153 = M0.checked_procedure_check_and_extract(M4.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__339692004,M4.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M0.list(car582007),c562005,__lt_572006);}var fold_var2003 = M0.cons(if_res1153,fold_var2002);var fold_var2001 = M0.values(fold_var2003);if (true!==false) {var if_res1154 = M0.not(false);} else {var if_res1154 = false;}if (if_res1154!==false) {var if_res1155 = for_loop1996(fold_var2001,M0.hash_iterate_next(ht1995,i1998));} else {var if_res1155 = fold_var2001;}var if_res1156 = if_res1155;} else {var if_res1156 = fold_var1997;}var if_res1157 = if_res1156;} else {var if_res1157 = fold_var1997;}return if_res1157;};var if_res1158 = M8.alt_reverse(for_loop1996(M0.rnull,M0.hash_iterate_first(ht1995)));}var sorted_classes1981 = if_res1158;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__340862009 = M2.__rjs_quoted__.sort7;var sorted_classes592010 = sorted_classes1981;var __lt_602011 = M0.__lt_;var caar612012 = M0.caar;if (M0.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1159 = M2.__rjs_quoted__.sort(false,caar612012,sorted_classes592010,__lt_602011);} else {var if_res1159 = M0.checked_procedure_check_and_extract(M4.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__340862009,M4.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M0.list(caar612012),sorted_classes592010,__lt_602011);}var lst2008 = if_res1159;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1160 = M0.rvoid();} else {var if_res1160 = M9.__rjs_quoted__.check_list(lst2008);}if_res1160;var for_loop2013 = function(fold_var2014, lst2015) {if (M0.pair_p(lst2015)!==false) {var c2016 = M10.unsafe_car(lst2015);var rest2017 = M10.unsafe_cdr(lst2015);if (true!==false) {var fold_var2019 = fold_var2014;var fold_var2020 = M0.cons(M3.map(M0.cdr,c2016),fold_var2019);var fold_var2018 = M0.values(fold_var2020);if (true!==false) {var if_res1161 = M0.not(false);} else {var if_res1161 = false;}if (if_res1161!==false) {var if_res1162 = for_loop2013(fold_var2018,rest2017);} else {var if_res1162 = fold_var2018;}var if_res1163 = if_res1162;} else {var if_res1163 = fold_var2014;}var if_res1164 = if_res1163;} else {var if_res1164 = fold_var2014;}return if_res1164;};return M8.alt_reverse(for_loop2013(M0.rnull,lst2008));};var cl1165 = function(key2021, l2022) {return group_by1949(key2021,l2022,M10.unsafe_undefined);};var cl1166 = function(key2023, l2024, __eq__p402025) {return group_by1949(key2023,l2024,__eq__p402025);};var group_by = $rjs_core.attachProcedureArity(function() {var fixed_lam1167 = {'2':cl1165,'3':cl1166}[arguments.length];if (fixed_lam1167!==undefined) {return fixed_lam1167.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cartesian_product = $rjs_core.attachProcedureArity(function(...ls20261168) {var ls2026 = $rjs_core.Pair.listFromArray(ls20261168);var let_result1169 = M9.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("l")),ls2026);var pos__gt_vals2027 = let_result1169.getAt(0);var pos_pre_inc2028 = let_result1169.getAt(1);var pos_next2029 = let_result1169.getAt(2);var init2030 = let_result1169.getAt(3);var pos_cont_p2031 = let_result1169.getAt(4);var val_cont_p2032 = let_result1169.getAt(5);var all_cont_p2033 = let_result1169.getAt(6);var start2034 = 0;if (M0.rvoid()!==false) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1170 = M0.rvoid();} else {var if_res1170 = M9.__rjs_quoted__.check_naturals(start2034);}var if_res1171 = if_res1170;} else {var if_res1171 = false;}if_res1171;var for_loop2035 = function(pos2036, pos2037) {if (pos_cont_p2031!==false) {var if_res1172 = pos_cont_p2031(pos2036);} else {var if_res1172 = true;}if (if_res1172!==false) {var if_res1173 = true;} else {var if_res1173 = false;}if (if_res1173!==false) {var l2042 = pos__gt_vals2027(pos2036);if (all_cont_p2033!==false) {var if_res1174 = function(pos2043) {return all_cont_p2033(pos2043,l2042);};} else {var if_res1174 = false;}var let_result1175 = M0.values(l2042,if_res1174);var l2038 = let_result1175.getAt(0);var all_cont_p_by_pos2039 = let_result1175.getAt(1);if (pos_pre_inc2028!==false) {var if_res1176 = pos_pre_inc2028(pos2036);} else {var if_res1176 = pos2036;}var pos2040 = if_res1176;var i2041 = pos2037;if (val_cont_p2032!==false) {var if_res1177 = val_cont_p2032(l2038);} else {var if_res1177 = true;}if (if_res1177!==false) {var if_res1178 = true;} else {var if_res1178 = false;}if (if_res1178!==false) {if (M0.list_p(l2038)!==false) {var if_res1179 = M0.rvoid();} else {var if_res1179 = M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("cartesian-product"),$rjs_core.UString.make("list?"),i2041,ls2026);}if_res1179;var let_result1180 = M0.values();var let_result1181 = M0.values();if (all_cont_p_by_pos2039!==false) {var if_res1182 = all_cont_p_by_pos2039(pos2040);} else {var if_res1182 = true;}if (if_res1182!==false) {var if_res1183 = true;} else {var if_res1183 = false;}if (if_res1183!==false) {var if_res1184 = M0.not(false);} else {var if_res1184 = false;}if (if_res1184!==false) {var if_res1185 = for_loop2035(pos_next2029(pos2040),pos2037+1);} else {var if_res1185 = M0.values();}var if_res1186 = if_res1185;} else {var if_res1186 = M0.values();}var if_res1187 = if_res1186;} else {var if_res1187 = M0.values();}return if_res1187;};for_loop2035(init2030,start2034);var let_result1188 = M0.values();M0.rvoid();var let_result1189 = M0.values();var cp_22044 = function(as2045, bs2046) {var lst2047 = as2045;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1190 = M0.rvoid();} else {var if_res1190 = M9.__rjs_quoted__.check_list(lst2047);}if_res1190;var for_loop2048 = function(fold_var2049, lst2050) {if (M0.pair_p(lst2050)!==false) {var i2051 = M10.unsafe_car(lst2050);var rest2052 = M10.unsafe_cdr(lst2050);if (true!==false) {var lst2054 = bs2046;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1191 = M0.rvoid();} else {var if_res1191 = M9.__rjs_quoted__.check_list(lst2054);}if_res1191;var for_loop2055 = function(fold_var2056, lst2057) {if (M0.pair_p(lst2057)!==false) {var j2058 = M10.unsafe_car(lst2057);var rest2059 = M10.unsafe_cdr(lst2057);if (true!==false) {var fold_var2061 = fold_var2056;var fold_var2062 = M0.cons(M0.cons(i2051,j2058),fold_var2061);var fold_var2060 = M0.values(fold_var2062);if (true!==false) {var if_res1192 = M0.not(false);} else {var if_res1192 = false;}if (if_res1192!==false) {var if_res1193 = for_loop2055(fold_var2060,rest2059);} else {var if_res1193 = fold_var2060;}var if_res1194 = if_res1193;} else {var if_res1194 = fold_var2056;}var if_res1195 = if_res1194;} else {var if_res1195 = fold_var2056;}return if_res1195;};var fold_var2053 = for_loop2055(fold_var2049,lst2054);if (true!==false) {var if_res1196 = M0.not(false);} else {var if_res1196 = false;}if (if_res1196!==false) {var if_res1197 = for_loop2048(fold_var2053,rest2052);} else {var if_res1197 = fold_var2053;}var if_res1198 = if_res1197;} else {var if_res1198 = fold_var2049;}var if_res1199 = if_res1198;} else {var if_res1199 = fold_var2049;}return if_res1199;};return M8.alt_reverse(for_loop2048(M0.rnull,lst2047));};return M2.foldr(cp_22044,M0.list(M0.list()),ls2026);});var remf = function(f2063, ls2064) {if (M0.list_p(ls2064)!==false) {var if_res1200 = M0.rvoid();} else {var if_res1200 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("list?"),1,f2063,ls2064);}if_res1200;if (M0.procedure_p(f2063)!==false) {var if_res1201 = M0.procedure_arity_includes_p(f2063,1);} else {var if_res1201 = false;}if (if_res1201!==false) {var if_res1202 = M0.rvoid();} else {var if_res1202 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("(-> any/c any/c)"),0,f2063,ls2064);}if_res1202;if (M0.null_p(ls2064)!==false) {var if_res1204 = $rjs_core.Pair.makeList();} else {if (f2063(M0.car(ls2064))!==false) {var if_res1203 = M0.cdr(ls2064);} else {var if_res1203 = M0.cons(M0.car(ls2064),remf(f2063,M0.cdr(ls2064)));}var if_res1204 = if_res1203;}return if_res1204;};var remf_times_ = function(f2065, ls2066) {if (M0.list_p(ls2066)!==false) {var if_res1205 = M0.rvoid();} else {var if_res1205 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("list?"),1,f2065,ls2066);}if_res1205;if (M0.procedure_p(f2065)!==false) {var if_res1206 = M0.procedure_arity_includes_p(f2065,1);} else {var if_res1206 = false;}if (if_res1206!==false) {var if_res1207 = M0.rvoid();} else {var if_res1207 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("(-> any/c any/c)"),0,f2065,ls2066);}if_res1207;if (M0.null_p(ls2066)!==false) {var if_res1209 = $rjs_core.Pair.makeList();} else {if (f2065(M0.car(ls2066))!==false) {var if_res1208 = remf_times_(f2065,M0.cdr(ls2066));} else {var if_res1208 = M0.cons(M0.car(ls2066),remf_times_(f2065,M0.cdr(ls2066)));}var if_res1209 = if_res1208;}return if_res1209;};var index_of2067 = function(ls442068, v452069, __eq__p432070) {var ls2071 = ls442068;var v2072 = v452069;if (M0.eq_p(__eq__p432070,M10.unsafe_undefined)!==false) {var if_res1210 = M0.equal_p;} else {var if_res1210 = __eq__p432070;}var __eq__p2073 = if_res1210;if (M0.list_p(ls2071)!==false) {var if_res1211 = M0.rvoid();} else {var if_res1211 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("list?"),0,ls2071,v2072);}if_res1211;if (M0.procedure_p(__eq__p2073)!==false) {var if_res1212 = M0.procedure_arity_includes_p(__eq__p2073,2);} else {var if_res1212 = false;}if (if_res1212!==false) {var if_res1213 = M0.rvoid();} else {var if_res1213 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls2071,v2072,__eq__p2073);}if_res1213;var loop2074 = function(ls2075, i2076) {if (M0.null_p(ls2075)!==false) {var if_res1215 = false;} else {if (__eq__p2073(M0.car(ls2075),v2072)!==false) {var if_res1214 = i2076;} else {var if_res1214 = loop2074(M0.cdr(ls2075),M0.add1(i2076));}var if_res1215 = if_res1214;}return if_res1215;};return loop2074(ls2071,0);};var cl1216 = function(ls2077, v2078) {return index_of2067(ls2077,v2078,M10.unsafe_undefined);};var cl1217 = function(ls2079, v2080, __eq__p432081) {return index_of2067(ls2079,v2080,__eq__p432081);};var index_of = $rjs_core.attachProcedureArity(function() {var fixed_lam1218 = {'2':cl1216,'3':cl1217}[arguments.length];if (fixed_lam1218!==undefined) {return fixed_lam1218.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var index_where = function(ls2082, f2083) {if (M0.list_p(ls2082)!==false) {var if_res1219 = M0.rvoid();} else {var if_res1219 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("list?"),0,ls2082,f2083);}if_res1219;if (M0.procedure_p(f2083)!==false) {var if_res1220 = M0.procedure_arity_includes_p(f2083,1);} else {var if_res1220 = false;}if (if_res1220!==false) {var if_res1221 = M0.rvoid();} else {var if_res1221 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls2082,f2083);}if_res1221;var loop2084 = function(ls2085, i2086) {if (M0.null_p(ls2085)!==false) {var if_res1223 = false;} else {if (f2083(M0.car(ls2085))!==false) {var if_res1222 = i2086;} else {var if_res1222 = loop2084(M0.cdr(ls2085),M0.add1(i2086));}var if_res1223 = if_res1222;}return if_res1223;};return loop2084(ls2082,0);};var indexes_of2087 = function(ls472088, v482089, __eq__p462090) {var ls2091 = ls472088;var v2092 = v482089;if (M0.eq_p(__eq__p462090,M10.unsafe_undefined)!==false) {var if_res1224 = M0.equal_p;} else {var if_res1224 = __eq__p462090;}var __eq__p2093 = if_res1224;if (M0.list_p(ls2091)!==false) {var if_res1225 = M0.rvoid();} else {var if_res1225 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("list?"),0,ls2091,v2092);}if_res1225;if (M0.procedure_p(__eq__p2093)!==false) {var if_res1226 = M0.procedure_arity_includes_p(__eq__p2093,2);} else {var if_res1226 = false;}if (if_res1226!==false) {var if_res1227 = M0.rvoid();} else {var if_res1227 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls2091,v2092,__eq__p2093);}if_res1227;var loop2094 = function(ls2095, i2096) {if (M0.null_p(ls2095)!==false) {var if_res1229 = $rjs_core.Pair.makeList();} else {if (__eq__p2093(M0.car(ls2095),v2092)!==false) {var if_res1228 = M0.cons(i2096,loop2094(M0.cdr(ls2095),M0.add1(i2096)));} else {var if_res1228 = loop2094(M0.cdr(ls2095),M0.add1(i2096));}var if_res1229 = if_res1228;}return if_res1229;};return loop2094(ls2091,0);};var cl1230 = function(ls2097, v2098) {return indexes_of2087(ls2097,v2098,M10.unsafe_undefined);};var cl1231 = function(ls2099, v2100, __eq__p462101) {return indexes_of2087(ls2099,v2100,__eq__p462101);};var indexes_of = $rjs_core.attachProcedureArity(function() {var fixed_lam1232 = {'2':cl1230,'3':cl1231}[arguments.length];if (fixed_lam1232!==undefined) {return fixed_lam1232.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var indexes_where = function(ls2102, f2103) {if (M0.list_p(ls2102)!==false) {var if_res1233 = M0.rvoid();} else {var if_res1233 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("list?"),0,ls2102,f2103);}if_res1233;if (M0.procedure_p(f2103)!==false) {var if_res1234 = M0.procedure_arity_includes_p(f2103,1);} else {var if_res1234 = false;}if (if_res1234!==false) {var if_res1235 = M0.rvoid();} else {var if_res1235 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls2102,f2103);}if_res1235;var loop2104 = function(ls2105, i2106) {if (M0.null_p(ls2105)!==false) {var if_res1237 = $rjs_core.Pair.makeList();} else {if (f2103(M0.car(ls2105))!==false) {var if_res1236 = M0.cons(i2106,loop2104(M0.cdr(ls2105),M0.add1(i2106)));} else {var if_res1236 = loop2104(M0.cdr(ls2105),M0.add1(i2106));}var if_res1237 = if_res1236;}return if_res1237;};return loop2104(ls2102,0);};var __rjs_quoted__ = {};__rjs_quoted__.remove_duplicates28 = remove_duplicates28;__rjs_quoted__.add_between = add_between;__rjs_quoted__.check_duplicates = check_duplicates;__rjs_quoted__.range_proc = range_proc;__rjs_quoted__.remove_duplicates = remove_duplicates;__rjs_quoted__.inclusive_range_proc = inclusive_range_proc;__rjs_quoted__.add_between23 = add_between23;__rjs_quoted__.check_duplicates35 = check_duplicates35;export { __rjs_quoted__,remf_times_,remf,cartesian_product,group_by,argmax,argmin,in_permutations,permutations,in_combinations,combinations,shuffle,filter_not,append_map,partition,count,filter_map,check_duplicates,remove_duplicates,add_between,flatten,append_times_,drop_common_prefix,take_common_prefix,split_common_prefix,list_prefix_p,splitf_at_right,dropf_right,takef_right,split_at_right,take_right,drop_right,splitf_at,dropf,takef,split_at,take,drop,indexes_where,indexes_of,index_where,index_of,list_set,list_update,make_list,empty,rest,last,last_pair,tenth,ninth,eighth,seventh,sixth,fifth,fourth,third,second,first };