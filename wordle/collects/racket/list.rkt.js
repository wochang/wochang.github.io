import * as $rjs_core from '../../runtime/core.js';import * as M0 from "../../runtime/kernel.rkt.js";import * as M1 from "./private/pre-base.rkt.js";import * as M2 from "./private/list.rkt.js";import * as M3 from "./private/map.rkt.js";import * as M4 from "./private/kw.rkt.js";import * as M5 from "./private/qq-and-or.rkt.js";import * as M6 from "./private/member.rkt.js";import * as M7 from "./private/more-scheme.rkt.js";import * as M8 from "./private/reverse.rkt.js";import * as M9 from "./private/for.rkt.js";import * as M10 from "../../runtime/unsafe.rkt.js";var first = function(x1266) {if (M0.pair_p(x1266)!==false) {var if_res670 = M0.list_p(x1266);} else {var if_res670 = false;}if (if_res670!==false) {var if_res671 = M0.car(x1266);} else {var if_res671 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("first"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),x1266);}return if_res671;};var second = function(l01267) {if (M0.list_p(l01267)!==false) {var loop1268 = function(l1269, pos1270) {if (M0.pair_p(l1269)!==false) {if (M0.eq_p(pos1270,1)!==false) {var if_res672 = M0.car(l1269);} else {var if_res672 = loop1268(M0.cdr(l1269),M0.sub1(pos1270));}var if_res673 = if_res672;} else {var if_res673 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01267);}return if_res673;};var if_res674 = loop1268(l01267,2);} else {var if_res674 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list?"),l01267);}return if_res674;};var third = function(l01271) {if (M0.list_p(l01271)!==false) {var loop1272 = function(l1273, pos1274) {if (M0.pair_p(l1273)!==false) {if (M0.eq_p(pos1274,1)!==false) {var if_res675 = M0.car(l1273);} else {var if_res675 = loop1272(M0.cdr(l1273),M0.sub1(pos1274));}var if_res676 = if_res675;} else {var if_res676 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01271);}return if_res676;};var if_res677 = loop1272(l01271,3);} else {var if_res677 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list?"),l01271);}return if_res677;};var fourth = function(l01275) {if (M0.list_p(l01275)!==false) {var loop1276 = function(l1277, pos1278) {if (M0.pair_p(l1277)!==false) {if (M0.eq_p(pos1278,1)!==false) {var if_res678 = M0.car(l1277);} else {var if_res678 = loop1276(M0.cdr(l1277),M0.sub1(pos1278));}var if_res679 = if_res678;} else {var if_res679 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01275);}return if_res679;};var if_res680 = loop1276(l01275,4);} else {var if_res680 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list?"),l01275);}return if_res680;};var fifth = function(l01279) {if (M0.list_p(l01279)!==false) {var loop1280 = function(l1281, pos1282) {if (M0.pair_p(l1281)!==false) {if (M0.eq_p(pos1282,1)!==false) {var if_res681 = M0.car(l1281);} else {var if_res681 = loop1280(M0.cdr(l1281),M0.sub1(pos1282));}var if_res682 = if_res681;} else {var if_res682 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01279);}return if_res682;};var if_res683 = loop1280(l01279,5);} else {var if_res683 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list?"),l01279);}return if_res683;};var sixth = function(l01283) {if (M0.list_p(l01283)!==false) {var loop1284 = function(l1285, pos1286) {if (M0.pair_p(l1285)!==false) {if (M0.eq_p(pos1286,1)!==false) {var if_res684 = M0.car(l1285);} else {var if_res684 = loop1284(M0.cdr(l1285),M0.sub1(pos1286));}var if_res685 = if_res684;} else {var if_res685 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01283);}return if_res685;};var if_res686 = loop1284(l01283,6);} else {var if_res686 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list?"),l01283);}return if_res686;};var seventh = function(l01287) {if (M0.list_p(l01287)!==false) {var loop1288 = function(l1289, pos1290) {if (M0.pair_p(l1289)!==false) {if (M0.eq_p(pos1290,1)!==false) {var if_res687 = M0.car(l1289);} else {var if_res687 = loop1288(M0.cdr(l1289),M0.sub1(pos1290));}var if_res688 = if_res687;} else {var if_res688 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01287);}return if_res688;};var if_res689 = loop1288(l01287,7);} else {var if_res689 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list?"),l01287);}return if_res689;};var eighth = function(l01291) {if (M0.list_p(l01291)!==false) {var loop1292 = function(l1293, pos1294) {if (M0.pair_p(l1293)!==false) {if (M0.eq_p(pos1294,1)!==false) {var if_res690 = M0.car(l1293);} else {var if_res690 = loop1292(M0.cdr(l1293),M0.sub1(pos1294));}var if_res691 = if_res690;} else {var if_res691 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01291);}return if_res691;};var if_res692 = loop1292(l01291,8);} else {var if_res692 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list?"),l01291);}return if_res692;};var ninth = function(l01295) {if (M0.list_p(l01295)!==false) {var loop1296 = function(l1297, pos1298) {if (M0.pair_p(l1297)!==false) {if (M0.eq_p(pos1298,1)!==false) {var if_res693 = M0.car(l1297);} else {var if_res693 = loop1296(M0.cdr(l1297),M0.sub1(pos1298));}var if_res694 = if_res693;} else {var if_res694 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01295);}return if_res694;};var if_res695 = loop1296(l01295,9);} else {var if_res695 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list?"),l01295);}return if_res695;};var tenth = function(l01299) {if (M0.list_p(l01299)!==false) {var loop1300 = function(l1301, pos1302) {if (M0.pair_p(l1301)!==false) {if (M0.eq_p(pos1302,1)!==false) {var if_res696 = M0.car(l1301);} else {var if_res696 = loop1300(M0.cdr(l1301),M0.sub1(pos1302));}var if_res697 = if_res696;} else {var if_res697 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l01299);}return if_res697;};var if_res698 = loop1300(l01299,10);} else {var if_res698 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list?"),l01299);}return if_res698;};var last_pair = function(l1303) {if (M0.pair_p(l1303)!==false) {var loop1304 = function(l1305, x1306) {if (M0.pair_p(x1306)!==false) {var if_res699 = loop1304(x1306,M0.cdr(x1306));} else {var if_res699 = l1305;}return if_res699;};var if_res700 = loop1304(l1303,M0.cdr(l1303));} else {var if_res700 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("last-pair"),$rjs_core.UString.make("pair?"),l1303);}return if_res700;};var last = function(l1307) {if (M0.pair_p(l1307)!==false) {var if_res701 = M0.list_p(l1307);} else {var if_res701 = false;}if (if_res701!==false) {var loop1308 = function(l1309, x1310) {if (M0.pair_p(x1310)!==false) {var if_res702 = loop1308(x1310,M0.cdr(x1310));} else {var if_res702 = M0.car(l1309);}return if_res702;};var if_res703 = loop1308(l1307,M0.cdr(l1307));} else {var if_res703 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("last"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l1307);}return if_res703;};var rest = function(l1311) {if (M0.pair_p(l1311)!==false) {var if_res704 = M0.list_p(l1311);} else {var if_res704 = false;}if (if_res704!==false) {var if_res705 = M0.cdr(l1311);} else {var if_res705 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("rest"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l1311);}return if_res705;};var empty = $rjs_core.Pair.makeList();var make_list = function(n1312, x1313) {if (M0.exact_nonnegative_integer_p(n1312)!==false) {var if_res706 = M0.rvoid();} else {var if_res706 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("make-list"),$rjs_core.UString.make("exact-nonnegative-integer?"),0,n1312,x1313);}if_res706;var loop1314 = function(n1315, r1316) {if (M0.zero_p(n1315)!==false) {var if_res707 = r1316;} else {var if_res707 = loop1314(M0.sub1(n1315),M0.cons(x1313,r1316));}return if_res707;};return loop1314(n1312,$rjs_core.Pair.makeList());};var list_update = function(l1317, i1318, f1319) {if (M0.list_p(l1317)!==false) {var if_res708 = M0.rvoid();} else {var if_res708 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("list?"),0,l1317,i1318,f1319);}if_res708;if (M0.exact_nonnegative_integer_p(i1318)!==false) {var if_res709 = M0.rvoid();} else {var if_res709 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1317,i1318,f1319);}if_res709;if (M0.procedure_p(f1319)!==false) {var if_res710 = M0.procedure_arity_includes_p(f1319,1);} else {var if_res710 = false;}if (if_res710!==false) {var if_res711 = M0.rvoid();} else {var if_res711 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("(-> any/c any/c)"),2,l1317,i1318,f1319);}if_res711;if (M0.zero_p(i1318)!==false) {var if_res712 = M0.cons(f1319(M0.car(l1317)),M0.cdr(l1317));} else {var if_res712 = M0.cons(M0.car(l1317),list_update(M0.cdr(l1317),M0.sub1(i1318),f1319));}return if_res712;};var list_set = function(l1320, k1321, v1322) {if (M0.list_p(l1320)!==false) {var if_res713 = M0.rvoid();} else {var if_res713 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("list?"),0,l1320,k1321,v1322);}if_res713;if (M0.exact_nonnegative_integer_p(k1321)!==false) {var if_res714 = M0.rvoid();} else {var if_res714 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1320,k1321,v1322);}if_res714;return list_update(l1320,k1321,function(_1323) {return v1322;});};var drop_times_ = function(list1324, n1325) {if (M0.zero_p(n1325)!==false) {var if_res716 = list1324;} else {if (M0.pair_p(list1324)!==false) {var if_res715 = drop_times_(M0.cdr(list1324),M0.sub1(n1325));} else {var if_res715 = false;}var if_res716 = if_res715;}return if_res716;};var too_large = function(who1326, list1327, n1328) {var proper_p1329 = M0.list_p(list1327);var temp719 = $rjs_core.UString.make("a ~alist with at least ~a ~a");if (proper_p1329!==false) {var if_res718 = $rjs_core.UString.make("");} else {var if_res718 = $rjs_core.UString.make("(possibly improper) ");}if (proper_p1329!==false) {var if_res717 = $rjs_core.UString.make("elements");} else {var if_res717 = $rjs_core.UString.make("pairs");}return M0.raise_argument_error(who1326,M0.format(temp719,if_res718,n1328,if_res717),list1327);};var take = function(list01330, n01331) {if (M0.exact_nonnegative_integer_p(n01331)!==false) {var if_res720 = M0.rvoid();} else {var if_res720 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("take"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list01330,n01331);}if_res720;var loop1332 = function(list1333, n1334) {if (M0.zero_p(n1334)!==false) {var if_res722 = $rjs_core.Pair.makeList();} else {if (M0.pair_p(list1333)!==false) {var if_res721 = M0.cons(M0.car(list1333),loop1332(M0.cdr(list1333),M0.sub1(n1334)));} else {var if_res721 = too_large($rjs_core.PrimitiveSymbol.make("take"),list01330,n01331);}var if_res722 = if_res721;}return if_res722;};return loop1332(list01330,n01331);};var drop = function(list1335, n1336) {if (M0.exact_nonnegative_integer_p(n1336)!==false) {var if_res723 = M0.rvoid();} else {var if_res723 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1335,n1336);}if_res723;var or_part1337 = drop_times_(list1335,n1336);if (or_part1337!==false) {var if_res724 = or_part1337;} else {var if_res724 = too_large($rjs_core.PrimitiveSymbol.make("drop"),list1335,n1336);}return if_res724;};var split_at = function(list01338, n01339) {if (M0.exact_nonnegative_integer_p(n01339)!==false) {var if_res725 = M0.rvoid();} else {var if_res725 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list01338,n01339);}if_res725;var loop1340 = function(list1341, n1342, pfx1343) {if (M0.zero_p(n1342)!==false) {var if_res727 = M0.values(M8.alt_reverse(pfx1343),list1341);} else {if (M0.pair_p(list1341)!==false) {var if_res726 = loop1340(M0.cdr(list1341),M0.sub1(n1342),M0.cons(M0.car(list1341),pfx1343));} else {var if_res726 = too_large($rjs_core.PrimitiveSymbol.make("split-at"),list01338,n01339);}var if_res727 = if_res726;}return if_res727;};return loop1340(list01338,n01339,$rjs_core.Pair.makeList());};var takef = function(list1344, pred1345) {if (M0.procedure_p(pred1345)!==false) {var if_res728 = M0.rvoid();} else {var if_res728 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("takef"),$rjs_core.UString.make("procedure?"),1,list1344,pred1345);}if_res728;var loop1346 = function(list1347) {if (M0.pair_p(list1347)!==false) {var x1348 = M0.car(list1347);if (pred1345(x1348)!==false) {var if_res729 = M0.cons(x1348,loop1346(M0.cdr(list1347)));} else {var if_res729 = $rjs_core.Pair.makeList();}var if_res730 = if_res729;} else {var if_res730 = $rjs_core.Pair.makeList();}return if_res730;};return loop1346(list1344);};var dropf = function(list1349, pred1350) {if (M0.procedure_p(pred1350)!==false) {var if_res731 = M0.rvoid();} else {var if_res731 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("dropf"),$rjs_core.UString.make("procedure?"),1,list1349,pred1350);}if_res731;var loop1351 = function(list1352) {if (M0.pair_p(list1352)!==false) {var if_res732 = pred1350(M0.car(list1352));} else {var if_res732 = false;}if (if_res732!==false) {var if_res733 = loop1351(M0.cdr(list1352));} else {var if_res733 = list1352;}return if_res733;};return loop1351(list1349);};var splitf_at = function(list1353, pred1354) {if (M0.procedure_p(pred1354)!==false) {var if_res734 = M0.rvoid();} else {var if_res734 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("splitf-at"),$rjs_core.UString.make("procedure?"),1,list1353,pred1354);}if_res734;var loop1355 = function(list1356, pfx1357) {if (M0.pair_p(list1356)!==false) {var if_res735 = pred1354(M0.car(list1356));} else {var if_res735 = false;}if (if_res735!==false) {var if_res736 = loop1355(M0.cdr(list1356),M0.cons(M0.car(list1356),pfx1357));} else {var if_res736 = M0.values(M8.alt_reverse(pfx1357),list1356);}return if_res736;};return loop1355(list1353,$rjs_core.Pair.makeList());};var take_right = function(list1358, n1359) {if (M0.exact_nonnegative_integer_p(n1359)!==false) {var if_res737 = M0.rvoid();} else {var if_res737 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("take-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1358,n1359);}if_res737;var loop1360 = function(list1361, lead1362) {if (M0.pair_p(lead1362)!==false) {var if_res739 = loop1360(M0.cdr(list1361),M0.cdr(lead1362));} else {var if_res739 = list1361;}return if_res739;};var or_part1363 = drop_times_(list1358,n1359);if (or_part1363!==false) {var if_res738 = or_part1363;} else {var if_res738 = too_large($rjs_core.PrimitiveSymbol.make("take-right"),list1358,n1359);}return loop1360(list1358,if_res738);};var drop_right = function(list1364, n1365) {if (M0.exact_nonnegative_integer_p(n1365)!==false) {var if_res740 = M0.rvoid();} else {var if_res740 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1364,n1365);}if_res740;var loop1366 = function(list1367, lead1368) {if (M0.pair_p(lead1368)!==false) {var if_res742 = M0.cons(M0.car(list1367),loop1366(M0.cdr(list1367),M0.cdr(lead1368)));} else {var if_res742 = $rjs_core.Pair.makeList();}return if_res742;};var or_part1369 = drop_times_(list1364,n1365);if (or_part1369!==false) {var if_res741 = or_part1369;} else {var if_res741 = too_large($rjs_core.PrimitiveSymbol.make("drop-right"),list1364,n1365);}return loop1366(list1364,if_res741);};var split_at_right = function(list1370, n1371) {if (M0.exact_nonnegative_integer_p(n1371)!==false) {var if_res743 = M0.rvoid();} else {var if_res743 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list1370,n1371);}if_res743;var loop1372 = function(list1373, lead1374, pfx1375) {if (M0.pair_p(lead1374)!==false) {var if_res745 = loop1372(M0.cdr(list1373),M0.cdr(lead1374),M0.cons(M0.car(list1373),pfx1375));} else {var if_res745 = M0.values(M8.alt_reverse(pfx1375),list1373);}return if_res745;};var or_part1376 = drop_times_(list1370,n1371);if (or_part1376!==false) {var if_res744 = or_part1376;} else {var if_res744 = too_large($rjs_core.PrimitiveSymbol.make("split-at-right"),list1370,n1371);}return loop1372(list1370,if_res744,$rjs_core.Pair.makeList());};var count_from_right = function(who1377, list1378, pred1379) {if (M0.procedure_p(pred1379)!==false) {var if_res746 = M0.rvoid();} else {var if_res746 = M0.raise_argument_error(who1377,$rjs_core.UString.make("procedure?"),1,list1378,pred1379);}if_res746;var loop1380 = function(list1381, rev1382, n1383) {if (M0.pair_p(list1381)!==false) {var if_res749 = loop1380(M0.cdr(list1381),M0.cons(M0.car(list1381),rev1382),M0.add1(n1383));} else {var loop1384 = function(n1385, list1386) {if (M0.pair_p(list1386)!==false) {var if_res747 = pred1379(M0.car(list1386));} else {var if_res747 = false;}if (if_res747!==false) {var if_res748 = loop1384(M0.sub1(n1385),M0.cdr(list1386));} else {var if_res748 = n1385;}return if_res748;};var if_res749 = loop1384(n1383,rev1382);}return if_res749;};return loop1380(list1378,$rjs_core.Pair.makeList(),0);};var takef_right = function(list1387, pred1388) {return drop(list1387,count_from_right($rjs_core.PrimitiveSymbol.make("takef-right"),list1387,pred1388));};var dropf_right = function(list1389, pred1390) {return take(list1389,count_from_right($rjs_core.PrimitiveSymbol.make("dropf-right"),list1389,pred1390));};var splitf_at_right = function(list1391, pred1392) {return split_at(list1391,count_from_right($rjs_core.PrimitiveSymbol.make("splitf-at-right"),list1391,pred1392));};var list_prefix_p1393 = function(ls21394, rs31395, same_p11396) {var ls1397 = ls21394;var rs1398 = rs31395;if (M0.eq_p(same_p11396,M10.unsafe_undefined)!==false) {var if_res750 = M0.equal_p;} else {var if_res750 = same_p11396;}var same_p1399 = if_res750;if (M0.list_p(ls1397)!==false) {var if_res751 = M0.rvoid();} else {var if_res751 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),0,ls1397,rs1398);}if_res751;if (M0.list_p(rs1398)!==false) {var if_res752 = M0.rvoid();} else {var if_res752 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),1,ls1397,rs1398);}if_res752;if (M0.procedure_p(same_p1399)!==false) {var if_res753 = M0.procedure_arity_includes_p(same_p1399,2);} else {var if_res753 = false;}if (if_res753!==false) {var if_res754 = M0.rvoid();} else {var if_res754 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,ls1397,rs1398,same_p1399);}if_res754;var or_part1400 = M0.null_p(ls1397);if (or_part1400!==false) {var if_res757 = or_part1400;} else {if (M0.pair_p(rs1398)!==false) {if (same_p1399(M0.car(ls1397),M0.car(rs1398))!==false) {var if_res755 = list_prefix_p(M0.cdr(ls1397),M0.cdr(rs1398));} else {var if_res755 = false;}var if_res756 = if_res755;} else {var if_res756 = false;}var if_res757 = if_res756;}return if_res757;};var cl758 = function(ls1401, rs1402) {return list_prefix_p1393(ls1401,rs1402,M10.unsafe_undefined);};var cl759 = function(ls1403, rs1404, same_p11405) {return list_prefix_p1393(ls1403,rs1404,same_p11405);};var list_prefix_p = $rjs_core.attachProcedureArity(function() {var fixed_lam760 = {'2':cl758,'3':cl759}[arguments.length];if (fixed_lam760!==undefined) {return fixed_lam760.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var internal_split_common_prefix = function(as1406, bs1407, same_p1408, keep_prefix_p1409, name1410) {if (M0.list_p(as1406)!==false) {var if_res761 = M0.rvoid();} else {var if_res761 = M0.raise_argument_error(name1410,$rjs_core.UString.make("list?"),0,as1406,bs1407);}if_res761;if (M0.list_p(bs1407)!==false) {var if_res762 = M0.rvoid();} else {var if_res762 = M0.raise_argument_error(name1410,$rjs_core.UString.make("list?"),1,as1406,bs1407);}if_res762;if (M0.procedure_p(same_p1408)!==false) {var if_res763 = M0.procedure_arity_includes_p(same_p1408,2);} else {var if_res763 = false;}if (if_res763!==false) {var if_res764 = M0.rvoid();} else {var if_res764 = M0.raise_argument_error(name1410,$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,as1406,bs1407,same_p1408);}if_res764;var loop1411 = function(as1412, bs1413) {if (M0.pair_p(as1412)!==false) {if (M0.pair_p(bs1413)!==false) {var if_res765 = same_p1408(M0.car(as1412),M0.car(bs1413));} else {var if_res765 = false;}var if_res766 = if_res765;} else {var if_res766 = false;}if (if_res766!==false) {var let_result767 = loop1411(M0.cdr(as1412),M0.cdr(bs1413));var prefix1414 = let_result767.getAt(0);var atail1415 = let_result767.getAt(1);var btail1416 = let_result767.getAt(2);if (keep_prefix_p1409!==false) {var if_res768 = M0.cons(M0.car(as1412),prefix1414);} else {var if_res768 = false;}var if_res769 = M0.values(if_res768,atail1415,btail1416);} else {var if_res769 = M0.values(M0.rnull,as1412,bs1413);}return if_res769;};return loop1411(as1406,bs1407);};var split_common_prefix1417 = function(as51418, bs61419, same_p41420) {var as1421 = as51418;var bs1422 = bs61419;if (M0.eq_p(same_p41420,M10.unsafe_undefined)!==false) {var if_res770 = M0.equal_p;} else {var if_res770 = same_p41420;}var same_p1423 = if_res770;return internal_split_common_prefix(as1421,bs1422,same_p1423,true,$rjs_core.PrimitiveSymbol.make("split-common-prefix"));};var cl771 = function(as1424, bs1425) {return split_common_prefix1417(as1424,bs1425,M10.unsafe_undefined);};var cl772 = function(as1426, bs1427, same_p41428) {return split_common_prefix1417(as1426,bs1427,same_p41428);};var split_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam773 = {'2':cl771,'3':cl772}[arguments.length];if (fixed_lam773!==undefined) {return fixed_lam773.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var take_common_prefix1429 = function(as81430, bs91431, same_p71432) {var as1433 = as81430;var bs1434 = bs91431;if (M0.eq_p(same_p71432,M10.unsafe_undefined)!==false) {var if_res774 = M0.equal_p;} else {var if_res774 = same_p71432;}var same_p1435 = if_res774;var let_result775 = internal_split_common_prefix(as1433,bs1434,same_p1435,true,$rjs_core.PrimitiveSymbol.make("take-common-prefix"));var prefix1436 = let_result775.getAt(0);var atail1437 = let_result775.getAt(1);var btail1438 = let_result775.getAt(2);return prefix1436;};var cl776 = function(as1439, bs1440) {return take_common_prefix1429(as1439,bs1440,M10.unsafe_undefined);};var cl777 = function(as1441, bs1442, same_p71443) {return take_common_prefix1429(as1441,bs1442,same_p71443);};var take_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam778 = {'2':cl776,'3':cl777}[arguments.length];if (fixed_lam778!==undefined) {return fixed_lam778.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var drop_common_prefix1444 = function(as111445, bs121446, same_p101447) {var as1448 = as111445;var bs1449 = bs121446;if (M0.eq_p(same_p101447,M10.unsafe_undefined)!==false) {var if_res779 = M0.equal_p;} else {var if_res779 = same_p101447;}var same_p1450 = if_res779;var let_result780 = internal_split_common_prefix(as1448,bs1449,same_p1450,false,$rjs_core.PrimitiveSymbol.make("drop-common-prefix"));var prefix1451 = let_result780.getAt(0);var atail1452 = let_result780.getAt(1);var btail1453 = let_result780.getAt(2);return M0.values(atail1452,btail1453);};var cl781 = function(as1454, bs1455) {return drop_common_prefix1444(as1454,bs1455,M10.unsafe_undefined);};var cl782 = function(as1456, bs1457, same_p101458) {return drop_common_prefix1444(as1456,bs1457,same_p101458);};var drop_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam783 = {'2':cl781,'3':cl782}[arguments.length];if (fixed_lam783!==undefined) {return fixed_lam783.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cl784 = function(ls1459) {return M0.apply(M0.append,ls1459);};var cl785 = function(l11460, l21461) {return M0.apply(M0.append,l11460,l21461);};var cl786 = function(l11462, l21463, l31464) {return M0.apply(M0.append,l11462,l21463,l31464);};var cl787 = function(l11465, l21466, l31467, l41468) {return M0.apply(M0.append,l11465,l21466,l31467,l41468);};var cl788 = $rjs_core.attachProcedureArity(function(l1469, ...lss1470791) {var lss1470 = $rjs_core.Pair.listFromArray(lss1470791);return M0.apply(M1.new_apply_proc,M0.append,l1469,lss1470);});var append_times_ = $rjs_core.attachProcedureArity(function() {var fixed_lam789 = {'1':cl784,'2':cl785,'3':cl786,'4':cl787}[arguments.length];if (fixed_lam789!==undefined) {return fixed_lam789.apply(null,arguments);} else {if (M0.__gt__eq_(cl788.length,1)!==false) {var if_res790 = cl788.apply(null,arguments);} else {var if_res790 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res790;}},[M0.make_arity_at_least(1)]);var flatten = function(orig_sexp1471) {var loop1472 = function(sexp1473, acc1474) {if (M0.null_p(sexp1473)!==false) {var if_res793 = acc1474;} else {if (M0.pair_p(sexp1473)!==false) {var if_res792 = loop1472(M0.car(sexp1473),loop1472(M0.cdr(sexp1473),acc1474));} else {var if_res792 = M0.cons(sexp1473,acc1474);}var if_res793 = if_res792;}return if_res793;};return loop1472(orig_sexp1471,M0.rnull);};var add_between = function(after_last161475, before_first141476, before_last151477, splice_p131478, l211479, x221480) {var l1481 = l211479;var x1482 = x221480;if (false!==false) {var if_res794 = false;} else {var if_res794 = splice_p131478;}var splice_p1483 = if_res794;if (false!==false) {var if_res795 = $rjs_core.Pair.makeList();} else {var if_res795 = before_first141476;}var before_first1484 = if_res795;if (M0.eq_p(before_last151477,M10.unsafe_undefined)!==false) {var if_res796 = x1482;} else {var if_res796 = before_last151477;}var before_last1485 = if_res796;if (false!==false) {var if_res797 = $rjs_core.Pair.makeList();} else {var if_res797 = after_last161475;}var after_last1486 = if_res797;if (M0.list_p(l1481)!==false) {var if_res798 = M0.rvoid();} else {var if_res798 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("add-between"),$rjs_core.UString.make("list?"),0,l1481,x1482);}if_res798;if (splice_p1483!==false) {var check_list1487 = function(x1488, which1489) {if (M0.list_p(x1488)!==false) {var if_res799 = M0.rvoid();} else {var if_res799 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M0.string_append($rjs_core.UString.make("list needed in splicing mode"),which1489),$rjs_core.UString.make("given"),x1488,$rjs_core.UString.make("given list..."),l1481);}return if_res799;};check_list1487(x1482,$rjs_core.UString.make(""));check_list1487(before_first1484,$rjs_core.UString.make(" for #:before-first"));check_list1487(before_last1485,$rjs_core.UString.make(" for #:before-last"));var if_res801 = check_list1487(after_last1486,$rjs_core.UString.make(" for #:after-last"));} else {var check_not_given1490 = function(x1491, which1492) {if (M0.eq_p($rjs_core.Pair.makeList(),x1491)!==false) {var if_res800 = M0.rvoid();} else {var if_res800 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M0.string_append(which1492,$rjs_core.UString.make(" can only be used in splicing mode")),$rjs_core.UString.make("given"),x1491,$rjs_core.UString.make("given list..."),l1481);}return if_res800;};check_not_given1490(before_first1484,$rjs_core.UString.make("#:before-first"));var if_res801 = check_not_given1490(after_last1486,$rjs_core.UString.make("#:after-last"));}if_res801;var or_part1493 = M0.null_p(l1481);if (or_part1493!==false) {var if_res802 = or_part1493;} else {var if_res802 = M0.null_p(M0.cdr(l1481));}if (if_res802!==false) {if (splice_p1483!==false) {var if_res803 = M0.append(before_first1484,l1481,after_last1486);} else {var if_res803 = l1481;}var if_res808 = if_res803;} else {if (splice_p1483!==false) {var x1494 = M8.alt_reverse(x1482);var loop1496 = function(i1497, l1498, r1499) {if (M0.pair_p(l1498)!==false) {var if_res804 = loop1496(M0.car(l1498),M0.cdr(l1498),M0.cons(i1497,M0.append(x1494,r1499)));} else {var if_res804 = M0.cons(i1497,M0.append(M8.alt_reverse(before_last1485),r1499));}return if_res804;};var r1495 = loop1496(M0.cadr(l1481),M0.cddr(l1481),$rjs_core.Pair.makeList());var r1500 = M8.alt_reverse(M0.append(M8.alt_reverse(after_last1486),r1495));var r1501 = M5.__rjs_quoted__.qq_append(before_first1484,M0.list_times_(M0.car(l1481),r1500));var if_res807 = r1501;} else {var temp806 = M0.car(l1481);var loop1502 = function(i1503, l1504, r1505) {if (M0.pair_p(l1504)!==false) {var if_res805 = loop1502(M0.car(l1504),M0.cdr(l1504),M0.cons(i1503,M0.cons(x1482,r1505)));} else {var if_res805 = M0.cons(i1503,M0.cons(before_last1485,r1505));}return if_res805;};var if_res807 = M0.cons(temp806,M8.alt_reverse(loop1502(M0.cadr(l1481),M0.cddr(l1481),$rjs_core.Pair.makeList())));}var if_res808 = if_res807;}return if_res808;};var add_between1263 = function(given_kws1506, given_args1507, l211508, x221509) {if (M0.pair_p(given_kws1506)!==false) {var if_res809 = M0.eq_p($rjs_core.Keyword.make("after-last"),M0.car(given_kws1506));} else {var if_res809 = false;}var after_last201510 = if_res809;if (after_last201510!==false) {var if_res810 = M0.car(given_args1507);} else {var if_res810 = $rjs_core.Pair.makeList();}var after_last161511 = if_res810;if (after_last201510!==false) {var if_res811 = M0.cdr(given_kws1506);} else {var if_res811 = given_kws1506;}var kws673871512 = if_res811;if (after_last201510!==false) {var if_res812 = M0.cdr(given_args1507);} else {var if_res812 = given_args1507;}var kw_args673881513 = if_res812;if (M0.pair_p(kws673871512)!==false) {var if_res813 = M0.eq_p($rjs_core.Keyword.make("before-first"),M0.car(kws673871512));} else {var if_res813 = false;}var before_first181514 = if_res813;if (before_first181514!==false) {var if_res814 = M0.car(kw_args673881513);} else {var if_res814 = $rjs_core.Pair.makeList();}var before_first141515 = if_res814;if (before_first181514!==false) {var if_res815 = M0.cdr(kws673871512);} else {var if_res815 = kws673871512;}var kws673891516 = if_res815;if (before_first181514!==false) {var if_res816 = M0.cdr(kw_args673881513);} else {var if_res816 = kw_args673881513;}var kw_args673901517 = if_res816;if (M0.pair_p(kws673891516)!==false) {var if_res817 = M0.eq_p($rjs_core.Keyword.make("before-last"),M0.car(kws673891516));} else {var if_res817 = false;}var before_last191518 = if_res817;if (before_last191518!==false) {var if_res818 = M0.car(kw_args673901517);} else {var if_res818 = M10.unsafe_undefined;}var before_last151519 = if_res818;if (before_last191518!==false) {var if_res819 = M0.cdr(kws673891516);} else {var if_res819 = kws673891516;}var kws673911520 = if_res819;if (before_last191518!==false) {var if_res820 = M0.cdr(kw_args673901517);} else {var if_res820 = kw_args673901517;}var kw_args673921521 = if_res820;var splice_p171522 = M0.pair_p(kws673911520);if (splice_p171522!==false) {var if_res821 = M0.car(kw_args673921521);} else {var if_res821 = false;}var splice_p131523 = if_res821;return add_between(after_last161511,before_first141515,before_last151519,splice_p131523,l211508,x221509);};var cl825 = function(given_kws1534, given_args1535, l1536, x1537) {return add_between1263(given_kws1534,given_args1535,l1536,x1537);};var temp827 = $rjs_core.attachProcedureArity(function() {var fixed_lam826 = {'4':cl825}[arguments.length];if (fixed_lam826!==undefined) {return fixed_lam826.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4]);var temp824 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("after-last"),$rjs_core.Keyword.make("before-first"),$rjs_core.Keyword.make("before-last"),$rjs_core.Keyword.make("splice?"));var cl822 = function(l1538, x1539) {return add_between1263(M0.rnull,M0.rnull,l1538,x1539);};var add_between23 = M4.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1524, given_argc1525) {if (M0.__eq_(given_argc1525,4)!==false) {var l1673931526 = given_kws1524;if (M0.null_p(l1673931526)!==false) {var if_res829 = l1673931526;} else {if (M0.eq_p(M0.car(l1673931526),$rjs_core.Keyword.make("after-last"))!==false) {var if_res828 = M0.cdr(l1673931526);} else {var if_res828 = l1673931526;}var if_res829 = if_res828;}var l1673931527 = if_res829;var l1673941528 = l1673931527;if (M0.null_p(l1673941528)!==false) {var if_res831 = l1673941528;} else {if (M0.eq_p(M0.car(l1673941528),$rjs_core.Keyword.make("before-first"))!==false) {var if_res830 = M0.cdr(l1673941528);} else {var if_res830 = l1673941528;}var if_res831 = if_res830;}var l1673941529 = if_res831;var l1673951530 = l1673941529;if (M0.null_p(l1673951530)!==false) {var if_res833 = l1673951530;} else {if (M0.eq_p(M0.car(l1673951530),$rjs_core.Keyword.make("before-last"))!==false) {var if_res832 = M0.cdr(l1673951530);} else {var if_res832 = l1673951530;}var if_res833 = if_res832;}var l1673951531 = if_res833;var l1673961532 = l1673951531;if (M0.null_p(l1673961532)!==false) {var if_res835 = l1673961532;} else {if (M0.eq_p(M0.car(l1673961532),$rjs_core.Keyword.make("splice?"))!==false) {var if_res834 = M0.cdr(l1673961532);} else {var if_res834 = l1673961532;}var if_res835 = if_res834;}var l1673961533 = if_res835;var if_res836 = M0.null_p(l1673961533);} else {var if_res836 = false;}return if_res836;},temp827,M0.rnull,temp824,$rjs_core.attachProcedureArity(function() {var fixed_lam823 = {'2':cl822}[arguments.length];if (fixed_lam823!==undefined) {return fixed_lam823.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2]));var remove_duplicates = function(key241540, l271541, __eq__p261542) {var l1543 = l271541;if (M0.eq_p(__eq__p261542,M10.unsafe_undefined)!==false) {var if_res837 = M0.equal_p;} else {var if_res837 = __eq__p261542;}var __eq__p1544 = if_res837;if (false!==false) {var if_res838 = false;} else {var if_res838 = key241540;}var key1545 = if_res838;if (M0.list_p(l1543)!==false) {var if_res839 = M0.rvoid();} else {var if_res839 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remove-duplicates"),$rjs_core.UString.make("list?"),l1543);}if_res839;var len1546 = M0.length(l1543);if (M0.__lt__eq_(len1546,1)!==false) {var if_res843 = true;} else {if (M0.__lt__eq_(len1546,40)!==false) {var if_res842 = false;} else {if (M0.eq_p(__eq__p1544,M0.eq_p)!==false) {var if_res841 = M0.make_hasheq();} else {if (M0.eq_p(__eq__p1544,M0.equal_p)!==false) {var if_res840 = M0.make_hash();} else {var if_res840 = false;}var if_res841 = if_res840;}var if_res842 = if_res841;}var if_res843 = if_res842;}var h1547 = if_res843;var tmp1548 = h1547;if (M0.equal_p(tmp1548,true)!==false) {var if_res862 = l1543;} else {if (M0.equal_p(tmp1548,false)!==false) {var or_part1550 = key1545;if (or_part1550!==false) {var if_res844 = or_part1550;} else {var if_res844 = function(x1551) {return x1551;};}var key1549 = if_res844;if (M0.eq_p(__eq__p1544,M0.equal_p)!==false) {var loop1552 = function(l1553, seen1554) {if (M0.null_p(l1553)!==false) {var if_res846 = l1553;} else {var x1555 = M0.car(l1553);var k1556 = key1549(x1555);var l1557 = M0.cdr(l1553);if (M6.member(k1556,seen1554)!==false) {var if_res845 = loop1552(l1557,seen1554);} else {var if_res845 = M0.cons(x1555,loop1552(l1557,M0.cons(k1556,seen1554)));}var if_res846 = if_res845;}return if_res846;};var if_res855 = loop1552(l1543,M0.rnull);} else {if (M0.eq_p(__eq__p1544,M0.eq_p)!==false) {var loop1558 = function(l1559, seen1560) {if (M0.null_p(l1559)!==false) {var if_res848 = l1559;} else {var x1561 = M0.car(l1559);var k1562 = key1549(x1561);var l1563 = M0.cdr(l1559);if (M0.memq(k1562,seen1560)!==false) {var if_res847 = loop1558(l1563,seen1560);} else {var if_res847 = M0.cons(x1561,loop1558(l1563,M0.cons(k1562,seen1560)));}var if_res848 = if_res847;}return if_res848;};var if_res854 = loop1558(l1543,M0.rnull);} else {if (M0.eq_p(__eq__p1544,M0.eqv_p)!==false) {var loop1564 = function(l1565, seen1566) {if (M0.null_p(l1565)!==false) {var if_res850 = l1565;} else {var x1567 = M0.car(l1565);var k1568 = key1549(x1567);var l1569 = M0.cdr(l1565);if (M0.memv(k1568,seen1566)!==false) {var if_res849 = loop1564(l1569,seen1566);} else {var if_res849 = M0.cons(x1567,loop1564(l1569,M0.cons(k1568,seen1566)));}var if_res850 = if_res849;}return if_res850;};var if_res853 = loop1564(l1543,M0.rnull);} else {var loop1570 = function(l1571, seen1572) {if (M0.null_p(l1571)!==false) {var if_res852 = l1571;} else {var x1573 = M0.car(l1571);var k1574 = key1549(x1573);var l1575 = M0.cdr(l1571);if ((function(x1576, seen1577) {return M3.ormap(function(y1578) {return __eq__p1544(x1576,y1578);},seen1577);})(k1574,seen1572)!==false) {var if_res851 = loop1570(l1575,seen1572);} else {var if_res851 = M0.cons(x1573,loop1570(l1575,M0.cons(k1574,seen1572)));}var if_res852 = if_res851;}return if_res852;};var if_res853 = loop1570(l1543,M0.rnull);}var if_res854 = if_res853;}var if_res855 = if_res854;}var if_res861 = if_res855;} else {if (key1545!==false) {var loop1579 = function(l1580) {if (M0.null_p(l1580)!==false) {var if_res857 = l1580;} else {var x1581 = M0.car(l1580);var k1582 = key1545(x1581);var l1583 = M0.cdr(l1580);if (M0.hash_ref(h1547,k1582,false)!==false) {var if_res856 = loop1579(l1583);} else {M0.hash_set_bang_(h1547,k1582,true);var if_res856 = M0.cons(x1581,loop1579(l1583));}var if_res857 = if_res856;}return if_res857;};var if_res860 = loop1579(l1543);} else {var loop1584 = function(l1585) {if (M0.null_p(l1585)!==false) {var if_res859 = l1585;} else {var x1586 = M0.car(l1585);var k1587 = x1586;var l1588 = M0.cdr(l1585);if (M0.hash_ref(h1547,k1587,false)!==false) {var if_res858 = loop1584(l1588);} else {M0.hash_set_bang_(h1547,k1587,true);var if_res858 = M0.cons(x1586,loop1584(l1588));}var if_res859 = if_res858;}return if_res859;};var if_res860 = loop1584(l1543);}var if_res861 = if_res860;}var if_res862 = if_res861;}return if_res862;};var remove_duplicates1264 = function(given_kws1589, given_args1590, l271591, __eq__p261592) {var key251593 = M0.pair_p(given_kws1589);if (key251593!==false) {var if_res863 = M0.car(given_args1590);} else {var if_res863 = false;}var key241594 = if_res863;return remove_duplicates(key241594,l271591,__eq__p261592);};var cl868 = function(given_kws1599, given_args1600, l1601) {return remove_duplicates1264(given_kws1599,given_args1600,l1601,M10.unsafe_undefined);};var cl869 = function(given_kws1602, given_args1603, l1604, __eq__p261605) {return remove_duplicates1264(given_kws1602,given_args1603,l1604,__eq__p261605);};var temp871 = $rjs_core.attachProcedureArity(function() {var fixed_lam870 = {'3':cl868,'4':cl869}[arguments.length];if (fixed_lam870!==undefined) {return fixed_lam870.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp867 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("key"));var cl864 = function(l1606) {return remove_duplicates1264(M0.rnull,M0.rnull,l1606,M10.unsafe_undefined);};var cl865 = function(l1607, __eq__p261608) {return remove_duplicates1264(M0.rnull,M0.rnull,l1607,__eq__p261608);};var remove_duplicates28 = M4.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1595, given_argc1596) {if (M0.__gt__eq_(given_argc1596,3)!==false) {var if_res872 = M0.__lt__eq_(given_argc1596,4);} else {var if_res872 = false;}if (if_res872!==false) {var l1674051597 = given_kws1595;if (M0.null_p(l1674051597)!==false) {var if_res874 = l1674051597;} else {if (M0.eq_p(M0.car(l1674051597),$rjs_core.Keyword.make("key"))!==false) {var if_res873 = M0.cdr(l1674051597);} else {var if_res873 = l1674051597;}var if_res874 = if_res873;}var l1674051598 = if_res874;var if_res875 = M0.null_p(l1674051598);} else {var if_res875 = false;}return if_res875;},temp871,M0.rnull,temp867,$rjs_core.attachProcedureArity(function() {var fixed_lam866 = {'1':cl864,'2':cl865}[arguments.length];if (fixed_lam866!==undefined) {return fixed_lam866.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates = function(default301609, key291610, items341611, same_p331612) {var items1613 = items341611;if (M0.eq_p(same_p331612,M10.unsafe_undefined)!==false) {var if_res876 = M0.equal_p;} else {var if_res876 = same_p331612;}var same_p1614 = if_res876;if (M0.eq_p(key291610,M10.unsafe_undefined)!==false) {var if_res877 = M0.values;} else {var if_res877 = key291610;}var key1615 = if_res877;if (M0.eq_p(default301609,M10.unsafe_undefined)!==false) {var if_res878 = function() {return false;};} else {var if_res878 = default301609;}var failure_result1616 = if_res878;if (M0.list_p(items1613)!==false) {var if_res879 = M0.rvoid();} else {var if_res879 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("list?"),0,items1613);}if_res879;if (M0.procedure_p(key1615)!==false) {var if_res880 = M0.procedure_arity_includes_p(key1615,1);} else {var if_res880 = false;}if (if_res880!==false) {var if_res881 = M0.rvoid();} else {var if_res881 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(-> any/c any/c)"),key1615);}if_res881;if (M0.procedure_p(failure_result1616)!==false) {var if_res882 = failure_result1616;} else {var if_res882 = function() {return failure_result1616;};}var fail_k1617 = if_res882;if (M0.eq_p(same_p1614,M0.equal_p)!==false) {var if_res887 = check_duplicates_by_t(items1613,key1615,M0.make_hash(),fail_k1617);} else {if (M0.eq_p(same_p1614,M0.eq_p)!==false) {var if_res886 = check_duplicates_by_t(items1613,key1615,M0.make_hasheq(),fail_k1617);} else {if (M0.eq_p(same_p1614,M0.eqv_p)!==false) {var if_res885 = check_duplicates_by_t(items1613,key1615,M0.make_hasheqv(),fail_k1617);} else {if (M0.procedure_p(same_p1614)!==false) {var if_res883 = M0.procedure_arity_includes_p(same_p1614,2);} else {var if_res883 = false;}if (if_res883!==false) {var if_res884 = M0.rvoid();} else {var if_res884 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),1,items1613,same_p1614);}if_res884;var if_res885 = check_duplicates_by_list(items1613,key1615,same_p1614,fail_k1617);}var if_res886 = if_res885;}var if_res887 = if_res886;}return if_res887;};var check_duplicates1265 = function(given_kws1618, given_args1619, items341620, same_p331621) {if (M0.pair_p(given_kws1618)!==false) {var if_res888 = M0.eq_p($rjs_core.Keyword.make("default"),M0.car(given_kws1618));} else {var if_res888 = false;}var default321622 = if_res888;if (default321622!==false) {var if_res889 = M0.car(given_args1619);} else {var if_res889 = M10.unsafe_undefined;}var default301623 = if_res889;if (default321622!==false) {var if_res890 = M0.cdr(given_kws1618);} else {var if_res890 = given_kws1618;}var kws674061624 = if_res890;if (default321622!==false) {var if_res891 = M0.cdr(given_args1619);} else {var if_res891 = given_args1619;}var kw_args674071625 = if_res891;var key311626 = M0.pair_p(kws674061624);if (key311626!==false) {var if_res892 = M0.car(kw_args674071625);} else {var if_res892 = M10.unsafe_undefined;}var key291627 = if_res892;return check_duplicates(default301623,key291627,items341620,same_p331621);};var cl897 = function(given_kws1634, given_args1635, items1636) {return check_duplicates1265(given_kws1634,given_args1635,items1636,M10.unsafe_undefined);};var cl898 = function(given_kws1637, given_args1638, items1639, same_p331640) {return check_duplicates1265(given_kws1637,given_args1638,items1639,same_p331640);};var temp900 = $rjs_core.attachProcedureArity(function() {var fixed_lam899 = {'3':cl897,'4':cl898}[arguments.length];if (fixed_lam899!==undefined) {return fixed_lam899.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp896 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("default"),$rjs_core.Keyword.make("key"));var cl893 = function(items1641) {return check_duplicates1265(M0.rnull,M0.rnull,items1641,M10.unsafe_undefined);};var cl894 = function(items1642, same_p331643) {return check_duplicates1265(M0.rnull,M0.rnull,items1642,same_p331643);};var check_duplicates35 = M4.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws1628, given_argc1629) {if (M0.__gt__eq_(given_argc1629,3)!==false) {var if_res901 = M0.__lt__eq_(given_argc1629,4);} else {var if_res901 = false;}if (if_res901!==false) {var l1674081630 = given_kws1628;if (M0.null_p(l1674081630)!==false) {var if_res903 = l1674081630;} else {if (M0.eq_p(M0.car(l1674081630),$rjs_core.Keyword.make("default"))!==false) {var if_res902 = M0.cdr(l1674081630);} else {var if_res902 = l1674081630;}var if_res903 = if_res902;}var l1674081631 = if_res903;var l1674091632 = l1674081631;if (M0.null_p(l1674091632)!==false) {var if_res905 = l1674091632;} else {if (M0.eq_p(M0.car(l1674091632),$rjs_core.Keyword.make("key"))!==false) {var if_res904 = M0.cdr(l1674091632);} else {var if_res904 = l1674091632;}var if_res905 = if_res904;}var l1674091633 = if_res905;var if_res906 = M0.null_p(l1674091633);} else {var if_res906 = false;}return if_res906;},temp900,M0.rnull,temp896,$rjs_core.attachProcedureArity(function() {var fixed_lam895 = {'1':cl893,'2':cl894}[arguments.length];if (fixed_lam895!==undefined) {return fixed_lam895.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates_by_t = function(items1644, key1645, table1646, fail_k1647) {var loop1648 = function(items1649) {if (M0.pair_p(items1649)!==false) {var key_item1650 = key1645(M0.car(items1649));if (M0.hash_ref(table1646,key_item1650,false)!==false) {var if_res907 = M0.car(items1649);} else {M0.hash_set_bang_(table1646,key_item1650,true);var if_res907 = loop1648(M0.cdr(items1649));}var if_res908 = if_res907;} else {var if_res908 = fail_k1647();}return if_res908;};return loop1648(items1644);};var check_duplicates_by_list = function(items1651, key1652, same_p1653, fail_k1654) {var loop1655 = function(items1656, sofar1657) {if (M0.pair_p(items1656)!==false) {var key_item1658 = key1652(M0.car(items1656));var lst1659 = sofar1657;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res909 = M0.rvoid();} else {var if_res909 = M9.__rjs_quoted__.check_list(lst1659);}if_res909;var for_loop1660 = function(result1661, lst1662) {if (M0.pair_p(lst1662)!==false) {var prev1663 = M10.unsafe_car(lst1662);var rest1664 = M10.unsafe_cdr(lst1662);if (true!==false) {var result1666 = result1661;var result1667 = same_p1653(key_item1658,prev1663);var result1665 = M0.values(result1667);if (true!==false) {var if_res911 = M0.not($rjs_core.attachProcedureArity(function(...x1668910) {var x1668 = $rjs_core.Pair.listFromArray(x1668910);return result1665;})(prev1663));} else {var if_res911 = false;}if (if_res911!==false) {var if_res912 = M0.not(false);} else {var if_res912 = false;}if (if_res912!==false) {var if_res913 = for_loop1660(result1665,rest1664);} else {var if_res913 = result1665;}var if_res914 = if_res913;} else {var if_res914 = result1661;}var if_res915 = if_res914;} else {var if_res915 = result1661;}return if_res915;};if (for_loop1660(false,lst1659)!==false) {var if_res916 = M0.car(items1656);} else {var if_res916 = loop1655(M0.cdr(items1656),M0.cons(key_item1658,sofar1657));}var if_res917 = if_res916;} else {var if_res917 = fail_k1654();}return if_res917;};return loop1655(items1651,M0.rnull);};var check_filter_arguments = function(who1669, f1670, l1671, ls1672) {if (M0.procedure_p(f1670)!==false) {var if_res918 = M0.rvoid();} else {var if_res918 = M0.apply(M0.raise_argument_error,who1669,$rjs_core.UString.make("procedure?"),0,f1670,l1671,ls1672);}if_res918;if (M0.procedure_arity_includes_p(f1670,M0.add1(M0.length(ls1672)))!==false) {var if_res919 = M0.rvoid();} else {var if_res919 = M0.raise_arguments_error(who1669,$rjs_core.UString.make("mismatch between procedure arity and argument count"),$rjs_core.UString.make("procedure"),f1670,$rjs_core.UString.make("expected arity"),M0.add1(M0.length(ls1672)));}if_res919;if (M0.list_p(l1671)!==false) {var if_res920 = M3.andmap(M0.list_p,ls1672);} else {var if_res920 = false;}if (if_res920!==false) {var if_res940 = M0.rvoid();} else {var let_result921 = M9.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),M0.cons(l1671,ls1672));var pos__gt_vals1673 = let_result921.getAt(0);var pos_pre_inc1674 = let_result921.getAt(1);var pos_next1675 = let_result921.getAt(2);var init1676 = let_result921.getAt(3);var pos_cont_p1677 = let_result921.getAt(4);var val_cont_p1678 = let_result921.getAt(5);var all_cont_p1679 = let_result921.getAt(6);var start1680 = 0;if (M0.rvoid()!==false) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res922 = M0.rvoid();} else {var if_res922 = M9.__rjs_quoted__.check_naturals(start1680);}var if_res923 = if_res922;} else {var if_res923 = false;}if_res923;var for_loop1681 = function(pos1682, pos1683) {if (pos_cont_p1677!==false) {var if_res924 = pos_cont_p1677(pos1682);} else {var if_res924 = true;}if (if_res924!==false) {var if_res925 = true;} else {var if_res925 = false;}if (if_res925!==false) {var x1688 = pos__gt_vals1673(pos1682);if (all_cont_p1679!==false) {var if_res926 = function(pos1689) {return all_cont_p1679(pos1689,x1688);};} else {var if_res926 = false;}var let_result927 = M0.values(x1688,if_res926);var x1684 = let_result927.getAt(0);var all_cont_p_by_pos1685 = let_result927.getAt(1);if (pos_pre_inc1674!==false) {var if_res928 = pos_pre_inc1674(pos1682);} else {var if_res928 = pos1682;}var pos1686 = if_res928;var i1687 = pos1683;if (val_cont_p1678!==false) {var if_res929 = val_cont_p1678(x1684);} else {var if_res929 = true;}if (if_res929!==false) {var if_res930 = true;} else {var if_res930 = false;}if (if_res930!==false) {if (M0.list_p(x1684)!==false) {var if_res931 = M0.rvoid();} else {var if_res931 = M0.apply(M0.raise_argument_error,who1669,$rjs_core.UString.make("list?"),M0.add1(i1687),f1670,l1671,ls1672);}if_res931;var let_result932 = M0.values();var let_result933 = M0.values();if (all_cont_p_by_pos1685!==false) {var if_res934 = all_cont_p_by_pos1685(pos1686);} else {var if_res934 = true;}if (if_res934!==false) {var if_res935 = true;} else {var if_res935 = false;}if (if_res935!==false) {var if_res936 = M0.not(false);} else {var if_res936 = false;}if (if_res936!==false) {var if_res937 = for_loop1681(pos_next1675(pos1686),pos1683+1);} else {var if_res937 = M0.values();}var if_res938 = if_res937;} else {var if_res938 = M0.values();}var if_res939 = if_res938;} else {var if_res939 = M0.values();}return if_res939;};for_loop1681(init1676,start1680);var if_res940 = M0.rvoid();}return if_res940;};var filter_map = $rjs_core.attachProcedureArity(function(f1690, l1691, ...ls1692941) {var ls1692 = $rjs_core.Pair.listFromArray(ls1692941);check_filter_arguments($rjs_core.PrimitiveSymbol.make("filter-map"),f1690,l1691,ls1692);if (M0.pair_p(ls1692)!==false) {var len1693 = M0.length(l1691);if (M3.andmap(function(l1694) {return M0.__eq_(len1693,M0.length(l1694));},ls1692)!==false) {var loop1695 = function(l1696, ls1697) {if (M0.null_p(l1696)!==false) {var if_res943 = M0.rnull;} else {var x1698 = M0.apply(f1690,M0.car(l1696),M3.map(M0.car,ls1697));if (x1698!==false) {var if_res942 = M0.cons(x1698,loop1695(M0.cdr(l1696),M3.map(M0.cdr,ls1697)));} else {var if_res942 = loop1695(M0.cdr(l1696),M3.map(M0.cdr,ls1697));}var if_res943 = if_res942;}return if_res943;};var if_res944 = loop1695(l1691,ls1692);} else {var if_res944 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("filter-map"),$rjs_core.UString.make("all lists must have same size"));}var if_res947 = if_res944;} else {var loop1699 = function(l1700) {if (M0.null_p(l1700)!==false) {var if_res946 = M0.rnull;} else {var x1701 = f1690(M0.car(l1700));if (x1701!==false) {var if_res945 = M0.cons(x1701,loop1699(M0.cdr(l1700)));} else {var if_res945 = loop1699(M0.cdr(l1700));}var if_res946 = if_res945;}return if_res946;};var if_res947 = loop1699(l1691);}return if_res947;});var count = $rjs_core.attachProcedureArity(function(f1702, l1703, ...ls1704948) {var ls1704 = $rjs_core.Pair.listFromArray(ls1704948);check_filter_arguments($rjs_core.PrimitiveSymbol.make("count"),f1702,l1703,ls1704);if (M0.pair_p(ls1704)!==false) {var len1705 = M0.length(l1703);if (M3.andmap(function(l1706) {return M0.__eq_(len1705,M0.length(l1706));},ls1704)!==false) {var loop1707 = function(l1708, ls1709, c1710) {if (M0.null_p(l1708)!==false) {var if_res952 = c1710;} else {var temp951 = M0.cdr(l1708);var temp950 = M3.map(M0.cdr,ls1709);if (M0.apply(f1702,M0.car(l1708),M3.map(M0.car,ls1709))!==false) {var if_res949 = M0.add1(c1710);} else {var if_res949 = c1710;}var if_res952 = loop1707(temp951,temp950,if_res949);}return if_res952;};var if_res953 = loop1707(l1703,ls1704,0);} else {var if_res953 = M0.raise_arguments_error($rjs_core.PrimitiveSymbol.make("count"),$rjs_core.UString.make("all lists must have same size"));}var if_res957 = if_res953;} else {var loop1711 = function(l1712, c1713) {if (M0.null_p(l1712)!==false) {var if_res956 = c1713;} else {var temp955 = M0.cdr(l1712);if (f1702(M0.car(l1712))!==false) {var if_res954 = M0.add1(c1713);} else {var if_res954 = c1713;}var if_res956 = loop1711(temp955,if_res954);}return if_res956;};var if_res957 = loop1711(l1703,0);}return if_res957;});var partition = function(pred1714, l1715) {if (M0.procedure_p(pred1714)!==false) {var if_res958 = M0.procedure_arity_includes_p(pred1714,1);} else {var if_res958 = false;}if (if_res958!==false) {var if_res959 = M0.rvoid();} else {var if_res959 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,pred1714,l1715);}if_res959;if (M0.list_p(l1715)!==false) {var if_res960 = M0.rvoid();} else {var if_res960 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("list?"),1,pred1714,l1715);}if_res960;var loop1716 = function(l1717, i1718, o1719) {if (M0.null_p(l1717)!==false) {var if_res962 = M0.values(M8.alt_reverse(i1718),M8.alt_reverse(o1719));} else {var x1720 = M0.car(l1717);var l1721 = M0.cdr(l1717);if (pred1714(x1720)!==false) {var if_res961 = loop1716(l1721,M0.cons(x1720,i1718),o1719);} else {var if_res961 = loop1716(l1721,i1718,M0.cons(x1720,o1719));}var if_res962 = if_res961;}return if_res962;};return loop1716(l1715,$rjs_core.Pair.makeList(),$rjs_core.Pair.makeList());};var cl963 = function(end1723) {var start1724 = 0;var end1725 = end1723;var inc1726 = 1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res967 = M0.rvoid();} else {var if_res967 = M9.__rjs_quoted__.check_range(start1724,end1725,inc1726);}if_res967;var for_loop1727 = function(fold_var1728, pos1729) {if (M0.__lt_(pos1729,end1725)!==false) {var i1730 = pos1729;if (true!==false) {var fold_var1732 = fold_var1728;var fold_var1733 = M0.cons(i1730,fold_var1732);var fold_var1731 = M0.values(fold_var1733);if (true!==false) {var if_res968 = M0.not(false);} else {var if_res968 = false;}if (if_res968!==false) {var if_res969 = for_loop1727(fold_var1731,pos1729+inc1726);} else {var if_res969 = fold_var1731;}var if_res970 = if_res969;} else {var if_res970 = fold_var1728;}var if_res971 = if_res970;} else {var if_res971 = fold_var1728;}return if_res971;};return M8.alt_reverse(for_loop1727(M0.rnull,start1724));};var cl964 = function(start1734, end1735) {var start1736 = start1734;var end1737 = end1735;var inc1738 = 1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res972 = M0.rvoid();} else {var if_res972 = M9.__rjs_quoted__.check_range(start1736,end1737,inc1738);}if_res972;var for_loop1739 = function(fold_var1740, pos1741) {if (M0.__lt_(pos1741,end1737)!==false) {var i1742 = pos1741;if (true!==false) {var fold_var1744 = fold_var1740;var fold_var1745 = M0.cons(i1742,fold_var1744);var fold_var1743 = M0.values(fold_var1745);if (true!==false) {var if_res973 = M0.not(false);} else {var if_res973 = false;}if (if_res973!==false) {var if_res974 = for_loop1739(fold_var1743,pos1741+inc1738);} else {var if_res974 = fold_var1743;}var if_res975 = if_res974;} else {var if_res975 = fold_var1740;}var if_res976 = if_res975;} else {var if_res976 = fold_var1740;}return if_res976;};return M8.alt_reverse(for_loop1739(M0.rnull,start1736));};var cl965 = function(start1746, end1747, step1748) {var start1749 = start1746;var end1750 = end1747;var inc1751 = step1748;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res977 = M0.rvoid();} else {var if_res977 = M9.__rjs_quoted__.check_range(start1749,end1750,inc1751);}if_res977;var for_loop1752 = function(fold_var1753, pos1754) {if (M0.__gt__eq_(step1748,0)!==false) {var if_res978 = M0.__lt_(pos1754,end1750);} else {var if_res978 = M0.__gt_(pos1754,end1750);}if (if_res978!==false) {var i1755 = pos1754;if (true!==false) {var fold_var1757 = fold_var1753;var fold_var1758 = M0.cons(i1755,fold_var1757);var fold_var1756 = M0.values(fold_var1758);if (true!==false) {var if_res979 = M0.not(false);} else {var if_res979 = false;}if (if_res979!==false) {var if_res980 = for_loop1752(fold_var1756,pos1754+inc1751);} else {var if_res980 = fold_var1756;}var if_res981 = if_res980;} else {var if_res981 = fold_var1753;}var if_res982 = if_res981;} else {var if_res982 = fold_var1753;}return if_res982;};return M8.alt_reverse(for_loop1752(M0.rnull,start1749));};var range1722 = $rjs_core.attachProcedureArity(function() {var fixed_lam966 = {'1':cl963,'2':cl964,'3':cl965}[arguments.length];if (fixed_lam966!==undefined) {return fixed_lam966.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2,3]);var range_proc = range1722;var cl983 = function(start1760, end1761) {var start1762 = start1760;var end1763 = end1761;var inc1764 = 1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res986 = M0.rvoid();} else {var if_res986 = M9.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start1762,end1763,inc1764);}if_res986;var for_loop1765 = function(fold_var1766, pos1767) {if (M0.__lt__eq_(pos1767,end1763)!==false) {var i1768 = pos1767;if (true!==false) {var fold_var1770 = fold_var1766;var fold_var1771 = M0.cons(i1768,fold_var1770);var fold_var1769 = M0.values(fold_var1771);if (true!==false) {var if_res987 = M0.not(false);} else {var if_res987 = false;}if (if_res987!==false) {var if_res988 = for_loop1765(fold_var1769,pos1767+inc1764);} else {var if_res988 = fold_var1769;}var if_res989 = if_res988;} else {var if_res989 = fold_var1766;}var if_res990 = if_res989;} else {var if_res990 = fold_var1766;}return if_res990;};return M8.alt_reverse(for_loop1765(M0.rnull,start1762));};var cl984 = function(start1772, end1773, step1774) {var start1775 = start1772;var end1776 = end1773;var inc1777 = step1774;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res991 = M0.rvoid();} else {var if_res991 = M9.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start1775,end1776,inc1777);}if_res991;var for_loop1778 = function(fold_var1779, pos1780) {if (M0.__gt__eq_(step1774,0)!==false) {var if_res992 = M0.__lt__eq_(pos1780,end1776);} else {var if_res992 = M0.__gt__eq_(pos1780,end1776);}if (if_res992!==false) {var i1781 = pos1780;if (true!==false) {var fold_var1783 = fold_var1779;var fold_var1784 = M0.cons(i1781,fold_var1783);var fold_var1782 = M0.values(fold_var1784);if (true!==false) {var if_res993 = M0.not(false);} else {var if_res993 = false;}if (if_res993!==false) {var if_res994 = for_loop1778(fold_var1782,pos1780+inc1777);} else {var if_res994 = fold_var1782;}var if_res995 = if_res994;} else {var if_res995 = fold_var1779;}var if_res996 = if_res995;} else {var if_res996 = fold_var1779;}return if_res996;};return M8.alt_reverse(for_loop1778(M0.rnull,start1775));};var inclusive_range1759 = $rjs_core.attachProcedureArity(function() {var fixed_lam985 = {'2':cl983,'3':cl984}[arguments.length];if (fixed_lam985!==undefined) {return fixed_lam985.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var inclusive_range_proc = inclusive_range1759;var cl997 = function(f1785, l1786) {return M0.apply(M0.append,M3.map(f1785,l1786));};var cl998 = function(f1787, l11788, l21789) {return M0.apply(M0.append,M3.map(f1787,l11788,l21789));};var cl999 = $rjs_core.attachProcedureArity(function(f1790, l1791, ...ls17921002) {var ls1792 = $rjs_core.Pair.listFromArray(ls17921002);return M0.apply(M0.append,M0.apply(M3.map,f1790,l1791,ls1792));});var append_map = $rjs_core.attachProcedureArity(function() {var fixed_lam1000 = {'2':cl997,'3':cl998}[arguments.length];if (fixed_lam1000!==undefined) {return fixed_lam1000.apply(null,arguments);} else {if (M0.__gt__eq_(cl999.length,1)!==false) {var if_res1001 = cl999.apply(null,arguments);} else {var if_res1001 = M0.error($rjs_core.UString.make("case-lambda: invalid case"));}return if_res1001;}},[M0.make_arity_at_least(2)]);var filter_not = function(f1793, list1794) {if (M0.procedure_p(f1793)!==false) {var if_res1003 = M0.procedure_arity_includes_p(f1793,1);} else {var if_res1003 = false;}if (if_res1003!==false) {var if_res1004 = M0.rvoid();} else {var if_res1004 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,f1793,list1794);}if_res1004;if (M0.list_p(list1794)!==false) {var if_res1005 = M0.rvoid();} else {var if_res1005 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("list?"),1,f1793,list1794);}if_res1005;var loop1795 = function(l1796, result1797) {if (M0.null_p(l1796)!==false) {var if_res1008 = M8.alt_reverse(result1797);} else {var temp1007 = M0.cdr(l1796);if (f1793(M0.car(l1796))!==false) {var if_res1006 = result1797;} else {var if_res1006 = M0.cons(M0.car(l1796),result1797);}var if_res1008 = loop1795(temp1007,if_res1006);}return if_res1008;};return loop1795(list1794,M0.rnull);};var shuffle = function(l1798) {if (M0.list_p(l1798)!==false) {var if_res1009 = M0.rvoid();} else {var if_res1009 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("shuffle"),$rjs_core.UString.make("list?"),0,l1798);}if_res1009;var let_result1010 = M0.values();var a1799 = M0.make_vector(M0.length(l1798));var lst1800 = l1798;var start1801 = 0;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1011 = M0.rvoid();} else {var if_res1011 = M9.__rjs_quoted__.check_list(lst1800);}if_res1011;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1012 = M0.rvoid();} else {var if_res1012 = M9.__rjs_quoted__.check_naturals(start1801);}if_res1012;var for_loop1802 = function(lst1803, pos1804) {if (M0.pair_p(lst1803)!==false) {var if_res1013 = true;} else {var if_res1013 = false;}if (if_res1013!==false) {var x1805 = M10.unsafe_car(lst1803);var rest1806 = M10.unsafe_cdr(lst1803);var i1807 = pos1804;if (true!==false) {var if_res1014 = true;} else {var if_res1014 = false;}if (if_res1014!==false) {var j1808 = M1.random(M0.add1(i1807));if (M0.__eq_(j1808,i1807)!==false) {var if_res1015 = M0.rvoid();} else {var if_res1015 = M0.vector_set_bang_(a1799,i1807,M0.vector_ref(a1799,j1808));}if_res1015;M0.vector_set_bang_(a1799,j1808,x1805);var let_result1016 = M0.values();var let_result1017 = M0.values();if (true!==false) {if (true!==false) {var if_res1018 = M0.not(false);} else {var if_res1018 = false;}var if_res1019 = if_res1018;} else {var if_res1019 = false;}if (if_res1019!==false) {var if_res1020 = for_loop1802(rest1806,pos1804+1);} else {var if_res1020 = M0.values();}var if_res1021 = if_res1020;} else {var if_res1021 = M0.values();}var if_res1022 = if_res1021;} else {var if_res1022 = M0.values();}return if_res1022;};for_loop1802(lst1800,start1801);M0.rvoid();return M0.vector__gt_list(a1799);};var combinations1809 = function(l371810, k361811) {var l1812 = l371810;if (false!==false) {var if_res1023 = false;} else {var if_res1023 = k361811;}var k1813 = if_res1023;var let_result1024 = M9.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),in_combinations(l1812,k1813));var pos__gt_vals1814 = let_result1024.getAt(0);var pos_pre_inc1815 = let_result1024.getAt(1);var pos_next1816 = let_result1024.getAt(2);var init1817 = let_result1024.getAt(3);var pos_cont_p1818 = let_result1024.getAt(4);var val_cont_p1819 = let_result1024.getAt(5);var all_cont_p1820 = let_result1024.getAt(6);M0.rvoid();var for_loop1821 = function(fold_var1822, pos1823) {if (pos_cont_p1818!==false) {var if_res1025 = pos_cont_p1818(pos1823);} else {var if_res1025 = true;}if (if_res1025!==false) {var x1827 = pos__gt_vals1814(pos1823);if (all_cont_p1820!==false) {var if_res1026 = function(pos1828) {return all_cont_p1820(pos1828,x1827);};} else {var if_res1026 = false;}var let_result1027 = M0.values(x1827,if_res1026);var x1824 = let_result1027.getAt(0);var all_cont_p_by_pos1825 = let_result1027.getAt(1);if (pos_pre_inc1815!==false) {var if_res1028 = pos_pre_inc1815(pos1823);} else {var if_res1028 = pos1823;}var pos1826 = if_res1028;if (val_cont_p1819!==false) {var if_res1029 = val_cont_p1819(x1824);} else {var if_res1029 = true;}if (if_res1029!==false) {var fold_var1830 = fold_var1822;var fold_var1831 = M0.cons(x1824,fold_var1830);var fold_var1829 = M0.values(fold_var1831);if (all_cont_p_by_pos1825!==false) {var if_res1030 = all_cont_p_by_pos1825(pos1826);} else {var if_res1030 = true;}if (if_res1030!==false) {var if_res1031 = M0.not(false);} else {var if_res1031 = false;}if (if_res1031!==false) {var if_res1032 = for_loop1821(fold_var1829,pos_next1816(pos1826));} else {var if_res1032 = fold_var1829;}var if_res1033 = if_res1032;} else {var if_res1033 = fold_var1822;}var if_res1034 = if_res1033;} else {var if_res1034 = fold_var1822;}return if_res1034;};return M8.alt_reverse(for_loop1821(M0.rnull,init1817));};var cl1035 = function(l1832) {return combinations1809(l1832,false);};var cl1036 = function(l1833, k361834) {return combinations1809(l1833,k361834);};var combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam1037 = {'1':cl1035,'2':cl1036}[arguments.length];if (fixed_lam1037!==undefined) {return fixed_lam1037.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var in_combinations1835 = function(l391836, k381837) {var l1838 = l391836;if (false!==false) {var if_res1038 = false;} else {var if_res1038 = k381837;}var k1839 = if_res1038;if (M0.list_p(l1838)!==false) {var if_res1039 = M0.rvoid();} else {var if_res1039 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("list?"),0,l1838);}if_res1039;var let_result1040 = M0.values();if (k1839!==false) {var if_res1041 = M0.not(M0.exact_nonnegative_integer_p(k1839));} else {var if_res1041 = false;}if (if_res1041!==false) {var if_res1042 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l1838,k1839);} else {var if_res1042 = M0.rvoid();}if_res1042;var let_result1043 = M0.values();var v1840 = M0.list__gt_vector(l1838);var N1841 = M0.vector_length(v1840);var N_11842 = N1841-1;if (M0.not(k1839)!==false) {var limit1844 = M0.expt(2,N1841);var curr_box1845 = M0.box(0);var if_res1080 = function() {var curr1846 = M0.unbox(curr_box1845);if (M0.__lt_(curr1846,limit1844)!==false) {var start1847 = N_11842;var end1848 = -1;var inc1849 = -1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1045 = M0.rvoid();} else {var if_res1045 = M9.__rjs_quoted__.check_range(start1847,end1848,inc1849);}if_res1045;var for_loop1850 = function(acc1851, pos1852) {if (M0.__gt_(pos1852,end1848)!==false) {var i1853 = pos1852;if (true!==false) {var acc1855 = acc1851;if (M0.bitwise_bit_set_p(curr1846,i1853)!==false) {var if_res1046 = M0.cons(M0.vector_ref(v1840,i1853),acc1855);} else {var if_res1046 = acc1855;}var acc1856 = if_res1046;var acc1854 = M0.values(acc1856);if (true!==false) {var if_res1047 = M0.not(false);} else {var if_res1047 = false;}if (if_res1047!==false) {var if_res1048 = for_loop1850(acc1854,pos1852+inc1849);} else {var if_res1048 = acc1854;}var if_res1049 = if_res1048;} else {var if_res1049 = acc1851;}var if_res1050 = if_res1049;} else {var if_res1050 = acc1851;}return if_res1050;};var begin_res1044 = for_loop1850($rjs_core.Pair.makeList(),start1847);M0.set_box_bang_(curr_box1845,curr1846+1);var if_res1051 = begin_res1044;} else {var if_res1051 = false;}return if_res1051;};} else {if (M0.__lt_(N1841,k1839)!==false) {var if_res1079 = function() {return false;};} else {var running_p1857 = true;var k_times_1858 = M2.build_vector(k1839,function(i1859) {return i1859;});var k_11860 = k1839-1;var if_res1079 = function() {if (running_p1857!==false) {var vec1863 = k_times_1858;M9.__rjs_quoted__.check_vector(vec1863);var let_result1053 = M0.values(vec1863,M10.unsafe_vector_length(vec1863));var vec1861 = let_result1053.getAt(0);var len1862 = let_result1053.getAt(1);false;var for_loop1864 = function(fold_var1865, pos1866) {if (M10.unsafe_fx_lt_(pos1866,len1862)!==false) {var i1867 = M10.unsafe_vector_ref(vec1861,pos1866);if (true!==false) {var fold_var1869 = fold_var1865;var fold_var1870 = M0.cons(M0.vector_ref(v1840,i1867),fold_var1869);var fold_var1868 = M0.values(fold_var1870);if (true!==false) {var if_res1054 = M0.not(false);} else {var if_res1054 = false;}if (if_res1054!==false) {var if_res1055 = for_loop1864(fold_var1868,M10.unsafe_fx_plus_(1,pos1866));} else {var if_res1055 = fold_var1868;}var if_res1056 = if_res1055;} else {var if_res1056 = fold_var1865;}var if_res1057 = if_res1056;} else {var if_res1057 = fold_var1865;}return if_res1057;};var begin_res1052 = M8.alt_reverse(for_loop1864(M0.rnull,0));var index_to_change1871 = false;var start1872 = k_11860;var end1873 = -1;var inc1874 = -1;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1058 = M0.rvoid();} else {var if_res1058 = M9.__rjs_quoted__.check_range(start1872,end1873,inc1874);}if_res1058;var for_loop1875 = function(pos1876) {if (M0.__gt_(pos1876,end1873)!==false) {var i1877 = pos1876;if (true!==false) {var next_k_proc1878 = function() {if (true!==false) {var if_res1059 = for_loop1875(pos1876+inc1874);} else {var if_res1059 = M0.values();}return if_res1059;};if (M0.not(M0.eq_p(M0.vector_ref(k_times_1858,i1877),i1877+N1841+M0.__(k1839)))!==false) {index_to_change1871 = i1877;var if_res1060 = true;} else {var if_res1060 = false;}if (if_res1060!==false) {var if_res1063 = M0.values();} else {M0.rvoid();var let_result1061 = M0.values();if (false!==false) {var if_res1062 = M0.values();} else {var if_res1062 = next_k_proc1878();}var if_res1063 = if_res1062;}var if_res1064 = if_res1063;} else {var if_res1064 = M0.values();}var if_res1065 = if_res1064;} else {var if_res1065 = M0.values();}return if_res1065;};for_loop1875(start1872);M0.rvoid();if (index_to_change1871!==false) {var val_to_change1879 = M0.add1(M0.vector_ref(k_times_1858,index_to_change1871));var start1880 = index_to_change1871;var end1881 = k1839;var inc1882 = 1;var start1883 = val_to_change1879;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1066 = M0.rvoid();} else {var if_res1066 = M9.__rjs_quoted__.check_range(start1880,end1881,inc1882);}if_res1066;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1067 = M0.rvoid();} else {var if_res1067 = M9.__rjs_quoted__.check_naturals(start1883);}if_res1067;var for_loop1884 = function(pos1885, pos1886) {if (M0.__lt_(pos1885,end1881)!==false) {var if_res1068 = true;} else {var if_res1068 = false;}if (if_res1068!==false) {var i1887 = pos1885;var v1888 = pos1886;if (true!==false) {var if_res1069 = true;} else {var if_res1069 = false;}if (if_res1069!==false) {M0.vector_set_bang_(k_times_1858,i1887,v1888);var let_result1070 = M0.values();var let_result1071 = M0.values();if (true!==false) {if (true!==false) {var if_res1072 = M0.not(false);} else {var if_res1072 = false;}var if_res1073 = if_res1072;} else {var if_res1073 = false;}if (if_res1073!==false) {var if_res1074 = for_loop1884(pos1885+inc1882,pos1886+1);} else {var if_res1074 = M0.values();}var if_res1075 = if_res1074;} else {var if_res1075 = M0.values();}var if_res1076 = if_res1075;} else {var if_res1076 = M0.values();}return if_res1076;};for_loop1884(start1880,start1883);var if_res1077 = M0.rvoid();} else {running_p1857 = false;var if_res1077 = null;}if_res1077;var if_res1078 = begin_res1052;} else {var if_res1078 = false;}return if_res1078;};}var if_res1080 = if_res1079;}var gen_combinations1843 = if_res1080;return M9.__rjs_quoted__.in_producer(gen_combinations1843,false);};var cl1081 = function(l1889) {return in_combinations1835(l1889,false);};var cl1082 = function(l1890, k381891) {return in_combinations1835(l1890,k381891);};var in_combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam1083 = {'1':cl1081,'2':cl1082}[arguments.length];if (fixed_lam1083!==undefined) {return fixed_lam1083.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var swap_plus_flip = function(l1892, i1893, j1894) {var tmp1895 = j1894;if (M0.equal_p(tmp1895,0)!==false) {var if_res1091 = M0.list_times_(M0.cadr(l1892),M0.car(l1892),M0.cddr(l1892));} else {if (M0.equal_p(tmp1895,1)!==false) {var a1896 = M0.car(l1892);var b1897 = M0.cadr(l1892);var c1898 = M0.caddr(l1892);var l1899 = M0.cdddr(l1892);var tmp1900 = i1893;if (M0.equal_p(tmp1900,0)!==false) {var if_res1084 = M0.list_times_(b1897,c1898,a1896,l1899);} else {var if_res1084 = M0.list_times_(c1898,a1896,b1897,l1899);}var if_res1090 = if_res1084;} else {if (M0.equal_p(tmp1895,2)!==false) {var a1901 = M0.car(l1892);var b1902 = M0.cadr(l1892);var c1903 = M0.caddr(l1892);var d1904 = M0.cadddr(l1892);var l1905 = M0.cddddr(l1892);var tmp1906 = i1893;if (M0.equal_p(tmp1906,0)!==false) {var if_res1086 = M0.list_times_(c1903,b1902,d1904,a1901,l1905);} else {if (M0.equal_p(tmp1906,1)!==false) {var if_res1085 = M0.list_times_(c1903,d1904,a1901,b1902,l1905);} else {var if_res1085 = M0.list_times_(d1904,b1902,a1901,c1903,l1905);}var if_res1086 = if_res1085;}var if_res1089 = if_res1086;} else {var loop1907 = function(n1908, l11909, r11910) {if (M0.__gt_(n1908,0)!==false) {var if_res1088 = loop1907(M0.sub1(n1908),M0.cons(M0.car(r11910),l11909),M0.cdr(r11910));} else {var loop1911 = function(n1912, l21913, r21914) {if (M0.__gt_(n1912,0)!==false) {var if_res1087 = loop1911(M0.sub1(n1912),M0.cons(M0.car(r21914),l21913),M0.cdr(r21914));} else {var if_res1087 = M5.__rjs_quoted__.qq_append(l21913,M0.list_times_(M0.car(r21914),M5.__rjs_quoted__.qq_append(l11909,M0.list_times_(M0.car(r11910),M0.cdr(r21914)))));}return if_res1087;};var if_res1088 = loop1911(j1894-i1893,$rjs_core.Pair.makeList(),M0.cdr(r11910));}return if_res1088;};var if_res1089 = loop1907(i1893,$rjs_core.Pair.makeList(),l1892);}var if_res1090 = if_res1089;}var if_res1091 = if_res1090;}return if_res1091;};var permutations = function(l1915) {if (M0.not(M0.list_p(l1915))!==false) {var if_res1098 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("list?"),0,l1915);} else {var or_part1916 = M0.null_p(l1915);if (or_part1916!==false) {var if_res1092 = or_part1916;} else {var if_res1092 = M0.null_p(M0.cdr(l1915));}if (if_res1092!==false) {var if_res1097 = M0.list(l1915);} else {var N1917 = M0.length(l1915)-2;if (M0.__gt_(N1917,254)!==false) {var if_res1093 = M0.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l1915);} else {var if_res1093 = M0.rvoid();}if_res1093;var let_result1094 = M0.values();var c1918 = M0.make_bytes(M0.add1(N1917),0);var loop1919 = function(i1920, acc1921) {var ci1922 = M0.bytes_ref(c1918,i1920);if (M0.__lt__eq_(ci1922,i1920)!==false) {M0.bytes_set_bang_(c1918,i1920,M0.add1(ci1922));var if_res1096 = loop1919(0,M0.cons(swap_plus_flip(M0.car(acc1921),ci1922,i1920),acc1921));} else {if (M0.__lt_(i1920,N1917)!==false) {M0.bytes_set_bang_(c1918,i1920,0);var if_res1095 = loop1919(M0.add1(i1920),acc1921);} else {var if_res1095 = acc1921;}var if_res1096 = if_res1095;}return if_res1096;};var if_res1097 = loop1919(0,M0.list(M8.alt_reverse(l1915)));}var if_res1098 = if_res1097;}return if_res1098;};var in_permutations = function(l1923) {if (M0.not(M0.list_p(l1923))!==false) {var if_res1107 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-permutations"),$rjs_core.UString.make("list?"),0,l1923);} else {var or_part1924 = M0.null_p(l1923);if (or_part1924!==false) {var if_res1099 = or_part1924;} else {var if_res1099 = M0.null_p(M0.cdr(l1923));}if (if_res1099!==false) {var if_res1106 = M9.__rjs_quoted__.in_value(l1923);} else {var N1925 = M0.length(l1923)-2;if (M0.__gt_(N1925,254)!==false) {var if_res1100 = M0.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l1923);} else {var if_res1100 = M0.rvoid();}if_res1100;var let_result1101 = M0.values();var c1926 = M0.make_bytes(M0.add1(N1925),0);var i1927 = 0;var cur1928 = M8.alt_reverse(l1923);var next1929 = function() {var r1930 = cur1928;var ci1931 = M0.bytes_ref(c1926,i1927);if (M0.__lt__eq_(ci1931,i1927)!==false) {M0.bytes_set_bang_(c1926,i1927,M0.add1(ci1931));var begin_res1102 = swap_plus_flip(cur1928,ci1931,i1927);i1927 = 0;var if_res1104 = begin_res1102;} else {if (M0.__lt_(i1927,N1925)!==false) {M0.bytes_set_bang_(c1926,i1927,0);i1927 = M0.add1(i1927);var if_res1103 = next1929();} else {var if_res1103 = false;}var if_res1104 = if_res1103;}return if_res1104;};var if_res1106 = M9.__rjs_quoted__.in_producer(function() {var begin_res1105 = cur1928;cur1928 = next1929();return begin_res1105;},false);}var if_res1107 = if_res1106;}return if_res1107;};var mk_min = function(cmp1932, name1933, f1934, xs1935) {if (M0.procedure_p(f1934)!==false) {var if_res1108 = M0.procedure_arity_includes_p(f1934,1);} else {var if_res1108 = false;}if (if_res1108!==false) {var if_res1109 = M0.rvoid();} else {var if_res1109 = M0.raise_argument_error(name1933,$rjs_core.UString.make("(any/c . -> . real?)"),0,f1934,xs1935);}if_res1109;if (M0.list_p(xs1935)!==false) {var if_res1110 = M0.pair_p(xs1935);} else {var if_res1110 = false;}if (if_res1110!==false) {var if_res1111 = M0.rvoid();} else {var if_res1111 = M0.raise_argument_error(name1933,$rjs_core.UString.make("(and/c list? (not/c empty?))"),1,f1934,xs1935);}if_res1111;var init_min_var1936 = f1934(M0.car(xs1935));if (M0.real_p(init_min_var1936)!==false) {var if_res1112 = M0.rvoid();} else {var if_res1112 = M0.raise_result_error(name1933,$rjs_core.UString.make("real?"),init_min_var1936);}if_res1112;var loop1937 = function(min1938, min_var1939, xs1940) {if (M0.null_p(xs1940)!==false) {var if_res1115 = min1938;} else {var new_min1941 = f1934(M0.car(xs1940));if (M0.real_p(new_min1941)!==false) {var if_res1113 = M0.rvoid();} else {var if_res1113 = M0.raise_result_error(name1933,$rjs_core.UString.make("real?"),new_min1941);}if_res1113;if (cmp1932(new_min1941,min_var1939)!==false) {var if_res1114 = loop1937(M0.car(xs1940),new_min1941,M0.cdr(xs1940));} else {var if_res1114 = loop1937(min1938,min_var1939,M0.cdr(xs1940));}var if_res1115 = if_res1114;}return if_res1115;};return loop1937(M0.car(xs1935),init_min_var1936,M0.cdr(xs1935));};var argmin = function(f1942, xs1943) {return mk_min(M0.__lt_,$rjs_core.PrimitiveSymbol.make("argmin"),f1942,xs1943);};var argmax = function(f1944, xs1945) {return mk_min(M0.__gt_,$rjs_core.PrimitiveSymbol.make("argmax"),f1944,xs1945);};var group_by1946 = function(key411947, l421948, __eq__p401949) {var key1950 = key411947;var l1951 = l421948;if (M0.eq_p(__eq__p401949,M10.unsafe_undefined)!==false) {var if_res1116 = M0.equal_p;} else {var if_res1116 = __eq__p401949;}var __eq__p1952 = if_res1116;if (M0.procedure_p(key1950)!==false) {var if_res1117 = M0.procedure_arity_includes_p(key1950,1);} else {var if_res1117 = false;}if (if_res1117!==false) {var if_res1118 = M0.rvoid();} else {var if_res1118 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(-> any/c any/c)"),0,key1950,l1951);}if_res1118;var let_result1119 = M0.values();if (M0.procedure_p(__eq__p1952)!==false) {var if_res1120 = M0.procedure_arity_includes_p(__eq__p1952,2);} else {var if_res1120 = false;}if (if_res1120!==false) {var if_res1121 = M0.rvoid();} else {var if_res1121 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,key1950,l1951,__eq__p1952);}if_res1121;var let_result1122 = M0.values();if (M0.list_p(l1951)!==false) {var if_res1123 = M0.rvoid();} else {var if_res1123 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("list?"),1,key1950,l1951);}if_res1123;var let_result1124 = M0.values();var alist_update1953 = function(al1954, k1955, up1956, fail1957) {var loop1958 = function(al1959) {if (M0.null_p(al1959)!==false) {var if_res1126 = M0.list(M0.cons(k1955,up1956($rjs_core.Pair.makeList())));} else {if (__eq__p1952(M0.car(M0.car(al1959)),k1955)!==false) {var if_res1125 = M0.cons(M0.cons(k1955,up1956(M0.cdr(M0.car(al1959)))),M0.cdr(al1959));} else {var if_res1125 = M0.cons(M0.car(al1959),loop1958(M0.cdr(al1959)));}var if_res1126 = if_res1125;}return if_res1126;};return loop1958(al1954);};if (M0.equal_p(__eq__p1952,M0.eq_p)!==false) {var if_res1129 = M0.values(M0.hasheq(),M7.hash_update);} else {if (M0.equal_p(__eq__p1952,M0.eqv_p)!==false) {var if_res1128 = M0.values(M0.hasheqv(),M7.hash_update);} else {if (M0.equal_p(__eq__p1952,M0.equal_p)!==false) {var if_res1127 = M0.values(M0.hash(),M7.hash_update);} else {var if_res1127 = M0.values($rjs_core.Pair.makeList(),alist_update1953);}var if_res1128 = if_res1127;}var if_res1129 = if_res1128;}var let_result1130 = if_res1129;var base1960 = let_result1130.getAt(0);var update1961 = let_result1130.getAt(1);var lst1963 = l1951;var start1964 = 0;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1131 = M0.rvoid();} else {var if_res1131 = M9.__rjs_quoted__.check_list(lst1963);}if_res1131;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1132 = M0.rvoid();} else {var if_res1132 = M9.__rjs_quoted__.check_naturals(start1964);}if_res1132;var for_loop1965 = function(res1966, lst1967, pos1968) {if (M0.pair_p(lst1967)!==false) {var if_res1133 = true;} else {var if_res1133 = false;}if (if_res1133!==false) {var elt1969 = M10.unsafe_car(lst1967);var rest1970 = M10.unsafe_cdr(lst1967);var idx1971 = pos1968;if (true!==false) {var if_res1134 = true;} else {var if_res1134 = false;}if (if_res1134!==false) {var res1973 = res1966;var k1975 = key1950(elt1969);var v1976 = M0.cons(idx1971,elt1969);var res1974 = update1961(res1973,k1975,function(o1977) {return M0.cons(v1976,o1977);},$rjs_core.Pair.makeList());var res1972 = M0.values(res1974);if (true!==false) {if (true!==false) {var if_res1135 = M0.not(false);} else {var if_res1135 = false;}var if_res1136 = if_res1135;} else {var if_res1136 = false;}if (if_res1136!==false) {var if_res1137 = for_loop1965(res1972,rest1970,pos1968+1);} else {var if_res1137 = res1972;}var if_res1138 = if_res1137;} else {var if_res1138 = res1966;}var if_res1139 = if_res1138;} else {var if_res1139 = res1966;}return if_res1139;};var classes1962 = for_loop1965(base1960,lst1963,start1964);if (M0.list_p(classes1962)!==false) {var lst1979 = classes1962;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1140 = M0.rvoid();} else {var if_res1140 = M9.__rjs_quoted__.check_list(lst1979);}if_res1140;var for_loop1980 = function(fold_var1981, lst1982) {if (M0.pair_p(lst1982)!==false) {var p1983 = M10.unsafe_car(lst1982);var rest1984 = M10.unsafe_cdr(lst1982);if (true!==false) {var fold_var1986 = fold_var1981;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__338851988 = M2.__rjs_quoted__.sort7;var temp531989 = M0.cdr(p1983);var __lt_541990 = M0.__lt_;var car551991 = M0.car;if (M0.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1141 = M2.__rjs_quoted__.sort(false,car551991,temp531989,__lt_541990);} else {var if_res1141 = M0.checked_procedure_check_and_extract(M4.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__338851988,M4.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M0.list(car551991),temp531989,__lt_541990);}var fold_var1987 = M0.cons(if_res1141,fold_var1986);var fold_var1985 = M0.values(fold_var1987);if (true!==false) {var if_res1142 = M0.not(false);} else {var if_res1142 = false;}if (if_res1142!==false) {var if_res1143 = for_loop1980(fold_var1985,rest1984);} else {var if_res1143 = fold_var1985;}var if_res1144 = if_res1143;} else {var if_res1144 = fold_var1981;}var if_res1145 = if_res1144;} else {var if_res1145 = fold_var1981;}return if_res1145;};var if_res1153 = M8.alt_reverse(for_loop1980(M0.rnull,lst1979));} else {var ht1992 = classes1962;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1146 = M0.rvoid();} else {var if_res1146 = M9.__rjs_quoted__.check_in_hash(ht1992);}if_res1146;var for_loop1993 = function(fold_var1994, i1995) {if (i1995!==false) {var let_result1147 = M0.hash_iterate_key_plus_value(ht1992,i1995);var _1996 = let_result1147.getAt(0);var c1997 = let_result1147.getAt(1);if (true!==false) {var fold_var1999 = fold_var1994;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__339692001 = M2.__rjs_quoted__.sort7;var c562002 = c1997;var __lt_572003 = M0.__lt_;var car582004 = M0.car;if (M0.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1148 = M2.__rjs_quoted__.sort(false,car582004,c562002,__lt_572003);} else {var if_res1148 = M0.checked_procedure_check_and_extract(M4.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__339692001,M4.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M0.list(car582004),c562002,__lt_572003);}var fold_var2000 = M0.cons(if_res1148,fold_var1999);var fold_var1998 = M0.values(fold_var2000);if (true!==false) {var if_res1149 = M0.not(false);} else {var if_res1149 = false;}if (if_res1149!==false) {var if_res1150 = for_loop1993(fold_var1998,M0.hash_iterate_next(ht1992,i1995));} else {var if_res1150 = fold_var1998;}var if_res1151 = if_res1150;} else {var if_res1151 = fold_var1994;}var if_res1152 = if_res1151;} else {var if_res1152 = fold_var1994;}return if_res1152;};var if_res1153 = M8.alt_reverse(for_loop1993(M0.rnull,M0.hash_iterate_first(ht1992)));}var sorted_classes1978 = if_res1153;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__340862006 = M2.__rjs_quoted__.sort7;var sorted_classes592007 = sorted_classes1978;var __lt_602008 = M0.__lt_;var caar612009 = M0.caar;if (M0.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1154 = M2.__rjs_quoted__.sort(false,caar612009,sorted_classes592007,__lt_602008);} else {var if_res1154 = M0.checked_procedure_check_and_extract(M4.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__340862006,M4.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M0.list(caar612009),sorted_classes592007,__lt_602008);}var lst2005 = if_res1154;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1155 = M0.rvoid();} else {var if_res1155 = M9.__rjs_quoted__.check_list(lst2005);}if_res1155;var for_loop2010 = function(fold_var2011, lst2012) {if (M0.pair_p(lst2012)!==false) {var c2013 = M10.unsafe_car(lst2012);var rest2014 = M10.unsafe_cdr(lst2012);if (true!==false) {var fold_var2016 = fold_var2011;var fold_var2017 = M0.cons(M3.map(M0.cdr,c2013),fold_var2016);var fold_var2015 = M0.values(fold_var2017);if (true!==false) {var if_res1156 = M0.not(false);} else {var if_res1156 = false;}if (if_res1156!==false) {var if_res1157 = for_loop2010(fold_var2015,rest2014);} else {var if_res1157 = fold_var2015;}var if_res1158 = if_res1157;} else {var if_res1158 = fold_var2011;}var if_res1159 = if_res1158;} else {var if_res1159 = fold_var2011;}return if_res1159;};return M8.alt_reverse(for_loop2010(M0.rnull,lst2005));};var cl1160 = function(key2018, l2019) {return group_by1946(key2018,l2019,M10.unsafe_undefined);};var cl1161 = function(key2020, l2021, __eq__p402022) {return group_by1946(key2020,l2021,__eq__p402022);};var group_by = $rjs_core.attachProcedureArity(function() {var fixed_lam1162 = {'2':cl1160,'3':cl1161}[arguments.length];if (fixed_lam1162!==undefined) {return fixed_lam1162.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cartesian_product = $rjs_core.attachProcedureArity(function(...ls20231163) {var ls2023 = $rjs_core.Pair.listFromArray(ls20231163);var let_result1164 = M9.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("l")),ls2023);var pos__gt_vals2024 = let_result1164.getAt(0);var pos_pre_inc2025 = let_result1164.getAt(1);var pos_next2026 = let_result1164.getAt(2);var init2027 = let_result1164.getAt(3);var pos_cont_p2028 = let_result1164.getAt(4);var val_cont_p2029 = let_result1164.getAt(5);var all_cont_p2030 = let_result1164.getAt(6);var start2031 = 0;if (M0.rvoid()!==false) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1165 = M0.rvoid();} else {var if_res1165 = M9.__rjs_quoted__.check_naturals(start2031);}var if_res1166 = if_res1165;} else {var if_res1166 = false;}if_res1166;var for_loop2032 = function(pos2033, pos2034) {if (pos_cont_p2028!==false) {var if_res1167 = pos_cont_p2028(pos2033);} else {var if_res1167 = true;}if (if_res1167!==false) {var if_res1168 = true;} else {var if_res1168 = false;}if (if_res1168!==false) {var l2039 = pos__gt_vals2024(pos2033);if (all_cont_p2030!==false) {var if_res1169 = function(pos2040) {return all_cont_p2030(pos2040,l2039);};} else {var if_res1169 = false;}var let_result1170 = M0.values(l2039,if_res1169);var l2035 = let_result1170.getAt(0);var all_cont_p_by_pos2036 = let_result1170.getAt(1);if (pos_pre_inc2025!==false) {var if_res1171 = pos_pre_inc2025(pos2033);} else {var if_res1171 = pos2033;}var pos2037 = if_res1171;var i2038 = pos2034;if (val_cont_p2029!==false) {var if_res1172 = val_cont_p2029(l2035);} else {var if_res1172 = true;}if (if_res1172!==false) {var if_res1173 = true;} else {var if_res1173 = false;}if (if_res1173!==false) {if (M0.list_p(l2035)!==false) {var if_res1174 = M0.rvoid();} else {var if_res1174 = M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("cartesian-product"),$rjs_core.UString.make("list?"),i2038,ls2023);}if_res1174;var let_result1175 = M0.values();var let_result1176 = M0.values();if (all_cont_p_by_pos2036!==false) {var if_res1177 = all_cont_p_by_pos2036(pos2037);} else {var if_res1177 = true;}if (if_res1177!==false) {var if_res1178 = true;} else {var if_res1178 = false;}if (if_res1178!==false) {var if_res1179 = M0.not(false);} else {var if_res1179 = false;}if (if_res1179!==false) {var if_res1180 = for_loop2032(pos_next2026(pos2037),pos2034+1);} else {var if_res1180 = M0.values();}var if_res1181 = if_res1180;} else {var if_res1181 = M0.values();}var if_res1182 = if_res1181;} else {var if_res1182 = M0.values();}return if_res1182;};for_loop2032(init2027,start2031);var let_result1183 = M0.values();M0.rvoid();var let_result1184 = M0.values();var cp_22041 = function(as2042, bs2043) {var lst2044 = as2042;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1185 = M0.rvoid();} else {var if_res1185 = M9.__rjs_quoted__.check_list(lst2044);}if_res1185;var for_loop2045 = function(fold_var2046, lst2047) {if (M0.pair_p(lst2047)!==false) {var i2048 = M10.unsafe_car(lst2047);var rest2049 = M10.unsafe_cdr(lst2047);if (true!==false) {var lst2051 = bs2043;if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res1186 = M0.rvoid();} else {var if_res1186 = M9.__rjs_quoted__.check_list(lst2051);}if_res1186;var for_loop2052 = function(fold_var2053, lst2054) {if (M0.pair_p(lst2054)!==false) {var j2055 = M10.unsafe_car(lst2054);var rest2056 = M10.unsafe_cdr(lst2054);if (true!==false) {var fold_var2058 = fold_var2053;var fold_var2059 = M0.cons(M0.cons(i2048,j2055),fold_var2058);var fold_var2057 = M0.values(fold_var2059);if (true!==false) {var if_res1187 = M0.not(false);} else {var if_res1187 = false;}if (if_res1187!==false) {var if_res1188 = for_loop2052(fold_var2057,rest2056);} else {var if_res1188 = fold_var2057;}var if_res1189 = if_res1188;} else {var if_res1189 = fold_var2053;}var if_res1190 = if_res1189;} else {var if_res1190 = fold_var2053;}return if_res1190;};var fold_var2050 = for_loop2052(fold_var2046,lst2051);if (true!==false) {var if_res1191 = M0.not(false);} else {var if_res1191 = false;}if (if_res1191!==false) {var if_res1192 = for_loop2045(fold_var2050,rest2049);} else {var if_res1192 = fold_var2050;}var if_res1193 = if_res1192;} else {var if_res1193 = fold_var2046;}var if_res1194 = if_res1193;} else {var if_res1194 = fold_var2046;}return if_res1194;};return M8.alt_reverse(for_loop2045(M0.rnull,lst2044));};return M2.foldr(cp_22041,M0.list(M0.list()),ls2023);});var remf = function(f2060, ls2061) {if (M0.list_p(ls2061)!==false) {var if_res1195 = M0.rvoid();} else {var if_res1195 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("list?"),1,f2060,ls2061);}if_res1195;if (M0.procedure_p(f2060)!==false) {var if_res1196 = M0.procedure_arity_includes_p(f2060,1);} else {var if_res1196 = false;}if (if_res1196!==false) {var if_res1197 = M0.rvoid();} else {var if_res1197 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("(-> any/c any/c)"),0,f2060,ls2061);}if_res1197;if (M0.null_p(ls2061)!==false) {var if_res1199 = $rjs_core.Pair.makeList();} else {if (f2060(M0.car(ls2061))!==false) {var if_res1198 = M0.cdr(ls2061);} else {var if_res1198 = M0.cons(M0.car(ls2061),remf(f2060,M0.cdr(ls2061)));}var if_res1199 = if_res1198;}return if_res1199;};var remf_times_ = function(f2062, ls2063) {if (M0.list_p(ls2063)!==false) {var if_res1200 = M0.rvoid();} else {var if_res1200 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("list?"),1,f2062,ls2063);}if_res1200;if (M0.procedure_p(f2062)!==false) {var if_res1201 = M0.procedure_arity_includes_p(f2062,1);} else {var if_res1201 = false;}if (if_res1201!==false) {var if_res1202 = M0.rvoid();} else {var if_res1202 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("(-> any/c any/c)"),0,f2062,ls2063);}if_res1202;if (M0.null_p(ls2063)!==false) {var if_res1204 = $rjs_core.Pair.makeList();} else {if (f2062(M0.car(ls2063))!==false) {var if_res1203 = remf_times_(f2062,M0.cdr(ls2063));} else {var if_res1203 = M0.cons(M0.car(ls2063),remf_times_(f2062,M0.cdr(ls2063)));}var if_res1204 = if_res1203;}return if_res1204;};var index_of2064 = function(ls442065, v452066, __eq__p432067) {var ls2068 = ls442065;var v2069 = v452066;if (M0.eq_p(__eq__p432067,M10.unsafe_undefined)!==false) {var if_res1205 = M0.equal_p;} else {var if_res1205 = __eq__p432067;}var __eq__p2070 = if_res1205;if (M0.list_p(ls2068)!==false) {var if_res1206 = M0.rvoid();} else {var if_res1206 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("list?"),0,ls2068,v2069);}if_res1206;if (M0.procedure_p(__eq__p2070)!==false) {var if_res1207 = M0.procedure_arity_includes_p(__eq__p2070,2);} else {var if_res1207 = false;}if (if_res1207!==false) {var if_res1208 = M0.rvoid();} else {var if_res1208 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls2068,v2069,__eq__p2070);}if_res1208;var loop2071 = function(ls2072, i2073) {if (M0.null_p(ls2072)!==false) {var if_res1210 = false;} else {if (__eq__p2070(M0.car(ls2072),v2069)!==false) {var if_res1209 = i2073;} else {var if_res1209 = loop2071(M0.cdr(ls2072),M0.add1(i2073));}var if_res1210 = if_res1209;}return if_res1210;};return loop2071(ls2068,0);};var cl1211 = function(ls2074, v2075) {return index_of2064(ls2074,v2075,M10.unsafe_undefined);};var cl1212 = function(ls2076, v2077, __eq__p432078) {return index_of2064(ls2076,v2077,__eq__p432078);};var index_of = $rjs_core.attachProcedureArity(function() {var fixed_lam1213 = {'2':cl1211,'3':cl1212}[arguments.length];if (fixed_lam1213!==undefined) {return fixed_lam1213.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var index_where = function(ls2079, f2080) {if (M0.list_p(ls2079)!==false) {var if_res1214 = M0.rvoid();} else {var if_res1214 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("list?"),0,ls2079,f2080);}if_res1214;if (M0.procedure_p(f2080)!==false) {var if_res1215 = M0.procedure_arity_includes_p(f2080,1);} else {var if_res1215 = false;}if (if_res1215!==false) {var if_res1216 = M0.rvoid();} else {var if_res1216 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls2079,f2080);}if_res1216;var loop2081 = function(ls2082, i2083) {if (M0.null_p(ls2082)!==false) {var if_res1218 = false;} else {if (f2080(M0.car(ls2082))!==false) {var if_res1217 = i2083;} else {var if_res1217 = loop2081(M0.cdr(ls2082),M0.add1(i2083));}var if_res1218 = if_res1217;}return if_res1218;};return loop2081(ls2079,0);};var indexes_of2084 = function(ls472085, v482086, __eq__p462087) {var ls2088 = ls472085;var v2089 = v482086;if (M0.eq_p(__eq__p462087,M10.unsafe_undefined)!==false) {var if_res1219 = M0.equal_p;} else {var if_res1219 = __eq__p462087;}var __eq__p2090 = if_res1219;if (M0.list_p(ls2088)!==false) {var if_res1220 = M0.rvoid();} else {var if_res1220 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("list?"),0,ls2088,v2089);}if_res1220;if (M0.procedure_p(__eq__p2090)!==false) {var if_res1221 = M0.procedure_arity_includes_p(__eq__p2090,2);} else {var if_res1221 = false;}if (if_res1221!==false) {var if_res1222 = M0.rvoid();} else {var if_res1222 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls2088,v2089,__eq__p2090);}if_res1222;var loop2091 = function(ls2092, i2093) {if (M0.null_p(ls2092)!==false) {var if_res1224 = $rjs_core.Pair.makeList();} else {if (__eq__p2090(M0.car(ls2092),v2089)!==false) {var if_res1223 = M0.cons(i2093,loop2091(M0.cdr(ls2092),M0.add1(i2093)));} else {var if_res1223 = loop2091(M0.cdr(ls2092),M0.add1(i2093));}var if_res1224 = if_res1223;}return if_res1224;};return loop2091(ls2088,0);};var cl1225 = function(ls2094, v2095) {return indexes_of2084(ls2094,v2095,M10.unsafe_undefined);};var cl1226 = function(ls2096, v2097, __eq__p462098) {return indexes_of2084(ls2096,v2097,__eq__p462098);};var indexes_of = $rjs_core.attachProcedureArity(function() {var fixed_lam1227 = {'2':cl1225,'3':cl1226}[arguments.length];if (fixed_lam1227!==undefined) {return fixed_lam1227.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var indexes_where = function(ls2099, f2100) {if (M0.list_p(ls2099)!==false) {var if_res1228 = M0.rvoid();} else {var if_res1228 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("list?"),0,ls2099,f2100);}if_res1228;if (M0.procedure_p(f2100)!==false) {var if_res1229 = M0.procedure_arity_includes_p(f2100,1);} else {var if_res1229 = false;}if (if_res1229!==false) {var if_res1230 = M0.rvoid();} else {var if_res1230 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls2099,f2100);}if_res1230;var loop2101 = function(ls2102, i2103) {if (M0.null_p(ls2102)!==false) {var if_res1232 = $rjs_core.Pair.makeList();} else {if (f2100(M0.car(ls2102))!==false) {var if_res1231 = M0.cons(i2103,loop2101(M0.cdr(ls2102),M0.add1(i2103)));} else {var if_res1231 = loop2101(M0.cdr(ls2102),M0.add1(i2103));}var if_res1232 = if_res1231;}return if_res1232;};return loop2101(ls2099,0);};var __rjs_quoted__ = {};__rjs_quoted__.remove_duplicates28 = remove_duplicates28;__rjs_quoted__.add_between = add_between;__rjs_quoted__.check_duplicates = check_duplicates;__rjs_quoted__.range_proc = range_proc;__rjs_quoted__.remove_duplicates = remove_duplicates;__rjs_quoted__.inclusive_range_proc = inclusive_range_proc;__rjs_quoted__.add_between23 = add_between23;__rjs_quoted__.check_duplicates35 = check_duplicates35;export { __rjs_quoted__,remf_times_,remf,cartesian_product,group_by,argmax,argmin,in_permutations,permutations,in_combinations,combinations,shuffle,filter_not,append_map,partition,count,filter_map,check_duplicates,remove_duplicates,add_between,flatten,append_times_,drop_common_prefix,take_common_prefix,split_common_prefix,list_prefix_p,splitf_at_right,dropf_right,takef_right,split_at_right,take_right,drop_right,splitf_at,dropf,takef,split_at,take,drop,indexes_where,indexes_of,index_where,index_of,list_set,list_update,make_list,empty,rest,last,last_pair,tenth,ninth,eighth,seventh,sixth,fifth,fourth,third,second,first };