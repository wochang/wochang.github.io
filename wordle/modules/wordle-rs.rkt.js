import * as $rjs_core from '../runtime/core.js';import * as M0 from "../collects/racket/private/modbeg.rkt.js";import * as M1 from "../links/racketscript-extras/racketscript/htdp/universe.rkt.js";import * as M2 from "../collects/racket/vector.rkt.js";import * as M3 from "../collects/racket/private/pre-base.rkt.js";import * as M4 from "../collects/racket/private/list-predicates.rkt.js";import * as M5 from "../collects/racket/private/map.rkt.js";import * as M6 from "./wordle-words.rkt.js";import * as M7 from "../runtime/kernel.rkt.js";import * as M8 from "../collects/racket/string.rkt.js";import * as M9 from "../links/racketscript-extras/racketscript/htdp/image.rkt.js";import * as M10 from "../collects/racket/private/for.rkt.js";import * as M11 from "../collects/racket/list.rkt.js";import * as M12 from "../collects/racket/private/member.rkt.js";import * as M13 from "../collects/racket/private/reverse.rkt.js";import * as M14 from "../runtime/unsafe.rkt.js";var let_result1 = M7.make_struct_type($rjs_core.PrimitiveSymbol.make("game"),false,2,0,false,M7.rnull,false,false,$rjs_core.Pair.makeList(0,1),false,$rjs_core.PrimitiveSymbol.make("game"));var struct_1 = let_result1.getAt(0);var make_2 = let_result1.getAt(1);var __p3 = let_result1.getAt(2);var __ref4 = let_result1.getAt(3);var __set_bang_5 = let_result1.getAt(4);var let_result2 = M7.values(struct_1,make_2,__p3,M7.make_struct_field_accessor(__ref4,0,$rjs_core.PrimitiveSymbol.make("guesses")),M7.make_struct_field_accessor(__ref4,1,$rjs_core.PrimitiveSymbol.make("current-guess")));var struct_game = let_result2.getAt(0);var game1 = let_result2.getAt(1);var game_p = let_result2.getAt(2);var game_guesses = let_result2.getAt(3);var game_current_guess = let_result2.getAt(4);var START_STATE = game1($rjs_core.Pair.makeList(),$rjs_core.UString.make(""));var ALL_WORDS = M6.WORDLE_WORDS;var NUM_WORDS = M7.length(ALL_WORDS);var random_word = function() {return M7.list_ref(ALL_WORDS,M3.random(NUM_WORDS));};var ANSWER = random_word();var game_update_current = function(g6, guess7) {return game1(game_guesses(g6),guess7);};var game_submit_guess = function(g8) {var guesses9 = game_guesses(g8);var current10 = game_current_guess(g8);var current_length11 = M7.string_length(current10);if (M7.__eq_(current_length11,5)!==false) {if (M12.member(current10,ALL_WORDS)!==false) {var if_res3 = game1(M7.cons(current10,guesses9),$rjs_core.UString.make(""));} else {var if_res3 = g8;}var if_res4 = if_res3;} else {var if_res4 = g8;}return if_res4;};var game_del_char = function(g12) {var current13 = game_current_guess(g12);var current_length14 = M7.string_length(current13);if (M7.zero_p(current_length14)!==false) {var if_res5 = $rjs_core.UString.make("");} else {var if_res5 = M7.substring(current13,0,M7.sub1(current_length14));}return game_update_current(g12,if_res5);};var game_add_char = function(g15, k16) {var current17 = game_current_guess(g15);var current_length18 = M7.string_length(current17);if (M7.__eq_(current_length18,5)!==false) {var if_res6 = current17;} else {var if_res6 = M7.string_append(current17,M7.string_downcase(k16));}return game_update_current(g15,if_res6);};var EMPTY_CANVAS = M9.empty_scene(300,400);var WRONG_COLOR = $rjs_core.UString.make("black");var CORRECT_COLOR = $rjs_core.UString.make("dark green");var MAYBE_COLOR = $rjs_core.UString.make("medium yellow");var GUESS_TILE_HEIGHT = 50;var GAP = 8;var CHARGAP = M9.rectangle(GAP,0,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("white"));var LINEGAP = M9.rectangle(0,GAP,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("white"));var BLANK = M9.square(GUESS_TILE_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray"));var WORD_LENGTH = 5;var MAX_GUESSES = 6;var GUESS_CHAR_FONT_SIZE = 32;var KEYBOARD_CHAR_FONT_SIZE = 32;var CURRENT_CHAR_VALID_COLOR = $rjs_core.UString.make("blue");var CURRENT_CHAR_INVALID_COLOR = $rjs_core.UString.make("black");var GUESS_CHAR_COLOR = $rjs_core.UString.make("white");var repeat = function(x19, n20) {var let_result7 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("m")),n20);var pos__gt_vals21 = let_result7.getAt(0);var pos_pre_inc22 = let_result7.getAt(1);var pos_next23 = let_result7.getAt(2);var init24 = let_result7.getAt(3);var pos_cont_p25 = let_result7.getAt(4);var val_cont_p26 = let_result7.getAt(5);var all_cont_p27 = let_result7.getAt(6);M7.rvoid();var for_loop28 = function(fold_var29, pos30) {if (pos_cont_p25!==false) {var if_res8 = pos_cont_p25(pos30);} else {var if_res8 = true;}if (if_res8!==false) {var m34 = pos__gt_vals21(pos30);if (all_cont_p27!==false) {var if_res9 = function(pos35) {return all_cont_p27(pos35,m34);};} else {var if_res9 = false;}var let_result10 = M7.values(m34,if_res9);var m31 = let_result10.getAt(0);var all_cont_p_by_pos32 = let_result10.getAt(1);if (pos_pre_inc22!==false) {var if_res11 = pos_pre_inc22(pos30);} else {var if_res11 = pos30;}var pos33 = if_res11;if (val_cont_p26!==false) {var if_res12 = val_cont_p26(m31);} else {var if_res12 = true;}if (if_res12!==false) {var fold_var37 = fold_var29;var fold_var38 = M7.cons(x19,fold_var37);var fold_var36 = M7.values(fold_var38);if (all_cont_p_by_pos32!==false) {var if_res13 = all_cont_p_by_pos32(pos33);} else {var if_res13 = true;}if (if_res13!==false) {var if_res14 = M7.not(false);} else {var if_res14 = false;}if (if_res14!==false) {var if_res15 = for_loop28(fold_var36,pos_next23(pos33));} else {var if_res15 = fold_var36;}var if_res16 = if_res15;} else {var if_res16 = fold_var29;}var if_res17 = if_res16;} else {var if_res17 = fold_var29;}return if_res17;};return M13.alt_reverse(for_loop28(M7.rnull,init24));};var img_join = function(imgs39, sep40, combiner41) {var let_result18 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("i")),imgs39);var pos__gt_vals42 = let_result18.getAt(0);var pos_pre_inc43 = let_result18.getAt(1);var pos_next44 = let_result18.getAt(2);var init45 = let_result18.getAt(3);var pos_cont_p46 = let_result18.getAt(4);var val_cont_p47 = let_result18.getAt(5);var all_cont_p48 = let_result18.getAt(6);M7.rvoid();var for_loop49 = function(img50, pos51) {if (pos_cont_p46!==false) {var if_res19 = pos_cont_p46(pos51);} else {var if_res19 = true;}if (if_res19!==false) {var i55 = pos__gt_vals42(pos51);if (all_cont_p48!==false) {var if_res20 = function(pos56) {return all_cont_p48(pos56,i55);};} else {var if_res20 = false;}var let_result21 = M7.values(i55,if_res20);var i52 = let_result21.getAt(0);var all_cont_p_by_pos53 = let_result21.getAt(1);if (pos_pre_inc43!==false) {var if_res22 = pos_pre_inc43(pos51);} else {var if_res22 = pos51;}var pos54 = if_res22;if (val_cont_p47!==false) {var if_res23 = val_cont_p47(i52);} else {var if_res23 = true;}if (if_res23!==false) {var img58 = img50;var img59 = combiner41(img58,i52,sep40);var img57 = M7.values(img59);if (all_cont_p_by_pos53!==false) {var if_res24 = all_cont_p_by_pos53(pos54);} else {var if_res24 = true;}if (if_res24!==false) {var if_res25 = M7.not(false);} else {var if_res25 = false;}if (if_res25!==false) {var if_res26 = for_loop49(img57,pos_next44(pos54));} else {var if_res26 = img57;}var if_res27 = if_res26;} else {var if_res27 = img50;}var if_res28 = if_res27;} else {var if_res28 = img50;}return if_res28;};return for_loop49(sep40,init45);};var render = function(g60) {var guesses61 = game_guesses(g60);var current62 = game_current_guess(g60);return M9.above(render_guesses(guesses61),render_current(current62),render_blanks(MAX_GUESSES-M7.length(guesses61)),render_keyboard(guesses61));};var render_guesses = function(guesses63) {var let_result29 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("guess")),guesses63);var pos__gt_vals64 = let_result29.getAt(0);var pos_pre_inc65 = let_result29.getAt(1);var pos_next66 = let_result29.getAt(2);var init67 = let_result29.getAt(3);var pos_cont_p68 = let_result29.getAt(4);var val_cont_p69 = let_result29.getAt(5);var all_cont_p70 = let_result29.getAt(6);M7.rvoid();var for_loop71 = function(img72, pos73) {if (pos_cont_p68!==false) {var if_res30 = pos_cont_p68(pos73);} else {var if_res30 = true;}if (if_res30!==false) {var guess77 = pos__gt_vals64(pos73);if (all_cont_p70!==false) {var if_res31 = function(pos78) {return all_cont_p70(pos78,guess77);};} else {var if_res31 = false;}var let_result32 = M7.values(guess77,if_res31);var guess74 = let_result32.getAt(0);var all_cont_p_by_pos75 = let_result32.getAt(1);if (pos_pre_inc65!==false) {var if_res33 = pos_pre_inc65(pos73);} else {var if_res33 = pos73;}var pos76 = if_res33;if (val_cont_p69!==false) {var if_res34 = val_cont_p69(guess74);} else {var if_res34 = true;}if (if_res34!==false) {var img80 = img72;var img81 = M9.above(LINEGAP,render_guess(guess74),img80);var img79 = M7.values(img81);if (all_cont_p_by_pos75!==false) {var if_res35 = all_cont_p_by_pos75(pos76);} else {var if_res35 = true;}if (if_res35!==false) {var if_res36 = M7.not(false);} else {var if_res36 = false;}if (if_res36!==false) {var if_res37 = for_loop71(img79,pos_next66(pos76));} else {var if_res37 = img79;}var if_res38 = if_res37;} else {var if_res38 = img72;}var if_res39 = if_res38;} else {var if_res39 = img72;}return if_res39;};return for_loop71(LINEGAP,init67);};var render_guess = function(word82) {var let_result40 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("c")),word82);var pos__gt_vals83 = let_result40.getAt(0);var pos_pre_inc84 = let_result40.getAt(1);var pos_next85 = let_result40.getAt(2);var init86 = let_result40.getAt(3);var pos_cont_p87 = let_result40.getAt(4);var val_cont_p88 = let_result40.getAt(5);var all_cont_p89 = let_result40.getAt(6);var let_result41 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("col")),compute_guess_colors(word82));var pos__gt_vals90 = let_result41.getAt(0);var pos_pre_inc91 = let_result41.getAt(1);var pos_next92 = let_result41.getAt(2);var init93 = let_result41.getAt(3);var pos_cont_p94 = let_result41.getAt(4);var val_cont_p95 = let_result41.getAt(5);var all_cont_p96 = let_result41.getAt(6);M7.rvoid();M7.rvoid();var for_loop97 = function(fold_var98, pos99, pos100) {if (pos_cont_p87!==false) {var if_res42 = pos_cont_p87(pos99);} else {var if_res42 = true;}if (if_res42!==false) {if (pos_cont_p94!==false) {var if_res43 = pos_cont_p94(pos100);} else {var if_res43 = true;}var if_res44 = if_res43;} else {var if_res44 = false;}if (if_res44!==false) {var c107 = pos__gt_vals83(pos99);if (all_cont_p89!==false) {var if_res45 = function(pos108) {return all_cont_p89(pos108,c107);};} else {var if_res45 = false;}var let_result46 = M7.values(c107,if_res45);var c101 = let_result46.getAt(0);var all_cont_p_by_pos102 = let_result46.getAt(1);if (pos_pre_inc84!==false) {var if_res47 = pos_pre_inc84(pos99);} else {var if_res47 = pos99;}var pos103 = if_res47;var col109 = pos__gt_vals90(pos100);if (all_cont_p96!==false) {var if_res48 = function(pos110) {return all_cont_p96(pos110,col109);};} else {var if_res48 = false;}var let_result49 = M7.values(col109,if_res48);var col104 = let_result49.getAt(0);var all_cont_p_by_pos105 = let_result49.getAt(1);if (pos_pre_inc91!==false) {var if_res50 = pos_pre_inc91(pos100);} else {var if_res50 = pos100;}var pos106 = if_res50;if (val_cont_p88!==false) {var if_res51 = val_cont_p88(c101);} else {var if_res51 = true;}if (if_res51!==false) {if (val_cont_p95!==false) {var if_res52 = val_cont_p95(col104);} else {var if_res52 = true;}var if_res53 = if_res52;} else {var if_res53 = false;}if (if_res53!==false) {var fold_var112 = fold_var98;var fold_var113 = M7.cons(guesschar__gt_tile(c101,col104),fold_var112);var fold_var111 = M7.values(fold_var113);if (all_cont_p_by_pos102!==false) {var if_res54 = all_cont_p_by_pos102(pos103);} else {var if_res54 = true;}if (if_res54!==false) {if (all_cont_p_by_pos105!==false) {var if_res55 = all_cont_p_by_pos105(pos106);} else {var if_res55 = true;}if (if_res55!==false) {var if_res56 = M7.not(false);} else {var if_res56 = false;}var if_res57 = if_res56;} else {var if_res57 = false;}if (if_res57!==false) {var if_res58 = for_loop97(fold_var111,pos_next85(pos103),pos_next92(pos106));} else {var if_res58 = fold_var111;}var if_res59 = if_res58;} else {var if_res59 = fold_var98;}var if_res60 = if_res59;} else {var if_res60 = fold_var98;}return if_res60;};return img_join(M13.alt_reverse(for_loop97(M7.rnull,init86,init93)),CHARGAP,M9.beside);};var compute_guess_colors = function(word114) {var remaining_letters115 = M7.list__gt_vector(M7.string__gt_list(ANSWER));var let_result61 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("c")),word114);var pos__gt_vals119 = let_result61.getAt(0);var pos_pre_inc120 = let_result61.getAt(1);var pos_next121 = let_result61.getAt(2);var init122 = let_result61.getAt(3);var pos_cont_p123 = let_result61.getAt(4);var val_cont_p124 = let_result61.getAt(5);var all_cont_p125 = let_result61.getAt(6);var start126 = 0;var let_result62 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("expected")),ANSWER);var pos__gt_vals127 = let_result62.getAt(0);var pos_pre_inc128 = let_result62.getAt(1);var pos_next129 = let_result62.getAt(2);var init130 = let_result62.getAt(3);var pos_cont_p131 = let_result62.getAt(4);var val_cont_p132 = let_result62.getAt(5);var all_cont_p133 = let_result62.getAt(6);if (M7.rvoid()!==false) {if (M7.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res63 = M7.rvoid();} else {var if_res63 = M10.__rjs_quoted__.check_naturals(start126);}var if_res64 = if_res63;} else {var if_res64 = false;}if_res64;M7.rvoid();var for_loop134 = function(vec135, i136, pos137, pos138, pos139) {if (pos_cont_p123!==false) {var if_res65 = pos_cont_p123(pos137);} else {var if_res65 = true;}if (if_res65!==false) {var if_res66 = true;} else {var if_res66 = false;}if (if_res66!==false) {if (pos_cont_p131!==false) {var if_res67 = pos_cont_p131(pos139);} else {var if_res67 = true;}var if_res68 = if_res67;} else {var if_res68 = false;}if (if_res68!==false) {var c147 = pos__gt_vals119(pos137);if (all_cont_p125!==false) {var if_res69 = function(pos148) {return all_cont_p125(pos148,c147);};} else {var if_res69 = false;}var let_result70 = M7.values(c147,if_res69);var c140 = let_result70.getAt(0);var all_cont_p_by_pos141 = let_result70.getAt(1);if (pos_pre_inc120!==false) {var if_res71 = pos_pre_inc120(pos137);} else {var if_res71 = pos137;}var pos142 = if_res71;var i143 = pos138;var expected149 = pos__gt_vals127(pos139);if (all_cont_p133!==false) {var if_res72 = function(pos150) {return all_cont_p133(pos150,expected149);};} else {var if_res72 = false;}var let_result73 = M7.values(expected149,if_res72);var expected144 = let_result73.getAt(0);var all_cont_p_by_pos145 = let_result73.getAt(1);if (pos_pre_inc128!==false) {var if_res74 = pos_pre_inc128(pos139);} else {var if_res74 = pos139;}var pos146 = if_res74;if (val_cont_p124!==false) {var if_res75 = val_cont_p124(c140);} else {var if_res75 = true;}if (if_res75!==false) {var if_res76 = true;} else {var if_res76 = false;}if (if_res76!==false) {if (val_cont_p132!==false) {var if_res77 = val_cont_p132(expected144);} else {var if_res77 = true;}var if_res78 = if_res77;} else {var if_res78 = false;}if (if_res78!==false) {var vec153 = vec135;var i154 = i136;if (M7.eq_p(i154,M14.unsafe_vector_times__length(vec153))!==false) {var if_res79 = M10.__rjs_quoted__.grow_vector(vec153);} else {var if_res79 = vec153;}var new_vec157 = if_res79;if (M7.char_eq__p(c140,expected144)!==false) {mark_used_bang_(remaining_letters115,i143);var if_res80 = CORRECT_COLOR;} else {var if_res80 = WRONG_COLOR;}M14.unsafe_vector_times__set_bang_(new_vec157,i154,if_res80);var let_result81 = M7.values(new_vec157,M14.unsafe_fx_plus_(i154,1));var vec155 = let_result81.getAt(0);var i156 = let_result81.getAt(1);var let_result82 = M7.values(vec155,i156);var vec151 = let_result82.getAt(0);var i152 = let_result82.getAt(1);if (all_cont_p_by_pos141!==false) {var if_res83 = all_cont_p_by_pos141(pos142);} else {var if_res83 = true;}if (if_res83!==false) {var if_res84 = true;} else {var if_res84 = false;}if (if_res84!==false) {if (all_cont_p_by_pos145!==false) {var if_res85 = all_cont_p_by_pos145(pos146);} else {var if_res85 = true;}if (if_res85!==false) {var if_res86 = M7.not(false);} else {var if_res86 = false;}var if_res87 = if_res86;} else {var if_res87 = false;}if (if_res87!==false) {var if_res88 = for_loop134(vec151,i152,pos_next121(pos142),pos138+1,pos_next129(pos146));} else {var if_res88 = M7.values(vec151,i152);}var if_res89 = if_res88;} else {var if_res89 = M7.values(vec135,i136);}var if_res90 = if_res89;} else {var if_res90 = M7.values(vec135,i136);}return if_res90;};var let_result91 = for_loop134(M7.make_vector(16),0,init122,start126,init130);var vec117 = let_result91.getAt(0);var i118 = let_result91.getAt(1);var partial_colors116 = M10.__rjs_quoted__.shrink_vector(vec117,i118);var let_result92 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("col")),partial_colors116);var pos__gt_vals158 = let_result92.getAt(0);var pos_pre_inc159 = let_result92.getAt(1);var pos_next160 = let_result92.getAt(2);var init161 = let_result92.getAt(3);var pos_cont_p162 = let_result92.getAt(4);var val_cont_p163 = let_result92.getAt(5);var all_cont_p164 = let_result92.getAt(6);var let_result93 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("c")),word114);var pos__gt_vals165 = let_result93.getAt(0);var pos_pre_inc166 = let_result93.getAt(1);var pos_next167 = let_result93.getAt(2);var init168 = let_result93.getAt(3);var pos_cont_p169 = let_result93.getAt(4);var val_cont_p170 = let_result93.getAt(5);var all_cont_p171 = let_result93.getAt(6);var start172 = 0;var let_result94 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("expected")),ANSWER);var pos__gt_vals173 = let_result94.getAt(0);var pos_pre_inc174 = let_result94.getAt(1);var pos_next175 = let_result94.getAt(2);var init176 = let_result94.getAt(3);var pos_cont_p177 = let_result94.getAt(4);var val_cont_p178 = let_result94.getAt(5);var all_cont_p179 = let_result94.getAt(6);M7.rvoid();if (M7.rvoid()!==false) {if (M7.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res95 = M7.rvoid();} else {var if_res95 = M10.__rjs_quoted__.check_naturals(start172);}var if_res96 = if_res95;} else {var if_res96 = false;}if_res96;M7.rvoid();var for_loop180 = function(fold_var181, pos182, pos183, pos184, pos185) {if (pos_cont_p162!==false) {var if_res97 = pos_cont_p162(pos182);} else {var if_res97 = true;}if (if_res97!==false) {if (pos_cont_p169!==false) {var if_res98 = pos_cont_p169(pos183);} else {var if_res98 = true;}if (if_res98!==false) {var if_res99 = true;} else {var if_res99 = false;}if (if_res99!==false) {if (pos_cont_p177!==false) {var if_res100 = pos_cont_p177(pos185);} else {var if_res100 = true;}var if_res101 = if_res100;} else {var if_res101 = false;}var if_res102 = if_res101;} else {var if_res102 = false;}if (if_res102!==false) {var col196 = pos__gt_vals158(pos182);if (all_cont_p164!==false) {var if_res103 = function(pos197) {return all_cont_p164(pos197,col196);};} else {var if_res103 = false;}var let_result104 = M7.values(col196,if_res103);var col186 = let_result104.getAt(0);var all_cont_p_by_pos187 = let_result104.getAt(1);if (pos_pre_inc159!==false) {var if_res105 = pos_pre_inc159(pos182);} else {var if_res105 = pos182;}var pos188 = if_res105;var c198 = pos__gt_vals165(pos183);if (all_cont_p171!==false) {var if_res106 = function(pos199) {return all_cont_p171(pos199,c198);};} else {var if_res106 = false;}var let_result107 = M7.values(c198,if_res106);var c189 = let_result107.getAt(0);var all_cont_p_by_pos190 = let_result107.getAt(1);if (pos_pre_inc166!==false) {var if_res108 = pos_pre_inc166(pos183);} else {var if_res108 = pos183;}var pos191 = if_res108;var i192 = pos184;var expected200 = pos__gt_vals173(pos185);if (all_cont_p179!==false) {var if_res109 = function(pos201) {return all_cont_p179(pos201,expected200);};} else {var if_res109 = false;}var let_result110 = M7.values(expected200,if_res109);var expected193 = let_result110.getAt(0);var all_cont_p_by_pos194 = let_result110.getAt(1);if (pos_pre_inc174!==false) {var if_res111 = pos_pre_inc174(pos185);} else {var if_res111 = pos185;}var pos195 = if_res111;if (val_cont_p163!==false) {var if_res112 = val_cont_p163(col186);} else {var if_res112 = true;}if (if_res112!==false) {if (val_cont_p170!==false) {var if_res113 = val_cont_p170(c189);} else {var if_res113 = true;}if (if_res113!==false) {var if_res114 = true;} else {var if_res114 = false;}if (if_res114!==false) {if (val_cont_p178!==false) {var if_res115 = val_cont_p178(expected193);} else {var if_res115 = true;}var if_res116 = if_res115;} else {var if_res116 = false;}var if_res117 = if_res116;} else {var if_res117 = false;}if (if_res117!==false) {var fold_var203 = fold_var181;if (M7.equal_p(col186,CORRECT_COLOR)!==false) {var if_res119 = CORRECT_COLOR;} else {if (M2.vector_member(c189,remaining_letters115)!==false) {mark_used_bang_(remaining_letters115,c189);var if_res118 = MAYBE_COLOR;} else {var if_res118 = WRONG_COLOR;}var if_res119 = if_res118;}var fold_var204 = M7.cons(if_res119,fold_var203);var fold_var202 = M7.values(fold_var204);if (all_cont_p_by_pos187!==false) {var if_res120 = all_cont_p_by_pos187(pos188);} else {var if_res120 = true;}if (if_res120!==false) {if (all_cont_p_by_pos190!==false) {var if_res121 = all_cont_p_by_pos190(pos191);} else {var if_res121 = true;}if (if_res121!==false) {var if_res122 = true;} else {var if_res122 = false;}if (if_res122!==false) {if (all_cont_p_by_pos194!==false) {var if_res123 = all_cont_p_by_pos194(pos195);} else {var if_res123 = true;}if (if_res123!==false) {var if_res124 = M7.not(false);} else {var if_res124 = false;}var if_res125 = if_res124;} else {var if_res125 = false;}var if_res126 = if_res125;} else {var if_res126 = false;}if (if_res126!==false) {var if_res127 = for_loop180(fold_var202,pos_next160(pos188),pos_next167(pos191),pos184+1,pos_next175(pos195));} else {var if_res127 = fold_var202;}var if_res128 = if_res127;} else {var if_res128 = fold_var181;}var if_res129 = if_res128;} else {var if_res129 = fold_var181;}return if_res129;};return M13.alt_reverse(for_loop180(M7.rnull,init161,init168,start172,init176));};var USED_LETTER = $rjs_core.UString.make("-");var mark_used_bang_ = function(vec205, c_by_i206) {if (M7.number_p(c_by_i206)!==false) {var if_res147 = M7.vector_set_bang_(vec205,c_by_i206,USED_LETTER);} else {var let_result130 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("j")),M7.vector_length(vec205));var pos__gt_vals209 = let_result130.getAt(0);var pos_pre_inc210 = let_result130.getAt(1);var pos_next211 = let_result130.getAt(2);var init212 = let_result130.getAt(3);var pos_cont_p213 = let_result130.getAt(4);var val_cont_p214 = let_result130.getAt(5);var all_cont_p215 = let_result130.getAt(6);M7.rvoid();var for_loop216 = function(val217, stop_p218, pos219) {if (pos_cont_p213!==false) {var if_res131 = pos_cont_p213(pos219);} else {var if_res131 = true;}if (if_res131!==false) {var j223 = pos__gt_vals209(pos219);if (all_cont_p215!==false) {var if_res132 = function(pos224) {return all_cont_p215(pos224,j223);};} else {var if_res132 = false;}var let_result133 = M7.values(j223,if_res132);var j220 = let_result133.getAt(0);var all_cont_p_by_pos221 = let_result133.getAt(1);if (pos_pre_inc210!==false) {var if_res134 = pos_pre_inc210(pos219);} else {var if_res134 = pos219;}var pos222 = if_res134;if (val_cont_p214!==false) {var if_res135 = val_cont_p214(j220);} else {var if_res135 = true;}if (if_res135!==false) {var val227 = val217;var stop_p228 = stop_p218;if (M7.equal_p(M7.vector_ref(vec205,j220),c_by_i206)!==false) {var val229 = val227;var stop_p230 = stop_p228;var let_result136 = M7.values(M7.vector_set_bang_(vec205,j220,USED_LETTER),true);var val231 = let_result136.getAt(0);var stop_p232 = let_result136.getAt(1);var if_res137 = M7.values(val231,stop_p232);} else {var if_res137 = M7.values(val227,stop_p228);}var let_result138 = if_res137;var val225 = let_result138.getAt(0);var stop_p226 = let_result138.getAt(1);if (all_cont_p_by_pos221!==false) {var if_res139 = all_cont_p_by_pos221(pos222);} else {var if_res139 = true;}if (if_res139!==false) {var if_res141 = M7.not($rjs_core.attachProcedureArity(function(...x233140) {var x233 = $rjs_core.Pair.listFromArray(x233140);return stop_p226;})(j220));} else {var if_res141 = false;}if (if_res141!==false) {var if_res142 = M7.not(false);} else {var if_res142 = false;}if (if_res142!==false) {var if_res143 = for_loop216(val225,stop_p226,pos_next211(pos222));} else {var if_res143 = M7.values(val225,stop_p226);}var if_res144 = if_res143;} else {var if_res144 = M7.values(val217,stop_p218);}var if_res145 = if_res144;} else {var if_res145 = M7.values(val217,stop_p218);}return if_res145;};var let_result146 = for_loop216(false,false,init212);var val207 = let_result146.getAt(0);var _208 = let_result146.getAt(1);var if_res147 = val207;}return if_res147;};var guesschar__gt_tile = function(c234, tile_color235) {return M9.overlay(char__gt_img(c234,GUESS_CHAR_COLOR),mk_guess_tile(tile_color235));};var char__gt_img = function(c236, color237) {return M9.text(char__gt_string(c236),GUESS_CHAR_FONT_SIZE,color237);};var char__gt_string = function(c238) {return M7.string_upcase(M7.string(c238));};var mk_guess_tile = function(color239) {return M9.square(GUESS_TILE_HEIGHT,$rjs_core.UString.make("solid"),color239);};var render_current = function(word240) {if (M12.member(word240,ALL_WORDS)!==false) {var if_res148 = valid_char__gt_tile;} else {var if_res148 = char__gt_tile;}return img_join(M7.append(M5.map(if_res148,M7.string__gt_list(word240)),repeat(BLANK,WORD_LENGTH-M7.string_length(word240))),CHARGAP,M9.beside);};var char__gt_tile = function(c241) {return M9.overlay(char__gt_img(c241,CURRENT_CHAR_INVALID_COLOR),BLANK);};var valid_char__gt_tile = function(c242) {return M9.overlay(char__gt_img(c242,CURRENT_CHAR_VALID_COLOR),BLANK);};var BLANK_WORD = render_current($rjs_core.UString.make(""));var render_blanks = function(guesses_remaining243) {var let_result149 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("n")),M7.sub1(guesses_remaining243));var pos__gt_vals244 = let_result149.getAt(0);var pos_pre_inc245 = let_result149.getAt(1);var pos_next246 = let_result149.getAt(2);var init247 = let_result149.getAt(3);var pos_cont_p248 = let_result149.getAt(4);var val_cont_p249 = let_result149.getAt(5);var all_cont_p250 = let_result149.getAt(6);M7.rvoid();var for_loop251 = function(img252, pos253) {if (pos_cont_p248!==false) {var if_res150 = pos_cont_p248(pos253);} else {var if_res150 = true;}if (if_res150!==false) {var n257 = pos__gt_vals244(pos253);if (all_cont_p250!==false) {var if_res151 = function(pos258) {return all_cont_p250(pos258,n257);};} else {var if_res151 = false;}var let_result152 = M7.values(n257,if_res151);var n254 = let_result152.getAt(0);var all_cont_p_by_pos255 = let_result152.getAt(1);if (pos_pre_inc245!==false) {var if_res153 = pos_pre_inc245(pos253);} else {var if_res153 = pos253;}var pos256 = if_res153;if (val_cont_p249!==false) {var if_res154 = val_cont_p249(n254);} else {var if_res154 = true;}if (if_res154!==false) {var img260 = img252;var img261 = M9.above(img260,BLANK_WORD,LINEGAP);var img259 = M7.values(img261);if (all_cont_p_by_pos255!==false) {var if_res155 = all_cont_p_by_pos255(pos256);} else {var if_res155 = true;}if (if_res155!==false) {var if_res156 = M7.not(false);} else {var if_res156 = false;}if (if_res156!==false) {var if_res157 = for_loop251(img259,pos_next246(pos256));} else {var if_res157 = img259;}var if_res158 = if_res157;} else {var if_res158 = img252;}var if_res159 = if_res158;} else {var if_res159 = img252;}return if_res159;};return for_loop251(LINEGAP,init247);};var KEYBOARD_1ST_ROW = $rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("q"),$rjs_core.PrimitiveSymbol.make("w"),$rjs_core.PrimitiveSymbol.make("e"),$rjs_core.PrimitiveSymbol.make("r"),$rjs_core.PrimitiveSymbol.make("t"),$rjs_core.PrimitiveSymbol.make("y"),$rjs_core.PrimitiveSymbol.make("u"),$rjs_core.PrimitiveSymbol.make("i"),$rjs_core.PrimitiveSymbol.make("o"),$rjs_core.PrimitiveSymbol.make("p"));var KEYBOARD_2ND_ROW = $rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("a"),$rjs_core.PrimitiveSymbol.make("s"),$rjs_core.PrimitiveSymbol.make("d"),$rjs_core.PrimitiveSymbol.make("f"),$rjs_core.PrimitiveSymbol.make("g"),$rjs_core.PrimitiveSymbol.make("h"),$rjs_core.PrimitiveSymbol.make("j"),$rjs_core.PrimitiveSymbol.make("k"),$rjs_core.PrimitiveSymbol.make("l"));var KEYBOARD_3RD_ROW = $rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("z"),$rjs_core.PrimitiveSymbol.make("x"),$rjs_core.PrimitiveSymbol.make("c"),$rjs_core.PrimitiveSymbol.make("v"),$rjs_core.PrimitiveSymbol.make("b"),$rjs_core.PrimitiveSymbol.make("n"),$rjs_core.PrimitiveSymbol.make("m"));var KEYBOARD = M7.list(KEYBOARD_1ST_ROW,KEYBOARD_2ND_ROW,KEYBOARD_3RD_ROW);var KEY_HEIGHT = 32;var KEYBOARD_FONT_SIZE = 14;var ENTER_KEY = M9.overlay(M9.rectangle(1.5*KEY_HEIGHT,KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray")),M9.text($rjs_core.UString.make("ENTER"),10,$rjs_core.PrimitiveSymbol.make("black")));var BACKSPACE_KEY = M9.overlay(M9.rectangle(1.5*KEY_HEIGHT,KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray")),M9.text($rjs_core.UString.make("Backspace"),8,$rjs_core.PrimitiveSymbol.make("black")));var render_keyboard = function(guesses262) {return M9.above(keys__gt_img(KEYBOARD_1ST_ROW,guesses262),keys__gt_img(KEYBOARD_2ND_ROW,guesses262),M9.beside(ENTER_KEY,keys__gt_img(KEYBOARD_3RD_ROW,guesses262),BACKSPACE_KEY));};var keys__gt_img = function(ks263, guesses264) {var let_result160 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("k")),ks263);var pos__gt_vals265 = let_result160.getAt(0);var pos_pre_inc266 = let_result160.getAt(1);var pos_next267 = let_result160.getAt(2);var init268 = let_result160.getAt(3);var pos_cont_p269 = let_result160.getAt(4);var val_cont_p270 = let_result160.getAt(5);var all_cont_p271 = let_result160.getAt(6);M7.rvoid();var for_loop272 = function(fold_var273, pos274) {if (pos_cont_p269!==false) {var if_res161 = pos_cont_p269(pos274);} else {var if_res161 = true;}if (if_res161!==false) {var k278 = pos__gt_vals265(pos274);if (all_cont_p271!==false) {var if_res162 = function(pos279) {return all_cont_p271(pos279,k278);};} else {var if_res162 = false;}var let_result163 = M7.values(k278,if_res162);var k275 = let_result163.getAt(0);var all_cont_p_by_pos276 = let_result163.getAt(1);if (pos_pre_inc266!==false) {var if_res164 = pos_pre_inc266(pos274);} else {var if_res164 = pos274;}var pos277 = if_res164;if (val_cont_p270!==false) {var if_res165 = val_cont_p270(k275);} else {var if_res165 = true;}if (if_res165!==false) {var fold_var281 = fold_var273;var fold_var282 = M7.cons(key__gt_img(k275,guesses264),fold_var281);var fold_var280 = M7.values(fold_var282);if (all_cont_p_by_pos276!==false) {var if_res166 = all_cont_p_by_pos276(pos277);} else {var if_res166 = true;}if (if_res166!==false) {var if_res167 = M7.not(false);} else {var if_res167 = false;}if (if_res167!==false) {var if_res168 = for_loop272(fold_var280,pos_next267(pos277));} else {var if_res168 = fold_var280;}var if_res169 = if_res168;} else {var if_res169 = fold_var273;}var if_res170 = if_res169;} else {var if_res170 = fold_var273;}return if_res170;};return M7.apply(M9.beside,M13.alt_reverse(for_loop272(M7.rnull,init268)));};var key__gt_img = function(sym283, guesses284) {var tile_col285 = key_color(M7.symbol__gt_string(sym283),guesses284);var temp172 = M7.string_upcase(M7.symbol__gt_string(sym283));if (M7.equal_p(tile_col285,$rjs_core.UString.make("white"))!==false) {var if_res171 = $rjs_core.UString.make("black");} else {var if_res171 = $rjs_core.UString.make("white");}return M9.overlay(M9.text(temp172,KEYBOARD_FONT_SIZE,if_res171),mk_key_tile(tile_col285));};var mk_key_tile = function(color286) {if (M7.equal_p(color286,$rjs_core.UString.make("white"))!==false) {var if_res173 = M9.square(KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray"));} else {var if_res173 = M9.square(KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("solid"),color286);}return if_res173;};var key_color = function(k287, guesses288) {if (correct_char_p(k287,guesses288)!==false) {var if_res176 = CORRECT_COLOR;} else {if (maybe_char_p(k287,guesses288)!==false) {var if_res175 = MAYBE_COLOR;} else {if (wrong_char_p(k287,guesses288)!==false) {var if_res174 = WRONG_COLOR;} else {var if_res174 = $rjs_core.UString.make("white");}var if_res175 = if_res174;}var if_res176 = if_res175;}return if_res176;};var correct_char_p = function(k289, guesses290) {var let_result177 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("g")),guesses290);var pos__gt_vals291 = let_result177.getAt(0);var pos_pre_inc292 = let_result177.getAt(1);var pos_next293 = let_result177.getAt(2);var init294 = let_result177.getAt(3);var pos_cont_p295 = let_result177.getAt(4);var val_cont_p296 = let_result177.getAt(5);var all_cont_p297 = let_result177.getAt(6);M7.rvoid();var for_loop298 = function(result299, pos300) {if (pos_cont_p295!==false) {var if_res178 = pos_cont_p295(pos300);} else {var if_res178 = true;}if (if_res178!==false) {var g304 = pos__gt_vals291(pos300);if (all_cont_p297!==false) {var if_res179 = function(pos305) {return all_cont_p297(pos305,g304);};} else {var if_res179 = false;}var let_result180 = M7.values(g304,if_res179);var g301 = let_result180.getAt(0);var all_cont_p_by_pos302 = let_result180.getAt(1);if (pos_pre_inc292!==false) {var if_res181 = pos_pre_inc292(pos300);} else {var if_res181 = pos300;}var pos303 = if_res181;if (val_cont_p296!==false) {var if_res182 = val_cont_p296(g301);} else {var if_res182 = true;}if (if_res182!==false) {var result307 = result299;var let_result183 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),g301);var pos__gt_vals309 = let_result183.getAt(0);var pos_pre_inc310 = let_result183.getAt(1);var pos_next311 = let_result183.getAt(2);var init312 = let_result183.getAt(3);var pos_cont_p313 = let_result183.getAt(4);var val_cont_p314 = let_result183.getAt(5);var all_cont_p315 = let_result183.getAt(6);var let_result184 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("y")),ANSWER);var pos__gt_vals316 = let_result184.getAt(0);var pos_pre_inc317 = let_result184.getAt(1);var pos_next318 = let_result184.getAt(2);var init319 = let_result184.getAt(3);var pos_cont_p320 = let_result184.getAt(4);var val_cont_p321 = let_result184.getAt(5);var all_cont_p322 = let_result184.getAt(6);M7.rvoid();M7.rvoid();var for_loop323 = function(result324, pos325, pos326) {if (pos_cont_p313!==false) {var if_res185 = pos_cont_p313(pos325);} else {var if_res185 = true;}if (if_res185!==false) {if (pos_cont_p320!==false) {var if_res186 = pos_cont_p320(pos326);} else {var if_res186 = true;}var if_res187 = if_res186;} else {var if_res187 = false;}if (if_res187!==false) {var x333 = pos__gt_vals309(pos325);if (all_cont_p315!==false) {var if_res188 = function(pos334) {return all_cont_p315(pos334,x333);};} else {var if_res188 = false;}var let_result189 = M7.values(x333,if_res188);var x327 = let_result189.getAt(0);var all_cont_p_by_pos328 = let_result189.getAt(1);if (pos_pre_inc310!==false) {var if_res190 = pos_pre_inc310(pos325);} else {var if_res190 = pos325;}var pos329 = if_res190;var y335 = pos__gt_vals316(pos326);if (all_cont_p322!==false) {var if_res191 = function(pos336) {return all_cont_p322(pos336,y335);};} else {var if_res191 = false;}var let_result192 = M7.values(y335,if_res191);var y330 = let_result192.getAt(0);var all_cont_p_by_pos331 = let_result192.getAt(1);if (pos_pre_inc317!==false) {var if_res193 = pos_pre_inc317(pos326);} else {var if_res193 = pos326;}var pos332 = if_res193;if (val_cont_p314!==false) {var if_res194 = val_cont_p314(x327);} else {var if_res194 = true;}if (if_res194!==false) {if (val_cont_p321!==false) {var if_res195 = val_cont_p321(y330);} else {var if_res195 = true;}var if_res196 = if_res195;} else {var if_res196 = false;}if (if_res196!==false) {var result338 = result324;if (M7.equal_p(x327,y330)!==false) {var if_res197 = M7.equal_p(M7.string(x327),k289);} else {var if_res197 = false;}var result339 = if_res197;var result337 = M7.values(result339);if (all_cont_p_by_pos328!==false) {var if_res198 = all_cont_p_by_pos328(pos329);} else {var if_res198 = true;}if (if_res198!==false) {var if_res200 = M7.not($rjs_core.attachProcedureArity(function(...x340199) {var x340 = $rjs_core.Pair.listFromArray(x340199);return result337;})(x327));} else {var if_res200 = false;}if (if_res200!==false) {if (all_cont_p_by_pos331!==false) {var if_res201 = all_cont_p_by_pos331(pos332);} else {var if_res201 = true;}if (if_res201!==false) {var if_res203 = M7.not($rjs_core.attachProcedureArity(function(...x341202) {var x341 = $rjs_core.Pair.listFromArray(x341202);return result337;})(y330));} else {var if_res203 = false;}if (if_res203!==false) {var if_res204 = M7.not(false);} else {var if_res204 = false;}var if_res205 = if_res204;} else {var if_res205 = false;}if (if_res205!==false) {var if_res206 = for_loop323(result337,pos_next311(pos329),pos_next318(pos332));} else {var if_res206 = result337;}var if_res207 = if_res206;} else {var if_res207 = result324;}var if_res208 = if_res207;} else {var if_res208 = result324;}return if_res208;};var result308 = for_loop323(false,init312,init319);var result306 = M7.values(result308);if (all_cont_p_by_pos302!==false) {var if_res209 = all_cont_p_by_pos302(pos303);} else {var if_res209 = true;}if (if_res209!==false) {var if_res211 = M7.not($rjs_core.attachProcedureArity(function(...x342210) {var x342 = $rjs_core.Pair.listFromArray(x342210);return result306;})(g301));} else {var if_res211 = false;}if (if_res211!==false) {var if_res212 = M7.not(false);} else {var if_res212 = false;}if (if_res212!==false) {var if_res213 = for_loop298(result306,pos_next293(pos303));} else {var if_res213 = result306;}var if_res214 = if_res213;} else {var if_res214 = result299;}var if_res215 = if_res214;} else {var if_res215 = result299;}return if_res215;};return for_loop298(false,init294);};var maybe_char_p = function(k343, guesses344) {if (M8.string_contains_p(ANSWER,k343)!==false) {var let_result216 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("g")),guesses344);var pos__gt_vals345 = let_result216.getAt(0);var pos_pre_inc346 = let_result216.getAt(1);var pos_next347 = let_result216.getAt(2);var init348 = let_result216.getAt(3);var pos_cont_p349 = let_result216.getAt(4);var val_cont_p350 = let_result216.getAt(5);var all_cont_p351 = let_result216.getAt(6);M7.rvoid();var for_loop352 = function(result353, pos354) {if (pos_cont_p349!==false) {var if_res217 = pos_cont_p349(pos354);} else {var if_res217 = true;}if (if_res217!==false) {var g358 = pos__gt_vals345(pos354);if (all_cont_p351!==false) {var if_res218 = function(pos359) {return all_cont_p351(pos359,g358);};} else {var if_res218 = false;}var let_result219 = M7.values(g358,if_res218);var g355 = let_result219.getAt(0);var all_cont_p_by_pos356 = let_result219.getAt(1);if (pos_pre_inc346!==false) {var if_res220 = pos_pre_inc346(pos354);} else {var if_res220 = pos354;}var pos357 = if_res220;if (val_cont_p350!==false) {var if_res221 = val_cont_p350(g355);} else {var if_res221 = true;}if (if_res221!==false) {var result361 = result353;var result362 = M8.string_contains_p(g355,k343);var result360 = M7.values(result362);if (all_cont_p_by_pos356!==false) {var if_res222 = all_cont_p_by_pos356(pos357);} else {var if_res222 = true;}if (if_res222!==false) {var if_res224 = M7.not($rjs_core.attachProcedureArity(function(...x363223) {var x363 = $rjs_core.Pair.listFromArray(x363223);return result360;})(g355));} else {var if_res224 = false;}if (if_res224!==false) {var if_res225 = M7.not(false);} else {var if_res225 = false;}if (if_res225!==false) {var if_res226 = for_loop352(result360,pos_next347(pos357));} else {var if_res226 = result360;}var if_res227 = if_res226;} else {var if_res227 = result353;}var if_res228 = if_res227;} else {var if_res228 = result353;}return if_res228;};var if_res229 = for_loop352(false,init348);} else {var if_res229 = false;}return if_res229;};var wrong_char_p = function(k364, guesses365) {var let_result230 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("g")),guesses365);var pos__gt_vals366 = let_result230.getAt(0);var pos_pre_inc367 = let_result230.getAt(1);var pos_next368 = let_result230.getAt(2);var init369 = let_result230.getAt(3);var pos_cont_p370 = let_result230.getAt(4);var val_cont_p371 = let_result230.getAt(5);var all_cont_p372 = let_result230.getAt(6);M7.rvoid();var for_loop373 = function(result374, pos375) {if (pos_cont_p370!==false) {var if_res231 = pos_cont_p370(pos375);} else {var if_res231 = true;}if (if_res231!==false) {var g379 = pos__gt_vals366(pos375);if (all_cont_p372!==false) {var if_res232 = function(pos380) {return all_cont_p372(pos380,g379);};} else {var if_res232 = false;}var let_result233 = M7.values(g379,if_res232);var g376 = let_result233.getAt(0);var all_cont_p_by_pos377 = let_result233.getAt(1);if (pos_pre_inc367!==false) {var if_res234 = pos_pre_inc367(pos375);} else {var if_res234 = pos375;}var pos378 = if_res234;if (val_cont_p371!==false) {var if_res235 = val_cont_p371(g376);} else {var if_res235 = true;}if (if_res235!==false) {var result382 = result374;var result383 = M8.string_contains_p(g376,k364);var result381 = M7.values(result383);if (all_cont_p_by_pos377!==false) {var if_res236 = all_cont_p_by_pos377(pos378);} else {var if_res236 = true;}if (if_res236!==false) {var if_res238 = M7.not($rjs_core.attachProcedureArity(function(...x384237) {var x384 = $rjs_core.Pair.listFromArray(x384237);return result381;})(g376));} else {var if_res238 = false;}if (if_res238!==false) {var if_res239 = M7.not(false);} else {var if_res239 = false;}if (if_res239!==false) {var if_res240 = for_loop373(result381,pos_next368(pos378));} else {var if_res240 = result381;}var if_res241 = if_res240;} else {var if_res241 = result374;}var if_res242 = if_res241;} else {var if_res242 = result374;}return if_res242;};if (for_loop373(false,init369)!==false) {var if_res243 = M7.not(M8.string_contains_p(ANSWER,k364));} else {var if_res243 = false;}return if_res243;};var render_last = function(g385) {M7.printf($rjs_core.UString.make("ANSWER: ~a\n"),M7.string_upcase(ANSWER));return M9.overlay(render_guesses(game_guesses(g385)),EMPTY_CANVAS);};var process_key = function(g386, k387) {if (M1.key_eq__p(k387,$rjs_core.UString.make("\r"))!==false) {var if_res246 = game_submit_guess(g386);} else {if (M1.key_eq__p(k387,$rjs_core.UString.make("\b"))!==false) {var if_res245 = game_del_char(g386);} else {if (valid_char_p(k387)!==false) {var if_res244 = game_add_char(g386,k387);} else {var if_res244 = g386;}var if_res245 = if_res244;}var if_res246 = if_res245;}return if_res246;};var valid_char_p = function(k388) {if (M7.__eq_(1,M7.string_length(k388))!==false) {var if_res247 = M7.regexp_match_p($rjs_core.Regexp.fromString("[A-Za-z]"),k388);} else {var if_res247 = false;}return if_res247;};var handle_mouse = function(g389, x390, y391, evt392) {if (M1.mouse_eq__p(evt392,$rjs_core.UString.make("button-down"))!==false) {if (mouse_in_1st_row_p(x390,y391)!==false) {var if_res252 = game_add_char(g389,row1__gt_char(x390));} else {if (mouse_in_2nd_row_p(x390,y391)!==false) {var if_res251 = game_add_char(g389,row2__gt_char(x390));} else {if (mouse_in_3rd_row_p(x390,y391)!==false) {var if_res250 = game_add_char(g389,row3__gt_char(x390));} else {if (mouse_enter_p(x390,y391)!==false) {var if_res249 = game_submit_guess(g389);} else {if (mouse_backspace_p(x390,y391)!==false) {var if_res248 = game_del_char(g389);} else {var if_res248 = g389;}var if_res249 = if_res248;}var if_res250 = if_res249;}var if_res251 = if_res250;}var if_res252 = if_res251;}var if_res253 = if_res252;} else {var if_res253 = g389;}return if_res253;};var KEYBOARD_Y_START = 356;var KEYBOARD_Y1_START = KEYBOARD_Y_START;var KEYBOARD_Y1_END = KEYBOARD_Y1_START+KEY_HEIGHT;var KEYBOARD_Y2_START = KEYBOARD_Y1_END;var KEYBOARD_Y2_END = KEYBOARD_Y2_START+KEY_HEIGHT;var KEYBOARD_Y3_START = KEYBOARD_Y2_END;var KEYBOARD_Y3_END = KEYBOARD_Y3_START+KEY_HEIGHT;var KEYBOARD_Y_END = KEYBOARD_Y3_END;var KEYBOARD_X1_START = 0;var KEYBOARD_X1_END = KEYBOARD_X1_START+(M7.length(M11.first(KEYBOARD))*KEY_HEIGHT);var KEYBOARD_X2_START = KEYBOARD_X1_START+(KEY_HEIGHT/2);var KEYBOARD_X2_END = KEYBOARD_X2_START+(M7.length(M11.second(KEYBOARD))*KEY_HEIGHT);var KEYBOARD_X3_START = KEYBOARD_X2_START+KEY_HEIGHT;var KEYBOARD_X3_END = KEYBOARD_X3_START+(M7.length(M11.third(KEYBOARD))*KEY_HEIGHT);var mouse_in_1st_row_p = function(x393, y394) {if (M7.__lt_(KEYBOARD_Y1_START,y394,KEYBOARD_Y1_END)!==false) {var if_res254 = M7.__lt_(KEYBOARD_X1_START,x393,KEYBOARD_X1_END);} else {var if_res254 = false;}return if_res254;};var mouse_in_2nd_row_p = function(x395, y396) {if (M7.__lt_(KEYBOARD_Y2_START,y396,KEYBOARD_Y2_END)!==false) {var if_res255 = M7.__lt_(KEYBOARD_X2_START,x395,KEYBOARD_X2_END);} else {var if_res255 = false;}return if_res255;};var mouse_in_3rd_row_p = function(x397, y398) {if (M7.__lt_(KEYBOARD_Y3_START,y398,KEYBOARD_Y3_END)!==false) {var if_res256 = M7.__lt_(KEYBOARD_X3_START,x397,KEYBOARD_X3_END);} else {var if_res256 = false;}return if_res256;};var mouse_enter_p = function(x399, y400) {if (M7.__lt_(KEYBOARD_Y3_START,y400,KEYBOARD_Y3_END)!==false) {var if_res257 = M7.__lt_(0,x399,1.5*KEY_HEIGHT);} else {var if_res257 = false;}return if_res257;};var mouse_backspace_p = function(x401, y402) {if (M7.__lt_(KEYBOARD_Y3_START,y402,KEYBOARD_Y3_END)!==false) {var if_res258 = M7.__lt_(KEYBOARD_X3_END,x401,KEYBOARD_X3_END+(1.5*KEY_HEIGHT));} else {var if_res258 = false;}return if_res258;};var row1__gt_char = function(x403) {return M7.symbol__gt_string(M7.list_ref(M11.first(KEYBOARD),M7.quotient(x403,KEY_HEIGHT)));};var row2__gt_char = function(x404) {return M7.symbol__gt_string(M7.list_ref(M11.second(KEYBOARD),M7.quotient(x404-KEYBOARD_X2_START,KEY_HEIGHT)));};var row3__gt_char = function(x405) {return M7.symbol__gt_string(M7.list_ref(M11.third(KEYBOARD),M7.quotient(x405-KEYBOARD_X3_START,KEY_HEIGHT)));};var game_over_p = function(g406) {var guesses407 = game_guesses(g406);if (M7.not(M4.empty_p(guesses407))!==false) {var if_res259 = M7.string_eq__p(M7.car(guesses407),ANSWER);} else {var if_res259 = false;}var or_part408 = if_res259;if (or_part408!==false) {var if_res260 = or_part408;} else {var if_res260 = M7.__eq_(M7.length(guesses407),MAX_GUESSES);}return if_res260;};M7.call_with_values(function() {return M1.big_bang(START_STATE,M1.to_draw(render),M1.on_key(process_key),M1.on_mouse(handle_mouse),M1.stop_when(game_over_p,render_last));},M0.__rjs_quoted__.print_values);var __rjs_quoted__ = {};__rjs_quoted__.game_guesses = game_guesses;__rjs_quoted__.game1 = game1;__rjs_quoted__.game_current_guess = game_current_guess;__rjs_quoted__.struct_game = struct_game;__rjs_quoted__.game_p = game_p;export { __rjs_quoted__ };