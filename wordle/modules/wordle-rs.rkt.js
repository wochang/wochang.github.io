import * as $rjs_core from '../runtime/core.js';import * as M0 from "../collects/racket/private/modbeg.rkt.js";import * as M1 from "../links/racketscript-extras/racketscript/htdp/universe.rkt.js";import * as M2 from "../collects/racket/vector.rkt.js";import * as M3 from "../collects/racket/private/pre-base.rkt.js";import * as M4 from "../collects/racket/private/list-predicates.rkt.js";import * as M5 from "../collects/racket/private/map.rkt.js";import * as M6 from "./wordle-words.rkt.js";import * as M7 from "../runtime/kernel.rkt.js";import * as M8 from "../collects/racket/string.rkt.js";import * as M9 from "../links/racketscript-extras/racketscript/htdp/image.rkt.js";import * as M10 from "../collects/racket/private/for.rkt.js";import * as M11 from "../collects/racket/list.rkt.js";import * as M12 from "../collects/racket/private/member.rkt.js";import * as M13 from "../collects/racket/private/reverse.rkt.js";import * as M14 from "../runtime/unsafe.rkt.js";var ALL_WORDS = M6.WORDLE_WORDS;var NUM_WORDS = M7.length(ALL_WORDS);var MAX_GUESSES = 6;var WORD_LENGTH = 5;var let_result1 = M7.make_struct_type($rjs_core.PrimitiveSymbol.make("game"),false,2,0,false,M7.rnull,false,false,$rjs_core.Pair.makeList(0,1),false,$rjs_core.PrimitiveSymbol.make("game"));var struct_1 = let_result1.getAt(0);var make_2 = let_result1.getAt(1);var __p3 = let_result1.getAt(2);var __ref4 = let_result1.getAt(3);var __set_bang_5 = let_result1.getAt(4);var let_result2 = M7.values(struct_1,make_2,__p3,M7.make_struct_field_accessor(__ref4,0,$rjs_core.PrimitiveSymbol.make("guesses")),M7.make_struct_field_accessor(__ref4,1,$rjs_core.PrimitiveSymbol.make("current-guess")));var struct_game = let_result2.getAt(0);var game1 = let_result2.getAt(1);var game_p = let_result2.getAt(2);var game_guesses = let_result2.getAt(3);var game_current_guess = let_result2.getAt(4);var ACTIVE_GAME = false;var ANSWER = $rjs_core.UString.make("");var mk_start_state = function() {ACTIVE_GAME = true;ANSWER = random_word();return game1($rjs_core.Pair.makeList(),$rjs_core.UString.make(""));};var random_word = function() {return M7.list_ref(ALL_WORDS,M3.random(NUM_WORDS));};var game_over_p = function(guesses6) {if (M7.not(M4.empty_p(guesses6))!==false) {var if_res3 = M7.string_eq__p(M7.car(guesses6),ANSWER);} else {var if_res3 = false;}var or_part7 = if_res3;if (or_part7!==false) {var if_res4 = or_part7;} else {var if_res4 = M7.__eq_(M7.length(guesses6),MAX_GUESSES);}return if_res4;};var game_update_current = function(g8, guess9) {return game1(game_guesses(g8),guess9);};var game_submit_guess = function(g10) {var guesses11 = game_guesses(g10);var current12 = game_current_guess(g10);var current_length13 = M7.string_length(current12);if (M7.__eq_(current_length13,5)!==false) {var if_res5 = M12.member(current12,ALL_WORDS);} else {var if_res5 = false;}if (if_res5!==false) {if (game_over_p(M7.cons(current12,guesses11))!==false) {M7.printf($rjs_core.UString.make("ANSWER: ~a\n"),M7.string_upcase(ANSWER));ACTIVE_GAME = false;var if_res6 = null;} else {var if_res6 = M7.rvoid();}if_res6;var if_res7 = game1(M7.cons(current12,guesses11),$rjs_core.UString.make(""));} else {var if_res7 = g10;}return if_res7;};var game_del_char = function(g14) {var current15 = game_current_guess(g14);var current_length16 = M7.string_length(current15);if (M7.zero_p(current_length16)!==false) {var if_res8 = $rjs_core.UString.make("");} else {var if_res8 = M7.substring(current15,0,M7.sub1(current_length16));}return game_update_current(g14,if_res8);};var game_add_char = function(g17, k18) {var current19 = game_current_guess(g17);var current_length20 = M7.string_length(current19);if (M7.__eq_(current_length20,5)!==false) {var if_res9 = current19;} else {var if_res9 = M7.string_append(current19,M7.string_downcase(k18));}return game_update_current(g17,if_res9);};var EMPTY_CANVAS = M9.empty_scene(320,452);var WRONG_COLOR = $rjs_core.UString.make("black");var CORRECT_COLOR = $rjs_core.UString.make("dark green");var MAYBE_COLOR = $rjs_core.UString.make("medium yellow");var GUESS_TILE_HEIGHT = 50;var GAP = 8;var CHARGAP = M9.rectangle(GAP,0,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("white"));var LINEGAP = M9.rectangle(0,GAP,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("white"));var BLANK = M9.square(GUESS_TILE_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray"));var GUESS_CHAR_FONT_SIZE = 32;var CURRENT_CHAR_VALID_COLOR = $rjs_core.UString.make("blue");var CURRENT_CHAR_INVALID_COLOR = $rjs_core.UString.make("black");var GUESS_CHAR_COLOR = $rjs_core.UString.make("white");var repeat = function(x21, n22) {var let_result10 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("m")),n22);var pos__gt_vals23 = let_result10.getAt(0);var pos_pre_inc24 = let_result10.getAt(1);var pos_next25 = let_result10.getAt(2);var init26 = let_result10.getAt(3);var pos_cont_p27 = let_result10.getAt(4);var val_cont_p28 = let_result10.getAt(5);var all_cont_p29 = let_result10.getAt(6);M7.rvoid();var for_loop30 = function(fold_var31, pos32) {if (pos_cont_p27!==false) {var if_res11 = pos_cont_p27(pos32);} else {var if_res11 = true;}if (if_res11!==false) {var m36 = pos__gt_vals23(pos32);if (all_cont_p29!==false) {var if_res12 = function(pos37) {return all_cont_p29(pos37,m36);};} else {var if_res12 = false;}var let_result13 = M7.values(m36,if_res12);var m33 = let_result13.getAt(0);var all_cont_p_by_pos34 = let_result13.getAt(1);if (pos_pre_inc24!==false) {var if_res14 = pos_pre_inc24(pos32);} else {var if_res14 = pos32;}var pos35 = if_res14;if (val_cont_p28!==false) {var if_res15 = val_cont_p28(m33);} else {var if_res15 = true;}if (if_res15!==false) {var fold_var39 = fold_var31;var fold_var40 = M7.cons(x21,fold_var39);var fold_var38 = M7.values(fold_var40);if (all_cont_p_by_pos34!==false) {var if_res16 = all_cont_p_by_pos34(pos35);} else {var if_res16 = true;}if (if_res16!==false) {var if_res17 = M7.not(false);} else {var if_res17 = false;}if (if_res17!==false) {var if_res18 = for_loop30(fold_var38,pos_next25(pos35));} else {var if_res18 = fold_var38;}var if_res19 = if_res18;} else {var if_res19 = fold_var31;}var if_res20 = if_res19;} else {var if_res20 = fold_var31;}return if_res20;};return M13.alt_reverse(for_loop30(M7.rnull,init26));};var img_join = function(imgs41, sep42, combiner43) {var let_result21 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("i")),imgs41);var pos__gt_vals44 = let_result21.getAt(0);var pos_pre_inc45 = let_result21.getAt(1);var pos_next46 = let_result21.getAt(2);var init47 = let_result21.getAt(3);var pos_cont_p48 = let_result21.getAt(4);var val_cont_p49 = let_result21.getAt(5);var all_cont_p50 = let_result21.getAt(6);M7.rvoid();var for_loop51 = function(img52, pos53) {if (pos_cont_p48!==false) {var if_res22 = pos_cont_p48(pos53);} else {var if_res22 = true;}if (if_res22!==false) {var i57 = pos__gt_vals44(pos53);if (all_cont_p50!==false) {var if_res23 = function(pos58) {return all_cont_p50(pos58,i57);};} else {var if_res23 = false;}var let_result24 = M7.values(i57,if_res23);var i54 = let_result24.getAt(0);var all_cont_p_by_pos55 = let_result24.getAt(1);if (pos_pre_inc45!==false) {var if_res25 = pos_pre_inc45(pos53);} else {var if_res25 = pos53;}var pos56 = if_res25;if (val_cont_p49!==false) {var if_res26 = val_cont_p49(i54);} else {var if_res26 = true;}if (if_res26!==false) {var img60 = img52;var img61 = combiner43(img60,i54,sep42);var img59 = M7.values(img61);if (all_cont_p_by_pos55!==false) {var if_res27 = all_cont_p_by_pos55(pos56);} else {var if_res27 = true;}if (if_res27!==false) {var if_res28 = M7.not(false);} else {var if_res28 = false;}if (if_res28!==false) {var if_res29 = for_loop51(img59,pos_next46(pos56));} else {var if_res29 = img59;}var if_res30 = if_res29;} else {var if_res30 = img52;}var if_res31 = if_res30;} else {var if_res31 = img52;}return if_res31;};return for_loop51(sep42,init47);};var render = function(g62) {if (ACTIVE_GAME!==false) {var if_res32 = render_active(g62);} else {var if_res32 = render_inactive(g62);}return if_res32;};var render_active = function(g63) {var guesses64 = game_guesses(g63);var current65 = game_current_guess(g63);return M9.above(render_guesses(guesses64),render_current(current65),render_blanks(MAX_GUESSES-M7.length(guesses64)),render_keyboard(guesses64));};var render_inactive = function(g66) {return M9.overlay_by_align($rjs_core.UString.make("middle"),$rjs_core.UString.make("top"),M9.above_by_align($rjs_core.UString.make("left"),render_guesses(game_guesses(g66)),M9.text($rjs_core.UString.make("ANSWER:"),10,$rjs_core.PrimitiveSymbol.make("black")),M9.beside(M9.rectangle(20,0,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("white")),M9.text(M7.string_upcase(ANSWER),GUESS_CHAR_FONT_SIZE,CORRECT_COLOR),M9.rectangle(40,0,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("white")),M9.overlay(M9.text($rjs_core.UString.make("PLAY AGAIN"),KEYBOARD_FONT_SIZE,$rjs_core.PrimitiveSymbol.make("black")),M9.rectangle(100,40,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("black")))),LINEGAP,M9.text($rjs_core.UString.make("        Click or press ENTER to play again"),KEYBOARD_FONT_SIZE,$rjs_core.PrimitiveSymbol.make("black"))),EMPTY_CANVAS);};var render_guesses = function(guesses67) {var let_result33 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("guess")),guesses67);var pos__gt_vals68 = let_result33.getAt(0);var pos_pre_inc69 = let_result33.getAt(1);var pos_next70 = let_result33.getAt(2);var init71 = let_result33.getAt(3);var pos_cont_p72 = let_result33.getAt(4);var val_cont_p73 = let_result33.getAt(5);var all_cont_p74 = let_result33.getAt(6);M7.rvoid();var for_loop75 = function(img76, pos77) {if (pos_cont_p72!==false) {var if_res34 = pos_cont_p72(pos77);} else {var if_res34 = true;}if (if_res34!==false) {var guess81 = pos__gt_vals68(pos77);if (all_cont_p74!==false) {var if_res35 = function(pos82) {return all_cont_p74(pos82,guess81);};} else {var if_res35 = false;}var let_result36 = M7.values(guess81,if_res35);var guess78 = let_result36.getAt(0);var all_cont_p_by_pos79 = let_result36.getAt(1);if (pos_pre_inc69!==false) {var if_res37 = pos_pre_inc69(pos77);} else {var if_res37 = pos77;}var pos80 = if_res37;if (val_cont_p73!==false) {var if_res38 = val_cont_p73(guess78);} else {var if_res38 = true;}if (if_res38!==false) {var img84 = img76;var img85 = M9.above(LINEGAP,render_guess(guess78),img84);var img83 = M7.values(img85);if (all_cont_p_by_pos79!==false) {var if_res39 = all_cont_p_by_pos79(pos80);} else {var if_res39 = true;}if (if_res39!==false) {var if_res40 = M7.not(false);} else {var if_res40 = false;}if (if_res40!==false) {var if_res41 = for_loop75(img83,pos_next70(pos80));} else {var if_res41 = img83;}var if_res42 = if_res41;} else {var if_res42 = img76;}var if_res43 = if_res42;} else {var if_res43 = img76;}return if_res43;};return for_loop75(LINEGAP,init71);};var render_guess = function(word86) {var let_result44 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("c")),word86);var pos__gt_vals87 = let_result44.getAt(0);var pos_pre_inc88 = let_result44.getAt(1);var pos_next89 = let_result44.getAt(2);var init90 = let_result44.getAt(3);var pos_cont_p91 = let_result44.getAt(4);var val_cont_p92 = let_result44.getAt(5);var all_cont_p93 = let_result44.getAt(6);var let_result45 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("col")),compute_guess_colors(word86));var pos__gt_vals94 = let_result45.getAt(0);var pos_pre_inc95 = let_result45.getAt(1);var pos_next96 = let_result45.getAt(2);var init97 = let_result45.getAt(3);var pos_cont_p98 = let_result45.getAt(4);var val_cont_p99 = let_result45.getAt(5);var all_cont_p100 = let_result45.getAt(6);M7.rvoid();M7.rvoid();var for_loop101 = function(fold_var102, pos103, pos104) {if (pos_cont_p91!==false) {var if_res46 = pos_cont_p91(pos103);} else {var if_res46 = true;}if (if_res46!==false) {if (pos_cont_p98!==false) {var if_res47 = pos_cont_p98(pos104);} else {var if_res47 = true;}var if_res48 = if_res47;} else {var if_res48 = false;}if (if_res48!==false) {var c111 = pos__gt_vals87(pos103);if (all_cont_p93!==false) {var if_res49 = function(pos112) {return all_cont_p93(pos112,c111);};} else {var if_res49 = false;}var let_result50 = M7.values(c111,if_res49);var c105 = let_result50.getAt(0);var all_cont_p_by_pos106 = let_result50.getAt(1);if (pos_pre_inc88!==false) {var if_res51 = pos_pre_inc88(pos103);} else {var if_res51 = pos103;}var pos107 = if_res51;var col113 = pos__gt_vals94(pos104);if (all_cont_p100!==false) {var if_res52 = function(pos114) {return all_cont_p100(pos114,col113);};} else {var if_res52 = false;}var let_result53 = M7.values(col113,if_res52);var col108 = let_result53.getAt(0);var all_cont_p_by_pos109 = let_result53.getAt(1);if (pos_pre_inc95!==false) {var if_res54 = pos_pre_inc95(pos104);} else {var if_res54 = pos104;}var pos110 = if_res54;if (val_cont_p92!==false) {var if_res55 = val_cont_p92(c105);} else {var if_res55 = true;}if (if_res55!==false) {if (val_cont_p99!==false) {var if_res56 = val_cont_p99(col108);} else {var if_res56 = true;}var if_res57 = if_res56;} else {var if_res57 = false;}if (if_res57!==false) {var fold_var116 = fold_var102;var fold_var117 = M7.cons(guesschar__gt_tile(c105,col108),fold_var116);var fold_var115 = M7.values(fold_var117);if (all_cont_p_by_pos106!==false) {var if_res58 = all_cont_p_by_pos106(pos107);} else {var if_res58 = true;}if (if_res58!==false) {if (all_cont_p_by_pos109!==false) {var if_res59 = all_cont_p_by_pos109(pos110);} else {var if_res59 = true;}if (if_res59!==false) {var if_res60 = M7.not(false);} else {var if_res60 = false;}var if_res61 = if_res60;} else {var if_res61 = false;}if (if_res61!==false) {var if_res62 = for_loop101(fold_var115,pos_next89(pos107),pos_next96(pos110));} else {var if_res62 = fold_var115;}var if_res63 = if_res62;} else {var if_res63 = fold_var102;}var if_res64 = if_res63;} else {var if_res64 = fold_var102;}return if_res64;};return img_join(M13.alt_reverse(for_loop101(M7.rnull,init90,init97)),CHARGAP,M9.beside);};var compute_guess_colors = function(word118) {var remaining_letters119 = M7.list__gt_vector(M7.string__gt_list(ANSWER));var let_result65 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("c")),word118);var pos__gt_vals123 = let_result65.getAt(0);var pos_pre_inc124 = let_result65.getAt(1);var pos_next125 = let_result65.getAt(2);var init126 = let_result65.getAt(3);var pos_cont_p127 = let_result65.getAt(4);var val_cont_p128 = let_result65.getAt(5);var all_cont_p129 = let_result65.getAt(6);var start130 = 0;var let_result66 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("expected")),ANSWER);var pos__gt_vals131 = let_result66.getAt(0);var pos_pre_inc132 = let_result66.getAt(1);var pos_next133 = let_result66.getAt(2);var init134 = let_result66.getAt(3);var pos_cont_p135 = let_result66.getAt(4);var val_cont_p136 = let_result66.getAt(5);var all_cont_p137 = let_result66.getAt(6);if (M7.rvoid()!==false) {if (M7.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res67 = M7.rvoid();} else {var if_res67 = M10.__rjs_quoted__.check_naturals(start130);}var if_res68 = if_res67;} else {var if_res68 = false;}if_res68;M7.rvoid();var for_loop138 = function(vec139, i140, pos141, pos142, pos143) {if (pos_cont_p127!==false) {var if_res69 = pos_cont_p127(pos141);} else {var if_res69 = true;}if (if_res69!==false) {var if_res70 = true;} else {var if_res70 = false;}if (if_res70!==false) {if (pos_cont_p135!==false) {var if_res71 = pos_cont_p135(pos143);} else {var if_res71 = true;}var if_res72 = if_res71;} else {var if_res72 = false;}if (if_res72!==false) {var c151 = pos__gt_vals123(pos141);if (all_cont_p129!==false) {var if_res73 = function(pos152) {return all_cont_p129(pos152,c151);};} else {var if_res73 = false;}var let_result74 = M7.values(c151,if_res73);var c144 = let_result74.getAt(0);var all_cont_p_by_pos145 = let_result74.getAt(1);if (pos_pre_inc124!==false) {var if_res75 = pos_pre_inc124(pos141);} else {var if_res75 = pos141;}var pos146 = if_res75;var i147 = pos142;var expected153 = pos__gt_vals131(pos143);if (all_cont_p137!==false) {var if_res76 = function(pos154) {return all_cont_p137(pos154,expected153);};} else {var if_res76 = false;}var let_result77 = M7.values(expected153,if_res76);var expected148 = let_result77.getAt(0);var all_cont_p_by_pos149 = let_result77.getAt(1);if (pos_pre_inc132!==false) {var if_res78 = pos_pre_inc132(pos143);} else {var if_res78 = pos143;}var pos150 = if_res78;if (val_cont_p128!==false) {var if_res79 = val_cont_p128(c144);} else {var if_res79 = true;}if (if_res79!==false) {var if_res80 = true;} else {var if_res80 = false;}if (if_res80!==false) {if (val_cont_p136!==false) {var if_res81 = val_cont_p136(expected148);} else {var if_res81 = true;}var if_res82 = if_res81;} else {var if_res82 = false;}if (if_res82!==false) {var vec157 = vec139;var i158 = i140;if (M7.eq_p(i158,M14.unsafe_vector_times__length(vec157))!==false) {var if_res83 = M10.__rjs_quoted__.grow_vector(vec157);} else {var if_res83 = vec157;}var new_vec161 = if_res83;if (M7.char_eq__p(c144,expected148)!==false) {mark_used_bang_(remaining_letters119,i147);var if_res84 = CORRECT_COLOR;} else {var if_res84 = WRONG_COLOR;}M14.unsafe_vector_times__set_bang_(new_vec161,i158,if_res84);var let_result85 = M7.values(new_vec161,M14.unsafe_fx_plus_(i158,1));var vec159 = let_result85.getAt(0);var i160 = let_result85.getAt(1);var let_result86 = M7.values(vec159,i160);var vec155 = let_result86.getAt(0);var i156 = let_result86.getAt(1);if (all_cont_p_by_pos145!==false) {var if_res87 = all_cont_p_by_pos145(pos146);} else {var if_res87 = true;}if (if_res87!==false) {var if_res88 = true;} else {var if_res88 = false;}if (if_res88!==false) {if (all_cont_p_by_pos149!==false) {var if_res89 = all_cont_p_by_pos149(pos150);} else {var if_res89 = true;}if (if_res89!==false) {var if_res90 = M7.not(false);} else {var if_res90 = false;}var if_res91 = if_res90;} else {var if_res91 = false;}if (if_res91!==false) {var if_res92 = for_loop138(vec155,i156,pos_next125(pos146),pos142+1,pos_next133(pos150));} else {var if_res92 = M7.values(vec155,i156);}var if_res93 = if_res92;} else {var if_res93 = M7.values(vec139,i140);}var if_res94 = if_res93;} else {var if_res94 = M7.values(vec139,i140);}return if_res94;};var let_result95 = for_loop138(M7.make_vector(16),0,init126,start130,init134);var vec121 = let_result95.getAt(0);var i122 = let_result95.getAt(1);var partial_colors120 = M10.__rjs_quoted__.shrink_vector(vec121,i122);var let_result96 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("col")),partial_colors120);var pos__gt_vals162 = let_result96.getAt(0);var pos_pre_inc163 = let_result96.getAt(1);var pos_next164 = let_result96.getAt(2);var init165 = let_result96.getAt(3);var pos_cont_p166 = let_result96.getAt(4);var val_cont_p167 = let_result96.getAt(5);var all_cont_p168 = let_result96.getAt(6);var let_result97 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("c")),word118);var pos__gt_vals169 = let_result97.getAt(0);var pos_pre_inc170 = let_result97.getAt(1);var pos_next171 = let_result97.getAt(2);var init172 = let_result97.getAt(3);var pos_cont_p173 = let_result97.getAt(4);var val_cont_p174 = let_result97.getAt(5);var all_cont_p175 = let_result97.getAt(6);var start176 = 0;var let_result98 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("expected")),ANSWER);var pos__gt_vals177 = let_result98.getAt(0);var pos_pre_inc178 = let_result98.getAt(1);var pos_next179 = let_result98.getAt(2);var init180 = let_result98.getAt(3);var pos_cont_p181 = let_result98.getAt(4);var val_cont_p182 = let_result98.getAt(5);var all_cont_p183 = let_result98.getAt(6);M7.rvoid();if (M7.rvoid()!==false) {if (M7.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res99 = M7.rvoid();} else {var if_res99 = M10.__rjs_quoted__.check_naturals(start176);}var if_res100 = if_res99;} else {var if_res100 = false;}if_res100;M7.rvoid();var for_loop184 = function(fold_var185, pos186, pos187, pos188, pos189) {if (pos_cont_p166!==false) {var if_res101 = pos_cont_p166(pos186);} else {var if_res101 = true;}if (if_res101!==false) {if (pos_cont_p173!==false) {var if_res102 = pos_cont_p173(pos187);} else {var if_res102 = true;}if (if_res102!==false) {var if_res103 = true;} else {var if_res103 = false;}if (if_res103!==false) {if (pos_cont_p181!==false) {var if_res104 = pos_cont_p181(pos189);} else {var if_res104 = true;}var if_res105 = if_res104;} else {var if_res105 = false;}var if_res106 = if_res105;} else {var if_res106 = false;}if (if_res106!==false) {var col200 = pos__gt_vals162(pos186);if (all_cont_p168!==false) {var if_res107 = function(pos201) {return all_cont_p168(pos201,col200);};} else {var if_res107 = false;}var let_result108 = M7.values(col200,if_res107);var col190 = let_result108.getAt(0);var all_cont_p_by_pos191 = let_result108.getAt(1);if (pos_pre_inc163!==false) {var if_res109 = pos_pre_inc163(pos186);} else {var if_res109 = pos186;}var pos192 = if_res109;var c202 = pos__gt_vals169(pos187);if (all_cont_p175!==false) {var if_res110 = function(pos203) {return all_cont_p175(pos203,c202);};} else {var if_res110 = false;}var let_result111 = M7.values(c202,if_res110);var c193 = let_result111.getAt(0);var all_cont_p_by_pos194 = let_result111.getAt(1);if (pos_pre_inc170!==false) {var if_res112 = pos_pre_inc170(pos187);} else {var if_res112 = pos187;}var pos195 = if_res112;var i196 = pos188;var expected204 = pos__gt_vals177(pos189);if (all_cont_p183!==false) {var if_res113 = function(pos205) {return all_cont_p183(pos205,expected204);};} else {var if_res113 = false;}var let_result114 = M7.values(expected204,if_res113);var expected197 = let_result114.getAt(0);var all_cont_p_by_pos198 = let_result114.getAt(1);if (pos_pre_inc178!==false) {var if_res115 = pos_pre_inc178(pos189);} else {var if_res115 = pos189;}var pos199 = if_res115;if (val_cont_p167!==false) {var if_res116 = val_cont_p167(col190);} else {var if_res116 = true;}if (if_res116!==false) {if (val_cont_p174!==false) {var if_res117 = val_cont_p174(c193);} else {var if_res117 = true;}if (if_res117!==false) {var if_res118 = true;} else {var if_res118 = false;}if (if_res118!==false) {if (val_cont_p182!==false) {var if_res119 = val_cont_p182(expected197);} else {var if_res119 = true;}var if_res120 = if_res119;} else {var if_res120 = false;}var if_res121 = if_res120;} else {var if_res121 = false;}if (if_res121!==false) {var fold_var207 = fold_var185;if (M7.equal_p(col190,CORRECT_COLOR)!==false) {var if_res123 = CORRECT_COLOR;} else {if (M2.vector_member(c193,remaining_letters119)!==false) {mark_used_bang_(remaining_letters119,c193);var if_res122 = MAYBE_COLOR;} else {var if_res122 = WRONG_COLOR;}var if_res123 = if_res122;}var fold_var208 = M7.cons(if_res123,fold_var207);var fold_var206 = M7.values(fold_var208);if (all_cont_p_by_pos191!==false) {var if_res124 = all_cont_p_by_pos191(pos192);} else {var if_res124 = true;}if (if_res124!==false) {if (all_cont_p_by_pos194!==false) {var if_res125 = all_cont_p_by_pos194(pos195);} else {var if_res125 = true;}if (if_res125!==false) {var if_res126 = true;} else {var if_res126 = false;}if (if_res126!==false) {if (all_cont_p_by_pos198!==false) {var if_res127 = all_cont_p_by_pos198(pos199);} else {var if_res127 = true;}if (if_res127!==false) {var if_res128 = M7.not(false);} else {var if_res128 = false;}var if_res129 = if_res128;} else {var if_res129 = false;}var if_res130 = if_res129;} else {var if_res130 = false;}if (if_res130!==false) {var if_res131 = for_loop184(fold_var206,pos_next164(pos192),pos_next171(pos195),pos188+1,pos_next179(pos199));} else {var if_res131 = fold_var206;}var if_res132 = if_res131;} else {var if_res132 = fold_var185;}var if_res133 = if_res132;} else {var if_res133 = fold_var185;}return if_res133;};return M13.alt_reverse(for_loop184(M7.rnull,init165,init172,start176,init180));};var USED_LETTER = $rjs_core.UString.make("-");var mark_used_bang_ = function(vec209, c_by_i210) {if (M7.number_p(c_by_i210)!==false) {var if_res151 = M7.vector_set_bang_(vec209,c_by_i210,USED_LETTER);} else {var let_result134 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("j")),M7.vector_length(vec209));var pos__gt_vals213 = let_result134.getAt(0);var pos_pre_inc214 = let_result134.getAt(1);var pos_next215 = let_result134.getAt(2);var init216 = let_result134.getAt(3);var pos_cont_p217 = let_result134.getAt(4);var val_cont_p218 = let_result134.getAt(5);var all_cont_p219 = let_result134.getAt(6);M7.rvoid();var for_loop220 = function(val221, stop_p222, pos223) {if (pos_cont_p217!==false) {var if_res135 = pos_cont_p217(pos223);} else {var if_res135 = true;}if (if_res135!==false) {var j227 = pos__gt_vals213(pos223);if (all_cont_p219!==false) {var if_res136 = function(pos228) {return all_cont_p219(pos228,j227);};} else {var if_res136 = false;}var let_result137 = M7.values(j227,if_res136);var j224 = let_result137.getAt(0);var all_cont_p_by_pos225 = let_result137.getAt(1);if (pos_pre_inc214!==false) {var if_res138 = pos_pre_inc214(pos223);} else {var if_res138 = pos223;}var pos226 = if_res138;if (val_cont_p218!==false) {var if_res139 = val_cont_p218(j224);} else {var if_res139 = true;}if (if_res139!==false) {var val231 = val221;var stop_p232 = stop_p222;if (M7.equal_p(M7.vector_ref(vec209,j224),c_by_i210)!==false) {var val233 = val231;var stop_p234 = stop_p232;var let_result140 = M7.values(M7.vector_set_bang_(vec209,j224,USED_LETTER),true);var val235 = let_result140.getAt(0);var stop_p236 = let_result140.getAt(1);var if_res141 = M7.values(val235,stop_p236);} else {var if_res141 = M7.values(val231,stop_p232);}var let_result142 = if_res141;var val229 = let_result142.getAt(0);var stop_p230 = let_result142.getAt(1);if (all_cont_p_by_pos225!==false) {var if_res143 = all_cont_p_by_pos225(pos226);} else {var if_res143 = true;}if (if_res143!==false) {var if_res145 = M7.not($rjs_core.attachProcedureArity(function(...x237144) {var x237 = $rjs_core.Pair.listFromArray(x237144);return stop_p230;})(j224));} else {var if_res145 = false;}if (if_res145!==false) {var if_res146 = M7.not(false);} else {var if_res146 = false;}if (if_res146!==false) {var if_res147 = for_loop220(val229,stop_p230,pos_next215(pos226));} else {var if_res147 = M7.values(val229,stop_p230);}var if_res148 = if_res147;} else {var if_res148 = M7.values(val221,stop_p222);}var if_res149 = if_res148;} else {var if_res149 = M7.values(val221,stop_p222);}return if_res149;};var let_result150 = for_loop220(false,false,init216);var val211 = let_result150.getAt(0);var _212 = let_result150.getAt(1);var if_res151 = val211;}return if_res151;};var guesschar__gt_tile = function(c238, tile_color239) {return M9.overlay(char__gt_img(c238,GUESS_CHAR_COLOR),mk_guess_tile(tile_color239));};var char__gt_img = function(c240, color241) {return M9.text(char__gt_string(c240),GUESS_CHAR_FONT_SIZE,color241);};var char__gt_string = function(c242) {return M7.string_upcase(M7.string(c242));};var mk_guess_tile = function(color243) {return M9.square(GUESS_TILE_HEIGHT,$rjs_core.UString.make("solid"),color243);};var render_current = function(word244) {if (M12.member(word244,ALL_WORDS)!==false) {var if_res152 = valid_char__gt_tile;} else {var if_res152 = char__gt_tile;}return img_join(M7.append(M5.map(if_res152,M7.string__gt_list(word244)),repeat(BLANK,WORD_LENGTH-M7.string_length(word244))),CHARGAP,M9.beside);};var char__gt_tile = function(c245) {return M9.overlay(char__gt_img(c245,CURRENT_CHAR_INVALID_COLOR),BLANK);};var valid_char__gt_tile = function(c246) {return M9.overlay(char__gt_img(c246,CURRENT_CHAR_VALID_COLOR),BLANK);};var BLANK_WORD = render_current($rjs_core.UString.make(""));var render_blanks = function(guesses_remaining247) {var let_result153 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("n")),M7.sub1(guesses_remaining247));var pos__gt_vals248 = let_result153.getAt(0);var pos_pre_inc249 = let_result153.getAt(1);var pos_next250 = let_result153.getAt(2);var init251 = let_result153.getAt(3);var pos_cont_p252 = let_result153.getAt(4);var val_cont_p253 = let_result153.getAt(5);var all_cont_p254 = let_result153.getAt(6);M7.rvoid();var for_loop255 = function(img256, pos257) {if (pos_cont_p252!==false) {var if_res154 = pos_cont_p252(pos257);} else {var if_res154 = true;}if (if_res154!==false) {var n261 = pos__gt_vals248(pos257);if (all_cont_p254!==false) {var if_res155 = function(pos262) {return all_cont_p254(pos262,n261);};} else {var if_res155 = false;}var let_result156 = M7.values(n261,if_res155);var n258 = let_result156.getAt(0);var all_cont_p_by_pos259 = let_result156.getAt(1);if (pos_pre_inc249!==false) {var if_res157 = pos_pre_inc249(pos257);} else {var if_res157 = pos257;}var pos260 = if_res157;if (val_cont_p253!==false) {var if_res158 = val_cont_p253(n258);} else {var if_res158 = true;}if (if_res158!==false) {var img264 = img256;var img265 = M9.above(img264,BLANK_WORD,LINEGAP);var img263 = M7.values(img265);if (all_cont_p_by_pos259!==false) {var if_res159 = all_cont_p_by_pos259(pos260);} else {var if_res159 = true;}if (if_res159!==false) {var if_res160 = M7.not(false);} else {var if_res160 = false;}if (if_res160!==false) {var if_res161 = for_loop255(img263,pos_next250(pos260));} else {var if_res161 = img263;}var if_res162 = if_res161;} else {var if_res162 = img256;}var if_res163 = if_res162;} else {var if_res163 = img256;}return if_res163;};return for_loop255(LINEGAP,init251);};var KEYBOARD_1ST_ROW = $rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("q"),$rjs_core.PrimitiveSymbol.make("w"),$rjs_core.PrimitiveSymbol.make("e"),$rjs_core.PrimitiveSymbol.make("r"),$rjs_core.PrimitiveSymbol.make("t"),$rjs_core.PrimitiveSymbol.make("y"),$rjs_core.PrimitiveSymbol.make("u"),$rjs_core.PrimitiveSymbol.make("i"),$rjs_core.PrimitiveSymbol.make("o"),$rjs_core.PrimitiveSymbol.make("p"));var KEYBOARD_2ND_ROW = $rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("a"),$rjs_core.PrimitiveSymbol.make("s"),$rjs_core.PrimitiveSymbol.make("d"),$rjs_core.PrimitiveSymbol.make("f"),$rjs_core.PrimitiveSymbol.make("g"),$rjs_core.PrimitiveSymbol.make("h"),$rjs_core.PrimitiveSymbol.make("j"),$rjs_core.PrimitiveSymbol.make("k"),$rjs_core.PrimitiveSymbol.make("l"));var KEYBOARD_3RD_ROW = $rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("z"),$rjs_core.PrimitiveSymbol.make("x"),$rjs_core.PrimitiveSymbol.make("c"),$rjs_core.PrimitiveSymbol.make("v"),$rjs_core.PrimitiveSymbol.make("b"),$rjs_core.PrimitiveSymbol.make("n"),$rjs_core.PrimitiveSymbol.make("m"));var KEYBOARD = M7.list(KEYBOARD_1ST_ROW,KEYBOARD_2ND_ROW,KEYBOARD_3RD_ROW);var KEY_HEIGHT = 32;var KEYBOARD_FONT_SIZE = 14;var ENTER_KEY = M9.overlay(M9.rectangle(1.5*KEY_HEIGHT,KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray")),M9.text($rjs_core.UString.make("ENTER"),10,$rjs_core.PrimitiveSymbol.make("black")));var BACKSPACE_KEY = M9.overlay(M9.rectangle(1.5*KEY_HEIGHT,KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray")),M9.text($rjs_core.UString.make("Backspace"),8,$rjs_core.PrimitiveSymbol.make("black")));var render_keyboard = function(guesses266) {return M9.above(keys__gt_img(KEYBOARD_1ST_ROW,guesses266),keys__gt_img(KEYBOARD_2ND_ROW,guesses266),M9.beside(ENTER_KEY,keys__gt_img(KEYBOARD_3RD_ROW,guesses266),BACKSPACE_KEY));};var keys__gt_img = function(ks267, guesses268) {var let_result164 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("k")),ks267);var pos__gt_vals269 = let_result164.getAt(0);var pos_pre_inc270 = let_result164.getAt(1);var pos_next271 = let_result164.getAt(2);var init272 = let_result164.getAt(3);var pos_cont_p273 = let_result164.getAt(4);var val_cont_p274 = let_result164.getAt(5);var all_cont_p275 = let_result164.getAt(6);M7.rvoid();var for_loop276 = function(fold_var277, pos278) {if (pos_cont_p273!==false) {var if_res165 = pos_cont_p273(pos278);} else {var if_res165 = true;}if (if_res165!==false) {var k282 = pos__gt_vals269(pos278);if (all_cont_p275!==false) {var if_res166 = function(pos283) {return all_cont_p275(pos283,k282);};} else {var if_res166 = false;}var let_result167 = M7.values(k282,if_res166);var k279 = let_result167.getAt(0);var all_cont_p_by_pos280 = let_result167.getAt(1);if (pos_pre_inc270!==false) {var if_res168 = pos_pre_inc270(pos278);} else {var if_res168 = pos278;}var pos281 = if_res168;if (val_cont_p274!==false) {var if_res169 = val_cont_p274(k279);} else {var if_res169 = true;}if (if_res169!==false) {var fold_var285 = fold_var277;var fold_var286 = M7.cons(key__gt_img(k279,guesses268),fold_var285);var fold_var284 = M7.values(fold_var286);if (all_cont_p_by_pos280!==false) {var if_res170 = all_cont_p_by_pos280(pos281);} else {var if_res170 = true;}if (if_res170!==false) {var if_res171 = M7.not(false);} else {var if_res171 = false;}if (if_res171!==false) {var if_res172 = for_loop276(fold_var284,pos_next271(pos281));} else {var if_res172 = fold_var284;}var if_res173 = if_res172;} else {var if_res173 = fold_var277;}var if_res174 = if_res173;} else {var if_res174 = fold_var277;}return if_res174;};return M7.apply(M9.beside,M13.alt_reverse(for_loop276(M7.rnull,init272)));};var key__gt_img = function(sym287, guesses288) {var tile_col289 = key_color(M7.symbol__gt_string(sym287),guesses288);var temp176 = M7.string_upcase(M7.symbol__gt_string(sym287));if (M7.equal_p(tile_col289,$rjs_core.UString.make("white"))!==false) {var if_res175 = $rjs_core.UString.make("black");} else {var if_res175 = $rjs_core.UString.make("white");}return M9.overlay(M9.text(temp176,KEYBOARD_FONT_SIZE,if_res175),mk_key_tile(tile_col289));};var mk_key_tile = function(color290) {if (M7.equal_p(color290,$rjs_core.UString.make("white"))!==false) {var if_res177 = M9.square(KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("outline"),$rjs_core.PrimitiveSymbol.make("gray"));} else {var if_res177 = M9.square(KEY_HEIGHT,$rjs_core.PrimitiveSymbol.make("solid"),color290);}return if_res177;};var key_color = function(k291, guesses292) {if (correct_char_p(k291,guesses292)!==false) {var if_res180 = CORRECT_COLOR;} else {if (maybe_char_p(k291,guesses292)!==false) {var if_res179 = MAYBE_COLOR;} else {if (wrong_char_p(k291,guesses292)!==false) {var if_res178 = WRONG_COLOR;} else {var if_res178 = $rjs_core.UString.make("white");}var if_res179 = if_res178;}var if_res180 = if_res179;}return if_res180;};var correct_char_p = function(k293, guesses294) {var let_result181 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("g")),guesses294);var pos__gt_vals295 = let_result181.getAt(0);var pos_pre_inc296 = let_result181.getAt(1);var pos_next297 = let_result181.getAt(2);var init298 = let_result181.getAt(3);var pos_cont_p299 = let_result181.getAt(4);var val_cont_p300 = let_result181.getAt(5);var all_cont_p301 = let_result181.getAt(6);M7.rvoid();var for_loop302 = function(result303, pos304) {if (pos_cont_p299!==false) {var if_res182 = pos_cont_p299(pos304);} else {var if_res182 = true;}if (if_res182!==false) {var g308 = pos__gt_vals295(pos304);if (all_cont_p301!==false) {var if_res183 = function(pos309) {return all_cont_p301(pos309,g308);};} else {var if_res183 = false;}var let_result184 = M7.values(g308,if_res183);var g305 = let_result184.getAt(0);var all_cont_p_by_pos306 = let_result184.getAt(1);if (pos_pre_inc296!==false) {var if_res185 = pos_pre_inc296(pos304);} else {var if_res185 = pos304;}var pos307 = if_res185;if (val_cont_p300!==false) {var if_res186 = val_cont_p300(g305);} else {var if_res186 = true;}if (if_res186!==false) {var result311 = result303;var let_result187 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),g305);var pos__gt_vals313 = let_result187.getAt(0);var pos_pre_inc314 = let_result187.getAt(1);var pos_next315 = let_result187.getAt(2);var init316 = let_result187.getAt(3);var pos_cont_p317 = let_result187.getAt(4);var val_cont_p318 = let_result187.getAt(5);var all_cont_p319 = let_result187.getAt(6);var let_result188 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("y")),ANSWER);var pos__gt_vals320 = let_result188.getAt(0);var pos_pre_inc321 = let_result188.getAt(1);var pos_next322 = let_result188.getAt(2);var init323 = let_result188.getAt(3);var pos_cont_p324 = let_result188.getAt(4);var val_cont_p325 = let_result188.getAt(5);var all_cont_p326 = let_result188.getAt(6);M7.rvoid();M7.rvoid();var for_loop327 = function(result328, pos329, pos330) {if (pos_cont_p317!==false) {var if_res189 = pos_cont_p317(pos329);} else {var if_res189 = true;}if (if_res189!==false) {if (pos_cont_p324!==false) {var if_res190 = pos_cont_p324(pos330);} else {var if_res190 = true;}var if_res191 = if_res190;} else {var if_res191 = false;}if (if_res191!==false) {var x337 = pos__gt_vals313(pos329);if (all_cont_p319!==false) {var if_res192 = function(pos338) {return all_cont_p319(pos338,x337);};} else {var if_res192 = false;}var let_result193 = M7.values(x337,if_res192);var x331 = let_result193.getAt(0);var all_cont_p_by_pos332 = let_result193.getAt(1);if (pos_pre_inc314!==false) {var if_res194 = pos_pre_inc314(pos329);} else {var if_res194 = pos329;}var pos333 = if_res194;var y339 = pos__gt_vals320(pos330);if (all_cont_p326!==false) {var if_res195 = function(pos340) {return all_cont_p326(pos340,y339);};} else {var if_res195 = false;}var let_result196 = M7.values(y339,if_res195);var y334 = let_result196.getAt(0);var all_cont_p_by_pos335 = let_result196.getAt(1);if (pos_pre_inc321!==false) {var if_res197 = pos_pre_inc321(pos330);} else {var if_res197 = pos330;}var pos336 = if_res197;if (val_cont_p318!==false) {var if_res198 = val_cont_p318(x331);} else {var if_res198 = true;}if (if_res198!==false) {if (val_cont_p325!==false) {var if_res199 = val_cont_p325(y334);} else {var if_res199 = true;}var if_res200 = if_res199;} else {var if_res200 = false;}if (if_res200!==false) {var result342 = result328;if (M7.equal_p(x331,y334)!==false) {var if_res201 = M7.equal_p(M7.string(x331),k293);} else {var if_res201 = false;}var result343 = if_res201;var result341 = M7.values(result343);if (all_cont_p_by_pos332!==false) {var if_res202 = all_cont_p_by_pos332(pos333);} else {var if_res202 = true;}if (if_res202!==false) {var if_res204 = M7.not($rjs_core.attachProcedureArity(function(...x344203) {var x344 = $rjs_core.Pair.listFromArray(x344203);return result341;})(x331));} else {var if_res204 = false;}if (if_res204!==false) {if (all_cont_p_by_pos335!==false) {var if_res205 = all_cont_p_by_pos335(pos336);} else {var if_res205 = true;}if (if_res205!==false) {var if_res207 = M7.not($rjs_core.attachProcedureArity(function(...x345206) {var x345 = $rjs_core.Pair.listFromArray(x345206);return result341;})(y334));} else {var if_res207 = false;}if (if_res207!==false) {var if_res208 = M7.not(false);} else {var if_res208 = false;}var if_res209 = if_res208;} else {var if_res209 = false;}if (if_res209!==false) {var if_res210 = for_loop327(result341,pos_next315(pos333),pos_next322(pos336));} else {var if_res210 = result341;}var if_res211 = if_res210;} else {var if_res211 = result328;}var if_res212 = if_res211;} else {var if_res212 = result328;}return if_res212;};var result312 = for_loop327(false,init316,init323);var result310 = M7.values(result312);if (all_cont_p_by_pos306!==false) {var if_res213 = all_cont_p_by_pos306(pos307);} else {var if_res213 = true;}if (if_res213!==false) {var if_res215 = M7.not($rjs_core.attachProcedureArity(function(...x346214) {var x346 = $rjs_core.Pair.listFromArray(x346214);return result310;})(g305));} else {var if_res215 = false;}if (if_res215!==false) {var if_res216 = M7.not(false);} else {var if_res216 = false;}if (if_res216!==false) {var if_res217 = for_loop302(result310,pos_next297(pos307));} else {var if_res217 = result310;}var if_res218 = if_res217;} else {var if_res218 = result303;}var if_res219 = if_res218;} else {var if_res219 = result303;}return if_res219;};return for_loop302(false,init298);};var maybe_char_p = function(k347, guesses348) {if (M8.string_contains_p(ANSWER,k347)!==false) {var let_result220 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("g")),guesses348);var pos__gt_vals349 = let_result220.getAt(0);var pos_pre_inc350 = let_result220.getAt(1);var pos_next351 = let_result220.getAt(2);var init352 = let_result220.getAt(3);var pos_cont_p353 = let_result220.getAt(4);var val_cont_p354 = let_result220.getAt(5);var all_cont_p355 = let_result220.getAt(6);M7.rvoid();var for_loop356 = function(result357, pos358) {if (pos_cont_p353!==false) {var if_res221 = pos_cont_p353(pos358);} else {var if_res221 = true;}if (if_res221!==false) {var g362 = pos__gt_vals349(pos358);if (all_cont_p355!==false) {var if_res222 = function(pos363) {return all_cont_p355(pos363,g362);};} else {var if_res222 = false;}var let_result223 = M7.values(g362,if_res222);var g359 = let_result223.getAt(0);var all_cont_p_by_pos360 = let_result223.getAt(1);if (pos_pre_inc350!==false) {var if_res224 = pos_pre_inc350(pos358);} else {var if_res224 = pos358;}var pos361 = if_res224;if (val_cont_p354!==false) {var if_res225 = val_cont_p354(g359);} else {var if_res225 = true;}if (if_res225!==false) {var result365 = result357;var result366 = M8.string_contains_p(g359,k347);var result364 = M7.values(result366);if (all_cont_p_by_pos360!==false) {var if_res226 = all_cont_p_by_pos360(pos361);} else {var if_res226 = true;}if (if_res226!==false) {var if_res228 = M7.not($rjs_core.attachProcedureArity(function(...x367227) {var x367 = $rjs_core.Pair.listFromArray(x367227);return result364;})(g359));} else {var if_res228 = false;}if (if_res228!==false) {var if_res229 = M7.not(false);} else {var if_res229 = false;}if (if_res229!==false) {var if_res230 = for_loop356(result364,pos_next351(pos361));} else {var if_res230 = result364;}var if_res231 = if_res230;} else {var if_res231 = result357;}var if_res232 = if_res231;} else {var if_res232 = result357;}return if_res232;};var if_res233 = for_loop356(false,init352);} else {var if_res233 = false;}return if_res233;};var wrong_char_p = function(k368, guesses369) {var let_result234 = M10.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("g")),guesses369);var pos__gt_vals370 = let_result234.getAt(0);var pos_pre_inc371 = let_result234.getAt(1);var pos_next372 = let_result234.getAt(2);var init373 = let_result234.getAt(3);var pos_cont_p374 = let_result234.getAt(4);var val_cont_p375 = let_result234.getAt(5);var all_cont_p376 = let_result234.getAt(6);M7.rvoid();var for_loop377 = function(result378, pos379) {if (pos_cont_p374!==false) {var if_res235 = pos_cont_p374(pos379);} else {var if_res235 = true;}if (if_res235!==false) {var g383 = pos__gt_vals370(pos379);if (all_cont_p376!==false) {var if_res236 = function(pos384) {return all_cont_p376(pos384,g383);};} else {var if_res236 = false;}var let_result237 = M7.values(g383,if_res236);var g380 = let_result237.getAt(0);var all_cont_p_by_pos381 = let_result237.getAt(1);if (pos_pre_inc371!==false) {var if_res238 = pos_pre_inc371(pos379);} else {var if_res238 = pos379;}var pos382 = if_res238;if (val_cont_p375!==false) {var if_res239 = val_cont_p375(g380);} else {var if_res239 = true;}if (if_res239!==false) {var result386 = result378;var result387 = M8.string_contains_p(g380,k368);var result385 = M7.values(result387);if (all_cont_p_by_pos381!==false) {var if_res240 = all_cont_p_by_pos381(pos382);} else {var if_res240 = true;}if (if_res240!==false) {var if_res242 = M7.not($rjs_core.attachProcedureArity(function(...x388241) {var x388 = $rjs_core.Pair.listFromArray(x388241);return result385;})(g380));} else {var if_res242 = false;}if (if_res242!==false) {var if_res243 = M7.not(false);} else {var if_res243 = false;}if (if_res243!==false) {var if_res244 = for_loop377(result385,pos_next372(pos382));} else {var if_res244 = result385;}var if_res245 = if_res244;} else {var if_res245 = result378;}var if_res246 = if_res245;} else {var if_res246 = result378;}return if_res246;};if (for_loop377(false,init373)!==false) {var if_res247 = M7.not(M8.string_contains_p(ANSWER,k368));} else {var if_res247 = false;}return if_res247;};var process_key = function(g389, k390) {if (M1.key_eq__p(k390,$rjs_core.UString.make("\r"))!==false) {if (ACTIVE_GAME!==false) {var if_res248 = game_submit_guess(g389);} else {var if_res248 = mk_start_state();}var if_res251 = if_res248;} else {if (M1.key_eq__p(k390,$rjs_core.UString.make("\b"))!==false) {var if_res250 = game_del_char(g389);} else {if (valid_char_p(k390)!==false) {var if_res249 = game_add_char(g389,k390);} else {var if_res249 = g389;}var if_res250 = if_res249;}var if_res251 = if_res250;}return if_res251;};var valid_char_p = function(k391) {if (M7.__eq_(1,M7.string_length(k391))!==false) {var if_res252 = M7.regexp_match_p($rjs_core.Regexp.fromString("[A-Za-z]"),k391);} else {var if_res252 = false;}return if_res252;};var handle_mouse = function(g392, x393, y394, evt395) {if (M1.mouse_eq__p(evt395,$rjs_core.UString.make("button-down"))!==false) {if (M7.not(ACTIVE_GAME)!==false) {var if_res253 = mouse_play_again_p(game_guesses(g392),y394);} else {var if_res253 = false;}if (if_res253!==false) {var if_res259 = mk_start_state();} else {if (mouse_in_1st_row_p(x393,y394)!==false) {var if_res258 = game_add_char(g392,row1__gt_char(x393));} else {if (mouse_in_2nd_row_p(x393,y394)!==false) {var if_res257 = game_add_char(g392,row2__gt_char(x393));} else {if (mouse_in_3rd_row_p(x393,y394)!==false) {var if_res256 = game_add_char(g392,row3__gt_char(x393));} else {if (mouse_enter_p(x393,y394)!==false) {var if_res255 = game_submit_guess(g392);} else {if (mouse_backspace_p(x393,y394)!==false) {var if_res254 = game_del_char(g392);} else {var if_res254 = g392;}var if_res255 = if_res254;}var if_res256 = if_res255;}var if_res257 = if_res256;}var if_res258 = if_res257;}var if_res259 = if_res258;}var if_res260 = if_res259;} else {var if_res260 = g392;}return if_res260;};var KEYBOARD_Y_START = 356;var KEYBOARD_Y1_START = KEYBOARD_Y_START;var KEYBOARD_Y1_END = KEYBOARD_Y1_START+KEY_HEIGHT;var KEYBOARD_Y2_START = KEYBOARD_Y1_END;var KEYBOARD_Y2_END = KEYBOARD_Y2_START+KEY_HEIGHT;var KEYBOARD_Y3_START = KEYBOARD_Y2_END;var KEYBOARD_Y3_END = KEYBOARD_Y3_START+KEY_HEIGHT;var KEYBOARD_Y_END = KEYBOARD_Y3_END;var KEYBOARD_X1_START = 0;var KEYBOARD_X1_END = KEYBOARD_X1_START+(M7.length(M11.first(KEYBOARD))*KEY_HEIGHT);var KEYBOARD_X2_START = KEYBOARD_X1_START+(KEY_HEIGHT/2);var KEYBOARD_X2_END = KEYBOARD_X2_START+(M7.length(M11.second(KEYBOARD))*KEY_HEIGHT);var KEYBOARD_X3_START = KEYBOARD_X2_START+KEY_HEIGHT;var KEYBOARD_X3_END = KEYBOARD_X3_START+(M7.length(M11.third(KEYBOARD))*KEY_HEIGHT);var mouse_play_again_p = function(guesses396, y397) {var y_adjustment398 = (MAX_GUESSES-M7.length(guesses396))*(GUESS_TILE_HEIGHT+GAP);return M7.__lt__eq_(KEYBOARD_Y_START-y_adjustment398,y397,KEYBOARD_Y_END);};var mouse_in_1st_row_p = function(x399, y400) {if (M7.__lt_(KEYBOARD_Y1_START,y400,KEYBOARD_Y1_END)!==false) {var if_res261 = M7.__lt_(KEYBOARD_X1_START,x399,KEYBOARD_X1_END);} else {var if_res261 = false;}return if_res261;};var mouse_in_2nd_row_p = function(x401, y402) {if (M7.__lt_(KEYBOARD_Y2_START,y402,KEYBOARD_Y2_END)!==false) {var if_res262 = M7.__lt_(KEYBOARD_X2_START,x401,KEYBOARD_X2_END);} else {var if_res262 = false;}return if_res262;};var mouse_in_3rd_row_p = function(x403, y404) {if (M7.__lt_(KEYBOARD_Y3_START,y404,KEYBOARD_Y3_END)!==false) {var if_res263 = M7.__lt_(KEYBOARD_X3_START,x403,KEYBOARD_X3_END);} else {var if_res263 = false;}return if_res263;};var mouse_enter_p = function(x405, y406) {if (M7.__lt_(KEYBOARD_Y3_START,y406,KEYBOARD_Y3_END)!==false) {var if_res264 = M7.__lt_(0,x405,1.5*KEY_HEIGHT);} else {var if_res264 = false;}return if_res264;};var mouse_backspace_p = function(x407, y408) {if (M7.__lt_(KEYBOARD_Y3_START,y408,KEYBOARD_Y3_END)!==false) {var if_res265 = M7.__lt_(KEYBOARD_X3_END,x407,KEYBOARD_X3_END+(1.5*KEY_HEIGHT));} else {var if_res265 = false;}return if_res265;};var row1__gt_char = function(x409) {return M7.symbol__gt_string(M7.list_ref(M11.first(KEYBOARD),M7.quotient(x409,KEY_HEIGHT)));};var row2__gt_char = function(x410) {return M7.symbol__gt_string(M7.list_ref(M11.second(KEYBOARD),M7.quotient(x410-KEYBOARD_X2_START,KEY_HEIGHT)));};var row3__gt_char = function(x411) {return M7.symbol__gt_string(M7.list_ref(M11.third(KEYBOARD),M7.quotient(x411-KEYBOARD_X3_START,KEY_HEIGHT)));};M7.call_with_values(function() {return M1.big_bang(mk_start_state(),M1.to_draw(render),M1.on_key(process_key),M1.on_mouse(handle_mouse));},M0.__rjs_quoted__.print_values);var __rjs_quoted__ = {};__rjs_quoted__.game_guesses = game_guesses;__rjs_quoted__.game1 = game1;__rjs_quoted__.game_current_guess = game_current_guess;__rjs_quoted__.struct_game = struct_game;__rjs_quoted__.game_p = game_p;export { __rjs_quoted__ };